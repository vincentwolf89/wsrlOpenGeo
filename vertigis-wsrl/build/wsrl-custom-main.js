/*! For license information please see main.js.LICENSE.txt */
define(["@arcgis/core/identity/IdentityManager","@arcgis/core/identity/OAuthInfo","react/jsx-runtime","react","@vertigis/web/components","@vertigis/web/ui","esri/Graphic","esri/geometry/Polyline","esri/geometry/Polygon","esri/geometry/Point","esri/geometry/Multipoint","esri/geometry/Mesh","esri/geometry/SpatialReference","esri/geometry/geometryEngine","esri/geometry/projection","esri/geometry/support/meshUtils","react-dom","@arcgis/core/geometry/geometryEngine","@arcgis/core/core/reactiveUtils","@vertigis/web/models","esri/layers/GraphicsLayer","esri/layers/ElevationLayer","esri/layers/FeatureLayer","@arcgis/core/renderers/UniqueValueRenderer","esri/widgets/Sketch","@vertigis/web/designer","@vertigis/web/ui/Box","@vertigis/web/ui/Slider/Slider","esri/layers/BaseElevationLayer"],((e,t,i,r,a,s,n,o,l,c,h,u,d,f,p,g,m,b,v,y,_,w,x,A,T,k,S,P,E)=>(()=>{var C={5655:(e,t,i)=>{"use strict";i.d(t,{A:()=>re});var r=function(){function e(e){var t=this;this._insertTag=function(e){var i;i=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,i),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var i=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{i.insertRule(e,i.cssRules.length)}catch(e){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),a=Math.abs,s=String.fromCharCode,n=Object.assign;function o(e){return e.trim()}function l(e,t,i){return e.replace(t,i)}function c(e,t){return e.indexOf(t)}function h(e,t){return 0|e.charCodeAt(t)}function u(e,t,i){return e.slice(t,i)}function d(e){return e.length}function f(e){return e.length}function p(e,t){return t.push(e),e}var g=1,m=1,b=0,v=0,y=0,_="";function w(e,t,i,r,a,s,n){return{value:e,root:t,parent:i,type:r,props:a,children:s,line:g,column:m,length:n,return:""}}function x(e,t){return n(w("",null,null,"",null,null,0),e,{length:-e.length},t)}function A(){return y=v>0?h(_,--v):0,m--,10===y&&(m=1,g--),y}function T(){return y=v<b?h(_,v++):0,m++,10===y&&(m=1,g++),y}function k(){return h(_,v)}function S(){return v}function P(e,t){return u(_,e,t)}function E(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function C(e){return g=m=1,b=d(_=e),v=0,[]}function D(e){return _="",e}function O(e){return o(P(v-1,I(91===e?e+2:40===e?e+1:e)))}function R(e){for(;(y=k())&&y<33;)T();return E(e)>2||E(y)>3?"":" "}function M(e,t){for(;--t&&T()&&!(y<48||y>102||y>57&&y<65||y>70&&y<97););return P(e,S()+(t<6&&32==k()&&32==T()))}function I(e){for(;T();)switch(y){case e:return v;case 34:case 39:34!==e&&39!==e&&I(y);break;case 40:41===e&&I(e);break;case 92:T()}return v}function L(e,t){for(;T()&&e+y!==57&&(e+y!==84||47!==k()););return"/*"+P(t,v-1)+"*"+s(47===e?e:T())}function F(e){for(;!E(k());)T();return P(e,v)}var N="-ms-",B="-moz-",j="-webkit-",z="comm",U="rule",H="decl",W="@keyframes";function V(e,t){for(var i="",r=f(e),a=0;a<r;a++)i+=t(e[a],a,e,t)||"";return i}function $(e,t,i,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case H:return e.return=e.return||e.value;case z:return"";case W:return e.return=e.value+"{"+V(e.children,r)+"}";case U:e.value=e.props.join(",")}return d(i=V(e.children,r))?e.return=e.value+"{"+i+"}":""}function X(e){return D(Y("",null,null,null,[""],e=C(e),0,[0],e))}function Y(e,t,i,r,a,n,o,u,f){for(var g=0,m=0,b=o,v=0,y=0,_=0,w=1,x=1,P=1,E=0,C="",D=a,I=n,N=r,B=C;x;)switch(_=E,E=T()){case 40:if(108!=_&&58==h(B,b-1)){-1!=c(B+=l(O(E),"&","&\f"),"&\f")&&(P=-1);break}case 34:case 39:case 91:B+=O(E);break;case 9:case 10:case 13:case 32:B+=R(_);break;case 92:B+=M(S()-1,7);continue;case 47:switch(k()){case 42:case 47:p(K(L(T(),S()),t,i),f);break;default:B+="/"}break;case 123*w:u[g++]=d(B)*P;case 125*w:case 59:case 0:switch(E){case 0:case 125:x=0;case 59+m:-1==P&&(B=l(B,/\f/g,"")),y>0&&d(B)-b&&p(y>32?q(B+";",r,i,b-1):q(l(B," ","")+";",r,i,b-2),f);break;case 59:B+=";";default:if(p(N=G(B,t,i,g,m,a,u,C,D=[],I=[],b),n),123===E)if(0===m)Y(B,t,N,N,D,n,b,u,I);else switch(99===v&&110===h(B,3)?100:v){case 100:case 108:case 109:case 115:Y(e,N,N,r&&p(G(e,N,N,0,0,a,u,C,a,D=[],b),I),a,I,b,u,r?D:I);break;default:Y(B,N,N,N,[""],I,0,u,I)}}g=m=y=0,w=P=1,C=B="",b=o;break;case 58:b=1+d(B),y=_;default:if(w<1)if(123==E)--w;else if(125==E&&0==w++&&125==A())continue;switch(B+=s(E),E*w){case 38:P=m>0?1:(B+="\f",-1);break;case 44:u[g++]=(d(B)-1)*P,P=1;break;case 64:45===k()&&(B+=O(T())),v=k(),m=b=d(C=B+=F(S())),E++;break;case 45:45===_&&2==d(B)&&(w=0)}}return n}function G(e,t,i,r,s,n,c,h,d,p,g){for(var m=s-1,b=0===s?n:[""],v=f(b),y=0,_=0,x=0;y<r;++y)for(var A=0,T=u(e,m+1,m=a(_=c[y])),k=e;A<v;++A)(k=o(_>0?b[A]+" "+T:l(T,/&\f/g,b[A])))&&(d[x++]=k);return w(e,t,i,0===s?U:h,d,p,g)}function K(e,t,i){return w(e,t,i,z,s(y),u(e,2,-2),0)}function q(e,t,i,r){return w(e,t,i,H,u(e,0,r),u(e,r+1,-1),r)}var Z=function(e,t,i){for(var r=0,a=0;r=a,a=k(),38===r&&12===a&&(t[i]=1),!E(a);)T();return P(e,v)},J=new WeakMap,Q=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,i=e.parent,r=e.column===i.column&&e.line===i.line;"rule"!==i.type;)if(!(i=i.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||J.get(i))&&!r){J.set(e,!0);for(var a=[],n=function(e,t){return D(function(e,t){var i=-1,r=44;do{switch(E(r)){case 0:38===r&&12===k()&&(t[i]=1),e[i]+=Z(v-1,t,i);break;case 2:e[i]+=O(r);break;case 4:if(44===r){e[++i]=58===k()?"&\f":"",t[i]=e[i].length;break}default:e[i]+=s(r)}}while(r=T());return e}(C(e),t))}(t,a),o=i.props,l=0,c=0;l<n.length;l++)for(var h=0;h<o.length;h++,c++)e.props[c]=a[l]?n[l].replace(/&\f/g,o[h]):o[h]+" "+n[l]}}},ee=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function te(e,t){switch(function(e,t){return 45^h(e,0)?(((t<<2^h(e,0))<<2^h(e,1))<<2^h(e,2))<<2^h(e,3):0}(e,t)){case 5103:return j+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return j+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return j+e+B+e+N+e+e;case 6828:case 4268:return j+e+N+e+e;case 6165:return j+e+N+"flex-"+e+e;case 5187:return j+e+l(e,/(\w+).+(:[^]+)/,j+"box-$1$2"+N+"flex-$1$2")+e;case 5443:return j+e+N+"flex-item-"+l(e,/flex-|-self/,"")+e;case 4675:return j+e+N+"flex-line-pack"+l(e,/align-content|flex-|-self/,"")+e;case 5548:return j+e+N+l(e,"shrink","negative")+e;case 5292:return j+e+N+l(e,"basis","preferred-size")+e;case 6060:return j+"box-"+l(e,"-grow","")+j+e+N+l(e,"grow","positive")+e;case 4554:return j+l(e,/([^-])(transform)/g,"$1"+j+"$2")+e;case 6187:return l(l(l(e,/(zoom-|grab)/,j+"$1"),/(image-set)/,j+"$1"),e,"")+e;case 5495:case 3959:return l(e,/(image-set\([^]*)/,j+"$1$`$1");case 4968:return l(l(e,/(.+:)(flex-)?(.*)/,j+"box-pack:$3"+N+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+j+e+e;case 4095:case 3583:case 4068:case 2532:return l(e,/(.+)-inline(.+)/,j+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(d(e)-1-t>6)switch(h(e,t+1)){case 109:if(45!==h(e,t+4))break;case 102:return l(e,/(.+:)(.+)-([^]+)/,"$1"+j+"$2-$3$1"+B+(108==h(e,t+3)?"$3":"$2-$3"))+e;case 115:return~c(e,"stretch")?te(l(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==h(e,t+1))break;case 6444:switch(h(e,d(e)-3-(~c(e,"!important")&&10))){case 107:return l(e,":",":"+j)+e;case 101:return l(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+j+(45===h(e,14)?"inline-":"")+"box$3$1"+j+"$2$3$1"+N+"$2box$3")+e}break;case 5936:switch(h(e,t+11)){case 114:return j+e+N+l(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return j+e+N+l(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return j+e+N+l(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return j+e+N+e+e}return e}var ie=[function(e,t,i,r){if(e.length>-1&&!e.return)switch(e.type){case H:e.return=te(e.value,e.length);break;case W:return V([x(e,{value:l(e.value,"@","@"+j)})],r);case U:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e){return(e=/(::plac\w+|:read-\w+)/.exec(e))?e[0]:e}(t)){case":read-only":case":read-write":return V([x(e,{props:[l(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return V([x(e,{props:[l(t,/:(plac\w+)/,":"+j+"input-$1")]}),x(e,{props:[l(t,/:(plac\w+)/,":-moz-$1")]}),x(e,{props:[l(t,/:(plac\w+)/,N+"input-$1")]})],r)}return""}))}}],re=function(e){var t=e.key;if("css"===t){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var a,s,n=e.stylisPlugins||ie,o={},l=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),i=1;i<t.length;i++)o[t[i]]=!0;l.push(e)}));var c,h,u,d,p=[$,(d=function(e){c.insert(e)},function(e){e.root||(e=e.return)&&d(e)})],g=(h=[Q,ee].concat(n,p),u=f(h),function(e,t,i,r){for(var a="",s=0;s<u;s++)a+=h[s](e,t,i,r)||"";return a});s=function(e,t,i,r){c=i,V(X(e?e+"{"+t.styles+"}":t.styles),g),r&&(m.inserted[t.name]=!0)};var m={key:t,sheet:new r({key:t,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:s};return m.sheet.hydrate(l),m}},6289:(e,t,i)=>{"use strict";function r(e){var t=Object.create(null);return function(i){return void 0===t[i]&&(t[i]=e(i)),t[i]}}i.d(t,{A:()=>r})},4684:(e,t,i)=>{"use strict";i.d(t,{C:()=>c,E:()=>m,T:()=>u,c:()=>p,h:()=>d,w:()=>h});var r=i(5959),a=i(5655),s=i(41),n=i(3174),o=i(1287),l=r.createContext("undefined"!=typeof HTMLElement?(0,a.A)({key:"css"}):null),c=l.Provider,h=function(e){return(0,r.forwardRef)((function(t,i){var a=(0,r.useContext)(l);return e(t,a,i)}))},u=r.createContext({}),d={}.hasOwnProperty,f="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",p=function(e,t){var i={};for(var r in t)d.call(t,r)&&(i[r]=t[r]);return i[f]=e,i},g=function(e){var t=e.cache,i=e.serialized,r=e.isStringTag;return(0,s.SF)(t,i,r),(0,o.s)((function(){return(0,s.sk)(t,i,r)})),null},m=h((function(e,t,i){var a=e.css;"string"==typeof a&&void 0!==t.registered[a]&&(a=t.registered[a]);var o=e[f],l=[a],c="";"string"==typeof e.className?c=(0,s.Rk)(t.registered,l,e.className):null!=e.className&&(c=e.className+" ");var h=(0,n.J)(l,void 0,r.useContext(u));c+=t.key+"-"+h.name;var p={};for(var m in e)d.call(e,m)&&"css"!==m&&m!==f&&(p[m]=e[m]);return p.className=c,i&&(p.ref=i),r.createElement(r.Fragment,null,r.createElement(g,{cache:t,serialized:h,isStringTag:"string"==typeof o}),r.createElement(o,p))}))},7437:(e,t,i)=>{"use strict";i.d(t,{AH:()=>d,i7:()=>f,mL:()=>u});var r,a,s=i(4684),n=i(5959),o=i(41),l=i(1287),c=i(3174),h=(i(5655),i(4146),function(e,t){var i=arguments;if(null==t||!s.h.call(t,"css"))return n.createElement.apply(void 0,i);var r=i.length,a=new Array(r);a[0]=s.E,a[1]=(0,s.c)(e,t);for(var o=2;o<r;o++)a[o]=i[o];return n.createElement.apply(null,a)});r=h||(h={}),a||(a=r.JSX||(r.JSX={}));var u=(0,s.w)((function(e,t){var i=e.styles,r=(0,c.J)([i],void 0,n.useContext(s.T)),a=n.useRef();return(0,l.i)((function(){var e=t.key+"-global",i=new t.sheet.constructor({key:e,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),s=!1,n=document.querySelector('style[data-emotion="'+e+" "+r.name+'"]');return t.sheet.tags.length&&(i.before=t.sheet.tags[0]),null!==n&&(s=!0,n.setAttribute("data-emotion",e),i.hydrate([n])),a.current=[i,s],function(){i.flush()}}),[t]),(0,l.i)((function(){var e=a.current,i=e[0];if(e[1])e[1]=!1;else{if(void 0!==r.next&&(0,o.sk)(t,r.next,!0),i.tags.length){var s=i.tags[i.tags.length-1].nextElementSibling;i.before=s,i.flush()}t.insert("",r,i,!1)}}),[t,r.name]),null}));function d(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,c.J)(t)}function f(){var e=d.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}},3174:(e,t,i)=>{"use strict";i.d(t,{J:()=>m});var r={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},a=i(6289),s=!1,n=/[A-Z]|^ms/g,o=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l=function(e){return 45===e.charCodeAt(1)},c=function(e){return null!=e&&"boolean"!=typeof e},h=(0,a.A)((function(e){return l(e)?e:e.replace(n,"-$&").toLowerCase()})),u=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(o,(function(e,t,i){return p={name:t,styles:i,next:p},t}))}return 1===r[e]||l(e)||"number"!=typeof t||0===t?t:t+"px"},d="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function f(e,t,i){if(null==i)return"";var r=i;if(void 0!==r.__emotion_styles)return r;switch(typeof i){case"boolean":return"";case"object":var a=i;if(1===a.anim)return p={name:a.name,styles:a.styles,next:p},a.name;var n=i;if(void 0!==n.styles){var o=n.next;if(void 0!==o)for(;void 0!==o;)p={name:o.name,styles:o.styles,next:p},o=o.next;return n.styles+";"}return function(e,t,i){var r="";if(Array.isArray(i))for(var a=0;a<i.length;a++)r+=f(e,t,i[a])+";";else for(var n in i){var o=i[n];if("object"!=typeof o){var l=o;null!=t&&void 0!==t[l]?r+=n+"{"+t[l]+"}":c(l)&&(r+=h(n)+":"+u(n,l)+";")}else{if("NO_COMPONENT_SELECTOR"===n&&s)throw new Error(d);if(!Array.isArray(o)||"string"!=typeof o[0]||null!=t&&void 0!==t[o[0]]){var p=f(e,t,o);switch(n){case"animation":case"animationName":r+=h(n)+":"+p+";";break;default:r+=n+"{"+p+"}"}}else for(var g=0;g<o.length;g++)c(o[g])&&(r+=h(n)+":"+u(n,o[g])+";")}}return r}(e,t,i);case"function":if(void 0!==e){var l=p,g=i(e);return p=l,f(e,t,g)}}var m=i;if(null==t)return m;var b=t[m];return void 0!==b?b:m}var p,g=/label:\s*([^\s;{]+)\s*(;|$)/g;function m(e,t,i){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,a="";p=void 0;var s=e[0];null==s||void 0===s.raw?(r=!1,a+=f(i,t,s)):a+=s[0];for(var n=1;n<e.length;n++)a+=f(i,t,e[n]),r&&(a+=s[n]);g.lastIndex=0;for(var o,l="";null!==(o=g.exec(a));)l+="-"+o[1];var c=function(e){for(var t,i=0,r=0,a=e.length;a>=4;++r,a-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),i=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&i)+(59797*(i>>>16)<<16);switch(a){case 3:i^=(255&e.charCodeAt(r+2))<<16;case 2:i^=(255&e.charCodeAt(r+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(r)))+(59797*(i>>>16)<<16)}return(((i=1540483477*(65535&(i^=i>>>13))+(59797*(i>>>16)<<16))^i>>>15)>>>0).toString(36)}(a)+l;return{name:c,styles:a,next:p}}},1287:(e,t,i)=>{"use strict";i.d(t,{i:()=>n,s:()=>s});var r=i(5959),a=!!r.useInsertionEffect&&r.useInsertionEffect,s=a||function(e){return e()},n=a||r.useLayoutEffect},41:(e,t,i)=>{"use strict";function r(e,t,i){var r="";return i.split(" ").forEach((function(i){void 0!==e[i]?t.push(e[i]+";"):i&&(r+=i+" ")})),r}i.d(t,{Rk:()=>r,SF:()=>a,sk:()=>s});var a=function(e,t,i){var r=e.key+"-"+t.name;!1===i&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},s=function(e,t,i){a(e,t,i);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var s=t;do{e.insert(t===s?"."+r:"",s,e.sheet,!0),s=s.next}while(void 0!==s)}}},6718:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},3594:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M6.36 18.78 6.61 21l1.62-1.54 2.77-7.6c-.68-.17-1.28-.51-1.77-.98zm8.41-7.9c-.49.47-1.1.81-1.77.98l2.77 7.6L17.39 21l.26-2.22zM15 8c0-1.3-.84-2.4-2-2.82V3h-2v2.18C9.84 5.6 9 6.7 9 8c0 1.66 1.34 3 3 3s3-1.34 3-3m-3 1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"Architecture")},1299:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment")},4702:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4"}),"AttachMoney")},2092:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")},9781:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},3684:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M17 13l-5 5-5-5h3V9h4v4z"}),"CloudDownload")},7034:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},8597:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},6815:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"m15.96 10.29-2.75 3.54-1.96-2.36L8.5 15h11zM3 5H1v16c0 1.1.9 2 2 2h16v-2H3zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2m0 16H7V3h14z"}),"Filter")},4664:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)([(0,s.jsx)("path",{d:"M21 8c-1.45 0-2.26 1.44-1.93 2.51l-3.55 3.56c-.3-.09-.74-.09-1.04 0l-2.55-2.55C12.27 10.45 11.46 9 10 9c-1.45 0-2.27 1.44-1.93 2.52l-4.56 4.55C2.44 15.74 1 16.55 1 18c0 1.1.9 2 2 2 1.45 0 2.26-1.44 1.93-2.51l4.55-4.56c.3.09.74.09 1.04 0l2.55 2.55C12.73 16.55 13.54 18 15 18c1.45 0 2.27-1.44 1.93-2.52l3.56-3.55c1.07.33 2.51-.48 2.51-1.93 0-1.1-.9-2-2-2"},"0"),(0,s.jsx)("path",{d:"m15 9 .94-2.07L18 6l-2.06-.93L15 3l-.92 2.07L12 6l2.08.93zM3.5 11 4 9l2-.5L4 8l-.5-2L3 8l-2 .5L3 9z"},"1")],"Insights")},3679:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"}),"Map")},594:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0,function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=n(t);if(i&&i.has(e))return i.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=a?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=e[s]}r.default=e,i&&i.set(e,r)}(i(5959));var a=r(i(2032)),s=i(6308);function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(n=function(e){return e?i:t})(e)}t.A=(0,a.default)((0,s.jsx)("path",{transform:"scale(0.5, 0.5)",d:"M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm-4 29V15l12 9-12 9z"}),"PlayCircleFilledWhite")},6102:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M3 5h2V3c-1.1 0-2 .9-2 2m0 8h2v-2H3zm4 8h2v-2H7zM3 9h2V7H3zm10-6h-2v2h2zm6 0v2h2c0-1.1-.9-2-2-2M5 21v-2H3c0 1.1.9 2 2 2m-2-4h2v-2H3zM9 3H7v2h2zm2 18h2v-2h-2zm8-8h2v-2h-2zm0 8c1.1 0 2-.9 2-2h-2zm0-12h2V7h-2zm0 8h2v-2h-2zm-4 4h2v-2h-2zm0-16h2V3h-2zM7 17h10V7H7zm2-8h6v6H9z"}),"SelectAll")},5532:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M21 8H3V4h18zm0 2H3v4h18zm0 6H3v4h18z"}),"TableRows")},6078:(e,t,i)=>{"use strict";var r=i(4994);t.A=void 0;var a=r(i(2032)),s=i(6308);t.A=(0,a.default)((0,s.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"}),"UploadFile")},2032:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=i(6621)},3478:(e,t,i)=>{"use strict";i.d(t,{A:()=>ce});var r=i(8168),a=i(8587),s=i(9453),n=i(1317),o=i(4188),l=i(3571),c=i(8749),h=i(771);const u={black:"#000",white:"#fff"},d={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},f="#f3e5f5",p="#ce93d8",g="#ba68c8",m="#ab47bc",b="#9c27b0",v="#7b1fa2",y="#e57373",_="#ef5350",w="#f44336",x="#d32f2f",A="#c62828",T="#ffb74d",k="#ffa726",S="#ff9800",P="#f57c00",E="#e65100",C="#e3f2fd",D="#90caf9",O="#42a5f5",R="#1976d2",M="#1565c0",I="#4fc3f7",L="#29b6f6",F="#03a9f4",N="#0288d1",B="#01579b",j="#81c784",z="#66bb6a",U="#4caf50",H="#388e3c",W="#2e7d32",V="#1b5e20",$=["mode","contrastThreshold","tonalOffset"],X={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:u.white,default:u.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Y={text:{primary:u.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:u.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function G(e,t,i,r){const a=r.light||r,s=r.dark||1.5*r;e[t]||(e.hasOwnProperty(i)?e[t]=e[i]:"light"===t?e.light=(0,h.a)(e.main,a):"dark"===t&&(e.dark=(0,h.e$)(e.main,s)))}const K=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"],q={textTransform:"uppercase"},Z='"Roboto", "Helvetica", "Arial", sans-serif';function J(e,t){const i="function"==typeof t?t(e):t,{fontFamily:s=Z,fontSize:o=14,fontWeightLight:l=300,fontWeightRegular:c=400,fontWeightMedium:h=500,fontWeightBold:u=700,htmlFontSize:d=16,allVariants:f,pxToRem:p}=i,g=(0,a.A)(i,K),m=o/14,b=p||(e=>e/d*m+"rem"),v=(e,t,i,a,n)=>{return(0,r.A)({fontFamily:s,fontWeight:e,fontSize:b(t),lineHeight:i},s===Z?{letterSpacing:(o=a/t,Math.round(1e5*o)/1e5+"em")}:{},n,f);var o},y={h1:v(l,96,1.167,-1.5),h2:v(l,60,1.2,-.5),h3:v(c,48,1.167,0),h4:v(c,34,1.235,.25),h5:v(c,24,1.334,0),h6:v(h,20,1.6,.15),subtitle1:v(c,16,1.75,.15),subtitle2:v(h,14,1.57,.1),body1:v(c,16,1.5,.15),body2:v(c,14,1.43,.15),button:v(h,14,1.75,.4,q),caption:v(c,12,1.66,.4),overline:v(c,12,2.66,1,q),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,n.A)((0,r.A)({htmlFontSize:d,pxToRem:b,fontFamily:s,fontSize:o,fontWeightLight:l,fontWeightRegular:c,fontWeightMedium:h,fontWeightBold:u},y),g,{clone:!1})}function Q(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,0.2)`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,0.14)`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,0.12)`].join(",")}const ee=["none",Q(0,2,1,-1,0,1,1,0,0,1,3,0),Q(0,3,1,-2,0,2,2,0,0,1,5,0),Q(0,3,3,-2,0,3,4,0,0,1,8,0),Q(0,2,4,-1,0,4,5,0,0,1,10,0),Q(0,3,5,-1,0,5,8,0,0,1,14,0),Q(0,3,5,-1,0,6,10,0,0,1,18,0),Q(0,4,5,-2,0,7,10,1,0,2,16,1),Q(0,5,5,-3,0,8,10,1,0,3,14,2),Q(0,5,6,-3,0,9,12,1,0,3,16,2),Q(0,6,6,-3,0,10,14,1,0,4,18,3),Q(0,6,7,-4,0,11,15,1,0,4,20,3),Q(0,7,8,-4,0,12,17,2,0,5,22,4),Q(0,7,8,-4,0,13,19,2,0,5,24,4),Q(0,7,9,-4,0,14,21,2,0,5,26,4),Q(0,8,9,-5,0,15,22,2,0,6,28,5),Q(0,8,10,-5,0,16,24,2,0,6,30,5),Q(0,8,11,-5,0,17,26,2,0,6,32,5),Q(0,9,11,-5,0,18,28,2,0,7,34,6),Q(0,9,12,-6,0,19,29,2,0,7,36,6),Q(0,10,13,-6,0,20,31,3,0,8,38,7),Q(0,10,13,-6,0,21,33,3,0,8,40,7),Q(0,10,14,-6,0,22,35,3,0,8,42,7),Q(0,11,14,-7,0,23,36,3,0,9,44,8),Q(0,11,15,-7,0,24,38,3,0,9,46,8)],te=["duration","easing","delay"],ie={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},re={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function ae(e){return`${Math.round(e)}ms`}function se(e){if(!e)return 0;const t=e/36;return Math.round(10*(4+15*t**.25+t/5))}function ne(e){const t=(0,r.A)({},ie,e.easing),i=(0,r.A)({},re,e.duration);return(0,r.A)({getAutoHeightDuration:se,create:(e=["all"],r={})=>{const{duration:s=i.standard,easing:n=t.easeInOut,delay:o=0}=r;return(0,a.A)(r,te),(Array.isArray(e)?e:[e]).map((e=>`${e} ${"string"==typeof s?s:ae(s)} ${n} ${"string"==typeof o?o:ae(o)}`)).join(",")}},e,{easing:t,duration:i})}const oe={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},le=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];const ce=function(e={},...t){const{mixins:i={},palette:K={},transitions:q={},typography:Z={}}=e,Q=(0,a.A)(e,le);if(e.vars)throw new Error((0,s.A)(18));const te=function(e){const{mode:t="light",contrastThreshold:i=3,tonalOffset:o=.2}=e,l=(0,a.A)(e,$),c=e.primary||function(e="light"){return"dark"===e?{main:D,light:C,dark:O}:{main:R,light:O,dark:M}}(t),K=e.secondary||function(e="light"){return"dark"===e?{main:p,light:f,dark:m}:{main:b,light:g,dark:v}}(t),q=e.error||function(e="light"){return"dark"===e?{main:w,light:y,dark:x}:{main:x,light:_,dark:A}}(t),Z=e.info||function(e="light"){return"dark"===e?{main:L,light:I,dark:N}:{main:N,light:F,dark:B}}(t),J=e.success||function(e="light"){return"dark"===e?{main:z,light:j,dark:H}:{main:W,light:U,dark:V}}(t),Q=e.warning||function(e="light"){return"dark"===e?{main:k,light:T,dark:P}:{main:"#ed6c02",light:S,dark:E}}(t);function ee(e){return(0,h.eM)(e,Y.text.primary)>=i?Y.text.primary:X.text.primary}const te=({color:e,name:t,mainShade:i=500,lightShade:a=300,darkShade:n=700})=>{if(!(e=(0,r.A)({},e)).main&&e[i]&&(e.main=e[i]),!e.hasOwnProperty("main"))throw new Error((0,s.A)(11,t?` (${t})`:"",i));if("string"!=typeof e.main)throw new Error((0,s.A)(12,t?` (${t})`:"",JSON.stringify(e.main)));return G(e,"light",a,o),G(e,"dark",n,o),e.contrastText||(e.contrastText=ee(e.main)),e},ie={dark:Y,light:X};return(0,n.A)((0,r.A)({common:(0,r.A)({},u),mode:t,primary:te({color:c,name:"primary"}),secondary:te({color:K,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:te({color:q,name:"error"}),warning:te({color:Q,name:"warning"}),info:te({color:Z,name:"info"}),success:te({color:J,name:"success"}),grey:d,contrastThreshold:i,getContrastText:ee,augmentColor:te,tonalOffset:o},ie[t]),l)}(K),ie=(0,c.A)(e);let re=(0,n.A)(ie,{mixins:(ae=ie.breakpoints,se=i,(0,r.A)({toolbar:{minHeight:56,[ae.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[ae.up("sm")]:{minHeight:64}}},se)),palette:te,shadows:ee.slice(),typography:J(te,Z),transitions:ne(q),zIndex:(0,r.A)({},oe)});var ae,se;return re=(0,n.A)(re,Q),re=t.reduce(((e,t)=>(0,n.A)(e,t)),re),re.unstable_sxConfig=(0,r.A)({},o.A,null==Q?void 0:Q.unstable_sxConfig),re.unstable_sx=function(e){return(0,l.A)({sx:e,theme:this})},re}},2765:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=(0,i(3478).A)()},8312:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r="$$material"},9770:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(4438);const a=e=>(0,r.A)(e)&&"classes"!==e},4438:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}},1848:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>o});var r=i(6461),a=i(2765),s=i(8312),n=i(9770);const o=(0,r.Ay)({themeId:s.A,defaultTheme:a.A,rootShouldForwardProp:n.A})},3541:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(6606),a=i(2765),s=i(8312);function n({props:e,name:t}){return(0,r.A)({props:e,name:t,defaultTheme:a.A,themeId:s.A})}},8466:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=i(3967).A},5003:(e,t,i)=>{"use strict";i.d(t,{A:()=>y});var r=i(8168),a=i(5959),s=i(8587),n=i(4164),o=i(5659),l=i(8466),c=i(3541),h=i(1848),u=i(8413),d=i(1609);function f(e){return(0,d.Ay)("MuiSvgIcon",e)}(0,u.A)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var p=i(6308);const g=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],m=(0,h.Ay)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,"inherit"!==i.color&&t[`color${(0,l.A)(i.color)}`],t[`fontSize${(0,l.A)(i.fontSize)}`]]}})((({theme:e,ownerState:t})=>{var i,r,a,s,n,o,l,c,h,u,d,f,p;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:t.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(i=e.transitions)||null==(r=i.create)?void 0:r.call(i,"fill",{duration:null==(a=e.transitions)||null==(a=a.duration)?void 0:a.shorter}),fontSize:{inherit:"inherit",small:(null==(s=e.typography)||null==(n=s.pxToRem)?void 0:n.call(s,20))||"1.25rem",medium:(null==(o=e.typography)||null==(l=o.pxToRem)?void 0:l.call(o,24))||"1.5rem",large:(null==(c=e.typography)||null==(h=c.pxToRem)?void 0:h.call(c,35))||"2.1875rem"}[t.fontSize],color:null!=(u=null==(d=(e.vars||e).palette)||null==(d=d[t.color])?void 0:d.main)?u:{action:null==(f=(e.vars||e).palette)||null==(f=f.action)?void 0:f.active,disabled:null==(p=(e.vars||e).palette)||null==(p=p.action)?void 0:p.disabled,inherit:void 0}[t.color]}})),b=a.forwardRef((function(e,t){const i=(0,c.A)({props:e,name:"MuiSvgIcon"}),{children:h,className:u,color:d="inherit",component:b="svg",fontSize:v="medium",htmlColor:y,inheritViewBox:_=!1,titleAccess:w,viewBox:x="0 0 24 24"}=i,A=(0,s.A)(i,g),T=a.isValidElement(h)&&"svg"===h.type,k=(0,r.A)({},i,{color:d,component:b,fontSize:v,instanceFontSize:e.fontSize,inheritViewBox:_,viewBox:x,hasSvgAsChild:T}),S={};_||(S.viewBox=x);const P=(e=>{const{color:t,fontSize:i,classes:r}=e,a={root:["root","inherit"!==t&&`color${(0,l.A)(t)}`,`fontSize${(0,l.A)(i)}`]};return(0,o.A)(a,f,r)})(k);return(0,p.jsxs)(m,(0,r.A)({as:b,className:(0,n.A)(P.root,u),focusable:"false",color:y,"aria-hidden":!w||void 0,role:w?"img":void 0,ref:t},S,A,T&&h.props,{ownerState:k,children:[T?h.props.children:h,w?(0,p.jsx)("title",{children:w}):null]}))}));b.muiName="SvgIcon";const v=b;function y(e,t){function i(i,a){return(0,p.jsx)(v,(0,r.A)({"data-testid":`${t}Icon`,ref:a},i,{children:e}))}return i.muiName=v.muiName,a.memo(a.forwardRef(i))}},1935:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=i(4705).A},6621:(e,t,i)=>{"use strict";i.r(t),i.d(t,{capitalize:()=>a.A,createChainedFunction:()=>s,createSvgIcon:()=>n.A,debounce:()=>o.A,deprecatedPropType:()=>l,isMuiElement:()=>c.A,ownerDocument:()=>h.A,ownerWindow:()=>u.A,requirePropFactory:()=>d,setRef:()=>f,unstable_ClassNameGenerator:()=>w,unstable_useEnhancedEffect:()=>p.A,unstable_useId:()=>g,unsupportedProp:()=>m,useControlled:()=>b.A,useEventCallback:()=>v.A,useForkRef:()=>y.A,useIsFocusVisible:()=>_.A});var r=i(9071),a=i(8466);const s=i(6673).A;var n=i(5003),o=i(1935);const l=function(e,t){return()=>null};var c=i(8593),h=i(6248),u=i(3749);i(8168);const d=function(e,t){return()=>null},f=i(7365).A;var p=i(2778);const g=i(4661).A,m=function(e,t,i,r,a){return null};var b=i(1381),v=i(3034),y=i(6852),_=i(1984);const w={configure:e=>{r.A.configure(e)}}},8593:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(5959);const a=function(e,t){var i,a;return r.isValidElement(e)&&-1!==t.indexOf(null!=(i=e.type.muiName)?i:null==(a=e.type)||null==(a=a._payload)||null==(a=a.value)?void 0:a.muiName)}},6248:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=i(2325).A},3749:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=i(4877).A},1381:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(5959);const a=function({controlled:e,default:t,name:i,state:a="value"}){const{current:s}=r.useRef(void 0!==e),[n,o]=r.useState(t);return[s?e:n,r.useCallback((e=>{s||o(e)}),[])]}},2778:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=i(1529).A},3034:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=i(1547).A},6852:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r=i(1523).A},1984:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r=i(5959),a=i(3068);let s=!0,n=!1;const o=new a.E,l={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function c(e){e.metaKey||e.altKey||e.ctrlKey||(s=!0)}function h(){s=!1}function u(){"hidden"===this.visibilityState&&n&&(s=!0)}const d=function(){const e=r.useCallback((e=>{var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",c,!0),t.addEventListener("mousedown",h,!0),t.addEventListener("pointerdown",h,!0),t.addEventListener("touchstart",h,!0),t.addEventListener("visibilitychange",u,!0))}),[]),t=r.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!function(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch(e){}return s||function(e){const{type:t,tagName:i}=e;return!("INPUT"!==i||!l[t]||e.readOnly)||"TEXTAREA"===i&&!e.readOnly||!!e.isContentEditable}(t)}(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(n=!0,o.start(100,(()=>{n=!1})),t.current=!1,!0)},ref:e}}},9940:(e,t,i)=>{"use strict";i.d(t,{A:()=>s}),i(5959);var r=i(7437),a=i(6308);function s(e){const{styles:t,defaultTheme:i={}}=e,s="function"==typeof t?e=>{return t(null==(r=e)||0===Object.keys(r).length?i:e);var r}:t;return(0,a.jsx)(r.mL,{styles:s})}},2532:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GlobalStyles:()=>x.A,StyledEngineProvider:()=>w,ThemeContext:()=>a.T,css:()=>b.AH,default:()=>A,internal_processStyles:()=>T,keyframes:()=>b.i7});var r=i(8168),a=i(4684),s=i(3174),n=i(1287),o=i(41),l=i(5959),c=i(6289),h=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,u=(0,c.A)((function(e){return h.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),d=function(e){return"theme"!==e},f=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?u:d},p=function(e,t,i){var r;if(t){var a=t.shouldForwardProp;r=e.__emotion_forwardProp&&a?function(t){return e.__emotion_forwardProp(t)&&a(t)}:a}return"function"!=typeof r&&i&&(r=e.__emotion_forwardProp),r},g=function(e){var t=e.cache,i=e.serialized,r=e.isStringTag;return(0,o.SF)(t,i,r),(0,n.s)((function(){return(0,o.sk)(t,i,r)})),null},m=function e(t,i){var n,c,h=t.__emotion_real===t,u=h&&t.__emotion_base||t;void 0!==i&&(n=i.label,c=i.target);var d=p(t,i,h),m=d||f(u),b=!m("as");return function(){var v=arguments,y=h&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==n&&y.push("label:"+n+";"),null==v[0]||void 0===v[0].raw)y.push.apply(y,v);else{var _=v[0];y.push(_[0]);for(var w=v.length,x=1;x<w;x++)y.push(v[x],_[x])}var A=(0,a.w)((function(e,t,i){var r=b&&e.as||u,n="",h=[],p=e;if(null==e.theme){for(var v in p={},e)p[v]=e[v];p.theme=l.useContext(a.T)}"string"==typeof e.className?n=(0,o.Rk)(t.registered,h,e.className):null!=e.className&&(n=e.className+" ");var _=(0,s.J)(y.concat(h),t.registered,p);n+=t.key+"-"+_.name,void 0!==c&&(n+=" "+c);var w=b&&void 0===d?f(r):m,x={};for(var A in e)b&&"as"===A||w(A)&&(x[A]=e[A]);return x.className=n,i&&(x.ref=i),l.createElement(l.Fragment,null,l.createElement(g,{cache:t,serialized:_,isStringTag:"string"==typeof r}),l.createElement(r,x))}));return A.displayName=void 0!==n?n:"Styled("+("string"==typeof u?u:u.displayName||u.name||"Component")+")",A.defaultProps=t.defaultProps,A.__emotion_real=A,A.__emotion_base=u,A.__emotion_styles=y,A.__emotion_forwardProp=d,Object.defineProperty(A,"toString",{value:function(){return"."+c}}),A.withComponent=function(t,a){return e(t,(0,r.A)({},i,a,{shouldForwardProp:p(A,a,!0)})).apply(void 0,y)},A}}.bind(null);["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){m[e]=m(e)}));var b=i(7437),v=i(5655),y=i(6308);let _;function w(e){const{injectFirst:t,children:i}=e;return t&&_?(0,y.jsx)(a.C,{value:_,children:i}):i}"object"==typeof document&&(_=(0,v.A)({key:"css",prepend:!0}));var x=i(9940);function A(e,t){return m(e,t)}const T=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}},771:(e,t,i)=>{"use strict";var r=i(4994);t.X4=function(e,t){return e=o(e),t=n(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,l(e)},t.e$=h,t.eM=function(e,t){const i=c(e),r=c(t);return(Math.max(i,r)+.05)/(Math.min(i,r)+.05)},t.a=u;var a=r(i(8944)),s=r(i(7535));function n(e,t=0,i=1){return(0,s.default)(e,t,i)}function o(e){if(e.type)return e;if("#"===e.charAt(0))return o(function(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let i=e.match(t);return i&&1===i[0].length&&(i=i.map((e=>e+e))),i?`rgb${4===i.length?"a":""}(${i.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", ")})`:""}(e));const t=e.indexOf("("),i=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(i))throw new Error((0,a.default)(9,e));let r,s=e.substring(t+1,e.length-1);if("color"===i){if(s=s.split(" "),r=s.shift(),4===s.length&&"/"===s[3].charAt(0)&&(s[3]=s[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error((0,a.default)(10,r))}else s=s.split(",");return s=s.map((e=>parseFloat(e))),{type:i,values:s,colorSpace:r}}function l(e){const{type:t,colorSpace:i}=e;let{values:r}=e;return-1!==t.indexOf("rgb")?r=r.map(((e,t)=>t<3?parseInt(e,10):e)):-1!==t.indexOf("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),r=-1!==t.indexOf("color")?`${i} ${r.join(" ")}`:`${r.join(", ")}`,`${t}(${r})`}function c(e){let t="hsl"===(e=o(e)).type||"hsla"===e.type?o(function(e){e=o(e);const{values:t}=e,i=t[0],r=t[1]/100,a=t[2]/100,s=r*Math.min(a,1-a),n=(e,t=(e+i/30)%12)=>a-s*Math.max(Math.min(t-3,9-t,1),-1);let c="rgb";const h=[Math.round(255*n(0)),Math.round(255*n(8)),Math.round(255*n(4))];return"hsla"===e.type&&(c+="a",h.push(t[3])),l({type:c,values:h})}(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function h(e,t){if(e=o(e),t=n(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(let i=0;i<3;i+=1)e.values[i]*=1-t;return l(e)}function u(e,t){if(e=o(e),t=n(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(let i=0;i<3;i+=1)e.values[i]+=(255-e.values[i])*t;else if(-1!==e.type.indexOf("color"))for(let i=0;i<3;i+=1)e.values[i]+=(1-e.values[i])*t;return l(e)}},6461:(e,t,i)=>{"use strict";var r=i(4994);t.Ay=function(e={}){const{themeId:t,defaultTheme:i=g,rootShouldForwardProp:r=p,slotShouldForwardProp:l=p}=e,h=e=>(0,c.default)((0,a.default)({},e,{theme:b((0,a.default)({},e,{defaultTheme:i,themeId:t}))}));return h.__mui_systemSx=!0,(e,c={})=>{(0,n.internal_processStyles)(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:u,slot:f,skipVariantsResolver:g,skipSx:_,overridesResolver:w=v(m(f))}=c,x=(0,s.default)(c,d),A=void 0!==g?g:f&&"Root"!==f&&"root"!==f||!1,T=_||!1;let k=p;"Root"===f||"root"===f?k=r:f?k=l:function(e){return"string"==typeof e&&e.charCodeAt(0)>96}(e)&&(k=void 0);const S=(0,n.default)(e,(0,a.default)({shouldForwardProp:k,label:void 0},x)),P=e=>"function"==typeof e&&e.__emotion_real!==e||(0,o.isPlainObject)(e)?r=>y(e,(0,a.default)({},r,{theme:b({theme:r.theme,defaultTheme:i,themeId:t})})):e,E=(r,...s)=>{let n=P(r);const o=s?s.map(P):[];u&&w&&o.push((e=>{const r=b((0,a.default)({},e,{defaultTheme:i,themeId:t}));if(!r.components||!r.components[u]||!r.components[u].styleOverrides)return null;const s=r.components[u].styleOverrides,n={};return Object.entries(s).forEach((([t,i])=>{n[t]=y(i,(0,a.default)({},e,{theme:r}))})),w(e,n)})),u&&!A&&o.push((e=>{var r;const s=b((0,a.default)({},e,{defaultTheme:i,themeId:t}));return y({variants:null==s||null==(r=s.components)||null==(r=r[u])?void 0:r.variants},(0,a.default)({},e,{theme:s}))})),T||o.push(h);const l=o.length-s.length;if(Array.isArray(r)&&l>0){const e=new Array(l).fill("");n=[...r,...e],n.raw=[...r.raw,...e]}const c=S(n,...o);return e.muiName&&(c.muiName=e.muiName),c};return S.withConfig&&(E.withConfig=S.withConfig),E}};var a=r(i(4634)),s=r(i(4893)),n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=f(t);if(i&&i.has(e))return i.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var n=a?Object.getOwnPropertyDescriptor(e,s):null;n&&(n.get||n.set)?Object.defineProperty(r,s,n):r[s]=e[s]}return r.default=e,i&&i.set(e,r),r}(i(2532)),o=i(4239),l=(r(i(7149)),r(i(4939)),r(i(3142))),c=r(i(3857));const h=["ownerState"],u=["variants"],d=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(f=function(e){return e?i:t})(e)}function p(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const g=(0,l.default)(),m=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function b({defaultTheme:e,theme:t,themeId:i}){return r=t,0===Object.keys(r).length?e:t[i]||t;var r}function v(e){return e?(t,i)=>i[e]:null}function y(e,t){let{ownerState:i}=t,r=(0,s.default)(t,h);const n="function"==typeof e?e((0,a.default)({ownerState:i},r)):e;if(Array.isArray(n))return n.flatMap((e=>y(e,(0,a.default)({ownerState:i},r))));if(n&&"object"==typeof n&&Array.isArray(n.variants)){const{variants:e=[]}=n;let t=(0,s.default)(n,u);return e.forEach((e=>{let s=!0;"function"==typeof e.props?s=e.props((0,a.default)({ownerState:i},r,i)):Object.keys(e.props).forEach((t=>{(null==i?void 0:i[t])!==e.props[t]&&r[t]!==e.props[t]&&(s=!1)})),s&&(Array.isArray(t)||(t=[t]),t.push("function"==typeof e.style?e.style((0,a.default)({ownerState:i},r,i)):e.style))})),t}return n}},9452:(e,t,i)=>{"use strict";i.d(t,{EU:()=>o,NI:()=>n,iZ:()=>c,kW:()=>h,vf:()=>l,zu:()=>a});var r=i(1317);const a={xs:0,sm:600,md:900,lg:1200,xl:1536},s={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${a[e]}px)`};function n(e,t,i){const r=e.theme||{};if(Array.isArray(t)){const e=r.breakpoints||s;return t.reduce(((r,a,s)=>(r[e.up(e.keys[s])]=i(t[s]),r)),{})}if("object"==typeof t){const e=r.breakpoints||s;return Object.keys(t).reduce(((r,s)=>{if(-1!==Object.keys(e.values||a).indexOf(s))r[e.up(s)]=i(t[s],s);else{const e=s;r[e]=t[e]}return r}),{})}return i(t)}function o(e={}){var t;return(null==(t=e.keys)?void 0:t.reduce(((t,i)=>(t[e.up(i)]={},t)),{}))||{}}function l(e,t){return e.reduce(((e,t)=>{const i=e[t];return(!i||0===Object.keys(i).length)&&delete e[t],e}),t)}function c(e,...t){const i=o(e),a=[i,...t].reduce(((e,t)=>(0,r.A)(e,t)),{});return l(Object.keys(i),a)}function h({values:e,breakpoints:t,base:i}){const r=i||function(e,t){if("object"!=typeof e)return{};const i={},r=Object.keys(t);return Array.isArray(e)?r.forEach(((t,r)=>{r<e.length&&(i[t]=!0)})):r.forEach((t=>{null!=e[t]&&(i[t]=!0)})),i}(e,t),a=Object.keys(r);if(0===a.length)return e;let s;return a.reduce(((t,i,r)=>(Array.isArray(e)?(t[i]=null!=e[r]?e[r]:e[s],s=r):"object"==typeof e?(t[i]=null!=e[i]?e[i]:e[s],s=i):t[i]=e,t)),{})}},8336:(e,t,i)=>{"use strict";function r(e,t){const i=this;if(i.vars&&"function"==typeof i.getColorSchemeSelector){const r=i.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)");return{[r]:t}}return i.palette.mode===e?t:{}}i.d(t,{A:()=>r})},8094:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(8587),a=i(8168);const s=["values","unit","step"],n=e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>(0,a.A)({},e,{[t.key]:t.val})),{})};function o(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:o=5}=e,l=(0,r.A)(e,s),c=n(t),h=Object.keys(c);function u(e){return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${i})`}function d(e){return`@media (max-width:${("number"==typeof t[e]?t[e]:e)-o/100}${i})`}function f(e,r){const a=h.indexOf(r);return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${i}) and (max-width:${(-1!==a&&"number"==typeof t[h[a]]?t[h[a]]:r)-o/100}${i})`}return(0,a.A)({keys:h,values:c,up:u,down:d,between:f,only:function(e){return h.indexOf(e)+1<h.length?f(e,h[h.indexOf(e)+1]):u(e)},not:function(e){const t=h.indexOf(e);return 0===t?u(h[1]):t===h.length-1?d(h[t]):f(e,h[h.indexOf(e)+1]).replace("@media","@media not all and")},unit:i},l)}},8749:(e,t,i)=>{"use strict";i.d(t,{A:()=>f});var r=i(8168),a=i(8587),s=i(1317),n=i(8094);const o={borderRadius:4};var l=i(8248),c=i(3571),h=i(4188),u=i(8336);const d=["breakpoints","palette","spacing","shape"],f=function(e={},...t){const{breakpoints:i={},palette:f={},spacing:p,shape:g={}}=e,m=(0,a.A)(e,d),b=(0,n.A)(i),v=function(e=8){if(e.mui)return e;const t=(0,l.LX)({spacing:e}),i=(...e)=>(0===e.length?[1]:e).map((e=>{const i=t(e);return"number"==typeof i?`${i}px`:i})).join(" ");return i.mui=!0,i}(p);let y=(0,s.A)({breakpoints:b,direction:"ltr",components:{},palette:(0,r.A)({mode:"light"},f),spacing:v,shape:(0,r.A)({},o,g)},m);return y.applyStyles=u.A,y=t.reduce(((e,t)=>(0,s.A)(e,t)),y),y.unstable_sxConfig=(0,r.A)({},h.A,null==m?void 0:m.unstable_sxConfig),y.unstable_sx=function(e){return(0,c.A)({sx:e,theme:this})},y}},3142:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A,private_createBreakpoints:()=>a.A,unstable_applyStyles:()=>s.A});var r=i(8749),a=i(8094),s=i(8336)},4620:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(1317);const a=function(e,t){return t?(0,r.A)(e,t,{clone:!1}):e}},8248:(e,t,i)=>{"use strict";i.d(t,{LX:()=>p,MA:()=>f,_W:()=>g,Lc:()=>b,Ms:()=>v});var r=i(9452),a=i(6481),s=i(4620);const n={m:"margin",p:"padding"},o={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},l={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},c=function(){const e={};return t=>(void 0===e[t]&&(e[t]=(e=>{if(e.length>2){if(!l[e])return[e];e=l[e]}const[t,i]=e.split(""),r=n[t],a=o[i]||"";return Array.isArray(a)?a.map((e=>r+e)):[r+a]})(t)),e[t])}(),h=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],u=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],d=[...h,...u];function f(e,t,i,r){var s;const n=null!=(s=(0,a.Yn)(e,t,!1))?s:i;return"number"==typeof n?e=>"string"==typeof e?e:n*e:Array.isArray(n)?e=>"string"==typeof e?e:n[e]:"function"==typeof n?n:()=>{}}function p(e){return f(e,"spacing",8)}function g(e,t){if("string"==typeof t||null==t)return t;const i=e(Math.abs(t));return t>=0?i:"number"==typeof i?-i:`-${i}`}function m(e,t){const i=p(e.theme);return Object.keys(e).map((a=>function(e,t,i,a){if(-1===t.indexOf(i))return null;const s=function(e,t){return i=>e.reduce(((e,r)=>(e[r]=g(t,i),e)),{})}(c(i),a),n=e[i];return(0,r.NI)(e,n,s)}(e,t,a,i))).reduce(s.A,{})}function b(e){return m(e,h)}function v(e){return m(e,u)}function y(e){return m(e,d)}b.propTypes={},b.filterProps=h,v.propTypes={},v.filterProps=u,y.propTypes={},y.filterProps=d},6481:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>o,BO:()=>n,Yn:()=>s});var r=i(3967),a=i(9452);function s(e,t,i=!0){if(!t||"string"!=typeof t)return null;if(e&&e.vars&&i){const i=`vars.${t}`.split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=i)return i}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function n(e,t,i,r=i){let a;return a="function"==typeof e?e(i):Array.isArray(e)?e[i]||r:s(e,i)||r,t&&(a=t(a,r,e)),a}const o=function(e){const{prop:t,cssProperty:i=e.prop,themeKey:o,transform:l}=e,c=e=>{if(null==e[t])return null;const c=e[t],h=s(e.theme,o)||{};return(0,a.NI)(e,c,(e=>{let a=n(h,l,e);return e===a&&"string"==typeof e&&(a=n(h,l,`${t}${"default"===e?"":(0,r.A)(e)}`,e)),!1===i?a:{[i]:a}}))};return c.propTypes={},c.filterProps=[t],c}},4188:(e,t,i)=>{"use strict";i.d(t,{A:()=>I});var r=i(8248),a=i(6481),s=i(4620);const n=function(...e){const t=e.reduce(((e,t)=>(t.filterProps.forEach((i=>{e[i]=t})),e)),{}),i=e=>Object.keys(e).reduce(((i,r)=>t[r]?(0,s.A)(i,t[r](e)):i),{});return i.propTypes={},i.filterProps=e.reduce(((e,t)=>e.concat(t.filterProps)),[]),i};var o=i(9452);function l(e){return"number"!=typeof e?e:`${e}px solid`}function c(e,t){return(0,a.Ay)({prop:e,themeKey:"borders",transform:t})}const h=c("border",l),u=c("borderTop",l),d=c("borderRight",l),f=c("borderBottom",l),p=c("borderLeft",l),g=c("borderColor"),m=c("borderTopColor"),b=c("borderRightColor"),v=c("borderBottomColor"),y=c("borderLeftColor"),_=c("outline",l),w=c("outlineColor"),x=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=(0,r.MA)(e.theme,"shape.borderRadius",4,"borderRadius"),i=e=>({borderRadius:(0,r._W)(t,e)});return(0,o.NI)(e,e.borderRadius,i)}return null};x.propTypes={},x.filterProps=["borderRadius"],n(h,u,d,f,p,g,m,b,v,y,x,_,w);const A=e=>{if(void 0!==e.gap&&null!==e.gap){const t=(0,r.MA)(e.theme,"spacing",8,"gap"),i=e=>({gap:(0,r._W)(t,e)});return(0,o.NI)(e,e.gap,i)}return null};A.propTypes={},A.filterProps=["gap"];const T=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=(0,r.MA)(e.theme,"spacing",8,"columnGap"),i=e=>({columnGap:(0,r._W)(t,e)});return(0,o.NI)(e,e.columnGap,i)}return null};T.propTypes={},T.filterProps=["columnGap"];const k=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=(0,r.MA)(e.theme,"spacing",8,"rowGap"),i=e=>({rowGap:(0,r._W)(t,e)});return(0,o.NI)(e,e.rowGap,i)}return null};function S(e,t){return"grey"===t?t:e}function P(e){return e<=1&&0!==e?100*e+"%":e}k.propTypes={},k.filterProps=["rowGap"],n(A,T,k,(0,a.Ay)({prop:"gridColumn"}),(0,a.Ay)({prop:"gridRow"}),(0,a.Ay)({prop:"gridAutoFlow"}),(0,a.Ay)({prop:"gridAutoColumns"}),(0,a.Ay)({prop:"gridAutoRows"}),(0,a.Ay)({prop:"gridTemplateColumns"}),(0,a.Ay)({prop:"gridTemplateRows"}),(0,a.Ay)({prop:"gridTemplateAreas"}),(0,a.Ay)({prop:"gridArea"})),n((0,a.Ay)({prop:"color",themeKey:"palette",transform:S}),(0,a.Ay)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:S}),(0,a.Ay)({prop:"backgroundColor",themeKey:"palette",transform:S}));const E=(0,a.Ay)({prop:"width",transform:P}),C=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var i,r;const a=(null==(i=e.theme)||null==(i=i.breakpoints)||null==(i=i.values)?void 0:i[t])||o.zu[t];return a?"px"!==(null==(r=e.theme)||null==(r=r.breakpoints)?void 0:r.unit)?{maxWidth:`${a}${e.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:P(t)}};return(0,o.NI)(e,e.maxWidth,t)}return null};C.filterProps=["maxWidth"];const D=(0,a.Ay)({prop:"minWidth",transform:P}),O=(0,a.Ay)({prop:"height",transform:P}),R=(0,a.Ay)({prop:"maxHeight",transform:P}),M=(0,a.Ay)({prop:"minHeight",transform:P}),I=((0,a.Ay)({prop:"size",cssProperty:"width",transform:P}),(0,a.Ay)({prop:"size",cssProperty:"height",transform:P}),n(E,C,D,O,R,M,(0,a.Ay)({prop:"boxSizing"})),{border:{themeKey:"borders",transform:l},borderTop:{themeKey:"borders",transform:l},borderRight:{themeKey:"borders",transform:l},borderBottom:{themeKey:"borders",transform:l},borderLeft:{themeKey:"borders",transform:l},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:l},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:x},color:{themeKey:"palette",transform:S},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:S},backgroundColor:{themeKey:"palette",transform:S},p:{style:r.Ms},pt:{style:r.Ms},pr:{style:r.Ms},pb:{style:r.Ms},pl:{style:r.Ms},px:{style:r.Ms},py:{style:r.Ms},padding:{style:r.Ms},paddingTop:{style:r.Ms},paddingRight:{style:r.Ms},paddingBottom:{style:r.Ms},paddingLeft:{style:r.Ms},paddingX:{style:r.Ms},paddingY:{style:r.Ms},paddingInline:{style:r.Ms},paddingInlineStart:{style:r.Ms},paddingInlineEnd:{style:r.Ms},paddingBlock:{style:r.Ms},paddingBlockStart:{style:r.Ms},paddingBlockEnd:{style:r.Ms},m:{style:r.Lc},mt:{style:r.Lc},mr:{style:r.Lc},mb:{style:r.Lc},ml:{style:r.Lc},mx:{style:r.Lc},my:{style:r.Lc},margin:{style:r.Lc},marginTop:{style:r.Lc},marginRight:{style:r.Lc},marginBottom:{style:r.Lc},marginLeft:{style:r.Lc},marginX:{style:r.Lc},marginY:{style:r.Lc},marginInline:{style:r.Lc},marginInlineStart:{style:r.Lc},marginInlineEnd:{style:r.Lc},marginBlock:{style:r.Lc},marginBlockStart:{style:r.Lc},marginBlockEnd:{style:r.Lc},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:A},rowGap:{style:k},columnGap:{style:T},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:P},maxWidth:{style:C},minWidth:{transform:P},height:{transform:P},maxHeight:{transform:P},minHeight:{transform:P},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}})},9599:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(8168),a=i(8587),s=i(1317),n=i(4188);const o=["sx"],l=e=>{var t,i;const r={systemProps:{},otherProps:{}},a=null!=(t=null==e||null==(i=e.theme)?void 0:i.unstable_sxConfig)?t:n.A;return Object.keys(e).forEach((t=>{a[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]})),r};function c(e){const{sx:t}=e,i=(0,a.A)(e,o),{systemProps:n,otherProps:c}=l(i);let h;return h=Array.isArray(t)?[n,...t]:"function"==typeof t?(...e)=>{const i=t(...e);return(0,s.Q)(i)?(0,r.A)({},n,i):n}:(0,r.A)({},n,t),(0,r.A)({},c,{sx:h})}},3857:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A,extendSxProp:()=>a.A,unstable_createStyleFunctionSx:()=>r.k,unstable_defaultSxConfig:()=>s.A});var r=i(3571),a=i(9599),s=i(4188)},3571:(e,t,i)=>{"use strict";i.d(t,{A:()=>h,k:()=>l});var r=i(3967),a=i(4620),s=i(6481),n=i(9452),o=i(4188);function l(){function e(e,t,i,a){const o={[e]:t,theme:i},l=a[e];if(!l)return{[e]:t};const{cssProperty:c=e,themeKey:h,transform:u,style:d}=l;if(null==t)return null;if("typography"===h&&"inherit"===t)return{[e]:t};const f=(0,s.Yn)(i,h)||{};return d?d(o):(0,n.NI)(o,t,(t=>{let i=(0,s.BO)(f,u,t);return t===i&&"string"==typeof t&&(i=(0,s.BO)(f,u,`${e}${"default"===t?"":(0,r.A)(t)}`,t)),!1===c?i:{[c]:i}}))}return function t(i){var r;const{sx:s,theme:l={}}=i||{};if(!s)return null;const c=null!=(r=l.unstable_sxConfig)?r:o.A;function h(i){let r=i;if("function"==typeof i)r=i(l);else if("object"!=typeof i)return i;if(!r)return null;const s=(0,n.EU)(l.breakpoints),o=Object.keys(s);let h=s;return Object.keys(r).forEach((i=>{const s="function"==typeof(o=r[i])?o(l):o;var o;if(null!=s)if("object"==typeof s)if(c[i])h=(0,a.A)(h,e(i,s,l,c));else{const e=(0,n.NI)({theme:l},s,(e=>({[i]:e})));!function(...e){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]),i=new Set(t);return e.every((e=>i.size===Object.keys(e).length))}(e,s)?h=(0,a.A)(h,e):h[i]=t({sx:s,theme:l})}else h=(0,a.A)(h,e(i,s,l,c))})),(0,n.vf)(o,h)}return Array.isArray(s)?s.map(h):h(s)}}const c=l();c.filterProps=["sx"];const h=c},2791:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(8749),a=i(5959),s=i(4684);const n=(0,r.A)(),o=function(e=n){return function(e=null){const t=a.useContext(s.T);return t&&(i=t,0!==Object.keys(i).length)?t:e;var i}(e)}},6606:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(7379),a=i(2791);function s({props:e,name:t,defaultTheme:i,themeId:s}){let n=(0,a.A)(i);s&&(n=n[s]||n);const o=function(e){const{theme:t,name:i,props:a}=e;return t&&t.components&&t.components[i]&&t.components[i].defaultProps?(0,r.A)(t.components[i].defaultProps,a):a}({theme:n,name:t,props:e});return o}},9071:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});const r=e=>e,a=(()=>{let e=r;return{configure(t){e=t},generate:t=>e(t),reset(){e=r}}})()},3967:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(9453);function a(e){if("string"!=typeof e)throw new Error((0,r.A)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},7149:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A});var r=i(3967)},7535:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});const r=function(e,t=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,i))}},5659:(e,t,i)=>{"use strict";function r(e,t,i=void 0){const r={};return Object.keys(e).forEach((a=>{r[a]=e[a].reduce(((e,r)=>{if(r){const a=t(r);""!==a&&e.push(a),i&&i[r]&&e.push(i[r])}return e}),[]).join(" ")})),r}i.d(t,{A:()=>r})},6673:(e,t,i)=>{"use strict";function r(...e){return e.reduce(((e,t)=>null==t?e:function(...i){e.apply(this,i),t.apply(this,i)}),(()=>{}))}i.d(t,{A:()=>r})},4705:(e,t,i)=>{"use strict";function r(e,t=166){let i;function r(...r){clearTimeout(i),i=setTimeout((()=>{e.apply(this,r)}),t)}return r.clear=()=>{clearTimeout(i)},r}i.d(t,{A:()=>r})},1317:(e,t,i)=>{"use strict";i.d(t,{A:()=>o,Q:()=>s});var r=i(8168),a=i(5959);function s(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)}function n(e){if(a.isValidElement(e)||!s(e))return e;const t={};return Object.keys(e).forEach((i=>{t[i]=n(e[i])})),t}function o(e,t,i={clone:!0}){const l=i.clone?(0,r.A)({},e):e;return s(e)&&s(t)&&Object.keys(t).forEach((r=>{a.isValidElement(t[r])?l[r]=t[r]:s(t[r])&&Object.prototype.hasOwnProperty.call(e,r)&&s(e[r])?l[r]=o(e[r],t[r],i):i.clone?l[r]=s(t[r])?n(t[r]):t[r]:l[r]=t[r]})),l}},4239:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A,isPlainObject:()=>r.Q});var r=i(1317)},9453:(e,t,i)=>{"use strict";function r(e){let t="https://mui.com/production-error/?code="+e;for(let e=1;e<arguments.length;e+=1)t+="&args[]="+encodeURIComponent(arguments[e]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}i.d(t,{A:()=>r})},8944:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r.A});var r=i(9453)},1609:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>s});var r=i(9071);const a={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function s(e,t,i="Mui"){const s=a[t];return s?`${i}-${s}`:`${r.A.generate(e)}-${t}`}},8413:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(1609);function a(e,t,i="Mui"){const a={};return t.forEach((t=>{a[t]=(0,r.Ay)(e,t,i)})),a}},4939:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l,getFunctionName:()=>s});var r=i(6774);const a=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function s(e){const t=`${e}`.match(a);return t&&t[1]||""}function n(e,t=""){return e.displayName||e.name||s(e)||t}function o(e,t,i){const r=n(t);return e.displayName||(""!==r?`${i}(${r})`:i)}function l(e){if(null!=e){if("string"==typeof e)return e;if("function"==typeof e)return n(e,"Component");if("object"==typeof e)switch(e.$$typeof){case r.vM:return o(e,e.render,"ForwardRef");case r.lD:return o(e,e.type,"memo");default:return}}}},2325:(e,t,i)=>{"use strict";function r(e){return e&&e.ownerDocument||document}i.d(t,{A:()=>r})},4877:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(2325);function a(e){return(0,r.A)(e).defaultView||window}},7379:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(8168);function a(e,t){const i=(0,r.A)({},t);return Object.keys(e).forEach((s=>{if(s.toString().match(/^(components|slots)$/))i[s]=(0,r.A)({},e[s],i[s]);else if(s.toString().match(/^(componentsProps|slotProps)$/)){const n=e[s]||{},o=t[s];i[s]={},o&&Object.keys(o)?n&&Object.keys(n)?(i[s]=(0,r.A)({},o),Object.keys(n).forEach((e=>{i[s][e]=a(n[e],o[e])}))):i[s]=o:i[s]=n}else void 0===i[s]&&(i[s]=e[s])})),i}},7365:(e,t,i)=>{"use strict";function r(e,t){"function"==typeof e?e(t):e&&(e.current=t)}i.d(t,{A:()=>r})},1529:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(5959);const a="undefined"!=typeof window?r.useLayoutEffect:r.useEffect},1547:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(5959),a=i(1529);const s=function(e){const t=r.useRef(e);return(0,a.A)((()=>{t.current=e})),r.useRef(((...e)=>(0,t.current)(...e))).current}},1523:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(5959),a=i(7365);function s(...e){return r.useMemo((()=>e.every((e=>null==e))?null:t=>{e.forEach((e=>{(0,a.A)(e,t)}))}),e)}},4661:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(5959);let a=0;const s=r["useId".toString()];function n(e){if(void 0!==s){const t=s();return null!=e?e:t}return function(e){const[t,i]=r.useState(e),s=e||t;return r.useEffect((()=>{null==t&&(a+=1,i(`mui-${a}`))}),[t]),s}(e)}},3068:(e,t,i)=>{"use strict";i.d(t,{E:()=>n,A:()=>o});var r=i(5959);const a={},s=[];class n{constructor(){this.currentId=null,this.clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new n}start(e,t){this.clear(),this.currentId=setTimeout((()=>{this.currentId=null,t()}),e)}}function o(){const e=function(e){const t=r.useRef(a);return t.current===a&&(t.current=e(void 0)),t}(n.create).current;var t;return t=e.disposeEffect,r.useEffect(t,s),e}},6774:(e,t)=>{"use strict";Symbol.for("react.transitional.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler");Symbol.for("react.provider");Symbol.for("react.consumer"),Symbol.for("react.context");var i=Symbol.for("react.forward_ref"),r=(Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"));Symbol.for("react.lazy"),Symbol.for("react.view_transition"),Symbol.for("react.client.reference");t.vM=i,t.lD=r},4146:(e,t,i)=>{"use strict";var r=i(3404),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(e){return r.isMemo(e)?n:o[e.$$typeof]||a}o[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[r.Memo]=n;var c=Object.defineProperty,h=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,i,r){if("string"!=typeof i){if(p){var a=f(i);a&&a!==p&&e(t,a,r)}var n=h(i);u&&(n=n.concat(u(i)));for(var o=l(t),g=l(i),m=0;m<n.length;++m){var b=n[m];if(!(s[b]||r&&r[b]||g&&g[b]||o&&o[b])){var v=d(i,b);try{c(t,b,v)}catch(e){}}}}return t}},3072:(e,t)=>{"use strict";var i="function"==typeof Symbol&&Symbol.for,r=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,n=i?Symbol.for("react.strict_mode"):60108,o=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,c=i?Symbol.for("react.context"):60110,h=i?Symbol.for("react.async_mode"):60111,u=i?Symbol.for("react.concurrent_mode"):60111,d=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,p=i?Symbol.for("react.suspense_list"):60120,g=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,b=i?Symbol.for("react.block"):60121,v=i?Symbol.for("react.fundamental"):60117,y=i?Symbol.for("react.responder"):60118,_=i?Symbol.for("react.scope"):60119;function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case h:case u:case s:case o:case n:case f:return e;default:switch(e=e&&e.$$typeof){case c:case d:case m:case g:case l:return e;default:return t}}case a:return t}}}function x(e){return w(e)===u}t.AsyncMode=h,t.ConcurrentMode=u,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=d,t.Fragment=s,t.Lazy=m,t.Memo=g,t.Portal=a,t.Profiler=o,t.StrictMode=n,t.Suspense=f,t.isAsyncMode=function(e){return x(e)||w(e)===h},t.isConcurrentMode=x,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===d},t.isFragment=function(e){return w(e)===s},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===g},t.isPortal=function(e){return w(e)===a},t.isProfiler=function(e){return w(e)===o},t.isStrictMode=function(e){return w(e)===n},t.isSuspense=function(e){return w(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===u||e===o||e===n||e===f||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===v||e.$$typeof===y||e.$$typeof===_||e.$$typeof===b)},t.typeOf=w},3404:(e,t,i)=>{"use strict";e.exports=i(3072)},2799:(e,t)=>{"use strict";Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.server_context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.offscreen");Symbol.for("react.module.reference")},4363:(e,t,i)=>{"use strict";i(2799)},9740:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DikeDesignerModel:()=>yw,applySettings:()=>ww,default:()=>bd,getSettings:()=>xw,getSettingsSchema:()=>Aw});var r=i(6308),a=i(3594),s=i(1299),n=i(4702),o=i(6102),l=i(8168),c=i(8587),h=i(5959),u=i.n(h),d=i(4164),f=i(2532),p=i(3571),g=i(9599),m=i(2791);const b=["className","component"];var v=i(9071),y=i(3478),_=i(8312),w=i(8413);const x=(0,w.A)("MuiBox",["root"]),A=(0,y.A)(),T=function(e={}){const{themeId:t,defaultTheme:i,defaultClassName:a="MuiBox-root",generateClassName:s}=e,n=(0,f.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(p.A);return h.forwardRef((function(e,o){const h=(0,m.A)(i),u=(0,g.A)(e),{className:f,component:p="div"}=u,v=(0,c.A)(u,b);return(0,r.jsx)(n,(0,l.A)({as:p,ref:o,className:(0,d.A)(f,s?s(a):a),theme:t&&h[t]||h},v))}))}({themeId:_.A,defaultTheme:A,defaultClassName:x.root,generateClassName:v.A.generate}),k=T;i(4363);var S=i(1523);function P(e){return"string"==typeof e}function E(e,t=[]){if(void 0===e)return{};const i={};return Object.keys(e).filter((i=>i.match(/^on[A-Z]/)&&"function"==typeof e[i]&&!t.includes(i))).forEach((t=>{i[t]=e[t]})),i}function C(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"==typeof e[t]))).forEach((i=>{t[i]=e[i]})),t}const D=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function O(e){var t;const{elementType:i,externalSlotProps:r,ownerState:a,skipResolvingSlotProps:s=!1}=e,n=(0,c.A)(e,D),o=s?{}:function(e,t){return"function"==typeof e?e(t,void 0):e}(r,a),{props:h,internalRef:u}=function(e){const{getSlotProps:t,additionalProps:i,externalSlotProps:r,externalForwardedProps:a,className:s}=e;if(!t){const e=(0,d.A)(null==i?void 0:i.className,s,null==a?void 0:a.className,null==r?void 0:r.className),t=(0,l.A)({},null==i?void 0:i.style,null==a?void 0:a.style,null==r?void 0:r.style),n=(0,l.A)({},i,a,r);return e.length>0&&(n.className=e),Object.keys(t).length>0&&(n.style=t),{props:n,internalRef:void 0}}const n=E((0,l.A)({},a,r)),o=C(r),c=C(a),h=t(n),u=(0,d.A)(null==h?void 0:h.className,null==i?void 0:i.className,s,null==a?void 0:a.className,null==r?void 0:r.className),f=(0,l.A)({},null==h?void 0:h.style,null==i?void 0:i.style,null==a?void 0:a.style,null==r?void 0:r.style),p=(0,l.A)({},h,i,c,o);return u.length>0&&(p.className=u),Object.keys(f).length>0&&(p.style=f),{props:p,internalRef:h.ref}}((0,l.A)({},n,{externalSlotProps:o})),f=(0,S.A)(u,null==o?void 0:o.ref,null==(t=e.additionalProps)?void 0:t.ref),p=function(e,t,i){return void 0===e||P(e)?t:(0,l.A)({},t,{ownerState:(0,l.A)({},t.ownerState,i)})}(i,(0,l.A)({},h,{ref:f}),a);return p}var R=i(5659);const M=h.createContext(),I=()=>{const e=h.useContext(M);return null!=e&&e};var L=i(1848),F=i(3541),N=i(2765);function B(){const e=(0,m.A)(N.A);return e[_.A]||e}var j=i(1935);let z;function U(){if(z)return z;const e=document.createElement("div"),t=document.createElement("div");return t.style.width="10px",t.style.height="1px",e.appendChild(t),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e),z="reverse",e.scrollLeft>0?z="default":(e.scrollLeft=1,0===e.scrollLeft&&(z="negative")),document.body.removeChild(e),z}function H(e,t){const i=e.scrollLeft;if("rtl"!==t)return i;switch(U()){case"negative":return e.scrollWidth-e.clientWidth+i;case"reverse":return e.scrollWidth-e.clientWidth-i;default:return i}}function W(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}var V=i(2778),X=i(3749);const Y=["onChange"],G={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};var K=i(5003);const q=(0,K.A)((0,r.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),Z=(0,K.A)((0,r.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight");var J=i(6852),Q=i(3034),ee=i(1984);function te(e,t){return te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},te(e,t)}function ie(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,te(e,t)}const re=u().createContext(null);function ae(e,t){var i=Object.create(null);return e&&h.Children.map(e,(function(e){return e})).forEach((function(e){i[e.key]=function(e){return t&&(0,h.isValidElement)(e)?t(e):e}(e)})),i}function se(e,t,i){return null!=i[t]?i[t]:e.props[t]}function ne(e,t,i){var r=ae(e.children),a=function(e,t){function i(i){return i in t?t[i]:e[i]}e=e||{},t=t||{};var r,a=Object.create(null),s=[];for(var n in e)n in t?s.length&&(a[n]=s,s=[]):s.push(n);var o={};for(var l in t){if(a[l])for(r=0;r<a[l].length;r++){var c=a[l][r];o[a[l][r]]=i(c)}o[l]=i(l)}for(r=0;r<s.length;r++)o[s[r]]=i(s[r]);return o}(t,r);return Object.keys(a).forEach((function(s){var n=a[s];if((0,h.isValidElement)(n)){var o=s in t,l=s in r,c=t[s],u=(0,h.isValidElement)(c)&&!c.props.in;!l||o&&!u?l||!o||u?l&&o&&(0,h.isValidElement)(c)&&(a[s]=(0,h.cloneElement)(n,{onExited:i.bind(null,n),in:c.props.in,exit:se(n,"exit",e),enter:se(n,"enter",e)})):a[s]=(0,h.cloneElement)(n,{in:!1}):a[s]=(0,h.cloneElement)(n,{onExited:i.bind(null,n),in:!0,exit:se(n,"exit",e),enter:se(n,"enter",e)})}})),a}var oe=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},le=function(e){function t(t,i){var r,a=(r=e.call(this,t,i)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r));return r.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},r}ie(t,e);var i=t.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var i,r,a=t.children,s=t.handleExited;return{children:t.firstRender?(i=e,r=s,ae(i.children,(function(e){return(0,h.cloneElement)(e,{onExited:r.bind(null,e),in:!0,appear:se(e,"appear",i),enter:se(e,"enter",i),exit:se(e,"exit",i)})}))):ne(e,a,s),firstRender:!1}},i.handleExited=function(e,t){var i=ae(this.props.children);e.key in i||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var i=(0,l.A)({},t.children);return delete i[e.key],{children:i}})))},i.render=function(){var e=this.props,t=e.component,i=e.childFactory,r=(0,c.A)(e,["component","childFactory"]),a=this.state.contextValue,s=oe(this.state.children).map(i);return delete r.appear,delete r.enter,delete r.exit,null===t?u().createElement(re.Provider,{value:a},s):u().createElement(re.Provider,{value:a},u().createElement(t,r,s))},t}(u().Component);le.propTypes={},le.defaultProps={component:"div",childFactory:function(e){return e}};const ce=le;var he=i(7437),ue=i(3068);const de=(0,w.A)("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),fe=["center","classes","className"];let pe,ge,me,be,ve=e=>e;const ye=(0,he.i7)(pe||(pe=ve`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),_e=(0,he.i7)(ge||(ge=ve`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),we=(0,he.i7)(me||(me=ve`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),xe=(0,L.Ay)("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Ae=(0,L.Ay)((function(e){const{className:t,classes:i,pulsate:a=!1,rippleX:s,rippleY:n,rippleSize:o,in:l,onExited:c,timeout:u}=e,[f,p]=h.useState(!1),g=(0,d.A)(t,i.ripple,i.rippleVisible,a&&i.ripplePulsate),m={width:o,height:o,top:-o/2+n,left:-o/2+s},b=(0,d.A)(i.child,f&&i.childLeaving,a&&i.childPulsate);return l||f||p(!0),h.useEffect((()=>{if(!l&&null!=c){const e=setTimeout(c,u);return()=>{clearTimeout(e)}}}),[c,l,u]),(0,r.jsx)("span",{className:g,style:m,children:(0,r.jsx)("span",{className:b})})}),{name:"MuiTouchRipple",slot:"Ripple"})(be||(be=ve`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),de.rippleVisible,ye,550,(({theme:e})=>e.transitions.easing.easeInOut),de.ripplePulsate,(({theme:e})=>e.transitions.duration.shorter),de.child,de.childLeaving,_e,550,(({theme:e})=>e.transitions.easing.easeInOut),de.childPulsate,we,(({theme:e})=>e.transitions.easing.easeInOut)),Te=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTouchRipple"}),{center:a=!1,classes:s={},className:n}=i,o=(0,c.A)(i,fe),[u,f]=h.useState([]),p=h.useRef(0),g=h.useRef(null);h.useEffect((()=>{g.current&&(g.current(),g.current=null)}),[u]);const m=h.useRef(!1),b=(0,ue.A)(),v=h.useRef(null),y=h.useRef(null),_=h.useCallback((e=>{const{pulsate:t,rippleX:i,rippleY:a,rippleSize:n,cb:o}=e;f((e=>[...e,(0,r.jsx)(Ae,{classes:{ripple:(0,d.A)(s.ripple,de.ripple),rippleVisible:(0,d.A)(s.rippleVisible,de.rippleVisible),ripplePulsate:(0,d.A)(s.ripplePulsate,de.ripplePulsate),child:(0,d.A)(s.child,de.child),childLeaving:(0,d.A)(s.childLeaving,de.childLeaving),childPulsate:(0,d.A)(s.childPulsate,de.childPulsate)},timeout:550,pulsate:t,rippleX:i,rippleY:a,rippleSize:n},p.current)])),p.current+=1,g.current=o}),[s]),w=h.useCallback(((e={},t={},i=()=>{})=>{const{pulsate:r=!1,center:s=a||t.pulsate,fakeElement:n=!1}=t;if("mousedown"===(null==e?void 0:e.type)&&m.current)return void(m.current=!1);"touchstart"===(null==e?void 0:e.type)&&(m.current=!0);const o=n?null:y.current,l=o?o.getBoundingClientRect():{width:0,height:0,left:0,top:0};let c,h,u;if(s||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)c=Math.round(l.width/2),h=Math.round(l.height/2);else{const{clientX:t,clientY:i}=e.touches&&e.touches.length>0?e.touches[0]:e;c=Math.round(t-l.left),h=Math.round(i-l.top)}if(s)u=Math.sqrt((2*l.width**2+l.height**2)/3),u%2==0&&(u+=1);else{const e=2*Math.max(Math.abs((o?o.clientWidth:0)-c),c)+2,t=2*Math.max(Math.abs((o?o.clientHeight:0)-h),h)+2;u=Math.sqrt(e**2+t**2)}null!=e&&e.touches?null===v.current&&(v.current=()=>{_({pulsate:r,rippleX:c,rippleY:h,rippleSize:u,cb:i})},b.start(80,(()=>{v.current&&(v.current(),v.current=null)}))):_({pulsate:r,rippleX:c,rippleY:h,rippleSize:u,cb:i})}),[a,_,b]),x=h.useCallback((()=>{w({},{pulsate:!0})}),[w]),A=h.useCallback(((e,t)=>{if(b.clear(),"touchend"===(null==e?void 0:e.type)&&v.current)return v.current(),v.current=null,void b.start(0,(()=>{A(e,t)}));v.current=null,f((e=>e.length>0?e.slice(1):e)),g.current=t}),[b]);return h.useImperativeHandle(t,(()=>({pulsate:x,start:w,stop:A})),[x,w,A]),(0,r.jsx)(xe,(0,l.A)({className:(0,d.A)(de.root,s.root,n),ref:y},o,{children:(0,r.jsx)(ce,{component:null,exit:!0,children:u})}))}));var ke=i(1609);function Se(e){return(0,ke.Ay)("MuiButtonBase",e)}const Pe=(0,w.A)("MuiButtonBase",["root","disabled","focusVisible"]),Ee=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],Ce=(0,L.Ay)("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Pe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),De=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiButtonBase"}),{action:a,centerRipple:s=!1,children:n,className:o,component:u="button",disabled:f=!1,disableRipple:p=!1,disableTouchRipple:g=!1,focusRipple:m=!1,LinkComponent:b="a",onBlur:v,onClick:y,onContextMenu:_,onDragLeave:w,onFocus:x,onFocusVisible:A,onKeyDown:T,onKeyUp:k,onMouseDown:S,onMouseLeave:P,onMouseUp:E,onTouchEnd:C,onTouchMove:D,onTouchStart:O,tabIndex:M=0,TouchRippleProps:I,touchRippleRef:L,type:N}=i,B=(0,c.A)(i,Ee),j=h.useRef(null),z=h.useRef(null),U=(0,J.A)(z,L),{isFocusVisibleRef:H,onFocus:W,onBlur:V,ref:$}=(0,ee.A)(),[X,Y]=h.useState(!1);f&&X&&Y(!1),h.useImperativeHandle(a,(()=>({focusVisible:()=>{Y(!0),j.current.focus()}})),[]);const[G,K]=h.useState(!1);h.useEffect((()=>{K(!0)}),[]);const q=G&&!p&&!f;function Z(e,t,i=g){return(0,Q.A)((r=>(t&&t(r),!i&&z.current&&z.current[e](r),!0)))}h.useEffect((()=>{X&&m&&!p&&G&&z.current.pulsate()}),[p,m,X,G]);const te=Z("start",S),ie=Z("stop",_),re=Z("stop",w),ae=Z("stop",E),se=Z("stop",(e=>{X&&e.preventDefault(),P&&P(e)})),ne=Z("start",O),oe=Z("stop",C),le=Z("stop",D),ce=Z("stop",(e=>{V(e),!1===H.current&&Y(!1),v&&v(e)}),!1),he=(0,Q.A)((e=>{j.current||(j.current=e.currentTarget),W(e),!0===H.current&&(Y(!0),A&&A(e)),x&&x(e)})),ue=()=>{const e=j.current;return u&&"button"!==u&&!("A"===e.tagName&&e.href)},de=h.useRef(!1),fe=(0,Q.A)((e=>{m&&!de.current&&X&&z.current&&" "===e.key&&(de.current=!0,z.current.stop(e,(()=>{z.current.start(e)}))),e.target===e.currentTarget&&ue()&&" "===e.key&&e.preventDefault(),T&&T(e),e.target===e.currentTarget&&ue()&&"Enter"===e.key&&!f&&(e.preventDefault(),y&&y(e))})),pe=(0,Q.A)((e=>{m&&" "===e.key&&z.current&&X&&!e.defaultPrevented&&(de.current=!1,z.current.stop(e,(()=>{z.current.pulsate(e)}))),k&&k(e),y&&e.target===e.currentTarget&&ue()&&" "===e.key&&!e.defaultPrevented&&y(e)}));let ge=u;"button"===ge&&(B.href||B.to)&&(ge=b);const me={};"button"===ge?(me.type=void 0===N?"button":N,me.disabled=f):(B.href||B.to||(me.role="button"),f&&(me["aria-disabled"]=f));const be=(0,J.A)(t,$,j),ve=(0,l.A)({},i,{centerRipple:s,component:u,disabled:f,disableRipple:p,disableTouchRipple:g,focusRipple:m,tabIndex:M,focusVisible:X}),ye=(e=>{const{disabled:t,focusVisible:i,focusVisibleClassName:r,classes:a}=e,s={root:["root",t&&"disabled",i&&"focusVisible"]},n=(0,R.A)(s,Se,a);return i&&r&&(n.root+=` ${r}`),n})(ve);return(0,r.jsxs)(Ce,(0,l.A)({as:ge,className:(0,d.A)(ye.root,o),ownerState:ve,onBlur:ce,onClick:y,onContextMenu:ie,onFocus:he,onKeyDown:fe,onKeyUp:pe,onMouseDown:te,onMouseLeave:se,onMouseUp:ae,onDragLeave:re,onTouchEnd:oe,onTouchMove:le,onTouchStart:ne,ref:be,tabIndex:f?-1:M,type:N},me,B,{children:[n,q?(0,r.jsx)(Te,(0,l.A)({ref:U,center:s},I)):null]}))}));function Oe(e){return(0,ke.Ay)("MuiTabScrollButton",e)}const Re=(0,w.A)("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),Me=["className","slots","slotProps","direction","orientation","disabled"],Ie=(0,L.Ay)(De,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.orientation&&t[i.orientation]]}})((({ownerState:e})=>(0,l.A)({width:40,flexShrink:0,opacity:.8,[`&.${Re.disabled}`]:{opacity:0}},"vertical"===e.orientation&&{width:"100%",height:40,"& svg":{transform:`rotate(${e.isRtl?-90:90}deg)`}}))),Le=h.forwardRef((function(e,t){var i,a;const s=(0,F.A)({props:e,name:"MuiTabScrollButton"}),{className:n,slots:o={},slotProps:h={},direction:u}=s,f=(0,c.A)(s,Me),p=I(),g=(0,l.A)({isRtl:p},s),m=(e=>{const{classes:t,orientation:i,disabled:r}=e,a={root:["root",i,r&&"disabled"]};return(0,R.A)(a,Oe,t)})(g),b=null!=(i=o.StartScrollButtonIcon)?i:q,v=null!=(a=o.EndScrollButtonIcon)?a:Z,y=O({elementType:b,externalSlotProps:h.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:g}),_=O({elementType:v,externalSlotProps:h.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:g});return(0,r.jsx)(Ie,(0,l.A)({component:"div",className:(0,d.A)(m.root,n),ref:t,role:null,ownerState:g,tabIndex:null},f,{children:"left"===u?(0,r.jsx)(b,(0,l.A)({},y)):(0,r.jsx)(v,(0,l.A)({},_))}))}));function Fe(e){return(0,ke.Ay)("MuiTabs",e)}const Ne=(0,w.A)("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]);var Be=i(6248);const je=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","slots","slotProps","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],ze=(e,t)=>e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:e.firstChild,Ue=(e,t)=>e===t?e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:e.lastChild,He=(e,t,i)=>{let r=!1,a=i(e,t);for(;a;){if(a===e.firstChild){if(r)return;r=!0}const t=a.disabled||"true"===a.getAttribute("aria-disabled");if(a.hasAttribute("tabindex")&&!t)return void a.focus();a=i(e,a)}},We=(0,L.Ay)("div",{name:"MuiTabs",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[{[`& .${Ne.scrollButtons}`]:t.scrollButtons},{[`& .${Ne.scrollButtons}`]:i.scrollButtonsHideMobile&&t.scrollButtonsHideMobile},t.root,i.vertical&&t.vertical]}})((({ownerState:e,theme:t})=>(0,l.A)({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},e.vertical&&{flexDirection:"column"},e.scrollButtonsHideMobile&&{[`& .${Ne.scrollButtons}`]:{[t.breakpoints.down("sm")]:{display:"none"}}}))),Ve=(0,L.Ay)("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.scroller,i.fixed&&t.fixed,i.hideScrollbar&&t.hideScrollbar,i.scrollableX&&t.scrollableX,i.scrollableY&&t.scrollableY]}})((({ownerState:e})=>(0,l.A)({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},e.fixed&&{overflowX:"hidden",width:"100%"},e.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},e.scrollableX&&{overflowX:"auto",overflowY:"hidden"},e.scrollableY&&{overflowY:"auto",overflowX:"hidden"}))),$e=(0,L.Ay)("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.flexContainer,i.vertical&&t.flexContainerVertical,i.centered&&t.centered]}})((({ownerState:e})=>(0,l.A)({display:"flex"},e.vertical&&{flexDirection:"column"},e.centered&&{justifyContent:"center"}))),Xe=(0,L.Ay)("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(e,t)=>t.indicator})((({ownerState:e,theme:t})=>(0,l.A)({position:"absolute",height:2,bottom:0,width:"100%",transition:t.transitions.create()},"primary"===e.indicatorColor&&{backgroundColor:(t.vars||t).palette.primary.main},"secondary"===e.indicatorColor&&{backgroundColor:(t.vars||t).palette.secondary.main},e.vertical&&{height:"100%",width:2,right:0}))),Ye=(0,L.Ay)((function(e){const{onChange:t}=e,i=(0,c.A)(e,Y),a=h.useRef(),s=h.useRef(null),n=()=>{a.current=s.current.offsetHeight-s.current.clientHeight};return(0,V.A)((()=>{const e=(0,j.A)((()=>{const e=a.current;n(),e!==a.current&&t(a.current)})),i=(0,X.A)(s.current);return i.addEventListener("resize",e),()=>{e.clear(),i.removeEventListener("resize",e)}}),[t]),h.useEffect((()=>{n(),t(a.current)}),[t]),(0,r.jsx)("div",(0,l.A)({style:G,ref:s},i))}))({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),Ge={},Ke=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTabs"}),a=B(),s=I(),{"aria-label":n,"aria-labelledby":o,action:u,centered:f=!1,children:p,className:g,component:m="div",allowScrollButtonsMobile:b=!1,indicatorColor:v="primary",onChange:y,orientation:_="horizontal",ScrollButtonComponent:w=Le,scrollButtons:x="auto",selectionFollowsFocus:A,slots:T={},slotProps:k={},TabIndicatorProps:S={},TabScrollButtonProps:P={},textColor:E="primary",value:C,variant:D="standard",visibleScrollbar:M=!1}=i,L=(0,c.A)(i,je),N="scrollable"===D,z="vertical"===_,V=z?"scrollTop":"scrollLeft",$=z?"top":"left",Y=z?"bottom":"right",G=z?"clientHeight":"clientWidth",K=z?"height":"width",q=(0,l.A)({},i,{component:m,allowScrollButtonsMobile:b,indicatorColor:v,orientation:_,vertical:z,scrollButtons:x,textColor:E,variant:D,visibleScrollbar:M,fixed:!N,hideScrollbar:N&&!M,scrollableX:N&&!z,scrollableY:N&&z,centered:f&&!N,scrollButtonsHideMobile:!b}),Z=(e=>{const{vertical:t,fixed:i,hideScrollbar:r,scrollableX:a,scrollableY:s,centered:n,scrollButtonsHideMobile:o,classes:l}=e,c={root:["root",t&&"vertical"],scroller:["scroller",i&&"fixed",r&&"hideScrollbar",a&&"scrollableX",s&&"scrollableY"],flexContainer:["flexContainer",t&&"flexContainerVertical",n&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",o&&"scrollButtonsHideMobile"],scrollableX:[a&&"scrollableX"],hideScrollbar:[r&&"hideScrollbar"]};return(0,R.A)(c,Fe,l)})(q),J=O({elementType:T.StartScrollButtonIcon,externalSlotProps:k.startScrollButtonIcon,ownerState:q}),ee=O({elementType:T.EndScrollButtonIcon,externalSlotProps:k.endScrollButtonIcon,ownerState:q}),[te,ie]=h.useState(!1),[re,ae]=h.useState(Ge),[se,ne]=h.useState(!1),[oe,le]=h.useState(!1),[ce,he]=h.useState(!1),[ue,de]=h.useState({overflow:"hidden",scrollbarWidth:0}),fe=new Map,pe=h.useRef(null),ge=h.useRef(null),me=()=>{const e=pe.current;let t,i;if(e){const i=e.getBoundingClientRect();t={clientWidth:e.clientWidth,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,scrollLeftNormalized:H(e,s?"rtl":"ltr"),scrollWidth:e.scrollWidth,top:i.top,bottom:i.bottom,left:i.left,right:i.right}}if(e&&!1!==C){const e=ge.current.children;if(e.length>0){const t=e[fe.get(C)];i=t?t.getBoundingClientRect():null}}return{tabsMeta:t,tabMeta:i}},be=(0,Q.A)((()=>{const{tabsMeta:e,tabMeta:t}=me();let i,r=0;if(z)i="top",t&&e&&(r=t.top-e.top+e.scrollTop);else if(i=s?"right":"left",t&&e){const a=s?e.scrollLeftNormalized+e.clientWidth-e.scrollWidth:e.scrollLeft;r=(s?-1:1)*(t[i]-e[i]+a)}const a={[i]:r,[K]:t?t[K]:0};if(isNaN(re[i])||isNaN(re[K]))ae(a);else{const e=Math.abs(re[i]-a[i]),t=Math.abs(re[K]-a[K]);(e>=1||t>=1)&&ae(a)}})),ve=(e,{animation:t=!0}={})=>{t?function(e,t,i,r={},a=()=>{}){const{ease:s=W,duration:n=300}=r;let o=null;const l=t[e];let c=!1;const h=r=>{if(c)return void a(new Error("Animation cancelled"));null===o&&(o=r);const u=Math.min(1,(r-o)/n);t[e]=s(u)*(i-l)+l,u>=1?requestAnimationFrame((()=>{a(null)})):requestAnimationFrame(h)};l===i?a(new Error("Element already at target position")):requestAnimationFrame(h)}(V,pe.current,e,{duration:a.transitions.duration.standard}):pe.current[V]=e},ye=e=>{let t=pe.current[V];z?t+=e:(t+=e*(s?-1:1),t*=s&&"reverse"===U()?-1:1),ve(t)},_e=()=>{const e=pe.current[G];let t=0;const i=Array.from(ge.current.children);for(let r=0;r<i.length;r+=1){const a=i[r];if(t+a[G]>e){0===r&&(t=e);break}t+=a[G]}return t},we=()=>{ye(-1*_e())},xe=()=>{ye(_e())},Ae=h.useCallback((e=>{de({overflow:null,scrollbarWidth:e})}),[]),Te=(0,Q.A)((e=>{const{tabsMeta:t,tabMeta:i}=me();if(i&&t)if(i[$]<t[$]){const r=t[V]+(i[$]-t[$]);ve(r,{animation:e})}else if(i[Y]>t[Y]){const r=t[V]+(i[Y]-t[Y]);ve(r,{animation:e})}})),ke=(0,Q.A)((()=>{N&&!1!==x&&he(!ce)}));h.useEffect((()=>{const e=(0,j.A)((()=>{pe.current&&be()}));let t;const i=(0,X.A)(pe.current);let r;return i.addEventListener("resize",e),"undefined"!=typeof ResizeObserver&&(t=new ResizeObserver(e),Array.from(ge.current.children).forEach((e=>{t.observe(e)}))),"undefined"!=typeof MutationObserver&&(r=new MutationObserver((i=>{i.forEach((e=>{e.removedNodes.forEach((e=>{var i;null==(i=t)||i.unobserve(e)})),e.addedNodes.forEach((e=>{var i;null==(i=t)||i.observe(e)}))})),e(),ke()})),r.observe(ge.current,{childList:!0})),()=>{var a,s;e.clear(),i.removeEventListener("resize",e),null==(a=r)||a.disconnect(),null==(s=t)||s.disconnect()}}),[be,ke]),h.useEffect((()=>{const e=Array.from(ge.current.children),t=e.length;if("undefined"!=typeof IntersectionObserver&&t>0&&N&&!1!==x){const i=e[0],r=e[t-1],a={root:pe.current,threshold:.99},s=new IntersectionObserver((e=>{ne(!e[0].isIntersecting)}),a);s.observe(i);const n=new IntersectionObserver((e=>{le(!e[0].isIntersecting)}),a);return n.observe(r),()=>{s.disconnect(),n.disconnect()}}}),[N,x,ce,null==p?void 0:p.length]),h.useEffect((()=>{ie(!0)}),[]),h.useEffect((()=>{be()})),h.useEffect((()=>{Te(Ge!==re)}),[Te,re]),h.useImperativeHandle(u,(()=>({updateIndicator:be,updateScrollButtons:ke})),[be,ke]);const Se=(0,r.jsx)(Xe,(0,l.A)({},S,{className:(0,d.A)(Z.indicator,S.className),ownerState:q,style:(0,l.A)({},re,S.style)}));let Pe=0;const Ee=h.Children.map(p,(e=>{if(!h.isValidElement(e))return null;const t=void 0===e.props.value?Pe:e.props.value;fe.set(t,Pe);const i=t===C;return Pe+=1,h.cloneElement(e,(0,l.A)({fullWidth:"fullWidth"===D,indicator:i&&!te&&Se,selected:i,selectionFollowsFocus:A,onChange:y,textColor:E,value:t},1!==Pe||!1!==C||e.props.tabIndex?{}:{tabIndex:0}))})),Ce=(()=>{const e={};e.scrollbarSizeListener=N?(0,r.jsx)(Ye,{onChange:Ae,className:(0,d.A)(Z.scrollableX,Z.hideScrollbar)}):null;const t=N&&("auto"===x&&(se||oe)||!0===x);return e.scrollButtonStart=t?(0,r.jsx)(w,(0,l.A)({slots:{StartScrollButtonIcon:T.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:J},orientation:_,direction:s?"right":"left",onClick:we,disabled:!se},P,{className:(0,d.A)(Z.scrollButtons,P.className)})):null,e.scrollButtonEnd=t?(0,r.jsx)(w,(0,l.A)({slots:{EndScrollButtonIcon:T.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:ee},orientation:_,direction:s?"left":"right",onClick:xe,disabled:!oe},P,{className:(0,d.A)(Z.scrollButtons,P.className)})):null,e})();return(0,r.jsxs)(We,(0,l.A)({className:(0,d.A)(Z.root,g),ownerState:q,ref:t,as:m},L,{children:[Ce.scrollButtonStart,Ce.scrollbarSizeListener,(0,r.jsxs)(Ve,{className:Z.scroller,ownerState:q,style:{overflow:ue.overflow,[z?"margin"+(s?"Left":"Right"):"marginBottom"]:M?void 0:-ue.scrollbarWidth},ref:pe,children:[(0,r.jsx)($e,{"aria-label":n,"aria-labelledby":o,"aria-orientation":"vertical"===_?"vertical":null,className:Z.flexContainer,ownerState:q,onKeyDown:e=>{const t=ge.current,i=(0,Be.A)(t).activeElement;if("tab"!==i.getAttribute("role"))return;let r="horizontal"===_?"ArrowLeft":"ArrowUp",a="horizontal"===_?"ArrowRight":"ArrowDown";switch("horizontal"===_&&s&&(r="ArrowRight",a="ArrowLeft"),e.key){case r:e.preventDefault(),He(t,i,Ue);break;case a:e.preventDefault(),He(t,i,ze);break;case"Home":e.preventDefault(),He(t,null,ze);break;case"End":e.preventDefault(),He(t,null,Ue)}},ref:ge,role:"tablist",children:Ee}),te&&Se]}),Ce.scrollButtonEnd]}))}));var qe=i(8466);function Ze(e){return(0,ke.Ay)("MuiTab",e)}const Je=(0,w.A)("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]),Qe=["className","disabled","disableFocusRipple","fullWidth","icon","iconPosition","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"],et=(0,L.Ay)(De,{name:"MuiTab",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.label&&i.icon&&t.labelIcon,t[`textColor${(0,qe.A)(i.textColor)}`],i.fullWidth&&t.fullWidth,i.wrapped&&t.wrapped]}})((({theme:e,ownerState:t})=>(0,l.A)({},e.typography.button,{maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center"},t.label&&{flexDirection:"top"===t.iconPosition||"bottom"===t.iconPosition?"column":"row"},{lineHeight:1.25},t.icon&&t.label&&{minHeight:72,paddingTop:9,paddingBottom:9,[`& > .${Je.iconWrapper}`]:(0,l.A)({},"top"===t.iconPosition&&{marginBottom:6},"bottom"===t.iconPosition&&{marginTop:6},"start"===t.iconPosition&&{marginRight:e.spacing(1)},"end"===t.iconPosition&&{marginLeft:e.spacing(1)})},"inherit"===t.textColor&&{color:"inherit",opacity:.6,[`&.${Je.selected}`]:{opacity:1},[`&.${Je.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},"primary"===t.textColor&&{color:(e.vars||e).palette.text.secondary,[`&.${Je.selected}`]:{color:(e.vars||e).palette.primary.main},[`&.${Je.disabled}`]:{color:(e.vars||e).palette.text.disabled}},"secondary"===t.textColor&&{color:(e.vars||e).palette.text.secondary,[`&.${Je.selected}`]:{color:(e.vars||e).palette.secondary.main},[`&.${Je.disabled}`]:{color:(e.vars||e).palette.text.disabled}},t.fullWidth&&{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},t.wrapped&&{fontSize:e.typography.pxToRem(12)}))),tt=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTab"}),{className:a,disabled:s=!1,disableFocusRipple:n=!1,fullWidth:o,icon:u,iconPosition:f="top",indicator:p,label:g,onChange:m,onClick:b,onFocus:v,selected:y,selectionFollowsFocus:_,textColor:w="inherit",value:x,wrapped:A=!1}=i,T=(0,c.A)(i,Qe),k=(0,l.A)({},i,{disabled:s,disableFocusRipple:n,selected:y,icon:!!u,iconPosition:f,label:!!g,fullWidth:o,textColor:w,wrapped:A}),S=(e=>{const{classes:t,textColor:i,fullWidth:r,wrapped:a,icon:s,label:n,selected:o,disabled:l}=e,c={root:["root",s&&n&&"labelIcon",`textColor${(0,qe.A)(i)}`,r&&"fullWidth",a&&"wrapped",o&&"selected",l&&"disabled"],iconWrapper:["iconWrapper"]};return(0,R.A)(c,Ze,t)})(k),P=u&&g&&h.isValidElement(u)?h.cloneElement(u,{className:(0,d.A)(S.iconWrapper,u.props.className)}):u;return(0,r.jsxs)(et,(0,l.A)({focusRipple:!n,className:(0,d.A)(S.root,a),ref:t,role:"tab","aria-selected":y,disabled:s,onClick:e=>{!y&&m&&m(e,x),b&&b(e)},onFocus:e=>{_&&!y&&m&&m(e,x),v&&v(e)},ownerState:k,tabIndex:y?0:-1},T,{children:["top"===f||"start"===f?(0,r.jsxs)(h.Fragment,{children:[P,g]}):(0,r.jsxs)(h.Fragment,{children:[g,P]}),p]}))}));var it=i(5635),rt=i(6817);function at(e,t,i,r){return new(i||(i=Promise))((function(a,s){function n(e){try{l(r.next(e))}catch(e){s(e)}}function o(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;class st{constructor(e){Object.defineProperty(this,"_value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._value=e}get value(){return this._value/100}get percent(){return this._value}toString(){return this._value+"%"}interpolate(e,t){return e+this.value*(t-e)}static normalize(e,t,i){return e instanceof st?e:new st(t===i?0:100*Math.min(Math.max(1/(i-t)*(e-t),0),1))}}function nt(e){return new st(e)}const ot=nt(0),lt=nt(100),ct=nt(50);function ht(e){return e instanceof st}function ut(e){return Number(e)!==e}function dt(e){if(null!=e&&!bt(e)){let t=Number(e);return ut(t)&&mt(e)&&""!=e&&e.match(/[0-9]+/)?dt(e.replace(/[^0-9.\-]+/g,"")):t}return e}function ft(e){if(gt(e))return new Date(e);if(bt(e))return new Date(e);{let t=Number(e);return bt(t)?new Date(t):new Date(e)}}function pt(e,t){return new Array(t+1).join(e)}function gt(e){return"[object Date]"===function(e){return{}.toString.call(e)}(e)}function mt(e){return"string"==typeof e}function bt(e){return"number"==typeof e&&Number(e)==e}function vt(e){return"object"==typeof e&&null!==e}const yt="__§§§__",_t="__§§§§__";function wt(e,t){const i=e.length;for(let r=0;r<i;++r)if(e[r]===t)return r;return-1}function xt(e,t){const i=e.length,r=new Array(i);for(let a=0;a<i;++a)r[a]=t(e[a],a);return r}function At(e,t){const i=e.length;for(let r=0;r<i;++r)t(e[r],r)}function Tt(e,t){let i=e.length;for(;i>0;)--i,t(e[i],i)}function kt(e,t){const i=e.length;for(let r=0;r<i&&t(e[r],r);++r);}function St(e,t){let i=!1,r=0;for(;;){if(r=e.indexOf(t,r),-1===r)return i;i=!0,e.splice(r,1)}}function Pt(e,t){let i=e.indexOf(t);return-1!==i&&(e.splice(i,1),!0)}function Et(e,t,i){let r=wt(e,t);-1!==r&&Rt(e,r),null==i?e.push(t):Ot(e,i,t)}function Ct(e,t){-1===e.indexOf(t)&&e.push(t)}function Dt(e){const t=e.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=e[r];return i}function Ot(e,t,i){e.splice(t,0,i)}function Rt(e,t){e.splice(t,1)}function Mt(e,t){const i=e.length;for(let r=0;r<i;++r)if(t(e[r],r))return r;return-1}function It(e,t){const i=Mt(e,t);if(-1!==i)return e[i]}function Lt(e,t){let i=e.length;for(;i>0;)--i,t(e[i])||e.splice(i,1)}function Ft(e){return Object.keys(e)}function Nt(e){return Object.assign({},e)}function Bt(e,t){Ft(e).forEach((i=>{t(i,e[i])}))}function jt(e,t){return{}.hasOwnProperty.call(e,t)}class zt{constructor(){Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class Ut{constructor(e){Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dispose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1,this._dispose=e}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class Ht extends zt{constructor(){super(...arguments),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]})}_dispose(){At(this._disposers,(e=>{e.dispose()}))}}class Wt extends zt{constructor(e){super(),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposers=e}_dispose(){At(this._disposers,(e=>{e.dispose()}))}get disposers(){return this._disposers}}class Vt extends Ut{constructor(){super(...arguments),Object.defineProperty(this,"_counter",{enumerable:!0,configurable:!0,writable:!0,value:0})}increment(){return++this._counter,new Ut((()=>{--this._counter,0===this._counter&&this.dispose()}))}}function $t(e,t,i,r){return e.addEventListener(t,i,r||!1),new Ut((()=>{e.removeEventListener(t,i,r||!1)}))}function Xt(e){return $t(window,"resize",(t=>{e()}))}function Yt(e){switch(e){case"touchevents":return window.hasOwnProperty("TouchEvent");case"pointerevents":return window.hasOwnProperty("PointerEvent");case"mouseevents":return window.hasOwnProperty("MouseEvent");case"wheelevents":return window.hasOwnProperty("WheelEvent");case"keyboardevents":return window.hasOwnProperty("KeyboardEvent")}return!1}function Gt(e){return e.pointerId||0}function Kt(e){if(Yt("pointerevents"))return e;if(Yt("touchevents"))switch(e){case"pointerover":case"pointerdown":return"touchstart";case"pointerout":case"pointerleave":case"pointerup":return"touchend";case"pointermove":return"touchmove";case"click":return"click";case"dblclick":return"dblclick"}else if(Yt("mouseevents"))switch(e){case"pointerover":return"mouseover";case"pointerout":return"mouseout";case"pointerleave":return"mouseleave";case"pointerdown":return"mousedown";case"pointermove":return"mousemove";case"pointerup":return"mouseup";case"click":return"click";case"dblclick":return"dblclick"}return e}function qt(e){if("undefined"!=typeof Touch&&e instanceof Touch)return!0;if("undefined"!=typeof PointerEvent&&e instanceof PointerEvent&&null!=e.pointerType)switch(e.pointerType){case"touch":case"pen":case 2:return!0;case"mouse":case 4:return!1;default:return!(e instanceof MouseEvent)}else if(null!=e.type&&e.type.match(/^mouse/))return!1;return!0}function Zt(e,t,i){e.style[t]=i}function Jt(e){if(e.composedPath){const t=e.composedPath();return 0===t.length?null:t[0]}return e.target}function Qt(e,t){return e.target&&function(e,t){let i=t;for(;;){if(e===i)return!0;if(null===i.parentNode){if(null==i.host)return!1;i=i.host}else i=i.parentNode}}(t.root.dom,e.target)}function ei(e,t){e.style.pointerEvents=t?"auto":"none"}function ti(e){if(void 0!==e.key)return e.key;switch(e.keyCode){case 9:return"Tab";case 13:return"Enter";case 16:return"Shift";case 17:return"Control";case 27:return"Escape";case 32:return" ";case 37:return"ArrowLeft";case 38:return"ArrowUp";case 39:return"ArrowRight";case 40:return"ArrowDown";case 46:return"Delete"}return""+e.keyCode}function ii(e,t){return bt(e)?e:null!=e&&bt(e.value)&&bt(t)?t*e.value:0}function ri(e){let t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}function ai(e,t=0,i="0"){return"string"!=typeof e&&(e=e.toString()),t>e.length?Array(t-e.length+1).join(i)+e:e}function si(e){return function(e){return e.replace(/^[\s]*/,"")}(function(e){return e.replace(/[\s]*$/,"")}(e))}function ni(e){return e.replace(/\/(date|number|duration)$/i,"")}function oi(e){return e?e.replace(/<[^>]*>/g,""):e}function li(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function ci(e,t=!1){const i=new Date(e.getFullYear(),0,0),r=e.getTime()-i.getTime()+60*(i.getTimezoneOffset()-e.getTimezoneOffset())*1e3;return Math.floor(r/864e5)}function hi(e,t=!1){const i=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=i.getUTCDay()||7;i.setUTCDate(i.getUTCDate()+4-r);const a=new Date(Date.UTC(i.getUTCFullYear(),0,1));return Math.ceil(((i.getTime()-a.getTime())/864e5+1)/7)}function ui(e,t=!1){const i=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=i.getUTCDay()||7;return i.setUTCDate(i.getUTCDate()+4-r),new Date(Date.UTC(i.getUTCFullYear(),0,1)).getFullYear()}function di(e,t=!1){const i=hi(new Date(e.getFullYear(),e.getMonth(),1),t);let r=hi(e,t);return 1==r&&(r=53),r-i+1}function fi(e,t){return e>12?e-=12:0===e&&(e=12),null!=t?e+(t-1):e}function pi(e,t=!1,i=!1,r=!1,a){if(r)return t?"Coordinated Universal Time":"UTC";if(a){const i=e.toLocaleString("en-US",{timeZone:a});return si(e.toLocaleString("en-US",{timeZone:a,timeZoneName:t?"long":"short"}).substr(i.length))}let s=e.toLocaleString("UTC"),n=e.toLocaleString("UTC",{timeZoneName:t?"long":"short"}).substr(s.length);return!1===i&&(n=n.replace(/ (standard|daylight|summer|winter) /i," ")),si(n)}function gi(e,t){const i=t||new Date(Date.UTC(2012,0,1,0,0,0,0)),r=new Date(i.toLocaleString("en-US",{timeZone:"UTC"}));return(new Date(i.toLocaleString("en-US",{timeZone:e})).getTime()-r.getTime())/6e4*-1}function mi(e){return e.charAt(0).toUpperCase()+e.slice(1)}function bi(e){let t,i,r,a=e.h,s=e.s,n=e.l;if(0==s)t=i=r=n;else{let e=function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},o=n<.5?n*(1+s):n+s-n*s,l=2*n-o;t=e(l,o,a+1/3),i=e(l,o,a),r=e(l,o,a-1/3)}return{r:Math.round(255*t),g:Math.round(255*i),b:Math.round(255*r)}}function vi(e){let t=e.r/255,i=e.g/255,r=e.b/255,a=Math.max(t,i,r),s=Math.min(t,i,r),n=0,o=0,l=(a+s)/2;if(a===s)n=o=0;else{let e=a-s;switch(o=l>.5?e/(2-a-s):e/(a+s),a){case t:n=(i-r)/e+(i<r?6:0);break;case i:n=(r-t)/e+2;break;case r:n=(t-i)/e+4}n/=6}return{h:n,s:o,l}}function yi(e,t){let i=t>0?255-e:e;return Math.round(i*t)}function _i(e){return(299*e.r+587*e.g+114*e.b)/1e3>=128}function wi(e,t){return e||(e=[]),[...e,...t].filter(((e,t,i)=>i.indexOf(e)===t))}function xi(e,t){return!!t&&e.left==t.left&&e.right==t.right&&e.top==t.top&&e.bottom==t.bottom}function Ai(e){return"#"===e[0]&&(e=e.substr(1)),3==e.length&&(e=e[0].repeat(2)+e[1].repeat(2)+e[2].repeat(2)),parseInt(e,16)}function Ti(e){return ki.fromAny(e)}class ki{constructor(e){Object.defineProperty(this,"_hex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hex=0|e}get hex(){return this._hex}get r(){return this._hex>>>16}get g(){return this._hex>>8&255}get b(){return 255&this._hex}toCSS(e=1){return"rgba("+this.r+", "+this.g+", "+this.b+", "+e+")"}toCSSHex(){return"#"+ai(this.r.toString(16),2)+ai(this.g.toString(16),2)+ai(this.b.toString(16),2)}toHSL(e=1){return vi({r:this.r,g:this.g,b:this.b,a:e})}static fromHSL(e,t,i){const r=bi({h:e,s:t,l:i});return this.fromRGB(r.r,r.g,r.b)}toString(){return this.toCSSHex()}static fromHex(e){return new ki(e)}static fromRGB(e,t,i){return new ki((0|i)+(t<<8)+(e<<16))}static fromString(e){return new ki(Ai(e))}static fromCSS(e){return new ki(function(e){let t=(e=e.replace(/[ ]/g,"")).match(/^rgb\(([0-9]*),([0-9]*),([0-9]*)\)/i);if(t)t.push("1");else if(t=e.match(/^rgba\(([0-9]*),([0-9]*),([0-9]*),([.0-9]*)\)/i),!t)return 0;let i="";for(let e=1;e<=3;e++){let r=parseInt(t[e]).toString(16);1==r.length&&(r="0"+r),i+=r}return Ai(i)}(e))}static fromAny(e){if(mt(e)){if("#"==e[0])return ki.fromString(e);if("rgb"==e.substr(0,3))return ki.fromCSS(e)}else{if(bt(e))return ki.fromHex(e);if(e instanceof ki)return ki.fromHex(e.hex)}throw new Error("Unknown color syntax: "+e)}static alternative(e,t,i){const r=function(e,t={r:255,g:255,b:255},i={r:255,g:255,b:255}){let r=t,a=i;return _i(i)&&(r=i,a=t),_i(e)?a:r}({r:e.r,g:e.g,b:e.b},t?{r:t.r,g:t.g,b:t.b}:void 0,i?{r:i.r,g:i.g,b:i.b}:void 0);return this.fromRGB(r.r,r.g,r.b)}static interpolate(e,t,i,r="rgb"){if("hsl"==r){const r=t.toHSL(),a=i.toHSL();return ki.fromHSL(Pi(e,r.h,a.h),Pi(e,r.s,a.s),Pi(e,r.l,a.l))}return ki.fromRGB(Pi(e,t.r,i.r),Pi(e,t.g,i.g),Pi(e,t.b,i.b))}static lighten(e,t){const i=function(e,t){return e?{r:Math.max(0,Math.min(255,e.r+yi(e.r,t))),g:Math.max(0,Math.min(255,e.g+yi(e.g,t))),b:Math.max(0,Math.min(255,e.b+yi(e.b,t))),a:e.a}:e}({r:e.r,g:e.g,b:e.b},t);return ki.fromRGB(i.r,i.g,i.b)}static brighten(e,t){const i=function(e,t){if(e){let i=yi(Math.min(Math.max(e.r,e.g,e.b),230),t);return{r:Math.max(0,Math.min(255,Math.round(e.r+i))),g:Math.max(0,Math.min(255,Math.round(e.g+i))),b:Math.max(0,Math.min(255,Math.round(e.b+i))),a:e.a}}return e}({r:e.r,g:e.g,b:e.b},t);return ki.fromRGB(i.r,i.g,i.b)}static saturate(e,t){const i=function(e,t){if(void 0===e||1==t)return e;let i=vi(e);return i.s=t,bi(i)}({r:e.r,g:e.g,b:e.b},t);return ki.fromRGB(i.r,i.g,i.b)}}function Si(e){return at(this,void 0,void 0,(function*(){if(void 0!==e){const t=[];Bt(e,((e,i)=>{t.push(i.waitForStop())})),yield Promise.all(t)}}))}function Pi(e,t,i){return t+e*(i-t)}function Ei(e,t,i){return e>=1?i:t}function Ci(e,t,i){return new st(Pi(e,t.percent,i.percent))}function Di(e,t,i){return ki.interpolate(e,t,i)}var Oi;!function(e){e[e.Stopped=0]="Stopped",e[e.Playing=1]="Playing",e[e.Paused=2]="Paused"}(Oi||(Oi={}));class Ri{constructor(){Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_killed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_iterating",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_enabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._listeners=[],this._killed=[],this._disabled={},this._iterating=0,this._enabled=!0,this._disposed=!1}isDisposed(){return this._disposed}dispose(){if(!this._disposed){this._disposed=!0;const e=this._listeners;this._iterating=1,this._listeners=null,this._disabled=null;try{At(e,(e=>{e.disposer.dispose()}))}finally{this._killed=null,this._iterating=null}}}hasListeners(){return 0!==this._listeners.length}hasListenersByType(e){return function(t){const i=t.length;for(let a=0;a<i;++a)if((null===(r=t[a]).type||r.type===e)&&!r.killed)return!0;var r;return!1}(this._listeners)}enable(){this._enabled=!0}disable(){this._enabled=!1}enableType(e){delete this._disabled[e]}disableType(e,t=1/0){this._disabled[e]=t}_removeListener(e){if(0===this._iterating){const t=this._listeners.indexOf(e);if(-1===t)throw new Error("Invalid state: could not remove listener");this._listeners.splice(t,1)}else this._killed.push(e)}_removeExistingListener(e,t,i,r){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener((a=>{a.once!==e||a.type!==t||void 0!==i&&a.callback!==i||a.context!==r||a.disposer.dispose()}))}isEnabled(e){if(this._disposed)throw new Error("EventDispatcher is disposed");return this._enabled&&this._listeners.length>0&&this.hasListenersByType(e)&&void 0===this._disabled[e]}removeType(e){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener((t=>{t.type===e&&t.disposer.dispose()}))}has(e,t,i){return-1!==Mt(this._listeners,(r=>!0!==r.once&&r.type===e&&(void 0===t||r.callback===t)&&r.context===i))}_shouldDispatch(e){if(this._disposed)throw new Error("EventDispatcher is disposed");const t=this._disabled[e];return bt(t)?(t<=1?delete this._disabled[e]:--this._disabled[e],!1):this._enabled}_eachListener(e){++this._iterating;try{At(this._listeners,e)}finally{--this._iterating,0===this._iterating&&0!==this._killed.length&&(At(this._killed,(e=>{this._removeListener(e)})),this._killed.length=0)}}dispatch(e,t){this._shouldDispatch(e)&&this._eachListener((i=>{i.killed||null!==i.type&&i.type!==e||i.dispatch(e,t)}))}_on(e,t,i,r,a,s){if(this._disposed)throw new Error("EventDispatcher is disposed");this._removeExistingListener(e,t,i,r);const n={type:t,callback:i,context:r,shouldClone:a,dispatch:s,killed:!1,once:e,disposer:new Ut((()=>{n.killed=!0,this._removeListener(n)}))};return this._listeners.push(n),n}onAll(e,t,i=!0){return this._on(!1,null,e,t,i,((i,r)=>e.call(t,r))).disposer}on(e,t,i,r=!0){return this._on(!1,e,t,i,r,((e,r)=>t.call(i,r))).disposer}once(e,t,i,r=!0){const a=this._on(!0,e,t,i,r,((e,r)=>{a.disposer.dispose(),t.call(i,r)}));return a.disposer}off(e,t,i){this._removeExistingListener(!1,e,t,i)}copyFrom(e){if(this._disposed)throw new Error("EventDispatcher is disposed");if(e===this)throw new Error("Cannot copyFrom the same TargetedEventDispatcher");const t=[];return At(e._listeners,(e=>{!e.killed&&e.shouldClone&&(null===e.type?t.push(this.onAll(e.callback,e.context)):e.once?t.push(this.once(e.type,e.callback,e.context)):t.push(this.on(e.type,e.callback,e.context)))})),new Wt(t)}}function Mi(e,t){if(!(e>=0&&e<t))throw new Error("Index out of bounds: "+e)}class Ii{constructor(e=[]){Object.defineProperty(this,"_values",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Ri}),this._values=e}get values(){return this._values}contains(e){return-1!==this._values.indexOf(e)}removeValue(e){let t=0,i=this._values.length;for(;t<i;)this._values[t]===e?(this.removeIndex(t),--i):++t}indexOf(e){return wt(this._values,e)}get length(){return this._values.length}hasIndex(e){return e>=0&&e<this._values.length}getIndex(e){return this._values[e]}_onPush(e){this.events.isEnabled("push")&&this.events.dispatch("push",{type:"push",target:this,newValue:e})}_onInsertIndex(e,t){this.events.isEnabled("insertIndex")&&this.events.dispatch("insertIndex",{type:"insertIndex",target:this,index:e,newValue:t})}_onSetIndex(e,t,i){this.events.isEnabled("setIndex")&&this.events.dispatch("setIndex",{type:"setIndex",target:this,index:e,oldValue:t,newValue:i})}_onSwap(e,t){this.events.isEnabled("swap")&&this.events.dispatch("swap",{type:"swap",target:this,a:e,b:t})}_onRemoveIndex(e,t){this.events.isEnabled("removeIndex")&&this.events.dispatch("removeIndex",{type:"removeIndex",target:this,index:e,oldValue:t})}_onMoveIndex(e,t,i){this.events.isEnabled("moveIndex")&&this.events.dispatch("moveIndex",{type:"moveIndex",target:this,oldIndex:e,newIndex:t,value:i})}_onClear(e){this.events.isEnabled("clear")&&this.events.dispatch("clear",{type:"clear",target:this,oldValues:e})}setIndex(e,t){Mi(e,this._values.length);const i=this._values[e];return i!==t&&(this._values[e]=t,this._onSetIndex(e,i,t)),i}insertIndex(e,t){return Mi(e,this._values.length+1),Ot(this._values,e,t),this._onInsertIndex(e,t),t}swap(e,t){const i=this._values.length;if(Mi(e,i),Mi(t,i),e!==t){const i=this._values[e],r=this._values[t];this._values[e]=r,this._values[t]=i,this._onSwap(i,r)}}removeIndex(e){Mi(e,this._values.length);const t=this._values[e];return Rt(this._values,e),this._onRemoveIndex(e,t),t}moveValue(e,t){let i=this.indexOf(e);if(-1!==i)if(Rt(this._values,i),null==t){const t=this._values.length;this._values.push(e),this._onMoveIndex(i,t,e)}else Ot(this._values,t,e),this._onMoveIndex(i,t,e);else null==t?(this._values.push(e),this._onPush(e)):(Ot(this._values,t,e),this._onInsertIndex(t,e));return e}push(e){return this._values.push(e),this._onPush(e),e}unshift(e){return this.insertIndex(0,e),e}pushAll(e){At(e,(e=>{this.push(e)}))}copyFrom(e){this.pushAll(e._values)}pop(){return this._values.length-1<0?void 0:this.removeIndex(this._values.length-1)}shift(){return this._values.length?this.removeIndex(0):void 0}setAll(e){const t=this._values;this._values=[],this._onClear(t),At(e,(e=>{this._values.push(e),this._onPush(e)}))}clear(){this.setAll([])}*[Symbol.iterator](){const e=this._values.length;for(let t=0;t<e;++t)yield this._values[t]}each(e){At(this._values,e)}eachReverse(e){Tt(this._values,e)}}class Li extends Ii{constructor(){super(...arguments),Object.defineProperty(this,"autoDispose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1})}swap(e,t){const i=this.autoDispose;this.autoDispose=!1,super.swap(e,t),this.autoDispose=i}_onSetIndex(e,t,i){this.autoDispose&&t.dispose(),super._onSetIndex(e,t,i)}_onRemoveIndex(e,t){this.autoDispose&&t.dispose(),super._onRemoveIndex(e,t)}_onClear(e){this.autoDispose&&At(e,(e=>{e.dispose()})),super._onClear(e)}_dispose(){this.autoDispose&&At(this._values,(e=>{e.dispose()}))}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class Fi extends Li{constructor(e,t){super(),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"make",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e,this.make=t}_dispose(){super._dispose(),this.autoDispose&&this.template.dispose()}}class Ni extends Ii{constructor(e){super(),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._container=e,this._events=this.events.onAll((e=>{if("clear"===e.type)At(e.oldValues,(e=>{this._onRemoved(e)}));else if("push"===e.type)this._onInserted(e.newValue);else if("setIndex"===e.type)this._onRemoved(e.oldValue),this._onInserted(e.newValue,e.index);else if("insertIndex"===e.type)this._onInserted(e.newValue,e.index);else if("removeIndex"===e.type)this._onRemoved(e.oldValue);else{if("moveIndex"!==e.type)throw new Error("Unknown IListEvent type");this._onRemoved(e.value),this._onInserted(e.value,e.newIndex)}}))}_onInserted(e,t){e._setParent(this._container,!0);const i=this._container._childrenDisplay;void 0===t?i.addChild(e._display):i.addChildAt(e._display,t)}_onRemoved(e){this._container._childrenDisplay.removeChild(e._display),this._container.markDirtyBounds(),this._container.markDirty()}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._events.dispose(),At(this.values,(e=>{e.dispose()})))}}function Bi(e){return e}function ji(e){return e*e*e}function zi(e){return function(t){return 1-e(1-t)}}Math.PI;Math.asin(1);class Ui{constructor(e,t){Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_userSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=e,this._settings=t,Bt(t,(e=>{this._userSettings[e]=!0}))}get(e,t){const i=this._settings[e];return void 0!==i?i:t}setRaw(e,t){this._settings[e]=t}set(e,t){this._userSettings[e]=!0,this.setRaw(e,t)}remove(e){delete this._userSettings[e],delete this._settings[e]}setAll(e){Ft(e).forEach((t=>{this.set(t,e[t])}))}_eachSetting(e){Bt(this._settings,e)}apply(){const e={stateAnimationEasing:!0,stateAnimationDuration:!0},t=this._entity.states.lookup("default");this._eachSetting(((i,r)=>{e[i]||(e[i]=!0,this!==t&&(i in t._settings||(t._settings[i]=this._entity.get(i))),this._entity.set(i,r))}))}applyAnimate(e){null==e&&(e=this._settings.stateAnimationDuration),null==e&&(e=this.get("stateAnimationDuration",this._entity.get("stateAnimationDuration",0)));let t=this._settings.stateAnimationEasing;null==t&&(t=this.get("stateAnimationEasing",this._entity.get("stateAnimationEasing",ji)));const i=this._entity.states.lookup("default"),r={stateAnimationEasing:!0,stateAnimationDuration:!0},a={};return this._eachSetting(((s,n)=>{if(!r[s]){r[s]=!0,this!=i&&(s in i._settings||(i._settings[s]=this._entity.get(s)));const o=this._entity.animate({key:s,to:n,duration:e,easing:t});o&&(a[s]=o)}})),a}}class Hi{constructor(e){Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._entity=e}lookup(e){return this._states[e]}create(e,t){const i=this._states[e];if(i)return i.setAll(t),i;{const i=new Ui(this._entity,t);return this._states[e]=i,i}}remove(e){delete this._states[e]}apply(e){const t=this._states[e];t&&t.apply(),this._entity._applyState(e)}applyAnimate(e,t){let i;const r=this._states[e];return r&&(i=r.applyAnimate(t)),this._entity._applyStateAnimated(e,t),i}}const Wi=new class{constructor(){Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.12.1"}),Object.defineProperty(this,"licenses",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"entitiesById",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"rootElements",{enumerable:!0,configurable:!0,writable:!0,value:[]})}};function Vi(e,t){return e===t?0:e<t?-1:1}function $i(e,t,i){const r=e.length,a=t.length,s=Math.min(r,a);for(let r=0;r<s;++r){const a=i(e[r],t[r]);if(0!==a)return a}return Vi(r,a)}function Xi(e,t){return e===t?0:e<t?-1:1}class Yi{constructor(e){Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=e}add(e,t){let i=this._callbacks[e];return void 0===i&&(i=this._callbacks[e]=[]),i.push(t),this._entity._markDirtyKey(e),new Ut((()=>{Pt(i,t)&&this._entity._markDirtyKey(e)}))}remove(e){const t=this._callbacks[e];void 0!==t&&(delete this._callbacks[e],0!==t.length&&this._entity._markDirtyKey(e))}enable(e){this._disabled[e]&&(delete this._disabled[e],this._entity._markDirtyKey(e))}disable(e){this._disabled[e]||(this._disabled[e]=!0,this._entity._markDirtyKey(e))}fold(e,t){if(!this._disabled[e]){const i=this._callbacks[e];if(void 0!==i)for(let r=0,a=i.length;r<a;++r)t=i[r](t,this._entity,e)}return t}}class Gi{constructor(e,t,i,r,a,s,n){Object.defineProperty(this,"_animation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_from",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_to",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_duration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_easing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_loops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_interpolate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_oldTime",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_time",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_stopped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_playing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Ri}),this._animation=e,this._from=t,this._to=i,this._duration=r,this._easing=a,this._loops=s,this._interpolate=function(e,t){return"number"==typeof e&&"number"==typeof t?Pi:e instanceof st&&t instanceof st?Ci:e instanceof ki&&t instanceof ki?Di:Ei}(t,i),this._oldTime=n}get to(){return this._to}get from(){return this._from}get playing(){return this._playing}get stopped(){return this._stopped}stop(){this._stopped||(this._stopped=!0,this._playing=!1,this.events.isEnabled("stopped")&&this.events.dispatch("stopped",{type:"stopped",target:this}))}pause(){this._playing=!1,this._oldTime=null}play(){this._stopped||this._playing||(this._playing=!0,this._animation._startAnimation())}get percentage(){return this._time/this._duration}waitForStop(){return new Promise(((e,t)=>{if(this._stopped)e();else{const t=()=>{i.dispose(),e()},i=this.events.on("stopped",t)}}))}_checkEnded(){return!(this._loops>1&&(--this._loops,1))}_run(e){null!==this._oldTime&&(this._time+=e-this._oldTime,this._time>this._duration&&(this._time=this._duration)),this._oldTime=e}_reset(e){this._oldTime=e,this._time=0}_value(e){return this._interpolate(this._easing(e),this._from,this._to)}}let Ki=0;class qi{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:++Ki}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_userProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"enableDispose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this._settings=e}_checkDirty(){Ft(this._settings).forEach((e=>{this._userProperties[e]=!0,this._markDirtyKey(e)}))}resetUserSettings(){this._userProperties={}}_runAnimation(e){let t=Oi.Stopped;if(!this.isDisposed()){let i=!1,r=!1;Bt(this._animatingSettings,((t,a)=>{if(a.stopped)this._stopAnimation(t);else if(a.playing){a._run(e);const r=a.percentage;r>=1?a._checkEnded()?this.set(t,a._value(1)):(i=!0,a._reset(e),this._set(t,a._value(1))):(i=!0,this._set(t,a._value(r)))}else r=!0})),Bt(this._animatingPrivateSettings,((t,a)=>{if(a.stopped)this._stopAnimationPrivate(t);else if(a.playing){a._run(e);const r=a.percentage;r>=1?a._checkEnded()?this.setPrivate(t,a._value(1)):(i=!0,a._reset(e),this._setPrivate(t,a._value(1))):(i=!0,this._setPrivate(t,a._value(r)))}else r=!0})),i?t=Oi.Playing:r&&(t=Oi.Paused)}return t}_markDirtyKey(e){this.markDirty()}_markDirtyPrivateKey(e){this.markDirty()}on(e,t){let i=this._settingEvents[e];return void 0===i&&(i=this._settingEvents[e]=[]),i.push(t),new Ut((()=>{Pt(i,t),0===i.length&&delete this._settingEvents[e]}))}off(e,t){let i=this._settingEvents[e];void 0!==i&&void 0!==t?Pt(i,t):delete this._settingEvents[e]}onPrivate(e,t){let i=this._privateSettingEvents[e];return void 0===i&&(i=this._privateSettingEvents[e]=[]),i.push(t),new Ut((()=>{Pt(i,t),0===i.length&&delete this._privateSettingEvents[e]}))}offPrivate(e,t){let i=this._privateSettingEvents[e];void 0!==i&&void 0!==t?Pt(i,t):delete this._privateSettingEvents[e]}getRaw(e,t){const i=this._settings[e];return void 0!==i?i:t}has(e){return e in this._settings}get(e,t){return this.getRaw(e,t)}_sendKeyEvent(e,t){const i=this._settingEvents[e];void 0!==i&&At(i,(i=>{i(t,this,e)}))}_sendPrivateKeyEvent(e,t){const i=this._privateSettingEvents[e];void 0!==i&&At(i,(i=>{i(t,this,e)}))}_setRaw(e,t,i){this._prevSettings[e]=t,this._sendKeyEvent(e,i)}setRaw(e,t){const i=this._settings[e];this._settings[e]=t,i!==t&&this._setRaw(e,i,t)}_set(e,t){const i=this._settings[e];this._settings[e]=t,i!==t&&(this._setRaw(e,i,t),this._markDirtyKey(e))}_stopAnimation(e){const t=this._animatingSettings[e];t&&(delete this._animatingSettings[e],t.stop())}set(e,t){return this._set(e,t),this._stopAnimation(e),t}remove(e){e in this._settings&&(this._prevSettings[e]=this._settings[e],delete this._settings[e],this._sendKeyEvent(e,void 0),this._markDirtyKey(e)),this._stopAnimation(e)}removeAll(){At(Ft(this._settings),(e=>{this.remove(e)}))}getPrivate(e,t){const i=this._privateSettings[e];return void 0!==i?i:t}_setPrivateRaw(e,t,i){this._prevPrivateSettings[e]=t,this._sendPrivateKeyEvent(e,i)}setPrivateRaw(e,t){const i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&this._setPrivateRaw(e,i,t)}_setPrivate(e,t){const i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&(this._setPrivateRaw(e,i,t),this._markDirtyPrivateKey(e))}_stopAnimationPrivate(e){const t=this._animatingPrivateSettings[e];t&&(t.stop(),delete this._animatingPrivateSettings[e])}setPrivate(e,t){return this._setPrivate(e,t),this._stopAnimationPrivate(e),t}removePrivate(e){e in this._privateSettings&&(this._prevPrivateSettings[e]=this._privateSettings[e],delete this._privateSettings[e],this._markDirtyPrivateKey(e)),this._stopAnimationPrivate(e)}setAll(e){Bt(e,((e,t)=>{this.set(e,t)}))}animate(e){const t=e.key,i=e.to,r=e.duration||0,a=e.loops||1,s=void 0===e.from?this.get(t):e.from,n=void 0===e.easing?Bi:e.easing;if(0===r)this.set(t,i);else{if(void 0!==s&&s!==i){this.set(t,s);const e=this._animatingSettings[t]=new Gi(this,s,i,r,n,a,this._animationTime());return this._startAnimation(),e}this.set(t,i)}const o=new Gi(this,s,i,r,n,a,null);return o.stop(),o}animatePrivate(e){const t=e.key,i=e.to,r=e.duration||0,a=e.loops||1,s=void 0===e.from?this.getPrivate(t):e.from,n=void 0===e.easing?Bi:e.easing;if(0===r)this.setPrivate(t,i);else{if(void 0!==s&&s!==i){this.setPrivate(t,s);const e=this._animatingPrivateSettings[t]=new Gi(this,s,i,r,n,a,this._animationTime());return this._startAnimation(),e}this.setPrivate(t,i)}const o=new Gi(this,s,i,r,n,a,null);return o.stop(),o}_dispose(){}isDisposed(){return this._disposed}dispose(){this.enableDispose&&!this._disposed&&(this._disposed=!0,this._dispose())}}class Zi extends qi{constructor(e,t,i,r=[]){if(super(t),Object.defineProperty(this,"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_user_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"states",{enumerable:!0,configurable:!0,writable:!0,value:new Hi(this)}),Object.defineProperty(this,"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new Yi(this)}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:this._createEvents()}),Object.defineProperty(this,"_userPrivateProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyPrivate",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_templates",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_internalTemplates",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_defaultThemes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_templateDisposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_runSetup",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_disposerProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._root=e,this._internalTemplates=r,t.id&&this._registerId(t.id)}static new(e,t,i){const r=new this(e,t,!0);return r._template=i,r._afterNew(),r}static _new(e,t,i=[]){const r=new this(e,t,!0,i);return r._afterNew(),r}_afterNew(){this._checkDirty();let e=!1;const t=this._template;t&&(e=!0,t._setObjectTemplate(this)),At(this._internalTemplates,(t=>{e=!0,t._setObjectTemplate(this)})),e&&this._applyTemplates(!1),this.states.create("default",{}),this._setDefaults()}_afterNewApplyThemes(){this._checkDirty();const e=this._template;e&&e._setObjectTemplate(this),At(this._internalTemplates,(e=>{e._setObjectTemplate(this)})),this.states.create("default",{}),this._setDefaults(),this._applyThemes()}_createEvents(){return new Ri}get classNames(){return this.constructor.classNames}get className(){return this.constructor.className}_setDefaults(){}_setDefaultFn(e,t){const i=this.get(e);if(i)return i;{const i=t();return this.set(e,i),i}}_setDefault(e,t){this.has(e)||super.set(e,t)}_setRawDefault(e,t){this.has(e)||super.setRaw(e,t)}_clearDirty(){Ft(this._dirty).forEach((e=>{this._dirty[e]=!1})),Ft(this._dirtyPrivate).forEach((e=>{this._dirtyPrivate[e]=!1}))}isDirty(e){return!!this._dirty[e]}isPrivateDirty(e){return!!this._dirtyPrivate[e]}_markDirtyKey(e){this._dirty[e]=!0,super._markDirtyKey(e)}_markDirtyPrivateKey(e){this._dirtyPrivate[e]=!0,super._markDirtyKey(e)}isType(e){return-1!==this.classNames.indexOf(e)}_pushPropertyDisposer(e,t){let i=this._disposerProperties[e];return void 0===i&&(i=this._disposerProperties[e]=[]),i.push(t),t}_disposeProperty(e){const t=this._disposerProperties[e];void 0!==t&&(At(t,(e=>{e.dispose()})),delete this._disposerProperties[e])}set template(e){const t=this._template;t!==e&&(this._template=e,t&&t._removeObjectTemplate(this),e&&e._setObjectTemplate(this),this._applyTemplates())}get template(){return this._template}markDirty(){this._root._addDirtyEntity(this)}_startAnimation(){this._root._addAnimation(this)}_animationTime(){return this._root.animationTime}_applyState(e){}_applyStateAnimated(e,t){}get(e,t){const i=this.adapters.fold(e,this._settings[e]);return void 0!==i?i:t}isUserSetting(e){return this._userProperties[e]||!1}set(e,t){return this._userProperties[e]=!0,super.set(e,t)}setRaw(e,t){this._userProperties[e]=!0,super.setRaw(e,t)}_setSoft(e,t){return this._userProperties[e]?t:super.set(e,t)}remove(e){delete this._userProperties[e],this._removeTemplateProperty(e)}setPrivate(e,t){return this._userPrivateProperties[e]=!0,super.setPrivate(e,t)}setPrivateRaw(e,t){this._userPrivateProperties[e]=!0,super.setPrivateRaw(e,t)}removePrivate(e){delete this._userPrivateProperties[e],this._removeTemplatePrivateProperty(e)}_setTemplateProperty(e,t,i){this._userProperties[t]||e===this._findTemplateByKey(t)&&super.set(t,i)}_setTemplatePrivateProperty(e,t,i){this._userPrivateProperties[t]||e===this._findTemplateByPrivateKey(t)&&super.setPrivate(t,i)}_removeTemplateProperty(e){if(!this._userProperties[e]){const t=this._findTemplateByKey(e);t?super.set(e,t._settings[e]):super.remove(e)}}_removeTemplatePrivateProperty(e){if(!this._userPrivateProperties[e]){const t=this._findTemplateByPrivateKey(e);t?super.setPrivate(e,t._privateSettings[e]):super.removePrivate(e)}}_walkParents(e){e(this._root._rootContainer),e(this)}_applyStateByKey(e){const t=this.states.create(e,{}),i={};this._eachTemplate((r=>{const a=r.states.lookup(e);a&&a._apply(t,i)})),Bt(t._settings,(e=>{i[e]||t._userSettings[e]||t.remove(e)}))}_applyTemplate(e,t){this._templateDisposers.push(e._apply(this,t)),Bt(e._settings,((e,i)=>{t.settings[e]||this._userProperties[e]||(t.settings[e]=!0,super.set(e,i))})),Bt(e._privateSettings,((e,i)=>{t.privateSettings[e]||this._userPrivateProperties[e]||(t.privateSettings[e]=!0,super.setPrivate(e,i))})),this._runSetup&&e.setup&&(this._runSetup=!1,e.setup(this))}_findStaticTemplate(e){if(this._template&&e(this._template))return this._template}_eachTemplate(e){this._findStaticTemplate((t=>(e(t),!1))),Tt(this._internalTemplates,e),At(this._templates,e)}_applyTemplates(e=!0){e&&this._disposeTemplates();const t={settings:{},privateSettings:{},states:{}};this._eachTemplate((e=>{this._applyTemplate(e,t)})),e&&(Bt(this._settings,(e=>{this._userProperties[e]||t.settings[e]||super.remove(e)})),Bt(this._privateSettings,(e=>{this._userPrivateProperties[e]||t.privateSettings[e]||super.removePrivate(e)})))}_findTemplate(e){const t=this._findStaticTemplate(e);if(void 0===t){const t=function(e,t){const i=function(e,t){let i=e.length;for(;i>0;)if(--i,t(e[i],i))return i;return-1}(e,t);if(-1!==i)return e[i]}(this._internalTemplates,e);return void 0===t?It(this._templates,e):t}return t}_findTemplateByKey(e){return this._findTemplate((t=>e in t._settings))}_findTemplateByPrivateKey(e){return this._findTemplate((t=>e in t._privateSettings))}_disposeTemplates(){At(this._templateDisposers,(e=>{e.dispose()})),this._templateDisposers.length=0}_removeTemplates(){At(this._templates,(e=>{e._removeObjectTemplate(this)})),this._templates.length=0}_applyThemes(e=!1){let t=!1;const i=[];let r=[];const a=new Set,s=this.get("themeTagsSelf");return s&&At(s,(e=>{a.add(e)})),this._walkParents((e=>{e===this._root._rootContainer&&(t=!0),e._defaultThemes.length>0&&i.push(e._defaultThemes);const s=e.get("themes");s&&r.push(s);const n=e.get("themeTags");n&&At(n,(e=>{a.add(e)}))})),r=i.concat(r),this._removeTemplates(),(t||e)&&Tt(this.classNames,(e=>{const t=[];At(r,(i=>{At(i,(i=>{const r=i._lookupRules(e);r&&Tt(r,(e=>{if(e.tags.every((e=>a.has(e)))){const i=function(e,t){let i=0,r=e.length,a=!1;for(;i<r;){const s=i+r>>1,n=t(e[s]);n<0?i=s+1:0===n?(a=!0,r=s):r=s}return{found:a,index:i}}(t,(t=>{const i=Vi(e.tags.length,t.tags.length);return 0===i?$i(e.tags,t.tags,Vi):i}));t.splice(i.index,0,e)}}))}))})),At(t,(e=>{this._templates.push(e.template),e.template._setObjectTemplate(this)}))})),this._applyTemplates(),(t||e)&&(this._runSetup=!1),t||e}_changed(){}_beforeChanged(){if(this.isDirty("id")){const e=this.get("id");e&&this._registerId(e);const t=this._prevSettings.id;t&&(delete this._root.entitiesById[t],delete Wi.entitiesById[t])}}_registerId(e){if(this._root.entitiesById[e]&&this._root.entitiesById[e]!==this)throw new Error('An entity with id "'+e+'" already exists.');this._root.entitiesById[e]=this,Wi.entitiesById[e]=this}_afterChanged(){}addDisposer(e){return this._disposers.push(e),e}_dispose(){super._dispose();const e=this._template;e&&e._removeObjectTemplate(this),At(this._internalTemplates,(e=>{e._removeObjectTemplate(this)})),this._removeTemplates(),this._disposeTemplates(),this.events.dispose(),this._disposers.forEach((e=>{e.dispose()})),Bt(this._disposerProperties,((e,t)=>{At(t,(e=>{e.dispose()}))}));const t=this.get("id");t&&(delete this._root.entitiesById[t],delete Wi.entitiesById[t])}setTimeout(e,t){const i=setTimeout((()=>{this.removeDispose(r),e()}),t),r=new Ut((()=>{clearTimeout(i)}));return this._disposers.push(r),r}removeDispose(e){if(!this.isDisposed()){let t=wt(this._disposers,e);t>-1&&this._disposers.splice(t,1)}e.dispose()}hasTag(e){return-1!==wt(this.get("themeTags",[]),e)}addTag(e){if(!this.hasTag(e)){const t=this.get("themeTags",[]);t.push(e),this.set("themeTags",t)}}removeTag(e){if(this.hasTag(e)){const t=this.get("themeTags",[]);St(t,e),this.set("themeTags",t)}}_t(e,t,...i){return this._root.language.translate(e,t,...i)}get root(){return this._root}}function Ji(e){Bt(e,((e,t)=>{vt(t)&&"function"==typeof t.dispose&&(t.enableDispose=!0,t.dispose())}))}Object.defineProperty(Zi,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Entity"}),Object.defineProperty(Zi,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:["Entity"]});class Qi{constructor(e,t,i){Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._name=e,this._template=t,this._settings=i}_dispose(){Ji(this._settings)}get(e,t){const i=this._settings[e];return void 0!==i?i:t}set(e,t){this._settings[e]=t,this._template._stateChanged(this._name)}remove(e){delete this._settings[e],this._template._stateChanged(this._name)}setAll(e){Ft(e).forEach((t=>{this._settings[t]=e[t]})),this._template._stateChanged(this._name)}_apply(e,t){Bt(this._settings,((i,r)=>{t[i]||e._userSettings[i]||(t[i]=!0,e.setRaw(i,r))}))}}class er{constructor(e){Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._template=e}_dispose(){Bt(this._states,((e,t)=>{t._dispose()}))}lookup(e){return this._states[e]}create(e,t){const i=this._states[e];if(i)return i.setAll(t),i;{const i=new Qi(e,this._template,t);return this._states[e]=i,this._template._stateChanged(e),i}}remove(e){delete this._states[e],this._template._stateChanged(e)}_apply(e,t){Bt(this._states,((i,r)=>{let a=t.states[i];null==a&&(a=t.states[i]={});const s=e.states.create(i,{});r._apply(s,a)}))}}class tr{constructor(){Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}})}add(e,t){let i=this._callbacks[e];return void 0===i&&(i=this._callbacks[e]=[]),i.push(t),new Ut((()=>{Pt(i,t),0===i.length&&delete this._callbacks[e]}))}remove(e){void 0!==this._callbacks[e]&&delete this._callbacks[e]}_apply(e){const t=[];return Bt(this._callbacks,((i,r)=>{At(r,(r=>{t.push(e.adapters.add(i,r))}))})),new Wt(t)}}class ir{constructor(e,t){if(Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entities",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"states",{enumerable:!0,configurable:!0,writable:!0,value:new er(this)}),Object.defineProperty(this,"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new tr}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Ri}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._settings=e}static new(e){return new ir(e,!0)}_dispose(){Ji(this._settings),Ji(this._privateSettings)}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}_checkDisposed(){if(this._disposed)throw new Error("Template is disposed")}get entities(){return this._entities}get(e,t){this._checkDisposed();const i=this._settings[e];return void 0!==i?i:t}setRaw(e,t){this._checkDisposed(),this._settings[e]=t}set(e,t){this._checkDisposed(),this._settings[e]!==t&&(this.setRaw(e,t),this._entities.forEach((i=>{i._setTemplateProperty(this,e,t)})))}remove(e){this._checkDisposed(),e in this._settings&&(delete this._settings[e],this._entities.forEach((t=>{t._removeTemplateProperty(e)})))}removeAll(){this._checkDisposed(),Bt(this._settings,((e,t)=>{this.remove(e)}))}getPrivate(e,t){this._checkDisposed();const i=this._privateSettings[e];return void 0!==i?i:t}setPrivateRaw(e,t){return this._checkDisposed(),this._privateSettings[e]=t,t}setPrivate(e,t){return this._checkDisposed(),this._privateSettings[e]!==t&&(this.setPrivateRaw(e,t),this._entities.forEach((i=>{i._setTemplatePrivateProperty(this,e,t)}))),t}removePrivate(e){this._checkDisposed(),e in this._privateSettings&&(delete this._privateSettings[e],this._entities.forEach((t=>{t._removeTemplatePrivateProperty(e)})))}setAll(e){this._checkDisposed(),Bt(e,((e,t)=>{this.set(e,t)}))}on(e,t){this._checkDisposed();let i=this._settingEvents[e];return void 0===i&&(i=this._settingEvents[e]=[]),i.push(t),new Ut((()=>{Pt(i,t),0===i.length&&delete this._settingEvents[e]}))}onPrivate(e,t){this._checkDisposed();let i=this._privateSettingEvents[e];return void 0===i&&(i=this._privateSettingEvents[e]=[]),i.push(t),new Ut((()=>{Pt(i,t),0===i.length&&delete this._privateSettingEvents[e]}))}_apply(e,t){this._checkDisposed();const i=[];return Bt(this._settingEvents,((t,r)=>{At(r,(r=>{i.push(e.on(t,r))}))})),Bt(this._privateSettingEvents,((t,r)=>{At(r,(r=>{i.push(e.onPrivate(t,r))}))})),this.states._apply(e,t),i.push(this.adapters._apply(e)),i.push(e.events.copyFrom(this.events)),new Wt(i)}_setObjectTemplate(e){this._checkDisposed(),this._entities.push(e)}_removeObjectTemplate(e){St(this._entities,e)}_stateChanged(e){this._checkDisposed(),this._entities.forEach((t=>{t._applyStateByKey(e)}))}}const rr=Math.PI,ar=rr/180,sr=180/rr;function nr(e,t,i){if(!bt(t)||t<=0){let t=Math.round(e);return i&&t-e==.5&&t--,t}{let i=Math.pow(10,t);return Math.round(e*i)/i}}function or(e,t,i){return Math.min(Math.max(e,t),i)}function lr(e){return Math.sin(ar*e)}function cr(e){return Math.cos(ar*e)}function hr(e,t){return{x:e*cr(t),y:e*lr(t)}}class ur extends Ri{constructor(e){super(),Object.defineProperty(this,"_sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rendererDisposers",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dispatchParents",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this._sprite=e}_makePointerEvent(e,t){return{type:e,originalEvent:t.event,point:t.point,simulated:t.simulated,native:t.native,target:this._sprite}}_onRenderer(e,t){this._sprite.set("interactive",!0),this._sprite._display.interactive=!0;let i=this._rendererDisposers[e];if(void 0===i){const r=this._sprite._display.on(e,(e=>{t.call(this,e)}));i=this._rendererDisposers[e]=new Vt((()=>{delete this._rendererDisposers[e],r.dispose()}))}return i.increment()}_on(e,t,i,r,a,s){const n=super._on(e,t,i,r,a,s),o=ur.RENDERER_EVENTS[t];return void 0!==o&&(n.disposer=new Wt([n.disposer,this._onRenderer(t,o)])),n}stopParentDispatch(){this._dispatchParents=!1}dispatchParents(e,t){const i=this._dispatchParents;this._dispatchParents=!0;try{this.dispatch(e,t),this._dispatchParents&&this._sprite.parent&&this._sprite.parent.events.dispatchParents(e,t)}finally{this._dispatchParents=i}}}Object.defineProperty(ur,"RENDERER_EVENTS",{enumerable:!0,configurable:!0,writable:!0,value:{click:function(e){this.isEnabled("click")&&!this._sprite.isDragging()&&this._sprite._hasDown()&&!this._sprite._hasMoved(this._makePointerEvent("click",e))&&this.dispatch("click",this._makePointerEvent("click",e))},rightclick:function(e){this.isEnabled("rightclick")&&this.dispatch("rightclick",this._makePointerEvent("rightclick",e))},middleclick:function(e){this.isEnabled("middleclick")&&this.dispatch("middleclick",this._makePointerEvent("middleclick",e))},dblclick:function(e){this.dispatchParents("dblclick",this._makePointerEvent("dblclick",e))},pointerover:function(e){const t=this._sprite;let i=!0;if(t.getPrivate("trustBounds")){t._getBounds();const r=t.globalBounds();if(t.isType("Graphics")){const e=t.get("strokeWidth",1)/2;e>=1&&(r.left-=e,r.right+=e,r.top-=e,r.bottom+=e)}(function(e,t){return e.x>=t.left&&e.y>=t.top&&e.x<=t.right&&e.y<=t.bottom})(e.point,r)||(i=!1,t._root._renderer.removeHovering(t._display))}i&&this.isEnabled("pointerover")&&this.dispatch("pointerover",this._makePointerEvent("pointerover",e))},pointerout:function(e){this.isEnabled("pointerout")&&this.dispatch("pointerout",this._makePointerEvent("pointerout",e))},pointerdown:function(e){this.dispatchParents("pointerdown",this._makePointerEvent("pointerdown",e))},pointerup:function(e){this.isEnabled("pointerup")&&this.dispatch("pointerup",this._makePointerEvent("pointerup",e))},globalpointerup:function(e){this.isEnabled("globalpointerup")&&this.dispatch("globalpointerup",this._makePointerEvent("globalpointerup",e))},globalpointermove:function(e){this.isEnabled("globalpointermove")&&this.dispatch("globalpointermove",this._makePointerEvent("globalpointermove",e))},wheel:function(e){this.dispatchParents("wheel",{type:"wheel",target:this._sprite,originalEvent:e.event,point:e.point})}}});class dr extends Zi{constructor(){super(...arguments),Object.defineProperty(this,"_adjustedLocalBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dataItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_templateField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_sizeDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dragEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isHidden",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isShowing",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isHiding",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_downPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downPoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_toggleDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dragDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_hoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_focusDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipMoveDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipPointerDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_statesHandled",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this.setPrivateRaw("visible",!0),super._afterNew()}markDirtyKey(e){this._markDirtyKey(e)}_markDirtyKey(e){super._markDirtyKey(e),"x"!=e&&"y"!=e&&"dx"!=e&&"dy"!=e||(this.markDirtyBounds(),this._addPercentagePositionChildren(),this.markDirtyPosition())}_markDirtyPrivateKey(e){super._markDirtyPrivateKey(e),"x"!=e&&"y"!=e||this.markDirtyPosition()}_removeTemplateField(){this._templateField&&this._templateField._removeObjectTemplate(this)}_createEvents(){return new ur(this)}_processTemplateField(){let e;const t=this.get("templateField");if(t){const i=this.dataItem;if(i){const r=i.dataContext;r&&(e=r[t],e instanceof ir||!e||(e=ir.new(e)))}}this._templateField!==e&&(this._removeTemplateField(),this._templateField=e,e&&e._setObjectTemplate(this),this._applyTemplates())}_setDataItem(e){const t=this._dataItem;this._dataItem=e,this._processTemplateField();const i="dataitemchanged";e!=t&&this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this,oldDataItem:t,newDataItem:e})}set dataItem(e){this._setDataItem(e)}get dataItem(){if(this._dataItem)return this._dataItem;{let e=this._parent;for(;e;){if(e._dataItem)return e._dataItem;e=e._parent}}}_addPercentageSizeChildren(){let e=this.parent;e&&(this.get("width")instanceof st||this.get("height")instanceof st?Ct(e._percentageSizeChildren,this):Pt(e._percentageSizeChildren,this))}_addPercentagePositionChildren(){let e=this.parent;e&&(this.get("x")instanceof st||this.get("y")instanceof st?Ct(e._percentagePositionChildren,this):Pt(e._percentagePositionChildren,this))}markDirtyPosition(){this._root._addDirtyPosition(this)}updatePivotPoint(){const e=this._localBounds;if(e){const t=this.get("centerX");null!=t&&(this._display.pivot.x=e.left+ii(t,e.right-e.left));const i=this.get("centerY");null!=i&&(this._display.pivot.y=e.top+ii(i,e.bottom-e.top))}}_beforeChanged(){if(super._beforeChanged(),this._handleStates(),this.isDirty("tooltip")){const e=this._prevSettings.tooltip;e&&e.dispose()}if((this.isDirty("layer")||this.isDirty("layerMargin"))&&(this._display.setLayer(this.get("layer"),this.get("layerMargin")),this.markDirtyLayer()),this.isDirty("tooltipPosition")){const e=this._tooltipMoveDp;e&&(e.dispose(),this._tooltipMoveDp=void 0);const t=this._tooltipPointerDp;t&&(t.dispose(),this._tooltipPointerDp=void 0),"pointer"==this.get("tooltipPosition")&&(this.isHover()&&(this._tooltipMoveDp=this.events.on("globalpointermove",(e=>{this.showTooltip(e.point)}))),this._tooltipPointerDp=new Wt([this.events.on("pointerover",(()=>{this._tooltipMoveDp=this.events.on("globalpointermove",(e=>{this.showTooltip(e.point)}))})),this.events.on("pointerout",(()=>{const e=this._tooltipMoveDp;e&&(e.dispose(),this._tooltipMoveDp=void 0)}))]))}}_handleStates(){this._statesHandled||(this.isDirty("active")&&(this.get("active")?(this.states.applyAnimate("active"),this.set("ariaChecked",!0)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!1)),this.markDirtyAccessibility()),this.isDirty("disabled")&&(this.get("disabled")?(this.states.applyAnimate("disabled"),this.set("ariaChecked",!1)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!0)),this.markDirtyAccessibility()),this._statesHandled=!0)}_changed(){super._changed();const e=this._display,t=this.events;if(this.isDirty("draggable")){const i=this.get("draggable");i?(this.set("interactive",!0),this._dragDp=new Wt([t.on("pointerdown",(e=>{this.dragStart(e)})),t.on("globalpointermove",(e=>{this.dragMove(e)})),t.on("globalpointerup",(e=>{this.dragStop(e)}))])):this._dragDp&&(this._dragDp.dispose(),this._dragDp=void 0),e.cancelTouch=!!i}if(this.isDirty("tooltipText")||this.isDirty("tooltipHTML")||this.isDirty("showTooltipOn")){const e=this.get("tooltipText"),i=this.get("tooltipHTML"),r=this.get("showTooltipOn","hover");this._tooltipDp&&(this._tooltipDp.dispose(),this._tooltipDp=void 0),(e||i)&&("click"==r?(this._tooltipDp=new Wt([t.on("click",(()=>{this.setTimeout((()=>{const e=this.getTooltip();e&&!e.isHidden()&&e.get("tooltipTarget")===this?this.hideTooltip():this.showTooltip()}),10)})),$t(document,"click",(e=>{this.hideTooltip()}))]),this._disposers.push(this._tooltipDp)):"always"==r||(this._tooltipDp=new Wt([t.on("pointerover",(()=>{this.showTooltip()})),t.on("pointerout",(()=>{this.hideTooltip()}))]),this._disposers.push(this._tooltipDp)))}if(this.isDirty("toggleKey")){let e=this.get("toggleKey");e&&"none"!=e?this._toggleDp=t.on("click",(()=>{this._isDragging||this.set(e,!this.get(e))})):this._toggleDp&&(this._toggleDp.dispose(),this._toggleDp=void 0)}if(this.isDirty("opacity")&&(e.alpha=Math.max(0,this.get("opacity",1)),this.get("focusable")&&this.markDirtyAccessibility()),this.isDirty("rotation")&&(this.markDirtyBounds(),e.angle=this.get("rotation",0)),this.isDirty("scale")&&(this.markDirtyBounds(),e.scale=this.get("scale",0)),(this.isDirty("centerX")||this.isDirty("centerY"))&&(this.markDirtyBounds(),this.updatePivotPoint()),(this.isDirty("visible")||this.isPrivateDirty("visible")||this.isDirty("forceHidden"))&&(this.get("visible")&&this.getPrivate("visible")&&!this.get("forceHidden")?e.visible=!0:(e.visible=!1,this.hideTooltip()),this.markDirtyBounds(),this.get("focusable")&&this.markDirtyAccessibility()),this.isDirty("width")||this.isDirty("height")){this.markDirtyBounds(),this._addPercentageSizeChildren();const e=this.parent;e&&(this.isDirty("width")&&this.get("width")instanceof st||this.isDirty("height")&&this.get("height")instanceof st)&&(e.markDirty(),e._prevWidth=0),this._sizeDirty=!0}if((this.isDirty("maxWidth")||this.isDirty("maxHeight")||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("minWidth")||this.isDirty("minHeight")||this.isPrivateDirty("maxWidth")||this.isPrivateDirty("maxHeight")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight")||this.isDirty("marginLeft")||this.isDirty("marginTop")||this.isDirty("marginRight")||this.isDirty("marginBottom"))&&(this.markDirtyBounds(),this._sizeDirty=!0),this._sizeDirty&&this._updateSize(),this.isDirty("wheelable")){const t=this.get("wheelable");t&&this.set("interactive",!0),e.wheelable=!!t}(this.isDirty("tabindexOrder")||this.isDirty("focusableGroup"))&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this)),this.isDirty("filter")&&(e.filter=this.get("filter"));let i=this.get("filter","");if(this.isDirty("blur")){const e=this.get("blur",0);0!=e&&(i+=" blur("+e+"px)")}if(this.isDirty("saturate")){const e=this.get("saturate",1);1!=e&&(i+=" saturate("+e+")")}if(this.isDirty("brightness")){const e=this.get("brightness",1);1!=e&&(i+=" brightness("+e+")")}if(this.isDirty("contrast")){const e=this.get("contrast",1);1!=e&&(i+=" contrast("+e+")")}if(this.isDirty("sepia")){const e=this.get("sepia",0);0!=e&&(i+=" sepia("+e+")")}if(this.isDirty("hue")){const e=this.get("hue",0);0!=e&&(i+=" hue-rotate("+e+"deg)")}if(this.isDirty("invert")){const e=this.get("invert",0);0!=e&&(i+=" invert("+e+")")}if(i&&(e.filter=i),this.isDirty("cursorOverStyle")&&(e.cursorOverStyle=this.get("cursorOverStyle")),this.isDirty("hoverOnFocus")&&(this.get("hoverOnFocus")?this._focusDp=new Wt([t.on("focus",(()=>{this.showTooltip()})),t.on("blur",(()=>{this.hideTooltip()}))]):this._focusDp&&(this._focusDp.dispose(),this._focusDp=void 0)),this.isDirty("focusable")&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this),this.markDirtyAccessibility(),this._disposers.push(t.on("blur",(()=>{this.setPrivateRaw("touchHovering",!1)}))),this._disposers.push(t.once("boundschanged",(()=>{this.markDirtyAccessibility()})))),this.isPrivateDirty("focusable")&&this.markDirtyAccessibility(),(this.isDirty("role")||this.isDirty("ariaLive")||this.isDirty("ariaChecked")||this.isDirty("ariaHidden")||this.isDirty("ariaOrientation")||this.isDirty("ariaValueNow")||this.isDirty("ariaValueMin")||this.isDirty("ariaValueMax")||this.isDirty("ariaValueText")||this.isDirty("ariaLabel")||this.isDirty("ariaControls"))&&this.markDirtyAccessibility(),this.isDirty("exportable")&&(e.exportable=this.get("exportable")),this.isDirty("interactive")){const e=this.events;this.get("interactive")&&!e.isDisposed()?this._hoverDp=new Wt([e.on("click",(e=>{qt(e.originalEvent)&&(this.getPrivate("touchHovering")||this.setTimeout((()=>{this._handleOver(),(this.get("tooltipText")||this.get("tooltipHTML"))&&this.showTooltip(),this.setPrivateRaw("touchHovering",!0),this.events.dispatch("pointerover",{type:"pointerover",target:e.target,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}),10))})),e.on("globalpointerup",(e=>{qt(e.originalEvent)&&this.getPrivate("touchHovering")&&(this._handleOut(),(this.get("tooltipText")||this.get("tooltipHTML"))&&this.hideTooltip(),this.setPrivateRaw("touchHovering",!1),this.events.dispatch("pointerout",{type:"pointerout",target:e.target,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})),this._isDown&&this._handleUp(e)})),e.on("pointerover",(()=>{this._handleOver()})),e.on("pointerout",(()=>{this._handleOut()})),e.on("pointerdown",(e=>{this._handleDown(e)}))]):(this._display.interactive=!1,this._hoverDp&&(this._hoverDp.dispose(),this._hoverDp=void 0))}this.isDirty("forceInactive")&&(this._display.inactive=this.get("forceInactive",null)),"always"==this.get("showTooltipOn")&&this._display.visible&&this.showTooltip()}dragStart(e){this._dragEvent=e,this.events.stopParentDispatch()}dragStop(e){if(this._dragEvent=void 0,this._dragPoint=void 0,this.events.stopParentDispatch(),this._isDragging){this._isDragging=!1;const t="dragstop";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}_handleOver(){this.isHidden()||(this.get("active")&&this.states.lookup("hoverActive")?this.states.applyAnimate("hoverActive"):this.get("disabled")&&this.states.lookup("hoverDisabled")?this.states.applyAnimate("hoverDisabled"):this.states.applyAnimate("hover"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}_handleOut(){this.isHidden()||(this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):(this.states.lookup("hover")||this.states.lookup("hoverActive"))&&this.states.applyAnimate("default"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}_handleUp(e){if(!this.isHidden()){this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):this.states.lookup("down")&&(this.isHover()?this.states.applyAnimate("hover"):this.states.applyAnimate("default")),this._downPoint=void 0;const t=Gt(e.originalEvent);delete this._downPoints[t],0==Ft(this._downPoints).length&&(this._isDown=!1)}}_hasMoved(e){const t=Gt(e.originalEvent),i=this._downPoints[t];if(i){const t=Math.abs(i.x-e.point.x),r=Math.abs(i.y-e.point.y);return t>5||r>5}return!1}_hasDown(){return Ft(this._downPoints).length>0}_handleDown(e){const t=this.parent;if(t&&!this.get("draggable")&&t._handleDown(e),this.get("interactive")&&!this.isHidden()){this.states.lookup("down")&&this.states.applyAnimate("down"),this._downPoint={x:e.point.x,y:e.point.y},this._isDown=!0;const t=Gt(e.originalEvent);this._downPoints[t]={x:e.point.x,y:e.point.y}}}dragMove(e){let t=this._dragEvent;if(t){if(t.simulated&&!e.simulated)return!0;let i=0,r=this.parent,a=1;for(;null!=r;)i+=r.get("rotation",0),r=r.parent,r&&(a*=r.get("scale",1));let s=(e.point.x-t.point.x)/a,n=(e.point.y-t.point.y)/a;const o=this.events;if(t.simulated&&!this._isDragging){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};const t="dragstart";o.isEnabled(t)&&o.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}if(this._isDragging){let t=this._dragPoint;this.set("x",t.x+s*cr(i)+n*lr(i)),this.set("y",t.y+n*cr(i)-s*lr(i));const r="dragged";o.isEnabled(r)&&o.dispatch(r,{type:r,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}else if(Math.hypot(s,n)>5){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};const t="dragstart";o.isEnabled(t)&&o.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}}_updateSize(){}_getBounds(){this._localBounds=this._display.getLocalBounds()}depth(){let e=this.parent,t=0;for(;;){if(!e)return t;++t,e=e.parent}}markDirtySize(){this._sizeDirty=!0,this.markDirty()}markDirtyBounds(){const e=this._display;if(this.get("isMeasured")){this._root._addDirtyBounds(this),e.isMeasured=!0,e.invalidateBounds();const t=this.parent;t&&"absolute"!=this.get("position")&&(null==t.get("width")||null==t.get("height")||t.get("layout"))&&t.markDirtyBounds(),this.get("focusable")&&this.markDirtyAccessibility()}}markDirtyAccessibility(){this._root._invalidateAccessibility(this)}markDirtyLayer(){this._display.markDirtyLayer(!0)}markDirty(){super.markDirty(),this.markDirtyLayer()}_updateBounds(){const e=this._adjustedLocalBounds;let t;if(this.get("visible")&&this.getPrivate("visible")&&!this.get("forceHidden")?(this._getBounds(),this._fixMinBounds(this._localBounds),this.updatePivotPoint(),this._adjustedLocalBounds=this._display.getAdjustedBounds(this._localBounds),t=this._adjustedLocalBounds):(t={left:0,right:0,top:0,bottom:0},this._localBounds=t,this._adjustedLocalBounds=t),!e||e.left!==t.left||e.top!==t.top||e.right!==t.right||e.bottom!==t.bottom){const e="boundschanged";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this}),this.parent&&(this.parent.markDirty(),this.parent.markDirtyBounds()),this.getPrivate("showingTooltip")&&this.showTooltip()}}_fixMinBounds(e){let t=this.get("minWidth",this.getPrivate("minWidth")),i=this.get("minHeight",this.getPrivate("minHeight"));bt(t)&&e.right-e.left<t&&(e.right=e.left+t),bt(i)&&e.bottom-e.top<i&&(e.bottom=e.top+i);let r=this.getPrivate("width"),a=this.getPrivate("height");bt(r)&&(r>0?e.right=e.left+r:e.left=e.right+r),bt(a)&&(a>0?e.bottom=e.top+a:e.top=e.bottom+a)}_removeParent(e){e&&(e.children.removeValue(this),Pt(e._percentageSizeChildren,this),Pt(e._percentagePositionChildren,this))}_clearDirty(){super._clearDirty(),this._sizeDirty=!1,this._statesHandled=!1}hover(){this.isDisposed()||(this.showTooltip(),this._handleOver())}unhover(){this.isDisposed()||(this.hideTooltip(),this._handleOut())}showTooltip(e){if(!this.isDisposed()){const t=this.getTooltip(),i=this.get("tooltipText"),r=this.get("tooltipHTML");if((i||r)&&t){const a=this.get("tooltipPosition"),s=this.getPrivate("tooltipTarget",this);if("fixed"!=a&&e||(this._display._setMatrix(),e=this.toGlobal(s._getTooltipPoint())),"pointer"==a){const t=this.getPrivate("lastTooltipCoords");if(t&&t.x==e.x&&t.y==e.y)return;this.setPrivate("lastTooltipCoords",e)}t.set("pointTo",e),t.set("tooltipTarget",s),t.get("x")||t.set("x",e.x),t.get("y")||t.set("y",e.y),i&&t.label.set("text",i),r&&t.label.set("html",r);const n=this.dataItem;if(n&&t.label._setDataItem(n),"always"==this.get("showTooltipOn")&&(e.x<0||e.x>this._root.width()||e.y<0||e.y>this._root.height()))return void this.hideTooltip();t.label.text.markDirtyText();const o=t.show();return this.setPrivateRaw("showingTooltip",!0),o}}}hideTooltip(){const e=this.getTooltip();if(e&&(this.removePrivate("lastTooltipCoords"),e.get("tooltipTarget")==this.getPrivate("tooltipTarget",this)||this.get("tooltip")==e)){let t=e.get("keepTargetHover")&&0==e.get("stateAnimationDuration",0)?400:void 0;const i=e.hide(t);return this.setPrivateRaw("showingTooltip",!1),i}}_getTooltipPoint(){const e=this._localBounds;if(e){let t=0,i=0;return this.get("isMeasured")?(t=e.left+ii(this.get("tooltipX",0),e.right-e.left),i=e.top+ii(this.get("tooltipY",0),e.bottom-e.top)):(t=ii(this.get("tooltipX",0),this.width()),i=ii(this.get("tooltipY",0),this.height())),{x:t,y:i}}return{x:0,y:0}}getTooltip(){let e=this.get("tooltip");if(e)return e;{let e=this.parent;if(e)return e.getTooltip()}}_updatePosition(){const e=this.parent;let t=this.get("dx",0),i=this.get("dy",0),r=this.get("x"),a=this.getPrivate("x"),s=0,n=0;const o=this.get("position");r instanceof st&&(r=e?e.innerWidth()*r.value+e.get("paddingLeft",0):0),bt(r)?s=r+t:null!=a?s=a:e&&"relative"==o&&(s=e.get("paddingLeft",0)+t);let l=this.get("y"),c=this.getPrivate("y");l instanceof st&&(l=e?e.innerHeight()*l.value+e.get("paddingTop",0):0),bt(l)?n=l+i:null!=c?n=c:e&&"relative"==o&&(n=e.get("paddingTop",0)+i);const h=this._display;if(h.x!=s||h.y!=n){h.invalidateBounds(),h.x=s,h.y=n;const e="positionchanged";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this})}this.getPrivate("showingTooltip")&&this.showTooltip()}x(){let e=this.get("x"),t=this.getPrivate("x");const i=this.parent;return i?e instanceof st?ii(e,i.innerWidth())+i.get("paddingLeft",0):bt(e)?e:null!=t?t:i.get("paddingLeft",this._display.x):this._display.x}y(){let e=this.getPrivate("y");if(null!=e)return e;let t=this.get("y");const i=this.parent;return i?t instanceof st?ii(t,i.innerHeight())+i.get("paddingTop",0):bt(t)?t:null!=e?e:i.get("paddingTop",this._display.y):this._display.y}_dispose(){super._dispose(),this._display.dispose(),this._removeTemplateField(),this._removeParent(this.parent),this._root._removeFocusElement(this);const e=this.get("tooltip");e&&e.dispose(),this.markDirty()}adjustedLocalBounds(){return this._fixMinBounds(this._adjustedLocalBounds),this._adjustedLocalBounds}localBounds(){return this._localBounds}bounds(){const e=this._adjustedLocalBounds,t=this.x(),i=this.y();return{left:e.left+t,right:e.right+t,top:e.top+i,bottom:e.bottom+i}}globalBounds(){const e=this.localBounds(),t=this.toGlobal({x:e.left,y:e.top}),i=this.toGlobal({x:e.right,y:e.top}),r=this.toGlobal({x:e.right,y:e.bottom}),a=this.toGlobal({x:e.left,y:e.bottom});return{left:Math.min(t.x,i.x,r.x,a.x),top:Math.min(t.y,i.y,r.y,a.y),right:Math.max(t.x,i.x,r.x,a.x),bottom:Math.max(t.y,i.y,r.y,a.y)}}_onShow(e){}_onHide(e){}appear(e,t){return at(this,void 0,void 0,(function*(){return yield this.hide(0),t?new Promise(((i,r)=>{this.setTimeout((()=>{i(this.show(e))}),t)})):this.show(e)}))}show(e){return at(this,void 0,void 0,(function*(){if(!this._isShowing){this._isHidden=!1,this._isShowing=!0,this._isHiding=!1,this.states.lookup("default").get("visible")&&this.set("visible",!0),this._onShow(e);const t=this.states.applyAnimate("default",e);yield Si(t),this._isShowing=!1}}))}hide(e){return at(this,void 0,void 0,(function*(){if(!this._isHiding&&!this._isHidden){this._isHiding=!0,this._isShowing=!1;let t=this.states.lookup("hidden");t||(t=this.states.create("hidden",{opacity:0,visible:!1})),this._isHidden=!0,this._onHide(e);const i=this.states.applyAnimate("hidden",e);yield Si(i),this._isHiding=!1}}))}isHidden(){return this._isHidden}isShowing(){return this._isShowing}isHiding(){return this._isHiding}isHover(){return this._display.hovering()}isFocus(){return this._root.focused(this)}isDragging(){return this._isDragging}isVisible(){return!(!this.get("visible")||!this.getPrivate("visible")||this.get("forceHidden"))}isVisibleDeep(){return this._parent?this._parent.isVisibleDeep()&&this.isVisible():this.isVisible()}compositeOpacity(){const e=this.get("opacity",1);return this._parent?this._parent.compositeOpacity()*e:e}compositeScale(){const e=this.get("scale",1);return this._parent?this._parent.compositeScale()*e:e}compositeRotation(){const e=this.get("rotation",0);return this._parent?this._parent.compositeRotation()+e:e}width(){let e=this.get("width"),t=this.get("maxWidth",this.getPrivate("maxWidth")),i=this.get("minWidth",this.getPrivate("minWidth")),r=this.getPrivate("width"),a=0;if(bt(r))a=r;else if(null==e)this._adjustedLocalBounds&&(a=this._adjustedLocalBounds.right-this._adjustedLocalBounds.left);else if(e instanceof st){const t=this.parent;a=t?t.innerWidth()*e.value:this._root.width()*e.value}else bt(e)&&(a=e);return bt(i)&&(a=Math.max(i,a)),bt(t)&&(a=Math.min(t,a)),a}maxWidth(){let e=this.get("maxWidth",this.getPrivate("maxWidth"));if(bt(e))return e;{let e=this.get("width");if(bt(e))return e}const t=this.parent;return t?t.innerWidth():this._root.width()}maxHeight(){let e=this.get("maxHeight",this.getPrivate("maxHeight"));if(bt(e))return e;{let e=this.get("height");if(bt(e))return e}const t=this.parent;return t?t.innerHeight():this._root.height()}height(){let e=this.get("height"),t=this.get("maxHeight",this.getPrivate("maxHeight")),i=this.get("minHeight",this.getPrivate("minHeight")),r=this.getPrivate("height"),a=0;if(bt(r))a=r;else if(null==e)this._adjustedLocalBounds&&(a=this._adjustedLocalBounds.bottom-this._adjustedLocalBounds.top);else if(e instanceof st){const t=this.parent;a=t?t.innerHeight()*e.value:this._root.height()*e.value}else bt(e)&&(a=e);return bt(i)&&(a=Math.max(i,a)),bt(t)&&(a=Math.min(t,a)),a}_findStaticTemplate(e){return this._templateField&&e(this._templateField)?this._templateField:super._findStaticTemplate(e)}_walkParents(e){this._parent&&this._walkParent(e)}_walkParent(e){this._parent&&this._parent._walkParent(e),e(this)}get parent(){return this._parent}_setParent(e,t=!1){const i=this._parent;e!==i&&(this.markDirtyBounds(),e.markDirty(),this._parent=e,t&&(this._removeParent(i),e&&(this._addPercentageSizeChildren(),this._addPercentagePositionChildren())),this.markDirtyPosition(),this._applyThemes())}getNumberFormatter(){return this.get("numberFormatter",this._root.numberFormatter)}getDateFormatter(){return this.get("dateFormatter",this._root.dateFormatter)}getDurationFormatter(){return this.get("durationFormatter",this._root.durationFormatter)}toGlobal(e){return this._display.toGlobal(e)}toLocal(e){return this._display.toLocal(e)}_getDownPoint(){const e=this._getDownPointId();if(e)return this._downPoints[e]}_getDownPointId(){if(this._downPoints)return(e=this._downPoints,t=(e,t)=>e>t?1:e<t?-1:0,Ft(e).sort(t))[0];var e,t}toFront(){const e=this.parent;e&&e.children.moveValue(this,e.children.length-1)}toBack(){const e=this.parent;e&&e.children.moveValue(this,0)}}Object.defineProperty(dr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sprite"}),Object.defineProperty(dr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Zi.classNames.concat([dr.className])});class fr extends Zi{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeGraphics()}),Object.defineProperty(this,"_backgroundDisplay",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeGraphics()}),Object.defineProperty(this,"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_pattern",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNewApplyThemes()}get pattern(){return this._pattern}_draw(){}_beforeChanged(){super._beforeChanged(),(this.isDirty("repetition")||this.isDirty("width")||this.isDirty("height")||this.isDirty("rotation")||this.isDirty("strokeWidth")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("colorOpacity")||this.isDirty("fillOpacity"))&&(this._clear=!0),this._checkDirtyFill()}_checkDirtyFill(){(this.isDirty("color")||this.isDirty("fill"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){const e=this.get("repetition",""),t=this.get("width",100),i=this.get("height",100),r=this.get("fill"),a=this.get("fillOpacity",1),s=this._backgroundDisplay,n=this._display;n.clear(),s.clear(),r&&a>0&&(s.beginFill(r,a),s.drawRect(0,0,t,i),s.endFill()),n.angle=this.get("rotation",0),this._draw(),this._pattern=this._root._renderer.createPattern(n,s,e,t,i)}this._clear=!1}}Object.defineProperty(fr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Pattern"}),Object.defineProperty(fr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Zi.classNames.concat([fr.className])});class pr extends fr{constructor(){super(...arguments),Object.defineProperty(this,"_image",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_beforeChanged(){super._beforeChanged(),this._clear=!0,this.isDirty("src")&&this._load();const e=this.get("canvas");e&&(this.set("width",e.width),this.set("height",e.height))}_draw(){super._draw();const e=this.get("colorOpacity");void 0!==e&&(this._display.alpha=Math.max(0,e));const t=this._image;if(t){const e=this.get("width",100),i=this.get("height",100),r=this.get("fit","image");let a=0,s=0;"pattern"==r?(a=e,s=i,this.markDirty()):(a=t.width,s=t.height,"image"==r&&(this.set("width",a),this.set("height",s)));let n=0,o=0;this.get("centered",!0)&&(n=e/2-a/2,o=i/2-s/2),this._display.image(t,a,s,n,o)}const i=this.get("canvas");i&&this._display.image(i,i.width,i.height,0,0)}_load(){const e=this.get("src");if(e){const t=new Image;t.src=e,t.decode().then((()=>{this._image=t,this._draw(),this.events.isEnabled("loaded")&&this.events.dispatch("loaded",{type:"loaded",target:this})})).catch((e=>{}))}}}var gr;Object.defineProperty(pr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PicturePattern"}),Object.defineProperty(pr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:fr.classNames.concat([pr.className])}),function(e){e.ADD="lighter",e.COLOR="color",e.COLOR_BURN="color-burn",e.COLOR_DODGE="color-dodge",e.DARKEN="darken",e.DIFFERENCE="difference",e.DST_OVER="destination-over",e.EXCLUSION="exclusion",e.HARD_LIGHT="hard-light",e.HUE="hue",e.LIGHTEN="lighten",e.LUMINOSITY="luminosity",e.MULTIPLY="multiply",e.NORMAL="source-over",e.OVERLAY="overlay",e.SATURATION="saturation",e.SCREEN="screen",e.SOFT_LIGHT="soft-light",e.SRC_ATOP="source-atop",e.XOR="xor"}(gr||(gr={}));class mr extends dr{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeGraphics()}),Object.defineProperty(this,"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_beforeChanged(){if(super._beforeChanged(),(this.isDirty("draw")||this.isDirty("svgPath"))&&this.markDirtyBounds(),(this.isDirty("fill")||this.isDirty("stroke")||this.isDirty("visible")||this.isDirty("forceHidden")||this.isDirty("scale")||this.isDirty("fillGradient")||this.isDirty("strokeGradient")||this.isDirty("fillPattern")||this.isDirty("strokePattern")||this.isDirty("fillOpacity")||this.isDirty("strokeOpacity")||this.isDirty("strokeWidth")||this.isDirty("draw")||this.isDirty("blendMode")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("svgPath")||this.isDirty("lineJoin")||this.isDirty("lineCap")||this.isDirty("shadowColor")||this.isDirty("shadowBlur")||this.isDirty("shadowOffsetX")||this.isDirty("shadowOffsetY"))&&(this._clear=!0),this._display.crisp=this.get("crisp",!1),this.isDirty("fillGradient")){const e=this.get("fillGradient");if(e){this._display.isMeasured=!0;const t=e.get("target");t&&(this._disposers.push(t.events.on("boundschanged",(()=>{this._markDirtyKey("fill")}))),this._disposers.push(t.events.on("positionchanged",(()=>{this._markDirtyKey("fill")}))))}}if(this.isDirty("strokeGradient")){const e=this.get("strokeGradient");if(e){this._display.isMeasured=!0;const t=e.get("target");t&&(this._disposers.push(t.events.on("boundschanged",(()=>{this._markDirtyKey("stroke")}))),this._disposers.push(t.events.on("positionchanged",(()=>{this._markDirtyKey("stroke")}))))}}}_changed(){if(super._changed(),this._clear){this.markDirtyBounds(),this.markDirtyLayer(),this._display.clear();let e=this.get("strokeDasharray");bt(e)&&(e=e<.5?[0]:[e]),this._display.setLineDash(e);const t=this.get("strokeDashoffset");t&&this._display.setLineDashOffset(t);const i=this.get("blendMode",gr.NORMAL);this._display.blendMode=i;const r=this.get("draw");r&&"function"==typeof r&&r(this._display,this);const a=this.get("svgPath");null!=a&&this._display.svgPath(a)}}_afterChanged(){if(super._afterChanged(),this._clear){const e=this.get("fill"),t=this.get("fillGradient"),i=this.get("fillPattern"),r=this.get("fillOpacity"),a=this.get("stroke"),s=this.get("strokeGradient"),n=this.get("strokePattern"),o=this.get("shadowColor"),l=this.get("shadowBlur"),c=this.get("shadowOffsetX"),h=this.get("shadowOffsetY"),u=this.get("shadowOpacity");if(o&&(l||c||h)&&this._display.shadow(o,l,c,h,u),e&&!t&&(this._display.beginFill(e,r),this._display.endFill()),t){if(e){const i=t.get("stops",[]);i.length&&At(i,(t=>{t.color&&!t.colorInherited||!e||(t.color=e,t.colorInherited=!0),(null==t.opacity||t.opacityInherited)&&(t.opacity=r,t.opacityInherited=!0)}))}const i=t.getFill(this);i&&(this._display.beginFill(i,r),this._display.endFill())}if(i){const e=i.pattern;e&&(this._display.beginFill(e,r),this._display.endFill(),i instanceof pr&&i.events.once("loaded",(()=>{this._clear=!0,this.markDirty()})))}if(a||s||n){const e=this.get("strokeOpacity");let t=this.get("strokeWidth",1);this.get("nonScalingStroke")&&(t/=this.get("scale",1)),this.get("crisp")&&(t/=this._root._renderer.resolution);const i=this.get("lineJoin"),r=this.get("lineCap");if(a&&!s&&(this._display.lineStyle(t,a,e,i,r),this._display.endStroke()),s){const n=s.get("stops",[]);n.length&&At(n,(t=>{t.color&&!t.colorInherited||!a||(t.color=a,t.colorInherited=!0),(null==t.opacity||t.opacityInherited)&&(t.opacity=e,t.opacityInherited=!0)}));const o=s.getFill(this);o&&(this._display.lineStyle(t,o,e,i,r),this._display.endStroke())}if(n){let a=n.pattern;a&&(this._display.lineStyle(t,a,e,i,r),this._display.endStroke(),n instanceof pr&&n.events.once("loaded",(()=>{this._clear=!0,this.markDirty()})))}}this.getPrivate("showingTooltip")&&this.showTooltip()}this._clear=!1}}Object.defineProperty(mr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Graphics"}),Object.defineProperty(mr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:dr.classNames.concat([mr.className])});class br extends mr{_afterNew(){super._afterNew(),this._display.isMeasured=!0,this.setPrivateRaw("trustBounds",!0)}_beforeChanged(){super._beforeChanged(),(this.isDirty("width")||this.isDirty("height")||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}_changed(){super._changed(),this._clear&&!this.get("draw")&&this._draw()}_draw(){this._display.drawRect(0,0,this.width(),this.height())}_updateSize(){this.markDirty(),this._clear=!0}}function vr(e,t){e.get("reverseChildren",!1)?e.children.eachReverse(t):e.children.each(t)}Object.defineProperty(br,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Rectangle"}),Object.defineProperty(br,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:mr.classNames.concat([br.className])});class yr extends Zi{}Object.defineProperty(yr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Layout"}),Object.defineProperty(yr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Zi.classNames.concat([yr.className])});class _r extends yr{updateContainer(e){let t=e.get("paddingLeft",0),i=e.innerWidth(),r=0;vr(e,(e=>{if(e.isVisible()&&"relative"==e.get("position")){let t=e.get("width");if(t instanceof st){r+=t.value;let a=i*t.value,s=e.get("minWidth",e.getPrivate("minWidth",-1/0));s>a&&(i-=s,r-=t.value);let n=e.get("maxWidth",e.getPrivate("maxWidth",1/0));a>n&&(i-=n,r-=t.value)}else bt(t)||(t=e.width()),i-=t+e.get("marginLeft",0)+e.get("marginRight",0)}})),(i<=0||i==1/0)&&(i=.1),vr(e,(e=>{if(e.isVisible()&&"relative"==e.get("position")){let t=e.get("width");if(t instanceof st){let a=i*t.value/r-e.get("marginLeft",0)-e.get("marginRight",0),s=e.get("minWidth",e.getPrivate("minWidth",-1/0)),n=e.get("maxWidth",e.getPrivate("maxWidth",1/0));a=Math.min(Math.max(s,a),n),e.setPrivate("width",a)}else e._prevSettings.width instanceof st&&e.setPrivate("width",void 0)}}));let a=t;vr(e,(e=>{if("relative"==e.get("position"))if(e.isVisible()){let t=e.adjustedLocalBounds(),i=e.get("marginLeft",0),r=e.get("marginRight",0),s=e.get("maxWidth"),n=t.left,o=t.right;s&&o-n>s&&(o=n+s);let l=a+i-n;e.setPrivate("x",l),a=l+o+r}else e.setPrivate("x",void 0)}))}}Object.defineProperty(_r,"className",{enumerable:!0,configurable:!0,writable:!0,value:"HorizontalLayout"}),Object.defineProperty(_r,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:yr.classNames.concat([_r.className])});class wr extends yr{updateContainer(e){let t=e.get("paddingTop",0),i=e.innerHeight(),r=0;vr(e,(e=>{if(e.isVisible()&&"relative"==e.get("position")){let t=e.get("height");if(t instanceof st){r+=t.value;let a=i*t.value,s=e.get("minHeight",e.getPrivate("minHeight",-1/0));s>a&&(i-=s,r-=t.value);let n=e.get("maxHeight",e.getPrivate("maxHeight",1/0));a>n&&(i-=n,r-=t.value)}else bt(t)||(t=e.height()),i-=t+e.get("marginTop",0)+e.get("marginBottom",0)}})),(i<=0||i==1/0)&&(i=.1),vr(e,(e=>{if(e.isVisible()&&"relative"==e.get("position")){let t=e.get("height");if(t instanceof st){let a=i*t.value/r-e.get("marginTop",0)-e.get("marginBottom",0),s=e.get("minHeight",e.getPrivate("minHeight",-1/0)),n=e.get("maxHeight",e.getPrivate("maxHeight",1/0));a=Math.min(Math.max(s,a),n),e.setPrivate("height",a)}else e._prevSettings.height instanceof st&&e.setPrivate("height",void 0)}}));let a=t;vr(e,(e=>{if("relative"==e.get("position"))if(e.isVisible()){let t=e.adjustedLocalBounds(),i=e.get("marginTop",0),r=t.top,s=t.bottom,n=e.get("maxHeight");n&&s-r>n&&(s=r+n);let o=e.get("marginBottom",0),l=a+i-r;e.setPrivate("y",l),a=l+s+o}else e.setPrivate("y",void 0)}))}}Object.defineProperty(wr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"VerticalLayout"}),Object.defineProperty(wr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:yr.classNames.concat([wr.className])});class xr extends yr{_afterNew(){this._setRawDefault("maxColumns",Number.MAX_VALUE),super._afterNew()}updateContainer(e){let t=e.get("paddingLeft",0),i=e.get("paddingRight",0),r=e.get("paddingTop",0),a=e.maxWidth()-t-i,s=a,n=1;vr(e,(e=>{if(e.get("visible")&&e.getPrivate("visible")&&!e.get("forceHidden")&&"absolute"!=e.get("position")){let t=e.width();t<s&&(s=t),t>n&&(n=t)}})),s=or(s,1,a),n=or(n,1,a);let o=1;o=this.get("fixedWidthGrid")?a/n:a/s,o=Math.max(1,Math.floor(o)),o=Math.min(this.get("maxColumns",Number.MAX_VALUE),o);let l=this.getColumnWidths(e,o,n,a),c=r,h=0,u=0;o=l.length;let d=t;vr(e,(e=>{if("relative"==e.get("position")&&e.isVisible()){const i=e.get("marginTop",0),r=e.get("marginBottom",0);let a=e.adjustedLocalBounds(),s=e.get("marginLeft",0),n=e.get("marginRight",0),f=d+s-a.left,p=c+i-a.top;e.setPrivate("x",f),e.setPrivate("y",p),d+=l[h]+n,u=Math.max(u,e.height()+i+r),h++,h>=o&&(h=0,d=t,c+=u)}}))}getColumnWidths(e,t,i,r){let a=0,s=[],n=0;return vr(e,(r=>{let a=r.adjustedLocalBounds();"absolute"!=r.get("position")&&r.isVisible()&&(this.get("fixedWidthGrid")?s[n]=i:s[n]=Math.max(0|s[n],a.right-a.left+r.get("marginLeft",0)+r.get("marginRight",0)),n<e.children.length-1&&(n++,n==t&&(n=0)))})),At(s,(e=>{a+=e})),a>r?t>2?(t-=1,this.getColumnWidths(e,t,i,r)):[r]:s}}Object.defineProperty(xr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"GridLayout"}),Object.defineProperty(xr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:yr.classNames.concat([xr.className])});class Ar{static escape(e){return e.replace(/\[\[/g,this.prefix+"1").replace(/([^\/\]]{1})\]\]/g,"$1"+this.prefix+"2").replace(/\]\]/g,this.prefix+"2").replace(/\{\{/g,this.prefix+"3").replace(/\}\}/g,this.prefix+"4").replace(/\'\'/g,this.prefix+"5")}static unescape(e){return e.replace(new RegExp(this.prefix+"1","g"),"[[").replace(new RegExp(this.prefix+"2","g"),"]]").replace(new RegExp(this.prefix+"3","g"),"{{").replace(new RegExp(this.prefix+"4","g"),"}}").replace(new RegExp(this.prefix+"5","g"),"''")}static cleanUp(e){return e.replace(/\[\[/g,"[").replace(/\]\]/g,"]").replace(/\{\{/g,"{").replace(/\}\}/g,"}").replace(/\'\'/g,"'")}static chunk(e,t=!1,i=!1){let r=[];e=this.escape(e);let a=t?e.split("'"):[e];for(let e=0;e<a.length;e++){let t=a[e];if(""!==t)if(e%2==0){t=t.replace(/\]\[/g,"]"+yt+"["),t=t.replace(/\[\]/g,"[ ]");let e=t.split(/[\[\]]+/);for(let t=0;t<e.length;t++){let a=this.cleanUp(this.unescape(e[t]));a!==yt&&""!==a&&(t%2==0?r.push({type:"value",text:a}):r.push({type:i?"value":"format",text:"["+a+"]"}))}}else{let e=t.split(/[\[\]]+/);for(let t=0;t<e.length;t++){let i=this.cleanUp(this.unescape(e[t]));""!==i&&(t%2==0?r.push({type:"text",text:i}):this.isImage(i)?r.push({type:"image",text:"["+i+"]"}):r.push({type:"format",text:"["+i+"]"}))}}}return r}static isImage(e){return!!e.match(/img[ ]?:/)}static getTextStyle(e){let t={};if(""==e||"[ ]"==e)return{};const i=e.match(/('[^']*')|("[^"]*")/gi);if(i)for(let t=0;t<i.length;t++)e=e.replace(i[t],i[t].replace(/['"]*/g,"").replace(/[ ]+/g,"+"));let r=e.match(/([\w\-]*:[\s]?[^;\s\]]*)|(\#[\w]{1,6})|([\w\-]+)|(\/)/gi);if(!r)return{};for(let e=0;e<r.length;e++)if(r[e].match(/^(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)$/i))t.fontWeight=r[e];else if(r[e].match(/^(underline|line-through)$/i))t.textDecoration=r[e];else if("/"==r[e]);else if(r[e].match(/:/)){const i=r[e].replace("+"," ").split(/:[ ]*/);t[i[0]]=i[1]}else t.fill=ki.fromString(r[e]);return t}}function Tr(e,t){if(null!=t){t=""+t;let i,r=(t=Ar.escape(t)).match(/\{([^}]+)\}/g);if(r)for(i=0;i<r.length;i++){let a=kr(e,r[i].replace(/\{([^}]+)\}/,"$1"),"");null==a&&(a=""),t=t.split(r[i]).join(a)}t=Ar.unescape(t)}else t="";return t}function kr(e,t,i){let r;const a=e.dataItem;let s,n=[],o=/(format[a-zA-Z]*)\((.*)\)|([^.]+)/g;for(;s=o.exec(t),null!==s;)if(s[3]){n.push({prop:s[3]});const t=e.getDateFormatter().get("dateFields",[]),i=e.getNumberFormatter().get("numericFields",[]),r=e.getDurationFormatter().get("durationFields",[]);-1!==t.indexOf(s[3])?n.push({method:"formatDate",params:[]}):-1!==i.indexOf(s[3])?n.push({method:"formatNumber",params:[]}):-1!==r.indexOf(s[3])&&n.push({method:"formatDuration",params:[]})}else{let e=[];if(""!=si(s[2])){let t,i=/'([^']*)'|"([^"]*)"|([0-9\-]+)/g;for(;t=i.exec(s[2]),null!==t;)e.push(t[1]||t[2]||t[3])}n.push({method:s[1],params:e})}if(a){r=Pr(e,n,a._settings),(null==r||vt(r))&&(r=Pr(e,n,a));let s=a.dataContext;null==r&&s&&(r=Pr(e,n,s),null==r&&(r=Pr(e,[{prop:t}],s)),null==r&&s.dataContext&&(r=Pr(e,n,s.dataContext))),null==r&&a.component&&a.component.dataItem!==a&&(r=kr(a.component,t,i))}return null==r&&(r=Pr(e,n,e)),null==r&&e.parent&&(r=kr(e.parent,t,i)),r}function Sr(e,t){const i=e.getPrivate("customData");if(vt(i))return i[t]}function Pr(e,t,i,r){let a=i,s=!1;for(let n=0,o=t.length;n<o;n++){let o=t[n];if(o.prop){if(a instanceof dr){let e=a.get(o.prop);null==e&&(e=a.getPrivate(o.prop)),null==e&&(e=Sr(a,o.prop)),null==e&&(e=a[o.prop]),a=e}else if(a.get){let e=a.get(o.prop);null==e&&(e=a[o.prop]),a=e}else a=a[o.prop];if(null==a)return}else switch(o.method){case"formatNumber":let t=dt(a);null!=t&&(a=e.getNumberFormatter().format(t,r||o.params[0]||void 0),s=!0);break;case"formatDate":let n=ft(a);if(!gt(n)||ut(n.getTime()))return;null!=n&&(a=e.getDateFormatter().format(n,r||o.params[0]||void 0),s=!0);break;case"formatDuration":let l=dt(a);null!=l&&(a=e.getDurationFormatter().format(l,r||o.params[0]||void 0,o.params[1]||void 0),s=!0);break;case"urlEncode":case"encodeURIComponent":a=encodeURIComponent(a);break;default:a[o.method]&&a[o.method].apply(i,o.params)}}if(!s){let t=[{method:"",params:r}];if(null==r)bt(a)?(t[0].method="formatNumber",t[0].params=""):gt(a)&&(t[0].method="formatDate",t[0].params="");else{let e=function(e){if(void 0===e)return"string";let t=(e=(e=(e=e.toLowerCase().replace(/^\[[^\]]*\]/,"")).replace(/\[[^\]]+\]/,"")).trim()).match(/\/(date|number|duration)$/);return t?t[1]:"number"===e?"number":"date"===e?"date":"duration"===e?"duration":e.match(/[#0]/)?"number":e.match(/[ymwdhnsqaxkzgtei]/)?"date":"string"}(r);"number"===e?t[0].method="formatNumber":"date"===e?t[0].method="formatDate":"duration"===e&&(t[0].method="formatDuration")}t[0].method&&(a=Pr(e,t,a))}return a}Object.defineProperty(Ar,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:"__amcharts__"});class Er extends dr{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeContainer()}),Object.defineProperty(this,"_childrenDisplay",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeContainer()}),Object.defineProperty(this,"children",{enumerable:!0,configurable:!0,writable:!0,value:new Ni(this)}),Object.defineProperty(this,"_percentageSizeChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_percentagePositionChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_prevWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prevHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_contentWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_contentHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_contentMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_vsbd0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_vsbd1",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNew(),this._display.addChild(this._childrenDisplay)}_dispose(){Tt(this.allChildren(),(e=>{e.dispose()})),this.getPrivate("htmlElement")&&this._root._removeHTMLContent(this),super._dispose()}_changed(){if(super._changed(),this.isDirty("interactiveChildren")&&(this._display.interactiveChildren=this.get("interactiveChildren",!1)),this.isDirty("layout")&&(this._prevWidth=0,this._prevHeight=0,this.markDirtyBounds(),this._prevSettings.layout&&this.children.each((e=>{e.removePrivate("x"),e.removePrivate("y")}))),(this.isDirty("paddingTop")||this.isDirty("paddingBottom")||this.isDirty("paddingLeft")||this.isDirty("paddingRight"))&&this.children.each((e=>{e.markDirtyPosition()})),this.isDirty("maskContent")){const e=this._childrenDisplay;let t=this._contentMask;this.get("maskContent")?t||(t=br.new(this._root,{x:-.5,y:-.5,width:this.width()+1,height:this.height()+1}),this._contentMask=t,e.addChildAt(t._display,0),e.mask=t._display):t&&(e.removeChild(t._display),e.mask=null,t.dispose(),this._contentMask=void 0)}}_updateSize(){super._updateSize(),At(this._percentageSizeChildren,(e=>{e._updateSize()})),At(this._percentagePositionChildren,(e=>{e.markDirtyPosition(),e._updateSize()})),this.updateBackground()}updateBackground(){const e=this.get("background");let t=this._localBounds;if(t&&!this.isHidden()){let i=t.left,r=t.top,a=t.right-i,s=t.bottom-r,n=this.get("maxWidth"),o=this.get("maxHeight");o&&s>o&&(s=o),n&&a>n&&(a=n);let l=this.width(),c=this.height();e&&(e.setAll({width:a,height:s,x:i,y:r}),this._display.interactive&&(e._display.interactive=!0));const h=this._contentMask;h&&h.setAll({width:l+1,height:c+1});const u=this.get("verticalScrollbar");if(u){u.set("height",c),u.set("x",l-u.width()-u.get("marginRight",0)),u.set("end",u.get("start",0)+c/this._contentHeight);const e=u.get("background");e&&e.setAll({width:u.width(),height:c});let t=!0;this._contentHeight<=c&&(t=!1),u.setPrivate("visible",t)}}}_applyThemes(e=!1){return!!super._applyThemes(e)&&(this.eachChildren((t=>{t._applyThemes(e)})),!0)}_applyState(e){super._applyState(e),this.get("setStateOnChildren")&&this.eachChildren((t=>{t.states.apply(e)}))}_applyStateAnimated(e,t){super._applyStateAnimated(e,t),this.get("setStateOnChildren")&&this.eachChildren((i=>{i.states.applyAnimate(e,t)}))}innerWidth(){return this.width()-this.get("paddingRight",0)-this.get("paddingLeft",0)}innerHeight(){return this.height()-this.get("paddingTop",0)-this.get("paddingBottom",0)}_getBounds(){if(this.get("html")){let e=this._localBounds;e&&(this._contentWidth=e.right-e.left,this._contentHeight=e.bottom-e.top)}else{let e=this.get("width"),t=this.get("height"),i=this.getPrivate("width"),r=this.getPrivate("height"),a={left:0,top:0,right:this.width(),bottom:this.height()},s=this.get("layout"),n=!1,o=!1;if((s instanceof _r||s instanceof xr)&&(n=!0),s instanceof wr&&(o=!0),null==e&&null==i||null==t&&null==r||this.get("verticalScrollbar")){let e=Number.MAX_VALUE,t=e,i=-e,r=e,s=-e;const l=this.get("paddingLeft",0),c=this.get("paddingTop",0),h=this.get("paddingRight",0),u=this.get("paddingBottom",0);this.children.each((e=>{if("absolute"!=e.get("position")&&e.get("isMeasured")){let a=e.adjustedLocalBounds(),l=e.x(),c=e.y(),h=l+a.left,u=l+a.right,d=c+a.top,f=c+a.bottom;n&&(h-=e.get("marginLeft",0),u+=e.get("marginRight",0)),o&&(d-=e.get("marginTop",0),f+=e.get("marginBottom",0)),h<t&&(t=h),u>i&&(i=u),d<r&&(r=d),f>s&&(s=f)}})),t==e&&(t=0),i==-e&&(i=0),r==e&&(r=0),s==-e&&(s=0),a.left=t-l,a.top=r-c,a.right=i+h,a.bottom=s+u;const d=this.get("minWidth");bt(d)&&d>0&&a.right-a.left<d&&(a.right>=d?a.left=a.right-d:a.right=a.left+d);const f=this.get("minHeight");bt(f)&&f>0&&a.bottom-a.top<f&&(a.bottom>=f?a.top=a.bottom-f:a.bottom=a.top+f)}this._contentWidth=a.right-a.left,this._contentHeight=a.bottom-a.top,bt(e)&&(a.left=0,a.right=e),bt(i)&&(a.left=0,a.right=i),bt(t)&&(a.top=0,a.bottom=t),bt(r)&&(a.top=0,a.bottom=r),this._localBounds=a}}_updateBounds(){const e=this.get("layout");e&&e.updateContainer(this),super._updateBounds(),this.updateBackground()}markDirty(){super.markDirty(),this._root._addDirtyParent(this)}_prepareChildren(){const e=this.innerWidth(),t=this.innerHeight();if(e!=this._prevWidth||t!=this._prevHeight){let i=this.get("layout"),r=!1,a=!1;i&&((i instanceof _r||i instanceof xr)&&(r=!0),i instanceof wr&&(a=!0)),At(this._percentageSizeChildren,(i=>{if(!r){let t=i.get("width");t instanceof st&&i.setPrivate("width",t.value*e)}if(!a){let e=i.get("height");e instanceof st&&i.setPrivate("height",e.value*t)}})),At(this._percentagePositionChildren,(e=>{e.markDirtyPosition(),e.markDirtyBounds()})),this._prevWidth=e,this._prevHeight=t,this._sizeDirty=!0,this.updateBackground()}this._handleStates()}_updateHTMLContent(){const e=this.get("html","");e&&""!==e?this._root._setHTMLContent(this,Tr(this,e)):this._root._removeHTMLContent(this),this._root._positionHTMLElement(this)}scrollToChild(e){const t=this.get("verticalScrollbar");if(t){let i=e.y(),r=this.innerHeight(),a=e.height(),s=this._contentHeight,n=1-(r-a/2)/s;if(i+.7*a+this._childrenDisplay.y>r||i-.3*a+this._childrenDisplay.y<0){let e=Math.max(0,Math.min(n,(i-a/2)/s));t.animate({key:"start",to:e,duration:t.get("animationDuration",0),easing:t.get("animationEasing")})}}}_updateChildren(){if(this.isDirty("html")&&this._updateHTMLContent(),this.isDirty("verticalScrollbar")){const e=this.get("verticalScrollbar");if(e){e._setParent(this),e.startGrip.setPrivate("visible",!1),e.endGrip.setPrivate("visible",!1),this.set("maskContent",!0),this.set("paddingRight",e.width()+e.get("marginRight",0)+e.get("marginLeft",0));let t=this.get("background");t||(t=this.set("background",br.new(this._root,{themeTags:["background"],fillOpacity:0,fill:this._root.interfaceColors.get("alternativeBackground")}))),this._vsbd0=this.events.on("wheel",(t=>{const i=t.originalEvent;if(!Qt(i,this))return;i.preventDefault();let r=i.deltaY/5e3;const a=e.get("start",0),s=e.get("end",1);a+r<=0&&(r=-a),s+r>=1&&(r=1-s),a+r>=0&&s+r<=1&&(e.set("start",a+r),e.set("end",s+r))})),this._disposers.push(this._vsbd0),this._vsbd1=e.events.on("rangechanged",(()=>{let t=this._contentHeight;const i=this._childrenDisplay,r=this._contentMask;i.y=-e.get("start",0)*t,i.markDirtyLayer(),r&&(r._display.y=-i.y,i.mask=r._display)})),this._disposers.push(this._vsbd1),this._display.addChild(e._display)}else{const e=this._prevSettings.verticalScrollbar;e&&(this._display.removeChild(e._display),this._vsbd0&&this._vsbd0.dispose(),this._vsbd1&&this._vsbd1.dispose(),this._childrenDisplay.y=0,this.setPrivate("height",void 0),this.set("maskContent",!1),this.set("paddingRight",void 0))}}if(this.isDirty("background")){const e=this._prevSettings.background;e&&this._display.removeChild(e._display);const t=this.get("background");t instanceof dr&&(t.set("isMeasured",!1),t._setParent(this),this._display.addChildAt(t._display,0))}if(this.isDirty("mask")){const e=this.get("mask"),t=this._prevSettings.mask;if(t&&(this._display.removeChild(t._display),t!=e&&t.dispose()),e){const t=e.parent;t&&t.children.removeValue(e),e._setParent(this),this._display.addChildAt(e._display,0),this._childrenDisplay.mask=e._display}}}_processTemplateField(){super._processTemplateField(),this.children.each((e=>{e._processTemplateField()}))}walkChildren(e){this.children.each((t=>{t instanceof Er&&t.walkChildren(e),e(t)}))}eachChildren(e){const t=this.get("background");t&&e(t);const i=this.get("verticalScrollbar");i&&e(i);const r=this.get("mask");r&&e(r),this.children.values.forEach((t=>{e(t)}))}allChildren(){const e=[];return this.eachChildren((t=>{e.push(t)})),e}_setDataItem(e){const t=e!==this._dataItem;super._setDataItem(e);const i=this.get("html","");i&&""!==i&&t&&this._root._setHTMLContent(this,Tr(this,i))}}Object.defineProperty(Er,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Container"}),Object.defineProperty(Er,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:dr.classNames.concat([Er.className])});class Cr extends dr{constructor(){super(...arguments),Object.defineProperty(this,"textStyle",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeTextStyle()}),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeText("",this.textStyle)}),Object.defineProperty(this,"_textStyles",{enumerable:!0,configurable:!0,writable:!0,value:["textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale","maxChars"]}),Object.defineProperty(this,"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_updateBounds(){if(this.get("text")){super._updateBounds();let e=this.get("fillGradient");e&&(this._display.style.fill=e.getFill(this))}else{let e={left:0,right:0,top:0,bottom:0};this._adjustedLocalBounds=e}}_changed(){super._changed(),this._display.clear();let e=this.textStyle;if(this.isDirty("opacity")){let e=this.get("opacity",1);this._display.alpha=e}if((this.isDirty("text")||this.isDirty("populateText"))&&(this._display.text=this._getText(),this.markDirtyBounds(),"tooltip"==this.get("role")&&this._root.updateTooltip(this)),this.isPrivateDirty("tooltipElement")&&this.getPrivate("tooltipElement")&&this._disposers.push(new Ut((()=>{this._root._removeTooltipElement(this)}))),this.isDirty("width")&&(e.wordWrapWidth=this.width(),this.markDirtyBounds()),this.isDirty("oversizedBehavior")&&(e.oversizedBehavior=this.get("oversizedBehavior","none"),this.markDirtyBounds()),this.isDirty("breakWords")&&(e.breakWords=this.get("breakWords",!1),this.markDirtyBounds()),this.isDirty("ellipsis")&&(e.ellipsis=this.get("ellipsis"),this.markDirtyBounds()),this.isDirty("ignoreFormatting")&&(e.ignoreFormatting=this.get("ignoreFormatting",!1),this.markDirtyBounds()),this.isDirty("minScale")&&(e.minScale=this.get("minScale",0),this.markDirtyBounds()),this.isDirty("fill")||this.isDirty("fillGradient")){const t=this.get("fill"),i=this.get("fillGradient"),r=this.get("fillOpacity");if(i){if(t){const e=i.get("stops",[]);e.length&&At(e,(e=>{e.color&&!e.colorInherited||!t||(e.color=t,e.colorInherited=!0),(null==e.opacity||e.opacityInherited)&&(e.opacity=r,e.opacityInherited=!0)}))}e.fill=i.getFill(this)}else t&&(e.fill=t)}if(this.isDirty("fillOpacity")){let t=this.get("fillOpacity",1);t&&(e.fillOpacity=t)}(this.isDirty("maxWidth")||this.isPrivateDirty("maxWidth"))&&(e.maxWidth=this.get("maxWidth",this.getPrivate("maxWidth")),this.markDirtyBounds()),(this.isDirty("maxHeight")||this.isPrivateDirty("maxHeight"))&&(e.maxHeight=this.get("maxHeight",this.getPrivate("maxHeight")),this.markDirtyBounds()),At(this._textStyles,(t=>{this._dirty[t]&&(e[t]=this.get(t),this.markDirtyBounds())})),e.fontSize=this.get("fontSize"),e.fontFamily=this.get("fontFamily"),this._display.style=e,this.isDirty("role")&&"tooltip"==this.get("role")&&this._root.updateTooltip(this)}_getText(){let e=this.get("text","");return this.get("maxChars")&&(e=function(e,t,i=!1,r="..."){if(e.length>t){let a=t-1;for(;a>=0&&e.charAt(a).match(/\w/);)a--;return a>=0&&0==i?e.substring(0,a+1)+"...":e.substring(0,t)+r}return e}(e,this.get("maxChars",1e8),this.get("breakWords"),this.get("ellipsis"))),this.get("populateText")?Tr(this,e):e}_getAccessibleText(){const e=this.get("ariaLabel");return void 0!==e?this.get("populateText")?Tr(this,e):e:this._getText()}markDirtyText(){this._display.text=this._getText(),"tooltip"==this.get("role")&&this._root.updateTooltip(this),this.markDirtyBounds(),this.markDirty()}_setDataItem(e){super._setDataItem(e),this.get("populateText")&&this.markDirtyText()}getNumberFormatter(){return this.parent?this.parent.getNumberFormatter():super.getNumberFormatter()}getDateFormatter(){return this.parent?this.parent.getDateFormatter():super.getDateFormatter()}getDurationFormatter(){return this.parent?this.parent.getDurationFormatter():super.getDurationFormatter()}}Object.defineProperty(Cr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Text"}),Object.defineProperty(Cr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:dr.classNames.concat([Cr.className])});class Dr{constructor(){Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._observer=new ResizeObserver((e=>{At(e,(e=>{At(this._targets,(t=>{t.target===e.target&&t.callback()}))}))}))}addTarget(e,t){this._observer.observe(e,{box:"border-box"}),this._targets.push({target:e,callback:t})}removeTarget(e){this._observer.unobserve(e),Lt(this._targets,(t=>t.target!==e))}}class Or{constructor(){Object.defineProperty(this,"_timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]})}addTarget(e,t){if(null===this._timer){let e=null;const t=()=>{const i=Date.now();(null===e||i>e+Or.delay)&&(e=i,At(this._targets,(e=>{let t=e.target.getBoundingClientRect();t.width===e.size.width&&t.height===e.size.height||(e.size=t,e.callback())}))),0===this._targets.length?this._timer=null:this._timer=requestAnimationFrame(t)};this._timer=requestAnimationFrame(t)}this._targets.push({target:e,callback:t,size:{width:0,height:0,left:0,right:0,top:0,bottom:0,x:0,y:0}})}removeTarget(e){Lt(this._targets,(t=>t.target!==e)),0===this._targets.length&&null!==this._timer&&(cancelAnimationFrame(this._timer),this._timer=null)}}Object.defineProperty(Or,"delay",{enumerable:!0,configurable:!0,writable:!0,value:200});let Rr=null;class Mr{constructor(e,t){Object.defineProperty(this,"_sensor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_listener",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this._sensor=(null===Rr&&(Rr="undefined"!=typeof ResizeObserver?new Dr:new Or),Rr),this._element=e,this._listener=Xt(t),this._sensor.addTarget(e,t)}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._sensor.removeTarget(this._element),this._listener.dispose())}get sensor(){return this._sensor}}class Ir extends Zi{}Object.defineProperty(Ir,"className",{enumerable:!0,configurable:!0,writable:!0,value:"InterfaceColors"}),Object.defineProperty(Ir,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Zi.classNames.concat([Ir.className])});class Lr extends Er{constructor(){super(...arguments),Object.defineProperty(this,"_text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_textKeys",{enumerable:!0,configurable:!0,writable:!0,value:["text","fill","fillGradient","fillOpacity","textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale","populateText","role","ignoreFormatting","maxChars","ariaLabel"]})}get text(){return this._text}_afterNew(){super._afterNew(),this._makeText(),At(this._textKeys,(e=>{const t=this.get(e);null!=t&&this._text.set(e,t)})),""!==this.get("html","")&&this._text.set("text",""),this.onPrivate("maxWidth",(()=>{this._setMaxDimentions()})),this.onPrivate("maxHeight",(()=>{this._setMaxDimentions()}))}_makeText(){this._text=this.children.push(Cr.new(this._root,{}))}_updateChildren(){super._updateChildren();const e=this._text;if(At(this._textKeys,(e=>{this._text.set(e,this.get(e))})),(this.isDirty("maxWidth")||this.isDirty("maxHeight")||this.isDirty("rotation"))&&this._setMaxDimentions(),""!==this.get("html","")?e.set("text",""):(e.set("text",this.get("text")),this._maybeUpdateHTMLColor()),(this.isDirty("fill")||this.isDirty("fillGradient"))&&this._maybeUpdateHTMLColor(),this.isDirty("textAlign")||this.isDirty("width")){const t=this.get("textAlign");let i;null!=this.get("width")?i="right"==t?lt:"center"==t?ct:0:"left"==t||"start"==t?i=this.get("paddingLeft",0):"right"!=t&&"end"!=t||(i=-this.get("paddingRight",0)),e.set("x",i)}const t=this.get("background");t&&t.setPrivate("visible",e._display.textVisible)}_maybeUpdateHTMLColor(){const e=this.getPrivate("htmlElement");e&&this.get("fill")&&(e.style.color=this.get("fill").toCSSHex())}_setMaxDimentions(){const e=this.get("rotation"),t=90==e||270==e||-90==e,i=this._text,r=this.get("maxWidth",this.getPrivate("maxWidth",1/0));bt(r)?i.set(t?"maxHeight":"maxWidth",r-this.get("paddingTop",0)-this.get("paddingBottom",0)):i.set(t?"maxHeight":"maxWidth",void 0);const a=this.get("maxHeight",this.getPrivate("maxHeight",1/0));bt(a)?i.set(t?"maxWidth":"maxHeight",a-this.get("paddingLeft",0)-this.get("paddingRight",0)):i.set(t?"maxWidth":"maxHeight",void 0),this.root.events.once("frameended",(()=>{i.markDirtyBounds()}))}_setDataItem(e){super._setDataItem(e),this._markDirtyKey("text"),this._markDirtyKey("html");const t=this._text;t.get("populateText")&&t.markDirtyText();const i=this.get("html");i&&""!==i&&this._updateHTMLContent()}getText(){return this._text._getText()}getAccessibleText(){return this._text._getAccessibleText()}}Object.defineProperty(Lr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Label"}),Object.defineProperty(Lr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Er.classNames.concat([Lr.className])});class Fr extends mr{_beforeChanged(){super._beforeChanged(),(this.isDirty("pointerBaseWidth")||this.isDirty("cornerRadius")||this.isDirty("pointerLength")||this.isDirty("pointerX")||this.isDirty("pointerY")||this.isDirty("width")||this.isDirty("height"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){this.markDirtyBounds();let e=this.width(),t=this.height();if(e>0&&t>0){let i=this.get("cornerRadius",8);i=or(i,0,Math.min(e/2,t/2));let r=this.get("pointerX",0),a=this.get("pointerY",0),s=this.get("pointerBaseWidth",15)/2,n=0,o=0,l=0,c=(r-n)*(t-o)-(a-o)*(e-n),h=(r-l)*(0-t)-(a-t)*(e-l);const u=this._display;if(u.moveTo(i,0),c>0&&h>0){let t=Math.round(or(r,i+s,e-s-i));a=or(a,-1/0,0),u.lineTo(t-s,0),u.lineTo(r,a),u.lineTo(t+s,0)}if(u.lineTo(e-i,0),u.arcTo(e,0,e,i,i),c>0&&h<0){let n=Math.round(or(a,i+s,t-s-i));r=or(r,e,1/0),u.lineTo(e,i),u.lineTo(e,Math.max(n-s,i)),u.lineTo(r,a),u.lineTo(e,n+s)}if(u.lineTo(e,t-i),u.arcTo(e,t,e-i,t,i),c<0&&h<0){let n=Math.round(or(r,i+s,e-s-i));a=or(a,t,1/0),u.lineTo(e-i,t),u.lineTo(n+s,t),u.lineTo(r,a),u.lineTo(n-s,t)}if(u.lineTo(i,t),u.arcTo(0,t,0,t-i,i),c<0&&h>0){let e=Math.round(or(a,i+s,t-i-s));r=or(r,-1/0,0),u.lineTo(0,t-i),u.lineTo(0,e+s),u.lineTo(r,a),u.lineTo(0,Math.max(e-s,i))}u.lineTo(0,i),u.arcTo(0,0,i,0,i),u.closePath()}}}}Object.defineProperty(Fr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PointedRectangle"}),Object.defineProperty(Fr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:mr.classNames.concat([Fr.className])});class Nr extends Er{constructor(e,t,i,r=[]){super(e,t,i,r),Object.defineProperty(this,"_fx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_fy",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_label",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_labelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_w",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_h",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_keepHoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_htmlContentHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this._settings.themeTags=wi(this._settings.themeTags,["tooltip"]),super._afterNew(),this._setDefaultFn("background",(()=>Fr.new(this._root,{}))).set("themeTags",["tooltip","background"]),this._label=this.children.push(Lr.new(this._root,{})),this._disposers.push(this._label.events.on("boundschanged",(()=>{this._updateBackground()}))),this._disposers.push(this.on("bounds",(()=>{this._updateBackground()}))),this._updateTextColor(),this._root.tooltipContainer.children.push(this),this.hide(0),this._disposers.push(this.label.onPrivate("htmlElement",(e=>{e&&(this._disposers.push($t(e,"pointerover",(e=>{this._htmlContentHovered=!0}))),this._disposers.push($t(e,"pointerout",(e=>{this._htmlContentHovered=!1}))))}))),this.on("visible",(e=>{this._handleReaderAnnouncement()})),this.label.events.on("dataitemchanged",(e=>{this._handleReaderAnnouncement()})),this._root._tooltips.push(this)}_handleReaderAnnouncement(){this.get("readerAnnounce")&&this.isVisibleDeep()&&this._root.readerAlert(this.label.getAccessibleText())}get label(){return this._label}_dispose(){super._dispose(),St(this._root._tooltips,this)}_updateChildren(){super._updateChildren(),(this.isDirty("pointerOrientation")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight"))&&this.get("background")._markDirtyKey("width"),null!=this.get("labelText")&&this.label.set("text",this.get("labelText")),null!=this.get("labelHTML")&&this.label.set("html",this.get("labelHTML")),null!=this.get("labelAriaLabel")&&this.label.set("ariaLabel",this.get("labelAriaLabel"))}_changed(){if(super._changed(),(this.isDirty("pointTo")||this.isDirty("pointerOrientation"))&&this._updateBackground(),this.isDirty("tooltipTarget")&&this.updateBackgroundColor(),this.isDirty("keepTargetHover"))if(this.get("keepTargetHover")){const e=this.get("background");this._keepHoverDp=new Wt([e.events.on("pointerover",(e=>{let t=this.get("tooltipTarget");t&&(t.parent&&t.parent.getPrivate("tooltipTarget")==t&&(t=t.parent),t.hover())})),e.events.on("pointerout",(e=>{let t=this.get("tooltipTarget");t&&(t.parent&&t.parent.getPrivate("tooltipTarget")==t&&(t=t.parent),this._htmlContentHovered||t.unhover())}))]),this.label.onPrivate("htmlElement",(t=>{this._keepHoverDp&&t&&this._keepHoverDp.disposers.push($t(t,"pointerleave",(t=>{const i=this.root._renderer.getEvent(t);e.events.dispatch("pointerout",{type:"pointerout",originalEvent:i.event,point:i.point,simulated:!1,target:e})})))}))}else this._keepHoverDp&&(this._keepHoverDp.dispose(),this._keepHoverDp=void 0)}_onShow(){super._onShow(),this.updateBackgroundColor()}updateBackgroundColor(){let e=this.get("tooltipTarget");const t=this.get("background");let i,r;e&&t&&(i=e.get("fill"),r=e.get("stroke"),null==i&&(i=r),this.get("getFillFromSprite")&&(this._fillDp&&this._fillDp.dispose(),null!=i&&t.set("fill",i),this._fillDp=e.on("fill",(e=>{null!=e&&(t.set("fill",e),this._updateTextColor(e))})),this._disposers.push(this._fillDp)),this.get("getStrokeFromSprite")&&(this._strokeDp&&this._strokeDp.dispose(),null!=i&&t.set("stroke",i),this._strokeDp=e.on("fill",(e=>{null!=e&&t.set("stroke",e)})),this._disposers.push(this._strokeDp)),this.get("getLabelFillFromSprite")&&(this._labelDp&&this._labelDp.dispose(),null!=i&&this.label.set("fill",i),this._labelDp=e.on("fill",(e=>{null!=e&&this.label.set("fill",e)})),this._disposers.push(this._labelDp))),this._updateTextColor(i)}_updateTextColor(e){this.get("autoTextColor")&&(null==e&&(e=this.get("background").get("fill")),null==e&&(e=this._root.interfaceColors.get("background")),e instanceof ki&&this.label.set("fill",ki.alternative(e,this._root.interfaceColors.get("alternativeText"),this._root.interfaceColors.get("text"))))}_setDataItem(e){super._setDataItem(e),this.label._setDataItem(e)}_updateBackground(){super.updateBackground();const e=this._root.container;if(e){let t=.5,i=.5,r=this.get("centerX");r instanceof st&&(t=r.value);let a=this.get("centerY");a instanceof st&&(i=a.value);let s=e.width(),n=e.height(),o=this.parent,l=0,c=0;if(o){l=o.x(),c=o.y();const e=o.get("layerMargin");e&&(l+=e.left||0,c+=e.top||0,s+=(e.left||0)+(e.right||0),n+=(e.top||0)+(e.bottom||0))}const h=this.get("bounds",{left:-l,top:-c,right:s-l,bottom:n-c});this._updateBounds();let u=this.width(),d=this.height();0===u&&(u=this._w),0===d&&(d=this._h);let f=this.get("pointTo",{x:s/2,y:n/2}),p=f.x,g=f.y,m=this.get("pointerOrientation"),b=this.get("background"),v=0,y=0,_=0;b instanceof Fr&&(v=b.get("pointerLength",0),y=b.get("strokeWidth",0)/2,_=y,b.set("width",u),b.set("height",d));let w=0,x=0,A=h.right-h.left,T=h.bottom-h.top;"horizontal"==m||"left"==m||"right"==m?(y=0,"horizontal"==m?p>h.left+A/2?(p-=u*(1-t)+v,_*=-1):p+=u*t+v:"left"==m?p+=u*(1-t)+v:(p-=u*t+v,_*=-1)):(_=0,"vertical"==m?g>h.top+d/2+v?g-=d*(1-i)+v:(g+=d*i+v,y*=-1):"down"==m?g-=d*(1-i)+v:(g+=d*i+v,y*=-1)),p=or(p,h.left+u*t,h.left+A-u*(1-t))+_,g=or(g,h.top+d*i,h.top+T-d*(1-i))-y,w=f.x-p+u*t+_,x=f.y-g+d*i-y,this._fx=p,this._fy=g;const k=this.get("animationDuration",0);if(k>0&&this.get("visible")&&this.get("opacity")>.1){const e=this.get("animationEasing");this.animate({key:"x",to:p,duration:k,easing:e}),this.animate({key:"y",to:g,duration:k,easing:e})}else this.set("x",p),this.set("y",g);b instanceof Fr&&(b.set("pointerX",w),b.set("pointerY",x)),u>0&&(this._w=u),d>0&&(this._h=d)}}}Object.defineProperty(Nr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Tooltip"}),Object.defineProperty(Nr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Er.classNames.concat([Nr.className])});class Br extends Zi{_setDefaults(){this._setDefault("negativeBase",0),this._setDefault("numberFormat","#,###.#####"),this._setDefault("smallNumberThreshold",1);const e="_big_number_suffix_",t="_small_number_suffix_",i="_byte_suffix_";this._setDefault("bigNumberPrefixes",[{number:1e3,suffix:this._t(e+"3")},{number:1e6,suffix:this._t(e+"6")},{number:1e9,suffix:this._t(e+"9")},{number:1e12,suffix:this._t(e+"12")},{number:1e15,suffix:this._t(e+"15")},{number:1e18,suffix:this._t(e+"18")},{number:1e21,suffix:this._t(e+"21")},{number:1e24,suffix:this._t(e+"24")}]),this._setDefault("smallNumberPrefixes",[{number:1e-24,suffix:this._t(t+"24")},{number:1e-21,suffix:this._t(t+"21")},{number:1e-18,suffix:this._t(t+"18")},{number:1e-15,suffix:this._t(t+"15")},{number:1e-12,suffix:this._t(t+"12")},{number:1e-9,suffix:this._t(t+"9")},{number:1e-6,suffix:this._t(t+"6")},{number:.001,suffix:this._t(t+"3")}]),this._setDefault("bytePrefixes",[{number:1,suffix:this._t(i+"B")},{number:1024,suffix:this._t(i+"KB")},{number:1048576,suffix:this._t(i+"MB")},{number:1073741824,suffix:this._t(i+"GB")},{number:1099511627776,suffix:this._t(i+"TB")},{number:0x4000000000000,suffix:this._t(i+"PB")}]),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t,i){let r;(null==t||mt(t)&&"number"===t.toLowerCase())&&(t=this.get("numberFormat",""));let a=Number(e);if(vt(t))try{return this.get("intlLocales")?new Intl.NumberFormat(this.get("intlLocales"),t).format(a):new Intl.NumberFormat(void 0,t).format(a)}catch(e){return"Invalid"}else{t=ni(t);let e,s=this.parseFormat(t,this._root.language);e=a>this.get("negativeBase")?s.positive:a<this.get("negativeBase")?s.negative:s.zero,null==i||e.mod||(e=Nt(e),e.decimals.active=0==a?0:i),r=e.template.split(yt).join(this.applyFormat(a,e))}return!0===this.get("forceLTR")&&(r="‎"+r),r}parseFormat(e,t){const i=t.translateEmpty("_thousandSeparator"),r=t.translateEmpty("_decimalSeparator");let a={positive:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:r},template:"",source:"",parsed:!1},negative:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:r},template:"",source:"",parsed:!1},zero:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:r},template:"",source:"",parsed:!1}},s=(e=e.replace("||",_t)).split("|");return a.positive.source=s[0],void 0===s[2]?a.zero=a.positive:a.zero.source=s[2],void 0===s[1]?a.negative=a.positive:a.negative.source=s[1],Bt(a,((e,t)=>{if(t.parsed)return;let i=t.source;"number"===i.toLowerCase()&&(i=this.get("numberFormat","#,###.#####"));let r=Ar.chunk(i,!0);for(let e=0;e<r.length;e++){let i=r[e];if(i.text=i.text.replace(_t,"|"),"value"===i.type){let e=i.text.match(/[#0.,]+[ ]?[abespABESP%!]?[abespABESP‰!]?/);if(e)if(null===e||""===e[0])t.template+=i.text;else{let r=e[0].match(/[abespABESP%‰!]{2}|[abespABESP%‰]{1}$/);r&&(t.mod=r[0].toLowerCase(),t.modSpacing=!!e[0].match(/[ ]{1}[abespABESP%‰!]{1}$/));let a=e[0].split(".");if(""===a[0]);else{t.thousands.active=(a[0].match(/0/g)||[]).length,t.thousands.passive=(a[0].match(/\#/g)||[]).length+t.thousands.active;let e=a[0].split(",");1===e.length||(t.thousands.interval=(e.pop()||"").length,0===t.thousands.interval&&(t.thousands.interval=-1))}void 0===a[1]||(t.decimals.active=(a[1].match(/0/g)||[]).length,t.decimals.passive=(a[1].match(/\#/g)||[]).length+t.decimals.active),t.template+=i.text.split(e[0]).join(yt)}}else t.template+=i.text}t.parsed=!0})),a}applyFormat(e,t){let i=e<0;e=Math.abs(e);let r="",a="",s=t.mod?t.mod.split(""):[];if(-1!==s.indexOf("b")){let i=this.applyPrefix(e,this.get("bytePrefixes"),-1!==s.indexOf("!"));e=i[0],r=i[1],a=i[2],t.modSpacing&&(a=" "+a)}else if(-1!==s.indexOf("a")){let i=this.applyPrefix(e,e<this.get("smallNumberThreshold")?this.get("smallNumberPrefixes"):this.get("bigNumberPrefixes"),-1!==s.indexOf("!"));e=i[0],r=i[1],a=i[2],t.modSpacing&&(a=" "+a)}else if(-1!==s.indexOf("p")){let t=Math.min(e.toString().length+2,21);e=parseFloat(e.toPrecision(t)),r=this._root.language.translate("_percentPrefix"),a=this._root.language.translate("_percentSuffix"),""==r&&""==a&&(a="%")}else if(-1!==s.indexOf("%")){let t=Math.min(e.toString().length+2,21);e*=100,e=parseFloat(e.toPrecision(t)),a="%"}else if(-1!==s.indexOf("‰")){let t=Math.min(e.toString().length+3,21);e*=1e3,e=parseFloat(e.toPrecision(t)),a="‰"}if(-1!==s.indexOf("e")){let i;i=t.decimals.passive>=0?e.toExponential(t.decimals.passive).split("e"):e.toExponential().split("e"),e=Number(i[0]),a="e"+i[1],t.modSpacing&&(a=" "+a)}else if(0===t.decimals.passive)e=Math.round(e);else if(t.decimals.passive>0){const i=ri(e);if(i>0){const r=Math.pow(10,t.decimals.passive);e=Math.round(parseFloat((e*r).toFixed(i)))/r}}let n="",o=function(e){if(ut(e))return"NaN";if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(0===e&&1/e==-1/0)return"-0";let t=e<0;e=Math.abs(e);let i,r=/^([0-9]+)(?:\.([0-9]+))?(?:e[\+\-]([0-9]+))?$/.exec(""+e),a=r[1],s=r[2]||"";if(void 0===r[3])i=""===s?a:a+"."+s;else{let t=+r[3];if(e<1)i="0."+pt("0",t-1)+a+s;else{let e=t-s.length;i=0===e?a+s:e<0?a+s.slice(0,e)+"."+s.slice(e):a+s+pt("0",e)}}return t?"-"+i:i}(e).split("."),l=o[0];if(l.length<t.thousands.active&&(l=Array(t.thousands.active-l.length+1).join("0")+l),t.thousands.interval>0){let e=[],i=l.split("").reverse().join("");for(let r=0,a=l.length;r<=a;r+=t.thousands.interval){let a=i.substr(r,t.thousands.interval).split("").reverse().join("");""!==a&&e.unshift(a)}l=e.join(t.thousands.separator)}n+=l,1===o.length&&o.push("");let c=o[1];return c.length<t.decimals.active&&(c+=Array(t.decimals.active-c.length+1).join("0")),""!==c&&(n+=t.decimals.separator+c),""===n&&(n="0"),0!==e&&i&&-1===s.indexOf("s")&&(n="-"+n),r&&(n=r+n),a&&(n+=a),n}applyPrefix(e,t,i=!1){let r=e,a="",s="",n=!1,o=1;for(let i=0,l=t.length;i<l;i++)t[i].number<=e&&(0===t[i].number?r=0:(r=e/t[i].number,o=t[i].number),a=t[i].prefix,s=t[i].suffix,n=!0);return!n&&i&&t.length&&0!=e&&(r=e/t[0].number,a=t[0].prefix,s=t[0].suffix,n=!0),n&&(r=parseFloat(r.toPrecision(Math.min(o.toString().length+Math.floor(r).toString().replace(/[^0-9]*/g,"").length,21)))),[r,a,s]}escape(e){return e.replace("||",_t)}unescape(e){return e.replace(_t,"|")}}function jr(e,t){let i=0,r=0,a=1,s=0,n=0,o=0,l=0,c=0;return e.formatToParts(t).forEach((e=>{switch(e.type){case"year":i=+e.value;break;case"month":r=+e.value-1;break;case"day":a=+e.value;break;case"hour":s=+e.value;break;case"minute":n=+e.value;break;case"second":o=+e.value;break;case"fractionalSecond":l=+e.value;break;case"weekday":switch(e.value){case"Sun":c=0;break;case"Mon":c=1;break;case"Tue":c=2;break;case"Wed":c=3;break;case"Thu":c=4;break;case"Fri":c=5;break;case"Sat":c=6}}})),24===s&&(s=0),{year:i,month:r,day:a,hour:s,minute:n,second:o,millisecond:l,weekday:c}}function zr(e,t){const{year:i,month:r,day:a,hour:s,minute:n,second:o,millisecond:l}=jr(e,t);return Date.UTC(i,r,a,s,n,o,l)}class Ur{constructor(e,t){if(Object.defineProperty(this,"_utc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dtf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this.name=e,this._utc=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3}),this._dtf=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3})}static new(e){return new this(e,!0)}convertLocal(e){const t=this.offsetUTC(e),i=e.getTimezoneOffset(),r=new Date(e);r.setUTCMinutes(r.getUTCMinutes()-(t-i));const a=r.getTimezoneOffset();return i!=a&&r.setUTCMinutes(r.getUTCMinutes()+a-i),r}offsetUTC(e){return(zr(this._utc,e)-zr(this._dtf,e))/6e4}parseDate(e){return jr(this._dtf,e)}}class Hr extends Zi{_setDefaults(){this._setDefault("capitalize",!0),this._setDefault("dateFormat","yyyy-MM-dd"),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t,i=!1){let r;void 0!==t&&""!==t||(t=this.get("dateFormat","yyyy-MM-dd"));let a=e;if(vt(t))try{const e=this.get("intlLocales");return e?new Intl.DateTimeFormat(e,t).format(a):new Intl.DateTimeFormat(void 0,t).format(a)}catch(e){return"Invalid"}let s=this.parseFormat(t);const n=this._root.timezone;let o=a;return!n||this._root.utc||i||(a=n.convertLocal(a)),bt(a.getTime())?(r=this.applyFormat(a,s,i,o),this.get("capitalize")&&(r=r.replace(/^.{1}/,r.substr(0,1).toUpperCase())),r):"Invalid date"}applyFormat(e,t,i=!1,r){let a,s,n,o,l,c,h,u,d=t.template,f=e.getTime();this._root.utc&&!i?(a=e.getUTCFullYear(),s=e.getUTCMonth(),n=e.getUTCDay(),o=e.getUTCDate(),l=e.getUTCHours(),c=e.getUTCMinutes(),h=e.getUTCSeconds(),u=e.getUTCMilliseconds()):(a=e.getFullYear(),s=e.getMonth(),n=e.getDay(),o=e.getDate(),l=e.getHours(),c=e.getMinutes(),h=e.getSeconds(),u=e.getMilliseconds());for(let i=0,p=t.parts.length;i<p;i++){let p="";switch(t.parts[i]){case"G":p=this._t(a<0?"_era_bc":"_era_ad");break;case"yyyy":p=Math.abs(a).toString(),a<0&&(p+=this._t("_era_bc"));break;case"yyy":case"yy":case"y":p=Math.abs(a).toString().substr(-t.parts[i].length),a<0&&(p+=this._t("_era_bc"));break;case"YYYY":case"YYY":case"YY":case"Y":let d=ui(e,this._root.utc);p="YYYY"==t.parts[i]?Math.abs(d).toString():Math.abs(d).toString().substr(-t.parts[i].length),d<0&&(p+=this._t("_era_bc"));break;case"u":case"F":case"g":break;case"q":p=""+Math.ceil((e.getMonth()+1)/3);break;case"MMMMM":p=this._t(this._getMonth(s)).substr(0,1);break;case"MMMM":p=this._t(this._getMonth(s));break;case"MMM":p=this._t(this._getShortMonth(s));break;case"MM":p=ai(s+1,2,"0");break;case"M":p=(s+1).toString();break;case"ww":p=ai(hi(e,this._root.utc),2,"0");break;case"w":p=hi(e,this._root.utc).toString();break;case"W":p=di(e,this._root.utc).toString();break;case"dd":p=ai(o,2,"0");break;case"d":p=o.toString();break;case"DD":case"DDD":p=ai(ci(e,this._root.utc).toString(),t.parts[i].length,"0");break;case"D":p=ci(e,this._root.utc).toString();break;case"t":p=this._root.language.translateFunc("_dateOrd").call(this,o);break;case"E":p=(n||7).toString();break;case"EE":p=ai((n||7).toString(),2,"0");break;case"EEE":case"eee":p=this._t(this._getShortWeekday(n));break;case"EEEE":case"eeee":p=this._t(this._getWeekday(n));break;case"EEEEE":case"eeeee":p=this._t(this._getShortWeekday(n)).substr(0,1);break;case"e":case"ee":p=(n-(this._root.locale.firstDayOfWeek||1)+1).toString(),"ee"==t.parts[i]&&(p=ai(p,2,"0"));break;case"a":p=l>=12?this._t("PM"):this._t("AM");break;case"aa":p=l>=12?this._t("P.M."):this._t("A.M.");break;case"aaa":p=l>=12?this._t("P"):this._t("A");break;case"h":p=fi(l).toString();break;case"hh":p=ai(fi(l),2,"0");break;case"H":p=l.toString();break;case"HH":p=ai(l,2,"0");break;case"K":p=fi(l,0).toString();break;case"KK":p=ai(fi(l,0),2,"0");break;case"k":p=(l+1).toString();break;case"kk":p=ai(l+1,2,"0");break;case"m":p=c.toString();break;case"mm":p=ai(c,2,"0");break;case"s":p=h.toString();break;case"ss":p=ai(h,2,"0");break;case"S":case"SS":case"SSS":p=Math.round(u/1e3*Math.pow(10,t.parts[i].length)).toString();break;case"x":p=f.toString();break;case"n":case"nn":case"nnn":p=ai(u,t.parts[i].length,"0");break;case"z":p=pi(r||e,!1,!1,this._root.utc,this._root.timezone?this._root.timezone.name:void 0).replace(/[+-]+[0-9]+$/,"");break;case"zz":p=pi(r||e,!0,!1,this._root.utc,this._root.timezone?this._root.timezone.name:void 0);break;case"zzz":p=pi(r||e,!1,!0,this._root.utc,this._root.timezone?this._root.timezone.name:void 0).replace(/[+-]+[0-9]+$/,"");break;case"zzzz":p=pi(r||e,!0,!0,this._root.utc,this._root.timezone?this._root.timezone.name:void 0);break;case"Z":case"ZZ":let g=this._root.utc?"UTC":this._root.timezone;g instanceof Ur&&(g=g.name);const m=g?gi(g,r||e):e.getTimezoneOffset();let b=Math.abs(m)/60,v=Math.floor(b),y=60*b-60*v;this._root.utc&&(v=0,y=0),"Z"==t.parts[i]?(p="GMT",p+=m>0?"-":"+",p+=ai(v,2)+":"+ai(y,2)):(p=m>0?"-":"+",p+=ai(v,2)+ai(y,2));break;case"i":p=e.toISOString();break;case"I":p=e.toUTCString()}d=d.replace(yt,p)}return d}parseFormat(e){let t={template:"",parts:[]},i=Ar.chunk(e,!0);for(let e=0;e<i.length;e++){let r=i[e];if("value"===r.type){if(r.text.match(/^date$/i)){let e=this.get("dateFormat","yyyy-MM-dd");mt(e)||(e="yyyy-MM-dd"),r.text=e}let e=r.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);if(e)for(let i=0;i<e.length;i++)t.parts.push(e[i]),r.text=r.text.replace(e[i],yt)}t.template+=r.text}return t}_months(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}_getMonth(e){return this._months()[e]}_shortMonths(){return["Jan","Feb","Mar","Apr","May(short)","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}_getShortMonth(e){return this._shortMonths()[e]}_weekdays(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}_getWeekday(e){return this._weekdays()[e]}_shortWeekdays(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}_getShortWeekday(e){return this._shortWeekdays()[e]}parse(e,t,i){if(void 0===i&&(i=this._root.utc),e instanceof Date)return e;if(bt(e))return new Date(e);if("x"==t)return new Date(parseInt(e));let r;mt(e)||(e=e.toString());let a="";t=(t=ni(t)).substr(0,e.length);let s=this.parseFormat(t),n={year:-1,year3:-1,year2:-1,year1:-1,month:-1,monthShort:-1,monthLong:-1,weekdayShort:-1,weekdayLong:-1,day:-1,yearDay:-1,week:-1,hourBase0:-1,hour12Base0:-1,hourBase1:-1,hour12Base1:-1,minute:-1,second:-1,millisecond:-1,millisecondDigits:-1,am:-1,zone:-1,timestamp:-1,iso:-1},o={year:1970,month:0,day:1,hour:0,minute:0,second:0,millisecond:0,timestamp:null,offset:0,utc:i},l=0,c=0;for(let e=0;e<s.parts.length;e++){switch(c=e+l+1,s.parts[e]){case"yyyy":case"YYYY":a+="([0-9]{4})",n.year=c;break;case"yyy":case"YYY":a+="([0-9]{3})",n.year3=c;break;case"yy":case"YY":a+="([0-9]{2})",n.year2=c;break;case"y":case"Y":a+="([0-9]{1})",n.year1=c;break;case"MMMM":a+="("+this.getStringList(this._months()).join("|")+")",n.monthLong=c;break;case"MMM":a+="("+this.getStringList(this._shortMonths()).join("|")+")",n.monthShort=c;break;case"MM":case"M":a+="([0-9]{2}|[0-9]{1})",n.month=c;break;case"ww":case"w":a+="([0-9]{2}|[0-9]{1})",n.week=c;break;case"dd":case"d":a+="([0-9]{2}|[0-9]{1})",n.day=c;break;case"DDD":case"DD":case"D":a+="([0-9]{3}|[0-9]{2}|[0-9]{1})",n.yearDay=c;break;case"dddd":a+="("+this.getStringList(this._weekdays()).join("|")+")",n.weekdayLong=c;break;case"ddd":a+="("+this.getStringList(this._shortWeekdays()).join("|")+")",n.weekdayShort=c;break;case"aaa":case"aa":case"a":a+="("+this.getStringList(["AM","PM","A.M.","P.M.","A","P"]).join("|")+")",n.am=c;break;case"hh":case"h":a+="([0-9]{2}|[0-9]{1})",n.hour12Base1=c;break;case"HH":case"H":a+="([0-9]{2}|[0-9]{1})",n.hourBase0=c;break;case"KK":case"K":a+="([0-9]{2}|[0-9]{1})",n.hour12Base0=c;break;case"kk":case"k":a+="([0-9]{2}|[0-9]{1})",n.hourBase1=c;break;case"mm":case"m":a+="([0-9]{2}|[0-9]{1})",n.minute=c;break;case"ss":case"s":a+="([0-9]{2}|[0-9]{1})",n.second=c;break;case"SSS":case"SS":case"S":a+="([0-9]{3}|[0-9]{2}|[0-9]{1})",n.millisecond=c,n.millisecondDigits=s.parts[e].length;break;case"nnn":case"nn":case"n":a+="([0-9]{3}|[0-9]{2}|[0-9]{1})",n.millisecond=c;break;case"x":a+="([0-9]{1,})",n.timestamp=c;break;case"Z":a+="GMT([-+]+[0-9]{2}:[0-9]{2})",n.zone=c;break;case"ZZ":a+="([\\-+]+[0-9]{2}[0-9]{2})",n.zone=c;break;case"i":a+="([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2})\\.?([0-9]{0,3})([zZ]|[+\\-][0-9]{2}:?[0-9]{2}|$)",n.iso=c,l+=7;break;case"G":case"YYYY":case"YYY":case"YY":case"Y":case"MMMMM":case"W":case"EEEEE":case"EEEE":case"EEE":case"EE":case"E":case"eeeee":case"eeee":case"eee":case"ee":case"e":case"zzzz":case"zzz":case"zz":case"z":case"t":l--}a+="[^0-9]*"}let h=new RegExp(a),u=e.match(h);if(u){if(n.year>-1&&(o.year=parseInt(u[n.year])),n.year3>-1){let e=parseInt(u[n.year3]);e+=1e3,o.year=e}if(n.year2>-1){let e=parseInt(u[n.year2]);e+=e>50?1e3:2e3,o.year=e}if(n.year1>-1){let e=parseInt(u[n.year1]);e=10*Math.floor((new Date).getFullYear()/10)+e,o.year=e}if(n.monthLong>-1&&(o.month=this.resolveMonth(u[n.monthLong])),n.monthShort>-1&&(o.month=this.resolveShortMonth(u[n.monthShort])),n.month>-1&&(o.month=parseInt(u[n.month])-1),n.week>-1&&-1===n.day&&(o.month=0,o.day=function(e,t,i=1,r=!1){let a=new Date(t,0,4,0,0,0,0);return r&&a.setUTCFullYear(t),7*e+i-((a.getDay()||7)+3)}(parseInt(u[n.week]),o.year,1,i)),n.day>-1&&(o.day=parseInt(u[n.day])),n.yearDay>-1&&(o.month=0,o.day=parseInt(u[n.yearDay])),n.hourBase0>-1&&(o.hour=parseInt(u[n.hourBase0])),n.hourBase1>-1&&(o.hour=parseInt(u[n.hourBase1])-1),n.hour12Base0>-1){let e=parseInt(u[n.hour12Base0]);11==e&&(e=0),n.am>-1&&!this.isAm(u[n.am])&&(e+=12),o.hour=e}if(n.hour12Base1>-1){let e=parseInt(u[n.hour12Base1]);12==e&&(e=0),n.am>-1&&!this.isAm(u[n.am])&&(e+=12),o.hour=e}if(n.minute>-1&&(o.minute=parseInt(u[n.minute])),n.second>-1&&(o.second=parseInt(u[n.second])),n.millisecond>-1){let e=parseInt(u[n.millisecond]);2==n.millisecondDigits?e*=10:1==n.millisecondDigits&&(e*=100),o.millisecond=e}if(n.timestamp>-1){o.timestamp=parseInt(u[n.timestamp]);const e=new Date(o.timestamp);o.year=e.getUTCFullYear(),o.month=e.getUTCMonth(),o.day=e.getUTCDate(),o.hour=e.getUTCHours(),o.minute=e.getUTCMinutes(),o.second=e.getUTCSeconds(),o.millisecond=e.getUTCMilliseconds()}n.zone>-1&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),u[n.zone])),n.iso>-1&&(o.year=dt(u[n.iso+0]),o.month=dt(u[n.iso+1])-1,o.day=dt(u[n.iso+2]),o.hour=dt(u[n.iso+3]),o.minute=dt(u[n.iso+4]),o.second=dt(u[n.iso+5]),o.millisecond=dt(u[n.iso+6]),"Z"==u[n.iso+7]||"z"==u[n.iso+7]?o.utc=!0:""!=u[n.iso+7]&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),u[n.iso+7]))),r=o.utc?new Date(Date.UTC(o.year,o.month,o.day,o.hour,o.minute,o.second,o.millisecond)):new Date(o.year,o.month,o.day,o.hour,o.minute+o.offset,o.second,o.millisecond)}else r=new Date(e);return r}resolveTimezoneOffset(e,t){if(t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/)){let i=t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/),r=i[1],a=i[2],s=i[3],n=60*parseInt(a)+parseInt(s);return"+"==r&&(n*=-1),n-(e||new Date).getTimezoneOffset()}return 0}resolveMonth(e){let t=this._months().indexOf(e);return t>-1||!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._months()).indexOf(e),t>-1)?t:0}resolveShortMonth(e){let t=this._shortMonths().indexOf(e);return t>-1?t:(t=this._months().indexOf(e),t>-1||this._root.language&&!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._shortMonths()).indexOf(e),t>-1)?t:0)}isAm(e){return this.getStringList(["AM","A.M.","A"]).indexOf(e.toUpperCase())>-1}getStringList(e){let t=[];for(let i=0;i<e.length;i++)this._root.language?t.push(li(this._t(e[i]))):t.push(li(e[i]));return t}}class Wr extends Zi{constructor(){super(...arguments),Object.defineProperty(this,"_unitAliases",{enumerable:!0,configurable:!0,writable:!0,value:{Y:"y",D:"d",H:"h",K:"h",k:"h",n:"S"}})}_setDefaults(){const e="_duration_millisecond",t="_duration_second",i="_duration_minute",r="_duration_hour",a="_duration_day",s="_duration_week",n="_duration_month",o="_minute",l="_hour",c="_day",h="_week",u="_week",d="_year";this._setDefault("negativeBase",0),this._setDefault("baseUnit","second"),this._setDefault("durationFormats",{millisecond:{millisecond:this._t(e),second:this._t(e+"_second"),minute:this._t(e+o),hour:this._t(e+l),day:this._t(e+c),week:this._t(e+h),month:this._t(e+u),year:this._t(e+d)},second:{second:this._t(t),minute:this._t(t+o),hour:this._t(t+l),day:this._t(t+c),week:this._t(t+h),month:this._t(t+u),year:this._t(t+d)},minute:{minute:this._t(i),hour:this._t(i+l),day:this._t(i+c),week:this._t(i+h),month:this._t(i+u),year:this._t(i+d)},hour:{hour:this._t(r),day:this._t(r+c),week:this._t(r+h),month:this._t(r+u),year:this._t(r+d)},day:{day:this._t(a),week:this._t(a+h),month:this._t(a+u),year:this._t(a+d)},week:{week:this._t(s),month:this._t(s+u),year:this._t(s+d)},month:{month:this._t(n),year:this._t(n+d)},year:{year:this._t("_duration_year")}}),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t,i){let r=i||this.get("baseUnit");void 0!==t&&""!==t||(t=null!=this.get("durationFormat")?this.get("durationFormat"):this.getFormat(dt(e),void 0,r)),t=ni(t);let a,s=this.parseFormat(t,r),n=Number(e);a=n>this.get("negativeBase")?s.positive:n<this.get("negativeBase")?s.negative:s.zero;let o=this.applyFormat(n,a);return""!==a.color&&(o="["+a.color+"]"+o+"[/]"),o}parseFormat(e,t){let i=t||this.get("baseUnit"),r={positive:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1},negative:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1},zero:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1}},a=(e=e.replace("||",_t)).split("|");return r.positive.source=a[0],void 0===a[2]?r.zero=r.positive:r.zero.source=a[2],void 0===a[1]?r.negative=r.positive:r.negative.source=a[1],Bt(r,((e,t)=>{if(t.parsed)return;let i=t.source,r=[];r=t.source.match(/^\[([^\]]*)\]/),r&&r.length&&""!==r[0]&&(i=t.source.substr(r[0].length),t.color=r[1]);let a=Ar.chunk(i,!0);for(let e=0;e<a.length;e++){let i=a[e];if(i.text=i.text.replace(_t,"|"),"value"===i.type){i.text.match(/[yYMdDwhHKkmsSn]+a/)&&(t.absolute=!0,i.text=i.text.replace(/([yYMdDwhHKkmsSn]+)a/,"$1"));let e=i.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);if(e)for(let r=0;r<e.length;r++)null==e[r]&&(e[r]=this._unitAliases[e[r]]),t.parts.push(e[r]),i.text=i.text.replace(e[r],yt)}t.template+=i.text}t.parsed=!0})),r}applyFormat(e,t){let i=!t.absolute&&e<this.get("negativeBase");e=Math.abs(e);let r=this.toTimeStamp(e,t.baseUnit),a=t.template;const s={millisecond:0,second:0,minute:0,hour:0,day:0,week:0,month:0,year:0};for(let e=0,i=t.parts.length;e<i;e++){let a,n=t.parts[e],o=this._toTimeUnit(n.substr(0,1));const l=this._getUnitValue(o);a=e<i-1?Math.floor(r/l):Math.round(r/l),s[o]+=a,r-=a*l}Bt(s,((e,t)=>{"millisecond"==e&&1e3==t?(s.second++,s.millisecond=0):"second"==e&&60==t?(s.minute++,s.second=0):"minute"==e&&60==t?(s.hour++,s.minute=0):"hour"==e&&24==t?(s.day++,s.hour=0):"day"==e&&7==t?(s.week++,s.day=0):"day"==e&&30==t?(s.month++,s.day=0):"month"==e&&12==t&&(s.year++,s.month=0)}));for(let e=0,i=t.parts.length;e<i;e++){let i=t.parts[e],r=this._toTimeUnit(i.substr(0,1)),n=i.length;a=a.replace(yt,ai(s[r],n,"0"))}return i&&(a="-"+a),a}toTimeStamp(e,t){return e*this._getUnitValue(t)}_toTimeUnit(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year"}}getFormat(e,t,i){if(null!=this.get("durationFormat"))return this.get("durationFormat");if(i||(i=this.get("baseUnit")),null!=t&&e!=t){e=Math.abs(e),t=Math.abs(t);let r=this.getValueUnit(Math.max(e,t),i);return this.get("durationFormats")[i][r]}{let t=this.getValueUnit(e,i);return this.get("durationFormats")[i][t]}}getValueUnit(e,t){let i;t||(t=this.get("baseUnit"));let r=this.getMilliseconds(e,t);return function(e,t){for(let i in e)if(jt(e,i)&&!t(i,e[i]))break}(this._getUnitValues(),((e,a)=>{if(e==t||i){if(r/a<=1)return i||(i=e),!1;i=e}return!0})),i}getMilliseconds(e,t){return t||(t=this.get("baseUnit")),e*this._getUnitValue(t)}_getUnitValue(e){return this._getUnitValues()[e]}_getUnitValues(){return{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2592e6,year:31536e6}}}const Vr={firstDayOfWeek:1,_decimalSeparator:".",_thousandSeparator:",",_percentPrefix:null,_percentSuffix:"%",_big_number_suffix_3:"k",_big_number_suffix_6:"M",_big_number_suffix_9:"G",_big_number_suffix_12:"T",_big_number_suffix_15:"P",_big_number_suffix_18:"E",_big_number_suffix_21:"Z",_big_number_suffix_24:"Y",_small_number_suffix_3:"m",_small_number_suffix_6:"μ",_small_number_suffix_9:"n",_small_number_suffix_12:"p",_small_number_suffix_15:"f",_small_number_suffix_18:"a",_small_number_suffix_21:"z",_small_number_suffix_24:"y",_byte_suffix_B:"B",_byte_suffix_KB:"KB",_byte_suffix_MB:"MB",_byte_suffix_GB:"GB",_byte_suffix_TB:"TB",_byte_suffix_PB:"PB",_date:"yyyy-MM-dd",_date_millisecond:"mm:ss SSS",_date_millisecond_full:"HH:mm:ss SSS",_date_second:"HH:mm:ss",_date_second_full:"HH:mm:ss",_date_minute:"HH:mm",_date_minute_full:"HH:mm - MMM dd, yyyy",_date_hour:"HH:mm",_date_hour_full:"HH:mm - MMM dd, yyyy",_date_day:"MMM dd",_date_day_full:"MMM dd, yyyy",_date_week:"ww",_date_week_full:"MMM dd, yyyy",_date_month:"MMM",_date_month_full:"MMM, yyyy",_date_year:"yyyy",_duration_millisecond:"SSS",_duration_millisecond_second:"ss.SSS",_duration_millisecond_minute:"mm:ss SSS",_duration_millisecond_hour:"hh:mm:ss SSS",_duration_millisecond_day:"d'd' mm:ss SSS",_duration_millisecond_week:"d'd' mm:ss SSS",_duration_millisecond_month:"M'm' dd'd' mm:ss SSS",_duration_millisecond_year:"y'y' MM'm' dd'd' mm:ss SSS",_duration_second:"ss",_duration_second_minute:"mm:ss",_duration_second_hour:"hh:mm:ss",_duration_second_day:"d'd' hh:mm:ss",_duration_second_week:"d'd' hh:mm:ss",_duration_second_month:"M'm' dd'd' hh:mm:ss",_duration_second_year:"y'y' MM'm' dd'd' hh:mm:ss",_duration_minute:"mm",_duration_minute_hour:"hh:mm",_duration_minute_day:"d'd' hh:mm",_duration_minute_week:"d'd' hh:mm",_duration_minute_month:"M'm' dd'd' hh:mm",_duration_minute_year:"y'y' MM'm' dd'd' hh:mm",_duration_hour:"hh'h'",_duration_hour_day:"d'd' hh'h'",_duration_hour_week:"d'd' hh'h'",_duration_hour_month:"M'm' dd'd' hh'h'",_duration_hour_year:"y'y' MM'm' dd'd' hh'h'",_duration_day:"d'd'",_duration_day_week:"d'd'",_duration_day_month:"M'm' dd'd'",_duration_day_year:"y'y' MM'm' dd'd'",_duration_week:"w'w'",_duration_week_month:"w'w'",_duration_week_year:"w'w'",_duration_month:"M'm'",_duration_month_year:"y'y' MM'm'",_duration_year:"y'y'",_era_ad:"AD",_era_bc:"BC",A:"",P:"",AM:"",PM:"","A.M.":"","P.M.":"",January:"",February:"",March:"",April:"",May:"",June:"",July:"",August:"",September:"",October:"",November:"",December:"",Jan:"",Feb:"",Mar:"",Apr:"","May(short)":"May",Jun:"",Jul:"",Aug:"",Sep:"",Oct:"",Nov:"",Dec:"",Sunday:"",Monday:"",Tuesday:"",Wednesday:"",Thursday:"",Friday:"",Saturday:"",Sun:"",Mon:"",Tue:"",Wed:"",Thu:"",Fri:"",Sat:"",_dateOrd:function(e){let t="th";if(e<11||e>13)switch(e%10){case 1:t="st";break;case 2:t="nd";break;case 3:t="rd"}return t},"Zoom Out":"",Play:"",Stop:"",Legend:"","Press ENTER to toggle":"",Loading:"",Home:"",Chart:"","Serial chart":"","X/Y chart":"","Pie chart":"","Gauge chart":"","Radar chart":"","Sankey diagram":"","Flow diagram":"","Chord diagram":"","TreeMap chart":"","Force directed tree":"","Sliced chart":"",Series:"","Candlestick Series":"","OHLC Series":"","Column Series":"","Line Series":"","Pie Slice Series":"","Funnel Series":"","Pyramid Series":"","X/Y Series":"",Map:"","Press ENTER to zoom in":"","Press ENTER to zoom out":"","Use arrow keys to zoom in and out":"","Use plus and minus keys on your keyboard to zoom in and out":"",Export:"",Image:"",Data:"",Print:"","Press ENTER or use arrow keys to navigate":"","Press ENTER to open":"","Press ENTER to print.":"","Press ENTER to export as %1.":"","(Press ESC to close this message)":"","Image Export Complete":"","Export operation took longer than expected. Something might have gone wrong.":"","Saved from":"",PNG:"",JPG:"",GIF:"",SVG:"",PDF:"",JSON:"",CSV:"",XLSX:"",HTML:"","Use TAB to select grip buttons or left and right arrows to change selection":"","Use left and right arrows to move selection":"","Use left and right arrows to move left selection":"","Use left and right arrows to move right selection":"","Use TAB select grip buttons or up and down arrows to change selection":"","Use up and down arrows to move selection":"","Use up and down arrows to move lower selection":"","Use up and down arrows to move upper selection":"","From %1 to %2":"","From %1":"","To %1":"","No parser available for file: %1":"","Error parsing file: %1":"","Unable to load file: %1":"","Invalid date":"",Close:"",Minimize:""};class $r extends Zi{_setDefaults(){this.setPrivate("defaultLocale",Vr),super._setDefaults()}translate(e,t,...i){t||(t=this._root.locale||this.getPrivate("defaultLocale"));let r=e,a=t[e];if(null===a)r="";else if(null!=a)a&&(r=a);else if(t!==this.getPrivate("defaultLocale"))return this.translate(e,this.getPrivate("defaultLocale"),...i);if(i.length)for(let e=i.length,t=0;t<e;++t)r=r.split("%"+(t+1)).join(i[t]);return r}translateAny(e,t,...i){return this.translate(e,t,...i)}setTranslationAny(e,t,i){(i||this._root.locale)[e]=t}setTranslationsAny(e,t){Bt(e,((e,i)=>{this.setTranslationAny(e,i,t)}))}translateEmpty(e,t,...i){let r=this.translate(e,t,...i);return r==e?"":r}translateFunc(e,t){return this._root.locale[e]?this._root.locale[e]:t!==this.getPrivate("defaultLocale")?this.translateFunc(e,this.getPrivate("defaultLocale")):()=>""}translateAll(e,t){return this.isDefault()?e:xt(e,(e=>this.translate(e,t)))}isDefault(){return this.getPrivate("defaultLocale")===this._root.locale}}class Xr{constructor(e,t){if(Object.defineProperty(this,"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rules",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._root=e,!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`")}static new(e){const t=new this(e,!0);return t.setupDefaultRules(),t}setupDefaultRules(){}_lookupRules(e){return this._rules[e]}ruleRaw(e,t=[]){let i=this._rules[e];i||(i=this._rules[e]=[]),t.sort(Vi);const{index:r,found:a}=function(e,t){let i=0,r=e.length,a=!1;for(;i<r;){const s=i+r>>1,n=t(e[s]);n<0?i=s+1:0===n?(a=!0,i=s+1):r=s}return{found:a,index:a?i-1:i}}(i,(e=>{const i=Vi(e.tags.length,t.length);return 0===i?$i(e.tags,t,Vi):i}));if(a)return i[r].template;{const e=ir.new({});return i.splice(r,0,{tags:t,template:e}),e}}rule(e,t=[]){return this.ruleRaw(e,t)}}function Yr(e,t,i,r){e.set(t,i.get(r)),i.on(r,(i=>{e.set(t,i)}))}class Gr extends Xr{setupDefaultRules(){super.setupDefaultRules();const e=this._root.language,t=this._root.interfaceColors,i=this._root.horizontalLayout,r=this._root.verticalLayout,a=this.rule.bind(this);a("InterfaceColors").setAll({stroke:ki.fromHex(15066597),fill:ki.fromHex(15987699),primaryButton:ki.fromHex(6788316),primaryButtonHover:ki.fromHex(6779356),primaryButtonDown:ki.fromHex(6872182),primaryButtonActive:ki.fromHex(6872182),primaryButtonDisabled:ki.fromHex(14342874),primaryButtonTextDisabled:ki.fromHex(16777215),primaryButtonText:ki.fromHex(16777215),primaryButtonStroke:ki.fromHex(16777215),secondaryButton:ki.fromHex(14277081),secondaryButtonHover:ki.fromHex(10724259),secondaryButtonDown:ki.fromHex(9276813),secondaryButtonActive:ki.fromHex(15132390),secondaryButtonText:ki.fromHex(0),secondaryButtonStroke:ki.fromHex(16777215),grid:ki.fromHex(0),background:ki.fromHex(16777215),alternativeBackground:ki.fromHex(0),text:ki.fromHex(0),alternativeText:ki.fromHex(16777215),disabled:ki.fromHex(11382189),positive:ki.fromHex(5288704),negative:ki.fromHex(11730944)});{const e=a("ColorSet");e.setAll({passOptions:{hue:.05,saturation:0,lightness:0},colors:[ki.fromHex(6797276)],step:1,reuse:!1,startIndex:0}),e.setPrivate("currentStep",0),e.setPrivate("currentPass",0)}a("Entity").setAll({stateAnimationDuration:0,stateAnimationEasing:zi(ji)}),a("Component").setAll({interpolationDuration:0,interpolationEasing:zi(ji)}),a("Sprite").setAll({visible:!0,scale:1,opacity:1,rotation:0,position:"relative",tooltipX:ct,tooltipY:ct,tooltipPosition:"fixed",isMeasured:!0}),a("Sprite").states.create("default",{visible:!0,opacity:1}),a("Container").setAll({interactiveChildren:!0,setStateOnChildren:!1}),a("Graphics").setAll({strokeWidth:1}),a("Chart").setAll({width:lt,height:lt,interactiveChildren:!1}),a("ZoomableContainer").setAll({width:lt,height:lt,wheelable:!0,pinchZoom:!0,maxZoomLevel:32,minZoomLevel:1,zoomStep:2,animationEasing:zi(ji),animationDuration:600,maxPanOut:.4}),a("Sprite",["horizontal","center"]).setAll({centerX:ct,x:ct}),a("Sprite",["vertical","center"]).setAll({centerY:ct,y:ct}),a("Container",["horizontal","layout"]).setAll({layout:i}),a("Container",["vertical","layout"]).setAll({layout:r}),a("Pattern").setAll({repetition:"repeat",width:50,height:50,rotation:0,fillOpacity:1}),a("LinePattern").setAll({gap:6,colorOpacity:1,width:49,height:49}),a("RectanglePattern").setAll({gap:6,checkered:!1,centered:!0,maxWidth:5,maxHeight:5,width:48,height:48,strokeWidth:0}),a("CirclePattern").setAll({gap:5,checkered:!1,centered:!1,radius:3,strokeWidth:0,width:45,height:45}),a("GrainPattern").setAll({width:200,height:200,colors:[ki.fromHex(0)],size:1,horizontalGap:0,verticalGap:0,density:1,minOpacity:0,maxOpacity:.2});{const e=a("PatternSet");e.setAll({step:1}),Yr(e,"color",t,"stroke")}a("LinearGradient").setAll({rotation:90}),a("Legend").setAll({fillField:"fill",strokeField:"stroke",nameField:"name",layout:xr.new(this._root,{}),layer:30,clickTarget:"itemContainer"}),a("Container",["legend","item","itemcontainer"]).setAll({paddingLeft:5,paddingRight:5,paddingBottom:5,paddingTop:5,layout:i,setStateOnChildren:!0,interactiveChildren:!1,ariaChecked:!0,focusable:!0,ariaLabel:e.translate("Press ENTER to toggle"),role:"checkbox"});{const e=a("Rectangle",["legend","item","background"]);e.setAll({fillOpacity:0}),Yr(e,"fill",t,"background")}a("Container",["legend","marker"]).setAll({setStateOnChildren:!0,centerY:ct,paddingLeft:0,paddingRight:0,paddingBottom:0,paddingTop:0,width:18,height:18}),a("RoundedRectangle",["legend","marker","rectangle"]).setAll({width:lt,height:lt,cornerRadiusBL:3,cornerRadiusTL:3,cornerRadiusBR:3,cornerRadiusTR:3});{const e=a("RoundedRectangle",["legend","marker","rectangle"]).states.create("disabled",{});Yr(e,"fill",t,"disabled"),Yr(e,"stroke",t,"disabled")}a("Label",["legend","label"]).setAll({centerY:ct,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,populateText:!0}),Yr(a("Label",["legend","label"]).states.create("disabled",{}),"fill",t,"disabled"),a("Label",["legend","value","label"]).setAll({centerY:ct,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,width:50,centerX:lt,populateText:!0}),Yr(a("Label",["legend","value","label"]).states.create("disabled",{}),"fill",t,"disabled"),a("HeatLegend").setAll({stepCount:1}),a("RoundedRectangle",["heatlegend","marker"]).setAll({cornerRadiusTR:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusBL:0}),a("RoundedRectangle",["vertical","heatlegend","marker"]).setAll({height:lt,width:15}),a("RoundedRectangle",["horizontal","heatlegend","marker"]).setAll({width:lt,height:15}),a("HeatLegend",["vertical"]).setAll({height:lt}),a("HeatLegend",["horizontal"]).setAll({width:lt}),a("Label",["heatlegend","start"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5}),a("Label",["heatlegend","end"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5});{const e=a("Label");e.setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontSize:"1em",populateText:!1}),Yr(e,"fill",t,"text")}a("RadialLabel").setAll({textType:"regular",centerY:ct,centerX:ct,inside:!1,radius:0,baseRadius:lt,orientation:"auto",textAlign:"center"}),a("EditableLabel").setAll({editOn:"click",themeTags:["editablelabel"],multiLine:!0}),a("RoundedRectangle",["editablelabel","background"]).setAll({fillOpacity:0,fill:ki.fromHex(0),cornerRadiusBL:3,cornerRadiusBR:3,cornerRadiusTL:3,cornerRadiusTR:3,strokeOpacity:0,stroke:ki.fromHex(0)}),a("RoundedRectangle",["editablelabel","background"]).states.create("active",{strokeOpacity:.2}),a("RoundedRectangle").setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8}),a("PointedRectangle").setAll({pointerBaseWidth:15,pointerLength:10,cornerRadius:8}),a("Slice").setAll({shiftRadius:0,dRadius:0,dInnerRadius:0});{const e=a("Tick");e.setAll({strokeOpacity:.15,isMeasured:!1,length:4.5,position:"absolute",crisp:!0}),Yr(e,"stroke",t,"grid")}a("Bullet").setAll({locationX:.5,locationY:.5}),a("Tooltip").setAll({position:"absolute",getFillFromSprite:!0,getStrokeFromSprite:!1,autoTextColor:!0,paddingTop:9,paddingBottom:8,paddingLeft:10,paddingRight:10,marginBottom:5,pointerOrientation:"vertical",centerX:ct,centerY:ct,animationEasing:zi(ji),exportable:!1}),a("Polygon").setAll({animationEasing:zi(ji)}),a("PointedRectangle",["tooltip","background"]).setAll({strokeOpacity:.9,cornerRadius:4,pointerLength:4,pointerBaseWidth:8,fillOpacity:.9,stroke:ki.fromHex(16777215)});{const e=a("Label",["tooltip"]);e.setAll({role:"tooltip",populateText:!0,paddingRight:0,paddingTop:0,paddingLeft:0,paddingBottom:0}),Yr(e,"fill",t,"alternativeText")}a("Button").setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,interactive:!0,layout:i,interactiveChildren:!1,setStateOnChildren:!0,focusable:!0}),a("Button").states.create("hover",{}),a("Button").states.create("down",{stateAnimationDuration:0}),a("Button").states.create("active",{}),a("Button").states.create("disabled",{forceInactive:!0});{const e=a("RoundedRectangle",["button","background"]);Yr(e,"fill",t,"primaryButton"),Yr(e,"stroke",t,"primaryButtonStroke")}Yr(a("RoundedRectangle",["button","background"]).states.create("hover",{}),"fill",t,"primaryButtonHover"),Yr(a("RoundedRectangle",["button","background"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"primaryButtonDown"),Yr(a("RoundedRectangle",["button","background"]).states.create("active",{}),"fill",t,"primaryButtonActive"),Yr(a("RoundedRectangle",["button","background"]).states.create("disabled",{}),"fill",t,"primaryButtonDisabled"),Yr(a("Graphics",["button","icon"]).states.create("disabled",{}),"fill",t,"primaryButtonTextDisabled"),Yr(a("Label",["button"]).states.create("disabled",{}),"fill",t,"primaryButtonTextDisabled");{const e=a("Graphics",["button","icon"]);e.setAll({forceInactive:!0}),Yr(e,"stroke",t,"primaryButtonText")}Yr(a("Label",["button"]),"fill",t,"primaryButtonText"),a("Button",["zoom"]).setAll({paddingTop:18,paddingBottom:18,paddingLeft:12,paddingRight:12,centerX:46,centerY:-10,y:0,x:lt,role:"button",ariaLabel:e.translate("Zoom Out"),layer:30});{const e=a("RoundedRectangle",["background","button","zoom"]);e.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),Yr(e,"fill",t,"primaryButton")}Yr(a("RoundedRectangle",["background","button","zoom"]).states.create("hover",{}),"fill",t,"primaryButtonHover"),Yr(a("RoundedRectangle",["background","button","zoom"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"primaryButtonDown");{const e=a("Graphics",["icon","button","zoom"]);e.setAll({crisp:!0,strokeOpacity:.7,draw:e=>{e.moveTo(0,0),e.lineTo(12,0)}}),Yr(e,"stroke",t,"primaryButtonText")}a("Button",["resize"]).setAll({paddingTop:9,paddingBottom:9,paddingLeft:13,paddingRight:13,draggable:!0,centerX:ct,centerY:ct,position:"absolute",role:"slider",ariaValueMin:"0",ariaValueMax:"100",ariaLabel:e.translate("Use up and down arrows to move selection")});{const e=a("RoundedRectangle",["background","resize","button"]);e.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),Yr(e,"fill",t,"secondaryButton"),Yr(e,"stroke",t,"secondaryButtonStroke")}Yr(a("RoundedRectangle",["background","resize","button"]).states.create("hover",{}),"fill",t,"secondaryButtonHover"),Yr(a("RoundedRectangle",["background","resize","button"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"secondaryButtonDown");{const e=a("Graphics",["resize","button","icon"]);e.setAll({interactive:!1,crisp:!0,strokeOpacity:.5,draw:e=>{e.moveTo(0,.5),e.lineTo(0,12.5),e.moveTo(4,.5),e.lineTo(4,12.5)}}),Yr(e,"stroke",t,"secondaryButtonText")}a("Button",["resize","vertical"]).setAll({rotation:90,cursorOverStyle:"ns-resize"}),a("Button",["resize","horizontal"]).setAll({cursorOverStyle:"ew-resize"}),a("Button",["play"]).setAll({paddingTop:13,paddingBottom:13,paddingLeft:14,paddingRight:14,ariaLabel:e.translate("Play"),toggleKey:"active"});{const e=a("RoundedRectangle",["play","background"]);e.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),Yr(e,"fill",t,"primaryButton")}{const e=a("Graphics",["play","icon"]);e.setAll({stateAnimationDuration:0,dx:1,draw:e=>{e.moveTo(0,-5),e.lineTo(8,0),e.lineTo(0,5),e.lineTo(0,-5)}}),Yr(e,"fill",t,"primaryButtonText")}a("Graphics",["play","icon"]).states.create("default",{stateAnimationDuration:0}),a("Graphics",["play","icon"]).states.create("active",{stateAnimationDuration:0,draw:e=>{e.moveTo(-4,-5),e.lineTo(-1,-5),e.lineTo(-1,5),e.lineTo(-4,5),e.lineTo(-4,-5),e.moveTo(4,-5),e.lineTo(1,-5),e.lineTo(1,5),e.lineTo(4,5),e.lineTo(4,-5)}}),a("Button",["switch"]).setAll({paddingTop:4,paddingBottom:4,paddingLeft:4,paddingRight:4,ariaLabel:e.translate("Press ENTER to toggle"),toggleKey:"active",width:40,height:24,layout:null});{const e=a("RoundedRectangle",["switch","background"]);e.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),Yr(e,"fill",t,"primaryButton")}{const e=a("Circle",["switch","icon"]);e.setAll({radius:8,centerY:0,centerX:0,dx:0}),Yr(e,"fill",t,"primaryButtonText")}a("Graphics",["switch","icon"]).states.create("active",{dx:16}),a("Scrollbar").setAll({start:0,end:1,layer:30,animationEasing:zi(ji)}),a("Scrollbar",["vertical"]).setAll({marginRight:13,marginLeft:13,minWidth:12,height:lt}),a("Scrollbar",["horizontal"]).setAll({marginTop:13,marginBottom:13,minHeight:12,width:lt}),this.rule("Button",["scrollbar"]).setAll({exportable:!1});{const e=a("RoundedRectangle",["scrollbar","main","background"]);e.setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8,fillOpacity:.8}),Yr(e,"fill",t,"fill")}{const e=a("RoundedRectangle",["scrollbar","thumb"]);e.setAll({role:"slider",ariaLive:"polite",position:"absolute",draggable:!0}),Yr(e,"fill",t,"secondaryButton")}Yr(a("RoundedRectangle",["scrollbar","thumb"]).states.create("hover",{}),"fill",t,"secondaryButtonHover"),Yr(a("RoundedRectangle",["scrollbar","thumb"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"secondaryButtonDown"),a("RoundedRectangle",["scrollbar","thumb","vertical"]).setAll({x:ct,width:lt,centerX:ct,ariaLabel:e.translate("Use up and down arrows to move selection")}),a("RoundedRectangle",["scrollbar","thumb","horizontal"]).setAll({y:ct,centerY:ct,height:lt,ariaLabel:e.translate("Use left and right arrows to move selection")});{const e=a("PointedRectangle",["axis","tooltip","background"]);e.setAll({cornerRadius:0}),Yr(e,"fill",t,"alternativeBackground")}a("Label",["axis","tooltip"]).setAll({role:void 0}),a("Label",["axis","tooltip","y"]).setAll({textAlign:"right"}),a("Label",["axis","tooltip","y","opposite"]).setAll({textAlign:"left"}),a("Label",["axis","tooltip","x"]).setAll({textAlign:"center"}),a("Tooltip",["categoryaxis"]).setAll({labelText:"{category}"}),a("Star").setAll({spikes:5,innerRadius:5,radius:10}),a("Tooltip",["stock"]).setAll({paddingTop:6,paddingBottom:5,paddingLeft:7,paddingRight:7}),a("Tooltip",["indicator"]).setAll({forceHidden:!0}),a("PointedRectangle",["tooltip","stock","axis"]).setAll({pointerLength:0,pointerBaseWidth:0,cornerRadius:3}),a("Label",["tooltip","stock"]).setAll({fontSize:"0.8em"}),a("SpriteResizer").setAll({rotationStep:10,isMeasured:!1}),a("Container",["resizer","grip"]).states.create("hover",{});{const e=a("RoundedRectangle",["resizer","grip"]);e.setAll({strokeOpacity:.7,strokeWidth:1,fillOpacity:1,width:12,height:12}),Yr(e,"fill",t,"background"),Yr(e,"stroke",t,"alternativeBackground")}{const e=a("RoundedRectangle",["resizer","grip","outline"]);e.setAll({strokeOpacity:0,fillOpacity:0,width:20,height:20}),e.states.create("hover",{fillOpacity:.3}),Yr(e,"fill",t,"alternativeBackground")}a("RoundedRectangle",["resizer","grip","left"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0}),a("RoundedRectangle",["resizer","grip","right"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0});{const e=a("Rectangle",["resizer","rectangle"]);e.setAll({strokeDasharray:[2,2],strokeOpacity:.5,strokeWidth:1}),Yr(e,"stroke",t,"alternativeBackground")}a("Graphics",["button","plus","icon"]).setAll({x:ct,y:ct,draw:e=>{e.moveTo(-4,0),e.lineTo(4,0),e.moveTo(0,-4),e.lineTo(0,4)}}),a("Graphics",["button","minus","icon"]).setAll({x:ct,y:ct,draw:e=>{e.moveTo(-4,0),e.lineTo(4,0)}}),a("Graphics",["button","home","icon"]).setAll({x:ct,y:ct,svgPath:"M 8 -1 L 6 -1 L 6 7 L 2 7 L 2 1 L -2 1 L -2 7 L -6 7 L -6 -1 L -8 -1 L 0 -9 L 8 -1 Z M 8 -1"}),a("Button",["zoomtools"]).setAll({marginTop:1,marginBottom:2}),a("ZoomTools").setAll({x:lt,centerX:lt,y:lt,centerY:lt,paddingRight:10,paddingBottom:10})}}class Kr{constructor(e=1,t=0,i=0,r=1,a=0,s=0){Object.defineProperty(this,"a",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"b",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"c",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"d",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.a=e,this.b=t,this.c=i,this.d=r,this.tx=a,this.ty=s}setTransform(e,t,i,r,a,s=1){this.a=Math.cos(a)*s,this.b=Math.sin(a)*s,this.c=-Math.sin(a)*s,this.d=Math.cos(a)*s,this.tx=e-(i*this.a+r*this.c),this.ty=t-(i*this.b+r*this.d)}apply(e){return{x:this.a*e.x+this.c*e.y+this.tx,y:this.b*e.x+this.d*e.y+this.ty}}applyInverse(e){const t=1/(this.a*this.d+this.c*-this.b);return{x:this.d*t*e.x+-this.c*t*e.y+(this.ty*this.c-this.tx*this.d)*t,y:this.a*t*e.y+-this.b*t*e.x+(-this.ty*this.a+this.tx*this.b)*t}}append(e){const t=this.a,i=this.b,r=this.c,a=this.d;this.a=e.a*t+e.b*r,this.b=e.a*i+e.b*a,this.c=e.c*t+e.d*r,this.d=e.c*i+e.d*a,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*i+e.ty*a+this.ty}prepend(e){const t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){const t=this.a,i=this.c;this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty}copyFrom(e){this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty}}var qr=2*Math.PI,Zr=function(e,t,i,r,a,s,n){var o=e.x,l=e.y;return{x:r*(o*=t)-a*(l*=i)+s,y:a*o+r*l+n}},Jr=function(e,t){var i=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:4/3*Math.tan(t/4),r=Math.cos(e),a=Math.sin(e),s=Math.cos(e+t),n=Math.sin(e+t);return[{x:r-a*i,y:a+r*i},{x:s+n*i,y:n-s*i},{x:s,y:n}]},Qr=function(e,t,i,r){var a=e*i+t*r;return a>1&&(a=1),a<-1&&(a=-1),(e*r-t*i<0?-1:1)*Math.acos(a)};const ea=function(e){var t=e.px,i=e.py,r=e.cx,a=e.cy,s=e.rx,n=e.ry,o=e.xAxisRotation,l=void 0===o?0:o,c=e.largeArcFlag,h=void 0===c?0:c,u=e.sweepFlag,d=void 0===u?0:u,f=[];if(0===s||0===n)return[];var p=Math.sin(l*qr/360),g=Math.cos(l*qr/360),m=g*(t-r)/2+p*(i-a)/2,b=-p*(t-r)/2+g*(i-a)/2;if(0===m&&0===b)return[];s=Math.abs(s),n=Math.abs(n);var v=Math.pow(m,2)/Math.pow(s,2)+Math.pow(b,2)/Math.pow(n,2);v>1&&(s*=Math.sqrt(v),n*=Math.sqrt(v));var y=function(e,t,i,r,a,s,n,o,l,c,h,u){var d=Math.pow(a,2),f=Math.pow(s,2),p=Math.pow(h,2),g=Math.pow(u,2),m=d*f-d*g-f*p;m<0&&(m=0),m/=d*g+f*p;var b=(m=Math.sqrt(m)*(n===o?-1:1))*a/s*u,v=m*-s/a*h,y=c*b-l*v+(e+i)/2,_=l*b+c*v+(t+r)/2,w=(h-b)/a,x=(u-v)/s,A=(-h-b)/a,T=(-u-v)/s,k=Qr(1,0,w,x),S=Qr(w,x,A,T);return 0===o&&S>0&&(S-=qr),1===o&&S<0&&(S+=qr),[y,_,k,S]}(t,i,r,a,s,n,h,d,p,g,m,b),_=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],r=!0,a=!1,s=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){a=!0,s=e}finally{try{!r&&o.return&&o.return()}finally{if(a)throw s}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(y,4),w=_[0],x=_[1],A=_[2],T=_[3],k=Math.abs(T)/(qr/4);Math.abs(1-k)<1e-7&&(k=1);var S=Math.max(Math.ceil(k),1);T/=S;for(var P=0;P<S;P++)f.push(Jr(A,T)),A+=T;return f.map((function(e){var t=Zr(e[0],s,n,g,p,w,x),i=t.x,r=t.y,a=Zr(e[1],s,n,g,p,w,x),o=a.x,l=a.y,c=Zr(e[2],s,n,g,p,w,x);return{x1:i,y1:r,x2:o,y2:l,x:c.x,y:c.y}}))};function ta(e,t,i){if(t!==i)throw new Error("Required "+i+" arguments for "+e+" but got "+t)}function ia(e,t,i){if(t<i)throw new Error("Required at least "+i+" arguments for "+e+" but got "+t)}function ra(e,t,i){if(ia(e,t,i),t%i!=0)throw new Error("Arguments for "+e+" must be in pairs of "+i)}function aa(e){for(let t=0;t<e.length;t+=7){let i=t+3,r=e[i];if(r.length>1){const t=/^([01])([01])(.*)$/.exec(r);null!==t&&(e.splice(i,0,t[1]),++i,e.splice(i,0,t[2]),++i,t[3].length>0?e[i]=t[3]:e.splice(i,1))}if(++i,r=e[i],r.length>1){const t=/^([01])(.+)$/.exec(r);null!==t&&(e.splice(i,0,t[1]),++i,e[i]=t[2])}}}function sa(e){if(0===e||1===e)return e;throw new Error("Flag must be 0 or 1")}function na(e,t){for(;(!e.interactive||t(e))&&e._parent;)e=e._parent}function oa(e,t,i){return $t(e,Kt(t),(e=>{const t=Jt(e);let r=e.touches;r?(0==r.length&&(r=e.changedTouches),i(Dt(r),t)):i([e],t)}))}function la(e){const t=document.createElement("canvas");t.width=1,t.height=1;const i=t.getContext("2d",{willReadFrequently:!0});i.drawImage(e,0,0,1,1);try{return i.getImageData(0,0,1,1),!1}catch(t){return console.warn('Image "'+e.src+'" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors'),!0}}function ca(e){e.width=0,e.height=0,e.style.width="0px",e.style.height="0px"}function ha(e){return Math.floor(e)+.5}class ua{constructor(){Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0})}get x(){return this._x}get y(){return this._y}set x(e){this._x=e}set y(e){this._y=e}}class da extends zt{constructor(e){super(),Object.defineProperty(this,"_layer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mask",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"interactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inactive",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"wheelable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"cancelTouch",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isMeasured",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"buttonMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"alpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"compoundAlpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"angle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"crisp",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"pivot",{enumerable:!0,configurable:!0,writable:!0,value:new ua}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cursorOverStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_replacedCursorStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_localMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new Kr}),Object.defineProperty(this,"_matrix",{enumerable:!0,configurable:!0,writable:!0,value:new Kr}),Object.defineProperty(this,"_uMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new Kr}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._renderer=e}subStatus(e){return{inactive:null==this.inactive?e.inactive:this.inactive,layer:this._layer||e.layer}}_dispose(){this._renderer._removeObject(this),this.getLayer().dirty=!0}getCanvas(){return this.getLayer().view}getLayer(){let e=this;for(;;){if(e._layer)return e._layer;if(!e._parent)return this._renderer.defaultLayer;e=e._parent}}setLayer(e,t){if(null==e)this._layer=void 0;else{const i=!0;this._layer=this._renderer.getLayer(e,i),this._layer.visible=i,this._layer.margin=t,t&&ei(this._layer.view,!1),this._renderer._ghostLayer.setMargin(this._renderer.layers),this._parent&&this._parent.registerChildLayer(this._layer),this._layer.dirty=!0,this._renderer.resizeLayer(this._layer),this._renderer.resizeGhost()}}markDirtyLayer(){this.getLayer().dirty=!0}clear(){this.invalidateBounds()}invalidateBounds(){this._localBounds=void 0}_addBounds(e){}_getColorId(){return void 0===this._colorId&&(this._colorId=this._renderer.paintId(this)),this._colorId}_isInteractive(e){return!e.inactive&&(this.interactive||this._renderer._forceInteractive>0)}_isInteractiveMask(e){return this._isInteractive(e)}contains(e){for(;;){if(e===this)return!0;if(!e._parent)return!1;e=e._parent}}toGlobal(e){return this._matrix.apply(e)}toLocal(e){return this._matrix.applyInverse(e)}getLocalMatrix(){return this._uMatrix.setTransform(0,0,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._uMatrix}getLocalBounds(){if(!this._localBounds){const e=1e7;this._localBounds={left:e,top:e,right:-e,bottom:-e},this._addBounds(this._localBounds)}return this._localBounds}getAdjustedBounds(e){this._setMatrix();const t=this.getLocalMatrix(),i=t.apply({x:e.left,y:e.top}),r=t.apply({x:e.right,y:e.top}),a=t.apply({x:e.right,y:e.bottom}),s=t.apply({x:e.left,y:e.bottom});return{left:Math.min(i.x,r.x,a.x,s.x),top:Math.min(i.y,r.y,a.y,s.y),right:Math.max(i.x,r.x,a.x,s.x),bottom:Math.max(i.y,r.y,a.y,s.y)}}on(e,t,i){return this.interactive?this._renderer._addEvent(this,e,t,i):new Ut((()=>{}))}_setMatrix(){this._localMatrix.setTransform(this.x,this.y,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._matrix.copyFrom(this._localMatrix),this._parent&&this._matrix.prepend(this._parent._matrix)}_transform(e,t){const i=this._matrix;let r=i.tx*t,a=i.ty*t;this.crisp&&(r=ha(r),a=ha(a)),e.setTransform(i.a*t,i.b*t,i.c*t,i.d*t,r,a)}_transformMargin(e,t,i){const r=this._matrix;e.setTransform(r.a*t,r.b*t,r.c*t,r.d*t,(r.tx+i.left)*t,(r.ty+i.top)*t)}_transformLayer(e,t,i){i.margin?this._transformMargin(e,i.scale||t,i.margin):this._transform(e,i.scale||t)}render(e,t=0){if(this.visible&&(!1!==this.exportable||!this._renderer._omitTainted)){this._setMatrix();const i=this.subStatus(e),r=this._renderer.resolution,a=this._renderer.layers,s=this._renderer._ghostLayer,n=s.context,o=this.mask;o&&o._setMatrix(),At(a,(e=>{if(e){const t=e.context;t.save(),o&&(o._transformLayer(t,r,e),o._runPath(t),t.clip()),t.globalAlpha=this.compoundAlpha*this.alpha,this._transformLayer(t,r,e),this.filter&&(t.filter=this.filter)}})),n.save(),o&&this._isInteractiveMask(i)&&(o._transformMargin(n,r,s.margin),o._runPath(n),n.clip()),this._transformMargin(n,r,s.margin),i.layer.order>0&&!t&&Et(this._renderer._deferredGhostLayers,i.layer.order),this._render(i,t),n.restore(),At(a,(e=>{e&&e.context.restore()}))}}_render(e,t=0){!1===this.exportable&&(e.layer.tainted=!0)}_ghostOnly(e=0){return e>0}_drawGhost(e,t=0){const i=this._isInteractive(e),r=e.layer.order||0;return!(!i||(0!=r||this._ghostOnly(t))&&r!=t)}hovering(){return this._renderer._hovering.has(this)}dragging(){return this._renderer._dragging.some((e=>e.value===this))}shouldCancelTouch(){const e=this._renderer;return!(e.tapToActivate&&!e._touchActive)&&(!!this.cancelTouch||!!this._parent&&this._parent.shouldCancelTouch())}}class fa extends da{constructor(){super(...arguments),Object.defineProperty(this,"interactiveChildren",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_childLayers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_children",{enumerable:!0,configurable:!0,writable:!0,value:[]})}_isInteractiveMask(e){return this.interactiveChildren||super._isInteractiveMask(e)}addChild(e){e._parent=this,this._children.push(e),e._layer&&this.registerChildLayer(e._layer)}addChildAt(e,t){e._parent=this,this._children.splice(t,0,e),e._layer&&this.registerChildLayer(e._layer)}removeChild(e){e._parent=void 0,Pt(this._children,e)}_render(e,t){super._render(e);const i=this._renderer;this.interactive&&this.interactiveChildren&&++i._forceInteractive,At(this._children,(i=>{i.compoundAlpha=this.compoundAlpha*this.alpha,i.render(e,t)})),this.interactive&&this.interactiveChildren&&--i._forceInteractive}registerChildLayer(e){this._childLayers||(this._childLayers=[]),Ct(this._childLayers,e),this._parent&&this._parent.registerChildLayer(e)}markDirtyLayer(e=!1){super.markDirtyLayer(),e&&this._childLayers&&At(this._childLayers,(e=>e.dirty=!0))}_dispose(){super._dispose(),this._childLayers&&At(this._childLayers,(e=>{e.dirty=!0}))}}function pa(e,t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.right=Math.max(e.right,t.x),e.bottom=Math.max(e.bottom,t.y)}class ga{colorize(e,t){}colorizeGhost(e,t){this.colorize(e,t)}path(e){}pathGhost(e){this.path(e)}addBounds(e){}}class ma extends ga{colorize(e,t){e.beginPath()}}class ba extends ga{constructor(e){super(),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.fillStyle=void 0!==t?t:this.color}}class va extends ga{constructor(e){super(),Object.defineProperty(this,"clearShadow",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.fill(),this.clearShadow&&(e.shadowColor="",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}}class ya extends ga{colorize(e,t){e.stroke()}}class _a extends ga{constructor(e,t,i,r){super(),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lineJoin",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"lineCap",{enumerable:!0,configurable:!0,writable:!0,value:r})}colorize(e,t){e.strokeStyle=void 0!==t?t:this.color,e.lineWidth=this.width,this.lineJoin&&(e.lineJoin=this.lineJoin),this.lineCap&&(e.lineCap=this.lineCap)}}class wa extends ga{constructor(e){super(),Object.defineProperty(this,"dash",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.setLineDash(this.dash)}}class xa extends ga{constructor(e){super(),Object.defineProperty(this,"dashOffset",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.lineDashOffset=this.dashOffset}}class Aa extends ga{constructor(e,t,i,r){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:r})}path(e){e.rect(this.x,this.y,this.width,this.height)}addBounds(e){const t=this.x,i=this.y,r=t+this.width,a=i+this.height;pa(e,{x:t,y:i}),pa(e,{x:r,y:i}),pa(e,{x:t,y:a}),pa(e,{x:r,y:a})}}class Ta extends ga{constructor(e,t,i){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:i})}path(e){e.moveTo(this.x+this.radius,this.y),e.arc(this.x,this.y,this.radius,0,2*Math.PI)}addBounds(e){pa(e,{x:this.x-this.radius,y:this.y-this.radius}),pa(e,{x:this.x+this.radius,y:this.y+this.radius})}}class ka extends ga{constructor(e,t,i,r){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radiusX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"radiusY",{enumerable:!0,configurable:!0,writable:!0,value:r})}path(e){e.ellipse(0,0,this.radiusX,this.radiusY,0,0,2*Math.PI)}addBounds(e){pa(e,{x:this.x-this.radiusX,y:this.y-this.radiusY}),pa(e,{x:this.x+this.radiusX,y:this.y+this.radiusY})}}class Sa extends ga{constructor(e,t,i,r,a,s){super(),Object.defineProperty(this,"cx",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cy",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"endAngle",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"anticlockwise",{enumerable:!0,configurable:!0,writable:!0,value:s})}path(e){this.radius>0&&e.arc(this.cx,this.cy,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}addBounds(e){let t=function(e,t,i,r,a){let s=Number.MAX_VALUE,n=Number.MAX_VALUE,o=-Number.MAX_VALUE,l=-Number.MAX_VALUE,c=[];c.push(hr(a,i)),c.push(hr(a,r));let h=Math.min(90*Math.floor(i/90),90*Math.floor(r/90)),u=Math.max(90*Math.ceil(i/90),90*Math.ceil(r/90));for(let e=h;e<=u;e+=90)e>=i&&e<=r&&c.push(hr(a,e));for(let e=0;e<c.length;e++){let t=c[e];t.x<s&&(s=t.x),t.y<n&&(n=t.y),t.x>o&&(o=t.x),t.y>l&&(l=t.y)}return{left:e+s,top:t+n,right:e+o,bottom:t+l}}(this.cx,this.cy,this.startAngle*sr,this.endAngle*sr,this.radius);pa(e,{x:t.left,y:t.top}),pa(e,{x:t.right,y:t.bottom})}}class Pa extends ga{constructor(e,t,i,r,a){super(),Object.defineProperty(this,"x1",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y1",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"x2",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"y2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:a})}path(e){this.radius>0&&e.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)}addBounds(e){}}class Ea extends ga{constructor(e,t){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t})}path(e){e.lineTo(this.x,this.y)}addBounds(e){pa(e,{x:this.x,y:this.y})}}class Ca extends ga{constructor(e,t){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t})}path(e){e.moveTo(this.x,this.y)}addBounds(e){pa(e,{x:this.x,y:this.y})}}class Da extends ga{path(e){e.closePath()}}class Oa extends ga{constructor(e,t,i,r,a,s){super(),Object.defineProperty(this,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"cpX2",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"cpY2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"toX",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"toY",{enumerable:!0,configurable:!0,writable:!0,value:s})}path(e){e.bezierCurveTo(this.cpX,this.cpY,this.cpX2,this.cpY2,this.toX,this.toY)}addBounds(e){pa(e,{x:this.cpX,y:this.cpY}),pa(e,{x:this.cpX2,y:this.cpY2}),pa(e,{x:this.toX,y:this.toY})}}class Ra extends ga{constructor(e,t,i,r){super(),Object.defineProperty(this,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"toX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"toY",{enumerable:!0,configurable:!0,writable:!0,value:r})}path(e){e.quadraticCurveTo(this.cpX,this.cpY,this.toX,this.toY)}addBounds(e){pa(e,{x:this.cpX,y:this.cpY}),pa(e,{x:this.toX,y:this.toY})}}class Ma extends ga{constructor(e,t,i,r,a){super(),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"blur",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"offsetX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"offsetY",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"opacity",{enumerable:!0,configurable:!0,writable:!0,value:a})}colorize(e,t){this.opacity&&(e.fillStyle=this.color),e.shadowColor=this.color,e.shadowBlur=this.blur,e.shadowOffsetX=this.offsetX,e.shadowOffsetY=this.offsetY}colorizeGhost(e,t){}}class Ia extends ga{constructor(e,t,i,r,a){super(),Object.defineProperty(this,"image",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:a})}path(e){e.drawImage(this.image,this.x,this.y,this.width,this.height)}addBounds(e){pa(e,{x:this.x,y:this.y}),pa(e,{x:this.width,y:this.height})}}class La extends da{constructor(){super(...arguments),Object.defineProperty(this,"_operations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"blendMode",{enumerable:!0,configurable:!0,writable:!0,value:gr.NORMAL}),Object.defineProperty(this,"_hasShadows",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_fillAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}clear(){super.clear(),this._operations.length=0}_pushOp(e){this._operations.push(e)}beginFill(e,t=1){this._fillAlpha=t,e?e instanceof ki?this._pushOp(new ba(e.toCSS(t))):(this.isMeasured=!0,this._pushOp(new ba(e))):this._pushOp(new ba("rgba(0, 0, 0, "+t+")"))}endFill(){this._pushOp(new va(this._hasShadows))}endStroke(){this._pushOp(new ya)}beginPath(){this._pushOp(new ma)}lineStyle(e=0,t,i=1,r,a){this._strokeAlpha=i,t?t instanceof ki?this._pushOp(new _a(e,t.toCSS(i),r,a)):this._pushOp(new _a(e,t,r,a)):this._pushOp(new _a(e,"rgba(0, 0, 0, "+i+")",r,a))}setLineDash(e){this._pushOp(new wa(e||[]))}setLineDashOffset(e=0){this._pushOp(new xa(e))}drawRect(e,t,i,r){this._pushOp(new Aa(e,t,i,r))}drawCircle(e,t,i){this._pushOp(new Ta(e,t,i))}drawEllipse(e,t,i,r){this._pushOp(new ka(e,t,i,r))}arc(e,t,i,r,a,s=!1){this._pushOp(new Sa(e,t,i,r,a,s))}arcTo(e,t,i,r,a){this._pushOp(new Pa(e,t,i,r,a))}lineTo(e,t){this._pushOp(new Ea(e,t))}moveTo(e,t){this._pushOp(new Ca(e,t))}bezierCurveTo(e,t,i,r,a,s){this._pushOp(new Oa(e,t,i,r,a,s))}quadraticCurveTo(e,t,i,r){this._pushOp(new Ra(e,t,i,r))}closePath(){this._pushOp(new Da)}shadow(e,t=0,i=0,r=0,a){this._hasShadows=!0,this._pushOp(new Ma(a?e.toCSS(a):e.toCSS(this._fillAlpha||this._strokeAlpha),t,i,r))}image(e,t,i,r,a){this._pushOp(new Ia(e,t,i,r,a))}svgPath(e){let t=0,i=0,r=null,a=null,s=null,n=null;const o=/([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g,l=/[\u0009\u0020\u000A\u000C\u000D]*([\+\-]?[0-9]*\.?[0-9]+(?:[eE][\+\-]?[0-9]+)?)[\u0009\u0020\u000A\u000C\u000D]*,?/g;let c;for(;null!==(c=o.exec(e));){const e=c[1],o=c[2],h=[];for(;null!==(c=l.exec(o));)h.push(c[1]);switch("S"!==e&&"s"!==e&&"C"!==e&&"c"!==e&&(r=null,a=null),"Q"!==e&&"q"!==e&&"T"!==e&&"t"!==e&&(s=null,n=null),e){case"M":ra(e,h.length,2),t=+h[0],i=+h[1],this.moveTo(t,i);for(let e=2;e<h.length;e+=2)t=+h[e],i=+h[e+1],this.lineTo(t,i);break;case"m":ra(e,h.length,2),t+=+h[0],i+=+h[1],this.moveTo(t,i);for(let e=2;e<h.length;e+=2)t+=+h[e],i+=+h[e+1],this.lineTo(t,i);break;case"L":ra(e,h.length,2);for(let e=0;e<h.length;e+=2)t=+h[e],i=+h[e+1],this.lineTo(t,i);break;case"l":ra(e,h.length,2);for(let e=0;e<h.length;e+=2)t+=+h[e],i+=+h[e+1],this.lineTo(t,i);break;case"H":ia(e,h.length,1);for(let e=0;e<h.length;++e)t=+h[e],this.lineTo(t,i);break;case"h":ia(e,h.length,1);for(let e=0;e<h.length;++e)t+=+h[e],this.lineTo(t,i);break;case"V":ia(e,h.length,1);for(let e=0;e<h.length;++e)i=+h[e],this.lineTo(t,i);break;case"v":ia(e,h.length,1);for(let e=0;e<h.length;++e)i+=+h[e],this.lineTo(t,i);break;case"C":ra(e,h.length,6);for(let e=0;e<h.length;e+=6){const s=+h[e],n=+h[e+1];r=+h[e+2],a=+h[e+3],t=+h[e+4],i=+h[e+5],this.bezierCurveTo(s,n,r,a,t,i)}break;case"c":ra(e,h.length,6);for(let e=0;e<h.length;e+=6){const s=+h[e]+t,n=+h[e+1]+i;r=+h[e+2]+t,a=+h[e+3]+i,t+=+h[e+4],i+=+h[e+5],this.bezierCurveTo(s,n,r,a,t,i)}break;case"S":ra(e,h.length,4),null!==r&&null!==a||(r=t,a=i);for(let e=0;e<h.length;e+=4){const s=2*t-r,n=2*i-a;r=+h[e],a=+h[e+1],t=+h[e+2],i=+h[e+3],this.bezierCurveTo(s,n,r,a,t,i)}break;case"s":ra(e,h.length,4),null!==r&&null!==a||(r=t,a=i);for(let e=0;e<h.length;e+=4){const s=2*t-r,n=2*i-a;r=+h[e]+t,a=+h[e+1]+i,t+=+h[e+2],i+=+h[e+3],this.bezierCurveTo(s,n,r,a,t,i)}break;case"Q":ra(e,h.length,4);for(let e=0;e<h.length;e+=4)s=+h[e],n=+h[e+1],t=+h[e+2],i=+h[e+3],this.quadraticCurveTo(s,n,t,i);break;case"q":ra(e,h.length,4);for(let e=0;e<h.length;e+=4)s=+h[e]+t,n=+h[e+1]+i,t+=+h[e+2],i+=+h[e+3],this.quadraticCurveTo(s,n,t,i);break;case"T":ra(e,h.length,2),null!==s&&null!==n||(s=t,n=i);for(let e=0;e<h.length;e+=2)s=2*t-s,n=2*i-n,t=+h[e],i=+h[e+1],this.quadraticCurveTo(s,n,t,i);break;case"t":ra(e,h.length,2),null!==s&&null!==n||(s=t,n=i);for(let e=0;e<h.length;e+=2)s=2*t-s,n=2*i-n,t+=+h[e],i+=+h[e+1],this.quadraticCurveTo(s,n,t,i);break;case"A":case"a":const o="a"===e;aa(h),ra(e,h.length,7);for(let e=0;e<h.length;e+=7){let r=+h[e+5],a=+h[e+6];o&&(r+=t,a+=i),At(ea({px:t,py:i,rx:+h[e],ry:+h[e+1],xAxisRotation:+h[e+2],largeArcFlag:sa(+h[e+3]),sweepFlag:sa(+h[e+4]),cx:r,cy:a}),(e=>{this.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x,e.y),t=e.x,i=e.y}))}break;case"Z":case"z":ta(e,h.length,0),this.closePath()}}}_runPath(e){e.beginPath(),At(this._operations,(t=>{t.path(e)}))}_render(e,t=0){super._render(e);const i=e.layer.dirty,r=this._isInteractive(e),a=this._ghostOnly(t),s=this._drawGhost(e,t);if(i||r||a){const t=e.layer.context,r=this._renderer._ghostLayer.context;let n;i&&!a&&(t.globalCompositeOperation=this.blendMode,t.beginPath()),s&&(r.beginPath(),n=this._getColorId()),At(this._operations,(e=>{i&&!a&&(e.path(t),e.colorize(t,void 0)),s&&(e.pathGhost(r),e.colorizeGhost(r,n))}))}}renderDetached(e){if(this.visible){this._setMatrix(),e.save();const t=this.mask;t&&(t._setMatrix(),t._transform(e,1),t._runPath(e),e.clip()),e.globalAlpha=this.compoundAlpha*this.alpha,this._transform(e,1),this.filter&&(e.filter=this.filter),e.globalCompositeOperation=this.blendMode,e.beginPath(),At(this._operations,(t=>{t.path(e),t.colorize(e,void 0)})),e.restore()}}_addBounds(e){this.visible&&this.isMeasured&&At(this._operations,(t=>{t.addBounds(e)}))}}class Fa extends da{constructor(e,t,i){super(e),Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"textVisible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"truncated",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_textInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:1}),this.text=t,this.style=i}invalidateBounds(){super.invalidateBounds(),this._textInfo=void 0}_shared(e){this.style.textAlign&&(e.textAlign=this.style.textAlign),this.style.direction&&(e.direction=this.style.direction),this.style.textBaseline&&(e.textBaseline=this.style.textBaseline)}_prerender(e,t=!1,i=!1){super._render(e);const r=e.layer.context,a=this._renderer._ghostLayer.context,s=this.style;let n=this._getFontStyle(void 0,i);r.font=n,this._isInteractive(e)&&!t&&(a.font=n),s.fill&&(s.fill instanceof ki?r.fillStyle=s.fill.toCSS(null!=s.fillOpacity?s.fillOpacity:1):r.fillStyle=s.fill),s.shadowColor&&(e.layer.context.shadowColor=s.shadowColor.toCSS(s.shadowOpacity||1)),s.shadowBlur&&(e.layer.context.shadowBlur=s.shadowBlur),s.shadowOffsetX&&(e.layer.context.shadowOffsetX=s.shadowOffsetX),s.shadowOffsetY&&(e.layer.context.shadowOffsetY=s.shadowOffsetY),this._shared(r),this._isInteractive(e)&&!t&&(a.fillStyle=this._getColorId(),this._shared(a))}_getFontStyle(e,t=!1){const i=this.style;let r=[];return e&&e.fontVariant?r.push(e.fontVariant):i.fontVariant&&r.push(i.fontVariant),t||(e&&e.fontWeight?r.push(e.fontWeight):i.fontWeight&&r.push(i.fontWeight)),e&&e.fontStyle?r.push(e.fontStyle):i.fontStyle&&r.push(i.fontStyle),e&&e.fontSize?(bt(e.fontSize)&&(e.fontSize=e.fontSize+"px"),r.push(e.fontSize)):i.fontSize&&(bt(i.fontSize)&&(i.fontSize=i.fontSize+"px"),r.push(i.fontSize)),e&&e.fontFamily?r.push(e.fontFamily):i.fontFamily?r.push(i.fontFamily):r.length&&r.push("Arial"),r.join(" ")}_render(e,t=0){if(this._textInfo||this._measure(e),this.textVisible){const i=this._isInteractive(e),r=e.layer.context,a=e.layer.dirty,s=this._renderer._ghostLayer.context,n=this._ghostOnly(t),o=this._drawGhost(e,t);r.save(),s.save(),this._prerender(e),At(this._textInfo,((t,l)=>{At(t.textChunks,((l,c)=>{if(l.style&&(r.save(),s.save(),n||(r.font=l.style),this._isInteractive(e)&&(s.font=l.style)),l.fill&&(r.save(),n||(r.fillStyle=l.fill.toCSS())),a&&!n&&r.fillText(l.text,l.offsetX,t.offsetY+l.offsetY),"underline"==l.textDecoration||"line-through"==l.textDecoration){let e=1,i=1,a=l.height;const s=this.style.oversizedBehavior||"";if(["truncate","wrap","wrap-no-break"].indexOf(s)>-1){const e=this._measureText(l.text,r);l.width=e.actualBoundingBoxLeft+e.actualBoundingBoxRight}let o,c=l.offsetX;switch(this.style.textAlign){case"right":case"end":c-=l.width;break;case"center":c-=l.width/2}if(l.style)switch(Ar.getTextStyle(l.style).fontWeight){case"bolder":case"bold":case"700":case"800":case"900":e=2}a&&(i=a/20),o="line-through"==l.textDecoration?e+t.offsetY+l.offsetY-l.height/2:e+1.5*i+t.offsetY+l.offsetY,n||(r.save(),r.beginPath(),l.fill?r.strokeStyle=l.fill.toCSS():this.style.fill&&this.style.fill instanceof ki&&(r.strokeStyle=this.style.fill.toCSS()),r.lineWidth=e*i,r.moveTo(c,o),r.lineTo(c+l.width,o),r.stroke(),r.restore())}i&&this.interactive&&o&&s.fillText(l.text,l.offsetX,t.offsetY+l.offsetY),l.fill&&r.restore(),l.style&&(r.restore(),s.restore())}))})),r.restore(),s.restore()}}_addBounds(e){if(this.visible&&this.isMeasured){const t=this._measure({inactive:this.inactive,layer:this.getLayer()});pa(e,{x:t.left,y:t.top}),pa(e,{x:t.right,y:t.bottom})}}_ignoreFontWeight(){return/apple/i.test(navigator.vendor)}_measure(e){const t=e.layer.context,i=this._renderer._ghostLayer.context,r="rtl"==this.style.direction;this._textInfo=[];const a=this.style.oversizedBehavior,s=this.style.maxWidth,n=bt(s)&&"truncate"==a,o=bt(s)&&("wrap"==a||"wrap-no-break"==a);t.save(),i.save(),this._prerender(e,!0,this._ignoreFontWeight());const l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",c=this.text.toString().replace(/\r/g,"").split(/\n/);let h,u=!0,d=0,f=0,p=0;At(c,((e,r)=>{let a;for(a=""==e?[{type:"value",text:""}]:Ar.chunk(e,!1,this.style.ignoreFormatting);a.length>0;){let e={offsetY:p,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};const r=this._measureText(l,t),c=r.actualBoundingBoxAscent+r.actualBoundingBoxDescent;let g;e.height=c,e.ascent=r.actualBoundingBoxAscent;let m,b,v,y=this.style.textDecoration,_=!1,w=!0,x=[];kt(a,((r,c)=>{if("format"==r.type)if("[/]"==r.text)u||(t.restore(),i.restore(),u=!0),m=void 0,h=void 0,b=void 0,y=this.style.textDecoration,v=void 0,g=r.text;else{u||(t.restore(),i.restore());let a=Ar.getTextStyle(r.text);const s=this._getFontStyle(a);t.save(),i.save(),t.font=s,h=s,g=r.text,a.textDecoration&&(y=a.textDecoration),a.fill&&(m=a.fill),a.width&&(b=dt(a.width)),a.verticalAlign&&(v=a.verticalAlign),u=!1;const n=this._measureText(l,t),o=n.actualBoundingBoxAscent+n.actualBoundingBoxDescent;o>e.height&&(e.height=o),n.actualBoundingBoxAscent>e.ascent&&(e.ascent=n.actualBoundingBoxAscent)}else if("value"==r.type&&!_){const i=this._measureText(r.text,t);let l=i.actualBoundingBoxLeft+i.actualBoundingBoxRight;if(n){this.truncated=void 0;let i=w||this.style.breakWords||!1;const a=this.style.ellipsis||"",n=this._measureText(a,t),o=n.actualBoundingBoxLeft+n.actualBoundingBoxRight;if(e.width+l>s){const n=s-e.width-o;r.text=this._truncateText(t,r.text,n,i),r.text+=a,_=!0,this.truncated=!0}}else if(o&&e.width+l>s){const i=s-e.width,n=this._truncateText(t,r.text,i,!1,w&&"wrap-no-break"!=this.style.oversizedBehavior);if(""==n)return this.textVisible=!0,!1;x=a.slice(c+1),si(n)!=si(r.text)&&(x.unshift({type:"value",text:r.text.substr(n.length)}),g&&x.unshift({type:"format",text:g})),r.text=si(n),a=[],_=!0}let u=1,d=1;if(h&&b&&b>l){const e=l/b;switch(this.style.textAlign){case"right":case"end":u=e;break;case"center":u=e,d=e;break;default:d=e}l=b}const f=i.actualBoundingBoxAscent+i.actualBoundingBoxDescent;f>e.height&&(e.height=f),i.actualBoundingBoxAscent>e.ascent&&(e.ascent=i.actualBoundingBoxAscent),e.width+=l,e.left+=i.actualBoundingBoxLeft/u,e.right+=i.actualBoundingBoxRight/d,e.textChunks.push({style:h,fill:m,text:r.text,width:l,height:f,left:i.actualBoundingBoxLeft,right:i.actualBoundingBoxRight,ascent:i.actualBoundingBoxAscent,offsetX:0,offsetY:0,textDecoration:y,verticalAlign:v}),w=!1}return!0})),this.style.lineHeight instanceof st?(e.height*=this.style.lineHeight.value,e.ascent*=this.style.lineHeight.value):(e.height*=this.style.lineHeight||1.2,e.ascent*=this.style.lineHeight||1.2),d<e.left&&(d=e.left),f<e.right&&(f=e.right),this._textInfo.push(e),p+=e.height,a=x||[]}})),u||(t.restore(),i.restore()),At(this._textInfo,((e,t)=>{let i=0;At(e.textChunks,(t=>{if(t.offsetX=i+t.left-e.left,t.offsetY+=e.height-e.height*(this.style.baselineRatio||.19),i+=t.width,t.verticalAlign)switch(t.verticalAlign){case"super":t.offsetY-=e.height/2-t.height/2;break;case"sub":t.offsetY+=t.height/2}}))}));const g={left:r?-f:-d,top:0,right:r?d:f,bottom:p};if("none"!==a){const e=this._fitRatio(g);if(e<1)if("fit"==a)bt(this.style.minScale)&&e<this.style.minScale?(this.textVisible=!1,g.left=0,g.top=0,g.right=0,g.bottom=0):(this._originalScale||(this._originalScale=this.scale),this.scale=e,this.textVisible=!0);else if("hide"==a)this.textVisible=!1,g.left=0,g.top=0,g.right=0,g.bottom=0;else{switch(this.style.textAlign){case"right":case"end":g.left=r?s:-s,g.right=0;break;case"center":g.left=-s/2,g.right=s/2;break;default:g.left=0,g.right=r?-s:s}this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}else this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}return t.restore(),i.restore(),g}_fitRatio(e){const t=this.style.maxWidth,i=this.style.maxHeight;if(!bt(t)&&!bt(i))return 1;const r=e.right-e.left,a=e.bottom-e.top;return Math.min(t/r||1,i/a||1)}_truncateText(e,t,i,r=!1,a=!0){let s;do{if(r)t=t.slice(0,-1);else{let e=t.replace(/[^,;:!?\\\/\s​]+[,;:!?\\\/\s​]*$/g,"");if(""!=e&&e!==t||!a){if(""==e)return t;t=e}else r=!0}const i=this._measureText(t,e);s=i.actualBoundingBoxLeft+i.actualBoundingBoxRight}while(s>i&&""!=t);return t}_measureText(e,t){let i=t.measureText(e),r={};if(null==i.actualBoundingBoxAscent){const t=document.createElement("div");t.innerText=e,t.style.visibility="hidden",t.style.position="absolute",t.style.top="-1000000px;",t.style.fontFamily=this.style.fontFamily||"",t.style.fontSize=this.style.fontSize+"",document.body.appendChild(t);const a=t.getBoundingClientRect();document.body.removeChild(t);const s=a.height,n=i.width;r={actualBoundingBoxAscent:s,actualBoundingBoxDescent:0,actualBoundingBoxLeft:0,actualBoundingBoxRight:n,fontBoundingBoxAscent:s,fontBoundingBoxDescent:0,width:n}}else r={actualBoundingBoxAscent:i.actualBoundingBoxAscent,actualBoundingBoxDescent:i.actualBoundingBoxDescent,actualBoundingBoxLeft:i.actualBoundingBoxLeft,actualBoundingBoxRight:i.actualBoundingBoxRight,fontBoundingBoxAscent:i.actualBoundingBoxAscent,fontBoundingBoxDescent:i.actualBoundingBoxDescent,width:i.width};const a=i.width;switch(this.style.textAlign){case"right":case"end":r.actualBoundingBoxLeft=a,r.actualBoundingBoxRight=0;break;case"center":r.actualBoundingBoxLeft=a/2,r.actualBoundingBoxRight=a/2;break;default:r.actualBoundingBoxLeft=0,r.actualBoundingBoxRight=a}return r}}class Na{constructor(){Object.defineProperty(this,"fill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fillOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textAlign",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontFamily",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontWeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontVariant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textDecoration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lineHeight",{enumerable:!0,configurable:!0,writable:!0,value:nt(120)}),Object.defineProperty(this,"baselineRatio",{enumerable:!0,configurable:!0,writable:!0,value:.19}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textBaseline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oversizedBehavior",{enumerable:!0,configurable:!0,writable:!0,value:"none"}),Object.defineProperty(this,"breakWords",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ellipsis",{enumerable:!0,configurable:!0,writable:!0,value:"…"}),Object.defineProperty(this,"maxWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"minScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreFormatting",{enumerable:!0,configurable:!0,writable:!0,value:!1})}}class Ba extends Fa{constructor(){super(...arguments),Object.defineProperty(this,"textType",{enumerable:!0,configurable:!0,writable:!0,value:"circular"}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inside",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"orientation",{enumerable:!0,configurable:!0,writable:!0,value:"auto"}),Object.defineProperty(this,"kerning",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_textReversed",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_render(e,t=0){"circular"===this.textType?this._renderCircular(e,t):super._render(e,t)}_renderCircular(e,t=0){if(this.textVisible){this._prerender(e);const r=this._isInteractive(e),a=e.layer.context,s=e.layer.dirty,n=this._renderer._ghostLayer.context;a.save(),r&&n.save(),this._textInfo||this._measure(e);let o=this.radius||0,l=this.startAngle||0,c=0,h=this.orientation,u="auto"==h?"auto":"inward"==h;const d=this.inside,f=this.style.textAlign||"left",p=this.kerning||0;let g="left"==f?1:-1;const m=!this._textReversed,b=this._ghostOnly(t),v=this._drawGhost(e,t);if("auto"==u){let e=0,t=0;At(this._textInfo,((t,i)=>{const r=l+t.width/(o-t.height)/2*-g;r>e&&(e=r)})),t="left"==f?(e+c/2)*sr:"right"==f?(e-c/2)*sr:l*sr,i=t,(i%=360)<0&&(i+=360),t=i,u=t>=270||t<=90}1==u&&m&&(this._textInfo.reverse(),this._textReversed=!0),At(this._textInfo,((e,t)=>{const i=e.height;d||(o+=i),(-1==g&&u||1==g&&!u)&&m&&e.textChunks.reverse();let h=l;c=0,"center"==f&&(h+=e.width/(o-i)/2*-g,c=h-l),h+=Math.PI*(u?0:1),a.save(),r&&n.save(),b||a.rotate(h),r&&n.rotate(h);let y=0;At(e.textChunks,((e,t)=>{const l=e.text,c=e.width;y=c/2/(o-i)*g,b||a.rotate(y),r&&n.rotate(y),e.style&&(a.save(),n.save(),b||(a.font=e.style),r&&(n.font=e.style)),e.fill&&(a.save(),b||(a.fillStyle=e.fill.toCSS())),b||(a.textBaseline="middle",a.textAlign="center"),r&&(n.textBaseline="middle",n.textAlign="center"),s&&!b&&a.fillText(l,0,(u?1:-1)*(0-o+i/2)),r&&v&&n.fillText(l,0,(u?1:-1)*(0-o+i/2)),e.fill&&a.restore(),e.style&&(a.restore(),n.restore()),y=(c/2+p)/(o-i)*g,b||a.rotate(y),r&&n.rotate(y)})),a.restore(),r&&n.restore(),d&&(o-=i)})),a.restore(),r&&n.restore()}var i}_measure(e){return"circular"===this.textType?this._measureCircular(e):super._measure(e)}_measureCircular(e){const t=e.layer.context,i=this._renderer._ghostLayer.context,r="rtl"==this.style.direction,a=this.style.oversizedBehavior,s=this.style.maxWidth,n=bt(s)&&"truncate"==a,o=this.style.ellipsis||"";let l;this.textVisible=!0,this._textInfo=[],this._textReversed=!1,t.save(),i.save(),this._prerender(e,!0);const c=this.text.toString().replace(/\r/g,"").split(/\n/);let h=!0,u=0,d=0;return At(c,((e,a)=>{let c,f,p,g=Ar.chunk(e,!1,this.style.ignoreFormatting),m={offsetY:d,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};At(g,((e,a)=>{if("format"==e.type){if("[/]"==e.text)h||(t.restore(),i.restore(),h=!0),f=void 0,c=void 0,p=void 0;else{let r=Ar.getTextStyle(e.text);const a=this._getFontStyle(r);t.save(),i.save(),t.font=a,c=a,r.fill&&(f=r.fill),r.width&&(p=dt(r.width)),h=!1}n&&(l=this._measureText(o,t))}else if("value"==e.type){let i=e.text.match(/./gu)||[];r&&(i=function(e){const t=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/,i=/([^اأدذرزو]*[اأدذرزو])/gi;let r=e.split(/(\s+)/),a=[];return r.forEach((e=>{if(e.match(/^\s+$/))(e=" ")&&(e="  "),a.push(e);else if(t.test(e)){let t=e.split(i).filter((e=>""!==e));a=a.concat(t)}else a=a.concat([...e])})),a}(e.text),i.reverse());for(let e=0;e<i.length;e++){const r=i[e],a=this._measureText(r,t);let h=a.width;c&&p&&p>h&&(h=p);const d=a.actualBoundingBoxAscent+a.actualBoundingBoxDescent;if(d>m.height&&(m.height=d),a.actualBoundingBoxAscent>m.ascent&&(m.ascent=a.actualBoundingBoxAscent),u+=h,n){l||(l=this._measureText(o,t));const e=l.actualBoundingBoxLeft+l.actualBoundingBoxRight;if(u+e>s){1==m.textChunks.length?this.textVisible=!1:(m.width+=e,m.left+=l.actualBoundingBoxLeft,m.right+=l.actualBoundingBoxRight,m.textChunks.push({style:c,fill:f,text:o,width:e,height:d+l.actualBoundingBoxDescent,left:l.actualBoundingBoxLeft,right:l.actualBoundingBoxRight,ascent:l.actualBoundingBoxAscent,offsetX:0,offsetY:d,textDecoration:void 0}));break}}m.width+=h,m.left+=a.actualBoundingBoxLeft,m.right+=a.actualBoundingBoxRight,m.textChunks.push({style:c,fill:f,text:r,width:h,height:d+a.actualBoundingBoxDescent,left:a.actualBoundingBoxLeft,right:a.actualBoundingBoxRight,ascent:a.actualBoundingBoxAscent,offsetX:0,offsetY:d,textDecoration:void 0})}}})),this.style.lineHeight instanceof st?m.height*=this.style.lineHeight.value:m.height*=this.style.lineHeight||1.2,this._textInfo.push(m),d+=m.height})),h||(t.restore(),i.restore()),"hide"==a&&u>s&&(this.textVisible=!1),At(this._textInfo,(e=>{At(e.textChunks,(t=>{t.offsetY+=Math.round((e.height-t.height+(e.ascent-t.ascent))/2)}))})),t.restore(),i.restore(),{left:0,top:0,right:0,bottom:0}}}class ja extends da{constructor(e,t){super(e),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_imageMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.image=t}_dispose(){super._dispose(),this._imageMask&&ca(this._imageMask)}getLocalBounds(){if(!this._localBounds){let e=0,t=0;this.width&&(e=this.width),this.height&&(t=this.height),this._localBounds={left:0,top:0,right:e,bottom:t},this._addBounds(this._localBounds)}return this._localBounds}_render(e,t=0){if(super._render(e),this.image){if(void 0===this.tainted&&(this.tainted=la(this.image),e.layer.tainted=!0),this.tainted&&this._renderer._omitTainted)return;const i=this._ghostOnly(t),r=this._drawGhost(e,t);if(e.layer.dirty&&!i){this.shadowColor&&(e.layer.context.shadowColor=this.shadowColor.toCSS(this.shadowOpacity||1)),this.shadowBlur&&(e.layer.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(e.layer.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(e.layer.context.shadowOffsetY=this.shadowOffsetY);const t=this.width||this.image.naturalWidth,i=this.height||this.image.naturalHeight;e.layer.context.drawImage(this.image,0,0,t,i)}if(this.interactive&&this._isInteractive(e)&&r){const e=this._getMask(this.image);this._renderer._ghostLayer.context.drawImage(e,0,0)}}}clear(){super.clear(),this.image=void 0,this._imageMask=void 0}_getMask(e){if(void 0===this._imageMask){const t=this.width||e.naturalWidth,i=this.height||e.naturalHeight,r=document.createElement("canvas");r.width=t,r.height=i;const a=r.getContext("2d");a.imageSmoothingEnabled=!1,a.fillStyle=this._getColorId(),a.fillRect(0,0,t,i),la(e)||(a.globalCompositeOperation="destination-in",a.drawImage(e,0,0,t,i)),this._imageMask=r}return this._imageMask}}class za{constructor(e,t,i,r){Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"originalPoint",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"point",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"bbox",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"simulated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"native",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Yt("touchevents")&&e instanceof Touch?this.id=e.identifier:this.id=null}}class Ua extends Ht{constructor(e){if(super(),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(this,"_layerDom",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(this,"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_dirtyLayers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"defaultLayer",{enumerable:!0,configurable:!0,writable:!0,value:this.getLayer(0)}),Object.defineProperty(this,"_ghostLayer",{enumerable:!0,configurable:!0,writable:!0,value:new Ha}),Object.defineProperty(this,"_deferredGhostLayers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_patternCanvas",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("canvas")}),Object.defineProperty(this,"_patternContext",{enumerable:!0,configurable:!0,writable:!0,value:this._patternCanvas.getContext("2d")}),Object.defineProperty(this,"_realWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_realHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_calculatedWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_calculatedHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interactionsEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_events",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_colorMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_forceInteractive",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_omitTainted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_hovering",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"_dragging",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_mousedown",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_lastPointerMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tapToActivate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"tapToActivateTimeout",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"_touchActive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_touchActiveTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.resolution=null==e?window.devicePixelRatio:e,this.view.style.position="absolute",this.view.setAttribute("aria-hidden","true"),this.view.appendChild(this._layerDom),this._disposers.push(new Ut((()=>{Bt(this._events,((e,t)=>{t.disposer.dispose()})),At(this.layers,(e=>{ca(e.view),e.exportableView&&ca(e.exportableView)})),ca(this._ghostLayer.view),ca(this._patternCanvas)}))),this._disposers.push(Xt((()=>{null==e&&(this.resolution=window.devicePixelRatio)}))),Yt("touchevents")){const e=e=>{0!==this._dragging.length&&kt(this._dragging,(t=>!t.value.shouldCancelTouch()||(e.preventDefault(),!1))),this._touchActiveTimeout&&this._delayTouchDeactivate()};this._disposers.push($t(window,"touchstart",e,{passive:!1})),this._disposers.push($t(this.view,"touchstart",e,{passive:!1})),this._disposers.push($t(this.view,"touchmove",(()=>{this._touchActiveTimeout&&this._delayTouchDeactivate()}),{passive:!0})),this._disposers.push($t(window,"click",(e=>{this._touchActive=!1}),{passive:!0})),this._disposers.push($t(this.view,"click",(e=>{window.setTimeout((()=>{this._touchActive=!0,this._delayTouchDeactivate()}),100)}),{passive:!0}))}Yt("wheelevents")&&this._disposers.push($t(this.view,"wheel",(e=>{let t=!1;this._hovering.forEach((e=>{if(e.wheelable)return t=!0,!1})),t&&e.preventDefault()}),{passive:!1}))}resetImageArray(){this._ghostLayer.imageArray=void 0}_delayTouchDeactivate(){this._touchActiveTimeout&&clearTimeout(this._touchActiveTimeout),this.tapToActivateTimeout>0&&(this._touchActiveTimeout=window.setTimeout((()=>{this._touchActive=!1}),this.tapToActivateTimeout))}get debugGhostView(){return!!this._ghostLayer.view.parentNode}set debugGhostView(e){e?this._ghostLayer.view.parentNode||this.view.appendChild(this._ghostLayer.view):this._ghostLayer.view.parentNode&&this._ghostLayer.view.parentNode.removeChild(this._ghostLayer.view)}createLinearGradient(e,t,i,r){return this.defaultLayer.context.createLinearGradient(e,t,i,r)}createRadialGradient(e,t,i,r,a,s){return this.defaultLayer.context.createRadialGradient(e,t,i,r,a,s)}createPattern(e,t,i,r,a){return this._patternCanvas.width=r,this._patternCanvas.height=a,this._patternContext.clearRect(0,0,r,a),t.renderDetached(this._patternContext),e.renderDetached(this._patternContext),this._patternContext.createPattern(this._patternCanvas,i)}makeContainer(){return new fa(this)}makeGraphics(){return new La(this)}makeText(e,t){return new Fa(this,e,t)}makeTextStyle(){return new Na}makeRadialText(e,t){return new Ba(this,e,t)}makePicture(e){return new ja(this,e)}resizeLayer(e){e.resize(this._calculatedWidth,this._calculatedHeight,this._calculatedWidth,this._calculatedHeight,this.resolution)}resizeGhost(){this._ghostLayer.resize(this._calculatedWidth,this._calculatedHeight,this._calculatedWidth,this._calculatedHeight,this.resolution)}resize(e,t,i,r){this._realWidth=e,this._realHeight=t,this._calculatedWidth=i,this._calculatedHeight=r,At(this.layers,(e=>{e&&(e.dirty=!0,this.resizeLayer(e))})),this.resizeGhost(),this.view.style.width=i+"px",this.view.style.height=r+"px"}createDetachedLayer(e=!1){const t=document.createElement("canvas"),i=t.getContext("2d",{willReadFrequently:e}),r=new Wa(t,i);return t.style.position="absolute",t.style.top="0px",t.style.left="0px",r}getLayerByOrder(e){const t=this.layers,i=t.length;for(let r=0;r<i;r++){const i=t[r];if(i.order==e)return i}}getLayer(e,t=!0){let i=this.getLayerByOrder(e);if(i)return i;const r=this.createDetachedLayer(99==e);r.order=e,r.visible=t,r.view.className="am5-layer-"+e,r.visible&&this.resizeLayer(r);const a=this.layers;a.push(r),a.sort(((e,t)=>e.order>t.order?1:e.order<t.order?-1:0));const s=a.length;let n;for(let e=wt(a,r)+1;e<s;e++)if(a[e].visible){n=a[e];break}return r.visible&&(void 0===n?this._layerDom.appendChild(r.view):this._layerDom.insertBefore(r.view,n.view)),r}render(e){this._dirtyLayers.length=0,this._deferredGhostLayers=[],At(this.layers,(e=>{e&&e.dirty&&e.visible&&(this._dirtyLayers.push(e),e.clear())})),this._ghostLayer.clear(),e.render({inactive:null,layer:this.defaultLayer});const t=this._deferredGhostLayers;if(t.length&&(t.sort(((e,t)=>e-t)),At(t,(t=>{e.render({inactive:null,layer:this.defaultLayer},t)}))),this._ghostLayer.context.restore(),At(this.layers,(e=>{if(e){const t=e.context;t.beginPath(),t.moveTo(0,0),t.stroke()}})),At(this._dirtyLayers,(e=>{e.context.restore(),e.dirty=!1})),this._hovering.size&&this._lastPointerMoveEvent){const{events:e,target:t,native:i}=this._lastPointerMoveEvent;At(e,(e=>{this._dispatchGlobalMousemove(e,t,i)}))}}paintId(e){const t=function(e){const t=[0,0,0];for(let i=0;i<24;i++)t[i%3]<<=1,t[i%3]|=1&e,e>>=1;return(0|t[0])+(t[1]<<8)+(t[2]<<16)}(++this._colorId),i=ki.fromHex(t).toCSS();return this._colorMap[i]=e,i}_removeObject(e){void 0!==e._colorId&&delete this._colorMap[e._colorId]}_adjustBoundingBox(e){const t=this._ghostLayer.margin;return new DOMRect(-t.left,-t.top,e.width+t.left+t.right,e.height+t.top+t.bottom)}getEvent(e,t=!0){const i=this.view.getBoundingClientRect(),r=e.clientX||0,a=e.clientY||0,s=this._calculatedWidth/this._realWidth,n=this._calculatedHeight/this._realHeight,o={x:r-i.left,y:a-i.top},l={x:(r-(t?i.left:0))*s,y:(a-(t?i.top:0))*n};return new za(e,o,l,this._adjustBoundingBox(i))}_getHitTarget(e,t,i){if(0===t.width||0===t.height||e.x<t.left||e.x>t.right||e.y<t.top||e.y>t.bottom)return;if(!i||!this._layerDom.contains(i))return;const r=this._ghostLayer.getImageData(e,t);if(0===r.data[0]&&0===r.data[1]&&0===r.data[2])return!1;const a=ki.fromRGB(r.data[0],r.data[1],r.data[2]).toCSS();return this._colorMap[a]}getObjectAtPoint(e){const t=this._ghostLayer.getImageArray(e);if(0===t[0]&&0===t[1]&&0===t[2])return;const i=ki.fromRGB(t[0],t[1],t[2]).toCSS();return this._colorMap[i]}_withEvents(e,t){const i=this._events[e];if(void 0!==i){i.dispatching=!0;try{t(i)}finally{i.dispatching=!1,i.cleanup&&(i.cleanup=!1,Lt(i.callbacks,(e=>!e.disposed)),0===i.callbacks.length&&(i.disposer.dispose(),delete this._events[e]))}}}_dispatchEventAll(e,t){this.interactionsEnabled&&this._withEvents(e,(e=>{At(e.callbacks,(e=>{e.disposed||e.callback.call(e.context,t)}))}))}_dispatchEvent(e,t,i){if(!this.interactionsEnabled)return!1;let r=!1;return this._withEvents(e,(e=>{At(e.callbacks,(e=>{e.disposed||e.object!==t||(e.callback.call(e.context,i),r=!0)}))})),r}_dispatchMousedown(e,t){const i=e.button;if(0!=i&&2!=i&&1!=i&&void 0!==i)return;const r=this.getEvent(e),a=this._getHitTarget(r.originalPoint,r.bbox,t);if(a){const e=r.id;let t=!1;na(a,(i=>{const a={id:e,value:i};return this._mousedown.push(a),!t&&this._dispatchEvent("pointerdown",i,r)&&(t=!0,this._dragging.some((t=>t.value===i&&t.id===e))||this._dragging.push(a)),!0}))}}_dispatchGlobalMousemove(e,t,i){const r=this.getEvent(e),a=this._getHitTarget(r.originalPoint,r.bbox,t);r.native=i,a?(this._hovering.forEach((e=>{e.contains(a)||(this._hovering.delete(e),e.cursorOverStyle&&Zt(document.body,"cursor",e._replacedCursorStyle),this._dispatchEvent("pointerout",e,r))})),r.native&&na(a,(e=>(this._hovering.has(e)||(this._hovering.add(e),e.cursorOverStyle&&(e._replacedCursorStyle=document.body.style.cursor,Zt(document.body,"cursor",e.cursorOverStyle)),this._dispatchEvent("pointerover",e,r)),!0)))):(this._hovering.forEach((e=>{e.cursorOverStyle&&Zt(document.body,"cursor",e._replacedCursorStyle),this._dispatchEvent("pointerout",e,r)})),this._hovering.clear()),this._dispatchEventAll("globalpointermove",r)}removeHovering(e){this._hovering.delete(e),e.cursorOverStyle&&Zt(document.body,"cursor",e._replacedCursorStyle)}_dispatchGlobalMouseup(e,t){const i=this.getEvent(e);i.native=t,this._dispatchEventAll("globalpointerup",i)}_dispatchDragMove(e){if(0!==this._dragging.length){const t=this.getEvent(e),i=t.id;this._dragging.forEach((e=>{e.id===i&&this._dispatchEvent("pointermove",e.value,t)}))}}_dispatchDragEnd(e,t){const i=e.button;let r;if(0==i||void 0===i)r="click";else if(2==i)r="rightclick";else{if(1!=i)return;r="middleclick"}const a=this.getEvent(e),s=a.id;if(0!==this._mousedown.length){const e=this._getHitTarget(a.originalPoint,a.bbox,t);e&&this._mousedown.forEach((t=>{t.id===s&&t.value.contains(e)&&this._dispatchEvent(r,t.value,a)})),this._mousedown.length=0}0!==this._dragging.length&&(this._dragging.forEach((e=>{e.id===s&&this._dispatchEvent("pointerup",e.value,a)})),this._dragging.length=0)}_dispatchDoubleClick(e,t){const i=this.getEvent(e),r=this._getHitTarget(i.originalPoint,i.bbox,t);r&&na(r,(e=>!this._dispatchEvent("dblclick",e,i)))}_dispatchWheel(e,t){const i=this.getEvent(e),r=this._getHitTarget(i.originalPoint,i.bbox,t);r&&na(r,(e=>!this._dispatchEvent("wheel",e,i)))}_makeSharedEvent(e,t){if(void 0===this._listeners[e]){const i=t();this._listeners[e]=new Vt((()=>{delete this._listeners[e],i.dispose()}))}return this._listeners[e].increment()}_onPointerEvent(e,t){let i=!1,r=null;function a(){r=null,i=!1}return new Wt([new Ut((()=>{null!==r&&clearTimeout(r),a()})),$t(this.view,Kt(e),(e=>{i=!0,null!==r&&clearTimeout(r),r=window.setTimeout(a,0)})),oa(window,e,((e,a)=>{null!==r&&(clearTimeout(r),r=null),t(e,a,i),i=!1}))])}_initEvent(e){switch(e){case"globalpointermove":case"pointerover":case"pointerout":return this._makeSharedEvent("pointermove",(()=>{const e=(e,t,i)=>{this._lastPointerMoveEvent={events:e,target:t,native:i},At(e,(e=>{this._dispatchGlobalMousemove(e,t,i)}))};return new Wt([this._onPointerEvent("pointerdown",e),this._onPointerEvent("pointermove",e)])}));case"globalpointerup":return this._makeSharedEvent("pointerup",(()=>{const e=this._onPointerEvent("pointerup",((e,t,i)=>{At(e,(e=>{this._dispatchGlobalMouseup(e,i)})),this._lastPointerMoveEvent={events:e,target:t,native:i}})),t=this._onPointerEvent("pointercancel",((e,t,i)=>{At(e,(e=>{this._dispatchGlobalMouseup(e,i)})),this._lastPointerMoveEvent={events:e,target:t,native:i}}));return new Ut((()=>{e.dispose(),t.dispose()}))}));case"click":case"rightclick":case"middleclick":case"pointerdown":case"pointermove":case"pointerup":return this._makeSharedEvent("pointerdown",(()=>{const e=this._onPointerEvent("pointerdown",((e,t)=>{At(e,(e=>{this._dispatchMousedown(e,t)}))})),t=this._onPointerEvent("pointermove",(e=>{At(e,(e=>{this._dispatchDragMove(e)}))})),i=this._onPointerEvent("pointerup",((e,t)=>{At(e,(e=>{this._dispatchDragEnd(e,t)}))})),r=this._onPointerEvent("pointercancel",((e,t)=>{At(e,(e=>{this._dispatchDragEnd(e,t)}))}));return new Ut((()=>{e.dispose(),t.dispose(),i.dispose(),r.dispose()}))}));case"dblclick":return this._makeSharedEvent("dblclick",(()=>this._onPointerEvent("dblclick",((e,t)=>{At(e,(e=>{this._dispatchDoubleClick(e,t)}))}))));case"wheel":return this._makeSharedEvent("wheel",(()=>$t(this.view,Kt("wheel"),(e=>{this._dispatchWheel(e,Jt(e))}),{passive:!1})))}}_addEvent(e,t,i,r){let a=this._events[t];void 0===a&&(a=this._events[t]={disposer:this._initEvent(t),callbacks:[],dispatching:!1,cleanup:!1});const s={object:e,context:r,callback:i,disposed:!1};return a.callbacks.push(s),new Ut((()=>{s.disposed=!0,a.dispatching?a.cleanup=!0:(Pt(a.callbacks,s),0===a.callbacks.length&&(a.disposer.dispose(),delete this._events[t]))}))}getCanvas(e,t){this.render(e),t||(t={});let i=this.resolution,r=Math.floor(this._calculatedWidth*this.resolution),a=Math.floor(this._calculatedHeight*this.resolution);if(t.minWidth&&t.minWidth>r){let e=t.minWidth/r;e>i&&(i=e*this.resolution)}if(t.minHeight&&t.minHeight>a){let e=t.minHeight/a;e>i&&(i=e*this.resolution)}if(t.maxWidth&&t.maxWidth<r){let e=t.maxWidth/r;e<i&&(i=e*this.resolution)}if(t.maxHeight&&t.maxHeight>a){let e=t.maxHeight/a;e<i&&(i=e*this.resolution)}t.maintainPixelRatio&&(i/=this.resolution);const s=[];let n=!1;const o=document.createElement("canvas");i!=this.resolution&&(n=!0,r=r*i/this.resolution,a=a*i/this.resolution),o.width=r,o.height=a,o.style.position="fixed",o.style.top="-10000px",this.view.appendChild(o),s.push(o);const l=o.getContext("2d");let c=0,h=0,u=!1;return At(this.layers,(e=>{if(e&&e.visible&&(e.tainted||n)){u=!0,e.exportableView=e.view,e.exportableContext=e.context,e.view=document.createElement("canvas"),e.view.style.position="fixed",e.view.style.top="-10000px",this.view.appendChild(e.view),s.push(e.view);let t=0,n=0;e.margin&&(t+=e.margin.left||0+e.margin.right||0,n+=e.margin.top||0+e.margin.bottom||0),e.view.width=r+t,e.view.height=a+n,e.context=e.view.getContext("2d"),e.dirty=!0,e.scale=i}})),u&&(this._omitTainted=!0,this.render(e),this._omitTainted=!1),At(this.layers,(e=>{if(e&&e.visible){let t=0,i=0;e.margin&&(t=-(e.margin.left||0)*this.resolution,i=-(e.margin.top||0)*this.resolution),l.drawImage(e.view,t,i),e.exportableView&&(e.view=e.exportableView,e.exportableView=void 0),e.exportableContext&&(e.context=e.exportableContext,e.exportableContext=void 0),c<e.view.clientWidth&&(c=e.view.clientWidth),h<e.view.clientHeight&&(h=e.view.clientHeight),e.scale=void 0}})),o.style.width=c+"px",o.style.height=h+"px",At(s,(e=>{e.style.position="",e.style.top="",this.view.removeChild(e)})),o}}class Ha{constructor(){Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_resolution",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"imageArray",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.view=document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.context.imageSmoothingEnabled=!1,this.view.style.position="absolute",this.view.style.top="0px",this.view.style.left="0px"}resize(e,t,i,r,a){this._resolution=a,e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,r+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px",this._width=Math.floor(e*a),this._height=Math.floor(t*a),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=r+"px"}getImageData(e,t){return this.context.getImageData(Math.round((e.x-t.left)/t.width*this._width),Math.round((e.y-t.top)/t.height*this._height),1,1)}getImageArray(e){this.imageArray||(this.imageArray=this.context.getImageData(0,0,this._width,this._height).data);const t=this.imageArray,i=Math.round(e.x*this._resolution),r=4*(Math.round(e.y*this._resolution)*this._width+i);return[t[r],t[r+1],t[r+2],t[r+3]]}setMargin(e){this.margin.left=0,this.margin.right=0,this.margin.top=0,this.margin.bottom=0,At(e,(e=>{e.margin&&(this.margin.left=Math.max(this.margin.left,e.margin.left),this.margin.right=Math.max(this.margin.right,e.margin.right),this.margin.top=Math.max(this.margin.top,e.margin.top),this.margin.bottom=Math.max(this.margin.bottom,e.margin.bottom))}))}clear(){this.context.save(),this.context.fillStyle="#000",this.context.fillRect(0,0,this._width,this._height)}}class Wa{constructor(e,t){Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"order",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dirty",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportableView",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exportableContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=e,this.context=t}resize(e,t,i,r,a){null!=this.width&&(e=this.width,i=this.width),null!=this.height&&(t=this.height,r=this.height),this.margin?(e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,r+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px"):(this.view.style.left="0px",this.view.style.top="0px"),this._width=Math.floor(e*a),this._height=Math.floor(t*a),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=r+"px"}clear(){this.context.save(),this.context.clearRect(0,0,this._width,this._height)}}function Va(e,t){null==e?requestAnimationFrame(t):setTimeout((()=>{requestAnimationFrame(t)}),1e3/e)}class $a{constructor(e,t={},i){if(Object.defineProperty(this,"dom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inner",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDirtyAnimation",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyBounds",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyPositions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_ticker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tickers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_updateTick",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Ri}),Object.defineProperty(this,"animationTime",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_animations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rootContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tooltipContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipContainerSettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"language",{enumerable:!0,configurable:!0,writable:!0,value:$r.new(this,{})}),Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:Vr}),Object.defineProperty(this,"utc",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timezone",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numberFormatter",{enumerable:!0,configurable:!0,writable:!0,value:Br.new(this,{})}),Object.defineProperty(this,"dateFormatter",{enumerable:!0,configurable:!0,writable:!0,value:Hr.new(this,{})}),Object.defineProperty(this,"durationFormatter",{enumerable:!0,configurable:!0,writable:!0,value:Wr.new(this,{})}),Object.defineProperty(this,"tabindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tabindexes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_a11yD",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_focusedSprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isShift",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_keyboardDragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_readerAlertElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_logo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipDiv",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nonce",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interfaceColors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verticalLayout",{enumerable:!0,configurable:!0,writable:!0,value:wr.new(this,{})}),Object.defineProperty(this,"horizontalLayout",{enumerable:!0,configurable:!0,writable:!0,value:_r.new(this,{})}),Object.defineProperty(this,"gridLayout",{enumerable:!0,configurable:!0,writable:!0,value:xr.new(this,{})}),Object.defineProperty(this,"_paused",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"autoResize",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_fontHash",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_resizeSensorDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltips",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_htmlElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_htmlEnabledContainers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"entitiesById",{enumerable:!0,configurable:!0,writable:!0,value:{}}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");let r,a;if(this._settings=t,0==t.accessible&&(this._a11yD=!0),null==t.useSafeResolution&&(t.useSafeResolution=!0),t.useSafeResolution&&(r=/apple/i.test(navigator.vendor)&&"ontouchend"in document?1:void 0),this._renderer=new Ua(r),a=e instanceof HTMLElement?e:document.getElementById(e),At(Wi.rootElements,(e=>{if(e.dom===a)throw new Error("You cannot have multiple Roots on the same DOM node")})),this.interfaceColors=Ir.new(this,{}),null===a)throw new Error("Could not find HTML element with id `"+e+"`");this.dom=a;let s=document.createElement("div");s.style.position="relative",s.style.width="100%",s.style.height="100%",a.appendChild(s);const n=t.tooltipContainerBounds;n&&(this._tooltipContainerSettings=n),this._inner=s,this._updateComputedStyles(),Wi.rootElements.push(this)}static new(e,t){const i=new $a(e,t,!0);return i._init(),i}moveDOM(e){let t;if(t=e instanceof HTMLElement?e:document.getElementById(e),t){for(;this.dom.childNodes.length>0;)t.appendChild(this.dom.childNodes[0]);this.dom=t,this._initResizeSensor(),this.resize()}}_handleLogo(){if(this._logo){const e=this.dom.offsetWidth,t=this.dom.offsetHeight;e<=150||t<=60?this._logo.hide():this._logo.show()}}_showBranding(){if(!this._logo){const e=this.tooltipContainer.children.push(Er.new(this,{interactive:!0,interactiveChildren:!1,position:"absolute",setStateOnChildren:!0,paddingTop:9,paddingRight:9,paddingBottom:9,paddingLeft:9,scale:.6,y:nt(100),centerY:lt,tooltipText:"Created using amCharts 5",tooltipX:lt,cursorOverStyle:"pointer",background:br.new(this,{fill:Ti(4671320),fillOpacity:0,tooltipY:5})})),t=Nr.new(this,{pointerOrientation:"horizontal",paddingTop:4,paddingRight:7,paddingBottom:4,paddingLeft:7});t.label.setAll({fontSize:12}),t.get("background").setAll({fill:this.interfaceColors.get("background"),stroke:this.interfaceColors.get("grid"),strokeOpacity:.3}),e.set("tooltip",t),e.events.on("click",(()=>{window.open("https://www.amcharts.com/","_blank")})),e.states.create("hover",{}),e.children.push(mr.new(this,{stroke:Ti(13421772),strokeWidth:3,svgPath:"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6"})).states.create("hover",{stroke:Ti(3976191)}),e.children.push(mr.new(this,{stroke:Ti(8947848),strokeWidth:3,svgPath:"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0"})).states.create("hover",{stroke:Ti(4671320)}),this._logo=e,this._handleLogo()}}_getRealSize(){return this.dom.getBoundingClientRect()}_getCalculatedSize(e){return this._settings.calculateSize?this._settings.calculateSize(e):{width:e.width,height:e.height}}_init(){const e=this._settings;!1!==e.accessible&&(e.focusable&&(this._inner.setAttribute("focusable","true"),this._inner.setAttribute("tabindex",this.tabindex+"")),e.ariaLabel&&this._inner.setAttribute("aria-label",e.ariaLabel),e.role&&this._inner.setAttribute("role",e.role));const t=this._renderer,i=this._getRealSize(),r=this._getCalculatedSize(i),a=Math.floor(r.width),s=Math.floor(r.height),n=Math.floor(i.width),o=Math.floor(i.height),l=Er.new(this,{visible:!0,width:a,height:s});this._rootContainer=l,this._rootContainer._defaultThemes.push(Gr.new(this));const c=l.children.push(Er.new(this,{visible:!0,width:lt,height:lt}));this.container=c,t.resize(n,o,a,s),this._inner.appendChild(t.view),this._initResizeSensor();const h=document.createElement("div");if(this._htmlElementContainer=h,h.className="am5-html-container",h.style.position="absolute",h.style.pointerEvents="none",this._tooltipContainerSettings||(h.style.overflow="hidden"),this._inner.appendChild(h),!0!==this._a11yD){const e=document.createElement("div");e.className="am5-reader-container",e.setAttribute("role","alert"),e.style.position="absolute",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden",e.style.clip="rect(1px, 1px, 1px, 1px)",this._readerAlertElement=e,this._inner.appendChild(this._readerAlertElement);const i=document.createElement("div");i.className="am5-focus-container",i.style.position="absolute",i.style.pointerEvents="none",i.style.top="0px",i.style.left="0px",i.style.overflow="hidden",i.style.width=a+"px",i.style.height=s+"px",i.setAttribute("role","graphics-document"),ei(i,!1),this._focusElementContainer=i,this._inner.appendChild(this._focusElementContainer);const r=document.createElement("div");this._tooltipElementContainer=r,r.className="am5-tooltip-container",this._inner.appendChild(r),Yt("keyboardevents")&&(this._disposers.push($t(window,"keydown",(e=>{const t=ti(e);"Shift"==t?this._isShift=!0:"Tab"==t&&(this._isShift=e.shiftKey)}))),this._disposers.push($t(window,"keyup",(e=>{"Shift"==ti(e)&&(this._isShift=!1)}))),this._disposers.push($t(i,"click",(()=>{const e=this._focusedSprite;if(e){const i=e.get("clickAnnounceText","");""!==i&&this.readerAlert(i);const r=t.getEvent(new MouseEvent("click"));e.events.dispatch("click",{type:"click",originalEvent:r.event,point:r.point,simulated:!0,target:e})}}))),this._disposers.push($t(i,"keydown",(e=>{const i=this._focusedSprite;if(i){"Escape"==e.key&&(function(){if(document.activeElement&&document.activeElement!=document.body)if(document.activeElement.blur)document.activeElement.blur();else{let e=document.createElement("button");e.style.position="fixed",e.style.top="0px",e.style.left="-10000px",document.body.appendChild(e),e.focus(),e.blur(),document.body.removeChild(e)}}(),this._focusedSprite=void 0);let r=0,a=0;const s=ti(e);switch(s){case"Enter":case" ":const n=i.get("clickAnnounceText","");if(""!==n&&this.readerAlert(n)," "==s&&"checkbox"!=i.get("role"))return;e.preventDefault();const o=t.getEvent(new MouseEvent("mouse"));return void i.events.dispatch("click",{type:"click",originalEvent:o.event,point:o.point,simulated:!0,target:i});case"ArrowLeft":r=-6;break;case"ArrowRight":r=6;break;case"ArrowUp":a=-6;break;case"ArrowDown":a=6;break;default:return}if(0!=r||0!=a){if(e.preventDefault(),!i.isDragging()){this._keyboardDragPoint={x:0,y:0};const e=t.getEvent(new MouseEvent("mousedown",{clientX:0,clientY:0}));e.point={x:0,y:0},i.events.isEnabled("pointerdown")&&i.events.dispatch("pointerdown",{type:"pointerdown",originalEvent:e.event,point:e.point,simulated:!0,target:i})}const s=this._keyboardDragPoint;s.x+=r,s.y+=a;const n=t.getEvent(new MouseEvent("mousemove",{clientX:s.x,clientY:s.y}),!1);i.events.isEnabled("globalpointermove")&&i.events.dispatch("globalpointermove",{type:"globalpointermove",originalEvent:n.event,point:n.point,simulated:!0,target:i})}}}))),this._disposers.push($t(i,"keyup",(e=>{if(this._focusedSprite){const r=this._focusedSprite,a=ti(e);switch(a){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":if(r.isDragging()){const e=this._keyboardDragPoint,i=t.getEvent(new MouseEvent("mouseup",{clientX:e.x,clientY:e.y}));return r.events.isEnabled("globalpointerup")&&r.events.dispatch("globalpointerup",{type:"globalpointerup",originalEvent:i.event,point:i.point,simulated:!0,target:r}),void(this._keyboardDragPoint=void 0)}if(r.get("focusableGroup")){const e=r.get("focusableGroup"),t=this._tabindexes.filter((t=>!(t.get("focusableGroup")!=e||!1===t.getPrivate("focusable")||!t.isVisibleDeep())));let s=t.indexOf(r);const n=t.length-1;s+="ArrowRight"==a||"ArrowDown"==a?1:-1,s<0?s=n:s>n&&(s=0),(i=t[s].getPrivate("focusElement").dom)&&i.focus()}break;case"Tab":const e=r.get("focusableGroup");if(e&&this._isShift)return void this._focusNext(r.getPrivate("focusElement").dom,-1,e)}}var i}))))}this._startTicker(),this.setThemes([]),this._addTooltip(),this._hasLicense()||this._showBranding()}_initResizeSensor(){this._resizeSensorDisposer&&this._resizeSensorDisposer.dispose(),this._resizeSensorDisposer=new Mr(this.dom,(()=>{this.autoResize&&this.resize()})),this._disposers.push(this._resizeSensorDisposer)}resize(){const e=this._getRealSize(),t=this._getCalculatedSize(e),i=Math.floor(t.width),r=Math.floor(t.height);if(i>0&&r>0){const t=Math.floor(e.width),a=Math.floor(e.height),s=this._htmlElementContainer;if(s.style.width=i+"px",s.style.height=r+"px",!0!==this._a11yD){const e=this._focusElementContainer;e.style.width=i+"px",e.style.height=r+"px"}this._renderer.resize(t,a,i,r);const n=this._rootContainer;n.setPrivate("width",i),n.setPrivate("height",r),this._render(),this._handleLogo()}}_render(){this._renderer.render(this._rootContainer._display),this._focusElementDirty&&(this._updateCurrentFocus(),this._focusElementDirty=!1)}_runTickers(e){At(this._tickers,(t=>{t(e)}))}_runAnimations(e){let t=0;return Lt(this._animations,(i=>{const r=i._runAnimation(e);return r!==Oi.Stopped&&(r!==Oi.Playing||(++t,!0))})),this._isDirtyAnimation=!1,0===t}_runDirties(){let e={};for(;this._isDirtyParents;)this._isDirtyParents=!1,Ft(this._dirtyParents).forEach((t=>{const i=this._dirtyParents[t];delete this._dirtyParents[t],i.isDisposed()||(e[i.uid]=i,i._prepareChildren())}));Ft(e).forEach((t=>{e[t]._updateChildren()}));const t=[];Ft(this._dirty).forEach((e=>{const i=this._dirty[e];i.isDisposed()?delete this._dirty[i.uid]:(t.push(i),i._beforeChanged())})),t.forEach((e=>{e._changed(),delete this._dirty[e.uid],e._clearDirty()})),this._isDirty=!1;const i={},r=[];Ft(this._dirtyBounds).forEach((e=>{const t=this._dirtyBounds[e];delete this._dirtyBounds[e],t.isDisposed()||(i[t.uid]=t.depth(),r.push(t))})),this._positionHTMLElements(),r.sort(((e,t)=>Vi(i[t.uid],i[e.uid]))),r.forEach((e=>{e._updateBounds()}));const a=this._dirtyPositions;Ft(a).forEach((e=>{const t=a[e];delete a[e],t.isDisposed()||t._updatePosition()})),t.forEach((e=>{e._afterChanged()}))}_renderFrame(e){if(this._updateTick){this.events.isEnabled("framestarted")&&this.events.dispatch("framestarted",{type:"framestarted",target:this,timestamp:e}),this._checkComputedStyles(),this._runTickers(e);const t=this._runAnimations(e);return this._runDirties(),this._render(),this._renderer.resetImageArray(),this._positionHTMLElements(),this.events.isEnabled("frameended")&&this.events.dispatch("frameended",{type:"frameended",target:this,timestamp:e}),0===this._tickers.length&&t&&!this._isDirtyAnimation&&!this._isDirty}return!0}_runTicker(e,t){this.isDisposed()||(this.animationTime=e,this._renderFrame(e)?(this._ticker=null,this.animationTime=null):this._paused||(t?this._ticker:Va(this.fps,this._ticker)))}_runTickerNow(e=1e4){if(!this.isDisposed()){const t=performance.now()+e;for(;;){const e=performance.now();if(e>=t){this.animationTime=null;break}if(this.animationTime=e,this._renderFrame(e)){this.animationTime=null;break}}}}_startTicker(){null===this._ticker&&(this.animationTime=null,this._ticker=e=>{this._runTicker(e)},Va(this.fps,this._ticker))}get updateTick(){return this._updateTick}set updateTick(e){this._updateTick=e,e&&this._startTicker()}_addDirtyEntity(e){this._isDirty=!0,void 0===this._dirty[e.uid]&&(this._dirty[e.uid]=e),this._startTicker()}_addDirtyParent(e){this._isDirty=!0,this._isDirtyParents=!0,void 0===this._dirtyParents[e.uid]&&(this._dirtyParents[e.uid]=e),this._startTicker()}_addDirtyBounds(e){this._isDirty=!0,void 0===this._dirtyBounds[e.uid]&&(this._dirtyBounds[e.uid]=e),this._startTicker()}_addDirtyPosition(e){this._isDirty=!0,void 0===this._dirtyPositions[e.uid]&&(this._dirtyPositions[e.uid]=e),this._startTicker()}_addAnimation(e){this._isDirtyAnimation=!0,-1===this._animations.indexOf(e)&&this._animations.push(e),this._startTicker()}_markDirty(){this._isDirty=!0}_markDirtyRedraw(){this.events.once("frameended",(()=>{this._isDirty=!0,this._startTicker()}))}eachFrame(e){return this._tickers.push(e),this._startTicker(),new Ut((()=>{Pt(this._tickers,e)}))}markDirtyGlobal(e){e||(e=this.container),e.walkChildren((e=>{e instanceof Er&&this.markDirtyGlobal(e),e.markDirty(),e.markDirtyBounds()}))}width(){return Math.floor(this._getCalculatedSize(this._getRealSize()).width)}height(){return Math.floor(this._getCalculatedSize(this._getRealSize()).height)}dispose(){var e;this._isDisposed||(this._isDisposed=!0,this._rootContainer.dispose(),this._renderer.dispose(),this.horizontalLayout.dispose(),this.verticalLayout.dispose(),this.interfaceColors.dispose(),At(this._disposers,(e=>{e.dispose()})),this._inner&&(e=this._inner).parentNode&&e.parentNode.removeChild(e),St(Wi.rootElements,this))}isDisposed(){return this._isDisposed}readerAlert(e){if(!0!==this._a11yD){const t=this._readerAlertElement;e=oi(e),t.innerHTML==e&&(t.innerHTML=""),t.innerHTML=e}}setThemes(e){this._rootContainer.set("themes",e);const t=this.tooltipContainer;t&&t._applyThemes();const i=this.interfaceColors;i&&i._applyThemes()}_addTooltip(){if(!this.tooltipContainer){const e=this._tooltipContainerSettings,t=this._rootContainer.children.push(Er.new(this,{position:"absolute",isMeasured:!1,width:lt,height:lt,layer:e?35:30,layerMargin:e||void 0}));this.tooltipContainer=t;const i=Nr.new(this,{});this.container.set("tooltip",i),i.hide(0),this._tooltip=i}}_registerTabindexOrder(e){1!=this._a11yD&&(e.get("focusable")?Ct(this._tabindexes,e):St(this._tabindexes,e),this._invalidateTabindexes())}_unregisterTabindexOrder(e){1!=this._a11yD&&(St(this._tabindexes,e),this._invalidateTabindexes())}_invalidateTabindexes(){if(1==this._a11yD)return;this._tabindexes.sort(((e,t)=>{const i=e.get("tabindexOrder",0),r=t.get("tabindexOrder",0);return i==r?0:i>r?1:-1}));const e=[];At(this._tabindexes,((t,i)=>{t.getPrivate("focusElement")?this._moveFocusElement(i,t):this._makeFocusElement(i,t);const r=t.get("focusableGroup");r&&!1!==t.getPrivate("focusable")&&(-1!==e.indexOf(r)?t.getPrivate("focusElement").dom.setAttribute("tabindex","-1"):e.push(r))}))}_updateCurrentFocus(){1!=this._a11yD&&this._focusedSprite&&(this._decorateFocusElement(this._focusedSprite),this._positionFocusElement(this._focusedSprite))}_decorateFocusElement(e,t){if(1==this._a11yD)return;if(t||(t=e.getPrivate("focusElement").dom),!t)return;const i=e.get("role");i?t.setAttribute("role",i):t.removeAttribute("role");const r=e.get("ariaLabel");if(r){const i=Tr(e,r);t.setAttribute("aria-label",i)}else t.removeAttribute("aria-label");const a=e.get("ariaLive");a?t.setAttribute("aria-live",a):t.removeAttribute("aria-live");const s=e.get("ariaChecked");null!=s&&i&&-1!==["checkbox","option","radio","menuitemcheckbox","menuitemradio","treeitem"].indexOf(i)?t.setAttribute("aria-checked",s?"true":"false"):t.removeAttribute("aria-checked");const n=e.get("ariaCurrent");null!=n?t.setAttribute("aria-current",n):t.removeAttribute("aria-current");const o=e.get("ariaSelected");null!=o&&i&&-1!==["gridcell","option","row","tab","columnheader","rowheader","treeitem"].indexOf(i)?t.setAttribute("aria-selected",o?"true":"false"):t.removeAttribute("aria-selected"),e.get("ariaHidden")?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden");const l=e.get("ariaOrientation");l?t.setAttribute("aria-orientation",l):t.removeAttribute("aria-orientation");const c=e.get("ariaValueNow");c?t.setAttribute("aria-valuenow",c):t.removeAttribute("aria-valuenow");const h=e.get("ariaValueMin");h?t.setAttribute("aria-valuemin",h):t.removeAttribute("aria-valuemin");const u=e.get("ariaValueMax");u?t.setAttribute("aria-valuemax",u):t.removeAttribute("aria-valuemax");const d=e.get("ariaValueText");d?t.setAttribute("aria-valuetext",d):t.removeAttribute("aria-valuetext");const f=e.get("ariaControls");f?t.setAttribute("aria-controls",f):t.removeAttribute("aria-controls"),e.get("visible")&&0!==e.get("opacity")&&"tooltip"!=e.get("role")&&!e.isHidden()&&!1!==e.getPrivate("focusable")&&(e.height()||e.width())?("-1"!=t.getAttribute("tabindex")&&t.setAttribute("tabindex",""+this.tabindex),t.removeAttribute("aria-hidden")):(t.removeAttribute("tabindex"),t.setAttribute("aria-hidden","true"))}_makeFocusElement(e,t){if(t.getPrivate("focusElement")||1==this._a11yD)return;const i=document.createElement("div");"tooltip"!=t.get("role")&&(i.tabIndex=this.tabindex),i.style.position="absolute",ei(i,!1);const r=[];t.setPrivate("focusElement",{dom:i,disposers:r}),this._decorateFocusElement(t),r.push($t(i,"focus",(e=>{this._handleFocus(e)}))),r.push($t(i,"blur",(e=>{this._handleBlur(e)}))),this._moveFocusElement(e,t)}_removeFocusElement(e){if(1==this._a11yD)return;St(this._tabindexes,e);const t=e.getPrivate("focusElement");t&&(this._focusElementContainer.removeChild(t.dom),At(t.disposers,(e=>{e.dispose()})))}_hideFocusElement(e){1!=this._a11yD&&(e.getPrivate("focusElement").dom.style.display="none")}_moveFocusElement(e,t){if(1==this._a11yD)return;const i=this._focusElementContainer,r=t.getPrivate("focusElement").dom;if(r===this._focusElementContainer.children[e])return;const a=this._focusElementContainer.children[e+1];a?i.insertBefore(r,a):i.append(r)}_positionFocusElement(e){if(1==this._a11yD||null==e)return;const t=e.globalBounds();let i=t.right==t.left?e.width():t.right-t.left,r=t.top==t.bottom?e.height():t.bottom-t.top;const a=void 0!==this._settings.focusPadding?this._settings.focusPadding:2;let s=t.left-a,n=t.top-a;i<0&&(s+=i,i=Math.abs(i)),r<0&&(n+=r,r=Math.abs(r));const o=e.getPrivate("focusElement").dom;o.style.top=n+"px",o.style.left=s+"px",o.style.width=i+2*a+"px",o.style.height=r+2*a+"px"}_getSpriteByFocusElement(e){let t;return kt(this._tabindexes,((i,r)=>i.getPrivate("focusElement").dom!==e||(t=i,!1))),t}_handleFocus(e){if(1==this._a11yD)return;const t=this._getSpriteByFocusElement(e.target);t&&(t.isVisibleDeep()?(this._positionFocusElement(t),this._focusedSprite=t,t.events.isEnabled("focus")&&t.events.dispatch("focus",{type:"focus",originalEvent:e,target:t})):this._focusNext(e.target,this._isShift?-1:1))}_focusNext(e,t,i){if(1==this._a11yD)return;const r=Array.from(document.querySelectorAll(["a[href]","area[href]","button:not([disabled])","details","input:not([disabled])","iframe:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contentEditable=""]','[contentEditable="true"]','[contentEditable="TRUE"]','[tabindex]:not([tabindex^="-"])'].join(",")));let a=r.indexOf(e)+t;a<0?a=r.length-1:a>=r.length&&(a=0);const s=r[a];if(i&&-1==t){const e=this._getSpriteByFocusElement(s);if(e&&e.get("focusableGroup")==i)return void this._focusNext(s,t)}s.focus()}_handleBlur(e){if(1==this._a11yD)return;const t=this._focusedSprite;t&&!t.isDisposed()&&t.events.isEnabled("blur")&&t.events.dispatch("blur",{type:"blur",originalEvent:e,target:t}),this._focusedSprite=void 0}updateTooltip(e){if(1==this._a11yD)return;const t=oi(e._getText());let i=e.getPrivate("tooltipElement");"tooltip"==e.get("role")&&""!=t?(i||(i=this._makeTooltipElement(e)),i.innerHTML!=t&&(i.innerHTML=t),i.setAttribute("aria-hidden",e.isVisibleDeep()?"false":"true")):i&&(i.remove(),e.removePrivate("tooltipElement"))}_makeTooltipElement(e){const t=this._tooltipElementContainer,i=document.createElement("div");return i.style.position="absolute",i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",i.style.clip="rect(1px, 1px, 1px, 1px)",ei(i,!1),this._decorateFocusElement(e,i),t.append(i),e.setPrivate("tooltipElement",i),i}_removeTooltipElement(e){if(1==this._a11yD)return;const t=e.getPrivate("tooltipElement");if(t){const e=t.parentElement;e&&e.removeChild(t)}}_invalidateAccessibility(e){if(1==this._a11yD)return;this._focusElementDirty=!0;const t=e.getPrivate("focusElement");e.get("focusable")?t&&(this._decorateFocusElement(e),this._positionFocusElement(e)):t&&this._removeFocusElement(e)}focused(e){return this._focusedSprite===e}documentPointToRoot(e){const t=this._getRealSize(),i=this._getCalculatedSize(t),r=i.width/t.width,a=i.height/t.height;return{x:(e.x-t.left)*r,y:(e.y-t.top)*a}}rootPointToDocument(e){const t=this._getRealSize(),i=this._getCalculatedSize(t),r=i.width/t.width,a=i.height/t.height;return{x:e.x/r+t.left,y:e.y/a+t.top}}addDisposer(e){return this._disposers.push(e),e}_updateComputedStyles(){const e=window.getComputedStyle(this.dom);let t="";Bt(e,((e,i)=>{mt(e)&&e.match(/^font/)&&(t+=i)}));const i=t!=this._fontHash;return i&&(this._fontHash=t),i}_checkComputedStyles(){this._updateComputedStyles()&&this._invalidateLabelBounds(this.container)}_invalidateLabelBounds(e){e instanceof Er?e.children.each((e=>{this._invalidateLabelBounds(e)})):e instanceof Cr&&e.markDirtyBounds()}_hasLicense(){for(let e=0;e<Wi.licenses.length;e++)if(Wi.licenses[e].match(/^AM5C.{5,}/i))return!0;return!1}_licenseApplied(){this._logo&&this._logo.set("forceHidden",!0)}get debugGhostView(){return this._renderer.debugGhostView}set debugGhostView(e){this._renderer.debugGhostView=e}set tapToActivate(e){this._renderer.tapToActivate=e}get tapToActivate(){return this._renderer.tapToActivate}set tapToActivateTimeout(e){this._renderer.tapToActivateTimeout=e}get tapToActivateTimeout(){return this._renderer.tapToActivateTimeout}_makeHTMLElement(e){const t=this._htmlElementContainer,i=document.createElement("div");e.setPrivate("htmlElement",i);let r,a,s=!1;return e._walkParents((e=>{if(e.get("verticalScrollbar"))return s=!0,r=e,!1})),s&&(a=document.createElement("div"),e.setPrivate("htmlElementWrapper",a),e.setPrivate("wrapperContainer",r),a.style.position="absolute",a.style.overflow="hidden",a.style.boxSizing="border-box",a.style.top="0px",a.style.left="0px",a.style.width="100%",a.style.height="100%",r.events.on("boundschanged",(()=>{this._positionHTMLElement(e)}))),i.style.position="absolute",i.style.overflow="auto",i.style.boxSizing="border-box",ei(i,e.get("interactive",!1)),e.events.isEnabled("click")&&(ei(i,!0),this._disposers.push($t(i,"click",(t=>{const i=this._renderer.getEvent(t);e.events.dispatch("click",{type:"click",originalEvent:i.event,point:i.point,simulated:!1,target:e})})))),this._positionHTMLElement(e),s?(a.append(i),t.append(a)):t.append(i),Ct(this._htmlEnabledContainers,e),i}_positionHTMLElements(){At(this._htmlEnabledContainers,(e=>{this._positionHTMLElement(e)}))}_positionHTMLElement(e){const t=e.getPrivate("htmlElementWrapper");if(t){const i=e.getPrivate("wrapperContainer");if(i){const e=i.globalBounds();t.style.clipPath="rect("+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px)"}}const i=e.getPrivate("htmlElement");if(i){At(["paddingTop","paddingRight","paddingBottom","paddingLeft","minWidth","minHeight","maxWidth","maxHeight"],(t=>{const r=e.get(t);i.style[t]=r?r+"px":""})),At(["fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration"],(t=>{const r=e.get(t);r?"fontSize"!=t||mt(r)?i.style[t]=r+"":i.style[t]=r+"px":i.style[t]=""}));const t=e.compositeScale()||1,r=e.compositeRotation()||0;i.style.transform="",i.style.transformOrigin="";const a=e.compositeOpacity();setTimeout((()=>{i.style.opacity=a+""}),10);const s=e.isVisibleDeep();s&&(i.style.display="block");let n={x:e.x()+e.get("dx",0),y:e.y()+e.get("dy",0)};e.parent&&(n=e.parent.toGlobal(n)),i.style.top=n.y+"px",i.style.left=n.x+"px";const o=e.get("width"),l=e.get("height");let c=0,h=0;if(o&&(c=e.width()),l&&(h=e.height()),!o||!l){i.style.position="fixed",i.style.width="",i.style.height="";const r=i.getBoundingClientRect();i.style.position="absolute",o||(c=r.width),l||(h=r.height);let a=c/t,s=h/t,n=e.get("centerX",0),u=e.get("centerY",0),d=0,f=0,p=0,g=0;n instanceof st?(d=-n.value*a,f=(1-n.value)*a):(d=-n,f=a-n),u instanceof st?(p=-u.value*s,g=(1-u.value)*s):(p=-u,g=s-u),e._localBounds={left:d,right:f,top:p,bottom:g};let m=e._adjustedLocalBounds,b=e._display.getAdjustedBounds(e._localBounds);e._adjustedLocalBounds=b,m.left===b.left&&m.right===b.right&&m.top===b.top&&m.bottom===b.bottom||e.markDirtyBounds()}c>0&&(i.style.minWidth=c+"px"),h>0&&(i.style.minHeight=h+"px"),s&&0!=a||(i.style.display="none");const u=e.get("centerX",0),d=ht(u)?u.percent+"%":u+"px",f=e.get("centerY",0),p=ht(f)?f.percent+"%":f+"px";(u||f)&&(i.style.transform="translate(-"+d+", -"+p+")"+i.style.transform),1!=t&&(i.style.transform+="scale("+t+")"),0!=r&&(i.style.transform+=" rotate("+r+"deg)"),""!=i.style.transform&&(i.style.transformOrigin=d+" "+p)}}_setHTMLContent(e,t){let i=e.getPrivate("htmlElement");i||(i=this._makeHTMLElement(e)),i.innerHTML!=t&&(i.innerHTML=t)}_removeHTMLContent(e){const t=e.getPrivate("htmlElementWrapper"),i=e.getPrivate("htmlElement");t?(this._htmlElementContainer.removeChild(t),e.removePrivate("htmlElement"),e.removePrivate("htmlElementWrapper"),e.removePrivate("wrapperContainer")):i&&(this._htmlElementContainer.removeChild(i),e.removePrivate("htmlElement"),e.removePrivate("wrapperContainer")),St(this._htmlEnabledContainers,e)}}class Xa extends mr{_afterNew(){super._afterNew(),this._display.isMeasured=!0,this.setPrivateRaw("trustBounds",!0)}_beforeChanged(){super._beforeChanged(),this.isDirty("radius")&&(this._clear=!0)}_changed(){super._changed(),this._clear&&this._display.drawCircle(0,0,Math.abs(this.get("radius",10)))}}Object.defineProperty(Xa,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Circle"}),Object.defineProperty(Xa,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:mr.classNames.concat([Xa.className])});class Ya extends Zi{constructor(){super(...arguments),Object.defineProperty(this,"_index",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNewApplyThemes()}_beforeChanged(){if(super._beforeChanged(),this.isDirty("sprite")){const e=this.get("sprite");e&&(e.setAll({position:"absolute",role:"figure"}),this._disposers.push(e))}(this.isDirty("locationX")||this.isDirty("locationY"))&&this.series&&this.series._positionBullet(this)}}Object.defineProperty(Ya,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Bullet"}),Object.defineProperty(Ya,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Zi.classNames.concat([Ya.className])});class Ga extends br{_beforeChanged(){super._beforeChanged(),(this.isDirty("cornerRadiusTL")||this.isDirty("cornerRadiusTR")||this.isDirty("cornerRadiusBR")||this.isDirty("cornerRadiusBL"))&&(this._clear=!0)}_draw(){let e=this.width(),t=this.height(),i=e,r=t,a=i/Math.abs(e),s=r/Math.abs(t);if(bt(i)&&bt(r)){let e=Math.min(i,r)/2,t=ii(this.get("cornerRadiusTL",8),e),n=ii(this.get("cornerRadiusTR",8),e),o=ii(this.get("cornerRadiusBR",8),e),l=ii(this.get("cornerRadiusBL",8),e),c=Math.min(Math.abs(i/2),Math.abs(r/2));t=or(t,0,c),n=or(n,0,c),o=or(o,0,c),l=or(l,0,c);const h=this._display;h.moveTo(t*a,0),h.lineTo(i-n*a,0),n>0&&h.arcTo(i,0,i,n*s,n),h.lineTo(i,r-o*s),o>0&&h.arcTo(i,r,i-o*a,r,o),h.lineTo(l*a,r),l>0&&h.arcTo(0,r,0,r-l*s,l),h.lineTo(0,t*s),t>0&&h.arcTo(0,0,t*a,0,t),h.closePath()}}}Object.defineProperty(Ga,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RoundedRectangle"}),Object.defineProperty(Ga,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:br.classNames.concat([Ga.className])});class Ka extends Er{_afterNew(){this._settings.themeTags=wi(this._settings.themeTags,["button"]),super._afterNew(),this._settings.background||this.set("background",Ga.new(this._root,{themeTags:wi(this._settings.themeTags,["background"])})),this.setPrivate("trustBounds",!0)}_prepareChildren(){if(super._prepareChildren(),this.isDirty("icon")){const e=this._prevSettings.icon,t=this.get("icon");t!==e&&(this._disposeProperty("icon"),e&&e.dispose(),t&&this.children.push(t),this._prevSettings.icon=t)}if(this.isDirty("label")){const e=this._prevSettings.label,t=this.get("label");t!==e&&(this._disposeProperty("label"),e&&e.dispose(),t&&this.children.push(t),this._prevSettings.label=t)}}}Object.defineProperty(Ka,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Button"}),Object.defineProperty(Ka,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Er.classNames.concat([Ka.className])});class qa extends Zi{_afterNew(){super._afterNewApplyThemes(),this._dirty.colors=!1}_beforeChanged(){this.isDirty("colors")&&this.reset()}generateColors(){this.setPrivate("currentPass",this.getPrivate("currentPass",0)+1);const e=this.getPrivate("currentPass"),t=this.get("colors",[this.get("baseColor",ki.fromHex(16711680))]);this.getPrivate("numColors")||this.setPrivate("numColors",t.length);const i=this.getPrivate("numColors"),r=this.get("passOptions"),a=this.get("reuse");for(let s=0;s<i;s++)if(a)t.push(t[s]);else{const i=t[s].toHSL();let a=i.h+(r.hue||0)*e;for(;a>1;)a-=1;let n=i.s+(r.saturation||0)*e;n>1&&(n=1),n<0&&(n=0);let o=i.l+(r.lightness||0)*e;for(;o>1;)o-=1;t.push(ki.fromHSL(a,n,o))}}getIndex(e){const t=this.get("colors",[]),i=this.get("saturation");return e>=t.length?(this.generateColors(),this.getIndex(e)):null!=i?ki.saturate(t[e],i):t[e]}next(){let e=this.getPrivate("currentStep",this.get("startIndex",0));return this.setPrivate("currentStep",e+this.get("step",1)),this.getIndex(e)}reset(){this.setPrivate("currentStep",this.get("startIndex",0)),this.setPrivate("currentPass",0)}}Object.defineProperty(qa,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ColorSet"}),Object.defineProperty(qa,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Zi.classNames.concat([qa.className])});let Za={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2629742400,year:31536e6};function Ja(e,t){return null==t&&(t=1),Za[e]*t}function Qa(e,t,i,r,a,s,n){if(!n||a){let n=0;switch(a||"millisecond"==t||(n=e.getTimezoneOffset(),e.setUTCMinutes(e.getUTCMinutes()-n)),t){case"day":let t=e.getUTCDate();if(i>1){if(s){s=Qa(s,"day",1);let t=e.getTime()-s.getTime(),r=Math.floor(t/Ja("day")/i),a=Ja("day",r*i);e.setTime(s.getTime()+a-n*Ja("minute"))}}else e.setUTCDate(t);e.setUTCHours(0,0,0,0);break;case"second":let a=e.getUTCSeconds();i>1&&(a=Math.floor(a/i)*i),e.setUTCSeconds(a,0);break;case"millisecond":if(1==i)return e;let o=e.getUTCMilliseconds();o=Math.floor(o/i)*i,e.setUTCMilliseconds(o);break;case"hour":let l=e.getUTCHours();i>1&&(l=Math.floor(l/i)*i),e.setUTCHours(l,0,0,0);break;case"minute":let c=e.getUTCMinutes();i>1&&(c=Math.floor(c/i)*i),e.setUTCMinutes(c,0,0);break;case"month":let h=e.getUTCMonth();i>1&&(h=Math.floor(h/i)*i),e.setUTCMonth(h,1),e.setUTCHours(0,0,0,0);break;case"year":let u=e.getUTCFullYear();i>1&&(u=Math.floor(u/i)*i),e.setUTCFullYear(u,0,1),e.setUTCHours(0,0,0,0);break;case"week":if(i>1&&s){s=Qa(s,"week",1);let t=e.getTime()-s.getTime(),r=Math.floor(t/Ja("week")/i),a=Ja("week",r*i);e.setTime(s.getTime()+a-n*Ja("minute"))}let d=e.getUTCDate(),f=e.getUTCDay();bt(r)||(r=1),d=f>=r?d-f+r:d-(7+f)+r,e.setUTCDate(d),e.setUTCHours(0,0,0,0)}if(!a&&"millisecond"!=t&&(e.setUTCMinutes(e.getUTCMinutes()+n),"day"==t||"week"==t||"month"==t||"year"==t)){let t=e.getTimezoneOffset();if(t!=n){let i=t-n;e.setUTCMinutes(e.getUTCMinutes()+i)}}return e}{if(isNaN(e.getTime()))return e;let o=e.getTime(),l=n.offsetUTC(e),c=e.getTimezoneOffset(),h=n.parseDate(e),u=h.year,d=h.month,f=h.day,p=h.hour,g=h.minute,m=h.second,b=h.millisecond,v=h.weekday,y=l-c;switch(t){case"day":if(i>1&&s){s=Qa(s,"day",1,r,a,void 0,n);let t=e.getTime()-s.getTime(),o=Math.floor(t/Ja("day")/i),l=Ja("day",o*i);e.setTime(s.getTime()+l),h=n.parseDate(e),u=h.year,d=h.month,f=h.day}p=0,g=y,m=0,b=0;break;case"second":g+=y,i>1&&(m=Math.floor(m/i)*i),b=0;break;case"millisecond":g+=y,i>1&&(b=Math.floor(b/i)*i);break;case"hour":i>1&&(p=Math.floor(p/i)*i),g=y,m=0,b=0;break;case"minute":i>1&&(g=Math.floor(g/i)*i),g+=y,m=0,b=0;break;case"month":i>1&&(d=Math.floor(d/i)*i),f=1,p=0,g=y,m=0,b=0;break;case"year":i>1&&(u=Math.floor(u/i)*i),d=0,f=1,p=0,g=y,m=0,b=0;break;case"week":bt(r)||(r=1),f=v>=r?f-v+r:f-(7+v)+r,p=0,g=y,m=0,b=0}const _=(e=new Date(u,d,f,p,g,m,b)).getTime();let w=36e5;"hour"==t&&(w=36e5*i),_+w<=o&&("hour"!=t&&"minute"!=t&&"second"!=t&&"millisecond"!=t||(e=new Date(_+w)));let x=e.getTimezoneOffset(),A=n.offsetUTC(e)-x;return A!=y&&e.setTime(e.getTime()+6e4*(A-y)),e}}class es extends Xr{setupDefaultRules(){super.setupDefaultRules();const e=this._root.interfaceColors,t=this._root.language,i=this.rule.bind(this);i("XYChart").setAll({colors:qa.new(this._root,{}),paddingLeft:20,paddingRight:20,paddingTop:16,paddingBottom:16,panX:!1,panY:!1,wheelStep:.25,arrangeTooltips:!0,pinchZoomX:!1,pinchZoomY:!1}),i("XYSeries").setAll({legendLabelText:"{name}"}),i("Rectangle",["plotbackground","xy","background"]).setAll({fill:ki.fromHex(0),fillOpacity:0}),i("XYChart",["scrollbar","chart"]).setAll({paddingBottom:0,paddingLeft:0,paddingTop:0,paddingRight:0,colors:qa.new(this._root,{saturation:0})});{const t=i("Graphics",["scrollbar","overlay"]);t.setAll({fillOpacity:.5}),Yr(t,"fill",e,"background")}i("RoundedRectangle",["xy","scrollbar","thumb"]).setAll({cornerRadiusTR:0,cornerRadiusTL:0,cornerRadiusBR:0,cornerRadiusBL:0,fillOpacity:0,focusable:!0}),i("RoundedRectangle",["xy","scrollbar","thumb"]).states.create("hover",{fillOpacity:.4}),i("RoundedRectangle",["xy","scrollbar","chart","background"]).setAll({cornerRadiusTL:0,cornerRadiusBL:0,cornerRadiusTR:0,cornerRadiusBR:0}),i("RoundedRectangle",["xy","scrollbar","chart","background","resize","button"]).setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),i("AxisRendererX",["xy","chart","scrollbar"]).setAll({strokeOpacity:0,inside:!0}),i("AxisRendererY",["xy","chart","scrollbar"]).setAll({strokeOpacity:0,inside:!0,minGridDistance:5}),i("AxisLabel",["xy","scrollbar","x"]).setAll({opacity:.5,centerY:lt,minPosition:.01,maxPosition:.99,fontSize:"0.8em"}),i("AxisLabel",["category"]).setAll({text:"{category}",populateText:!0}),i("AxisLabel",["x"]).setAll({centerY:0}),i("AxisLabel",["x","inside"]).setAll({centerY:lt}),i("AxisLabel",["x","inside","opposite"]).setAll({centerY:0}),i("AxisLabel",["x","opposite"]).setAll({centerY:lt}),i("AxisLabel",["y"]).setAll({centerX:lt}),i("AxisLabel",["y","inside"]).setAll({centerX:0}),i("AxisLabel",["y","inside","opposite"]).setAll({centerX:lt}),i("AxisLabel",["y","opposite"]).setAll({centerX:0}),i("AxisLabel",["minor"]).setAll({fontSize:"0.6em"}),i("AxisLabel",["xy","scrollbar","y"]).setAll({visible:!1}),i("Grid",["xy","scrollbar","y"]).setAll({visible:!1}),i("Grid",["xy","scrollbar","x"]).setAll({opacity:.5}),i("XYCursor").setAll({behavior:"none",layer:30,exportable:!1,snapToSeriesBy:"xy",moveThreshold:1});{const r=i("Grid",["cursor","x"]);r.setAll({forceInactive:!0,strokeOpacity:.8,strokeDasharray:[2,2],role:"slider",ariaLabel:t.translate("Use left and right arrows to move selection")}),Yr(r,"stroke",e,"alternativeBackground")}{const r=i("Grid",["cursor","y"]);r.setAll({forceInactive:!0,strokeOpacity:.8,strokeDasharray:[2,2],role:"slider",ariaLabel:t.translate("Use up and down arrows to move selection")}),Yr(r,"stroke",e,"alternativeBackground")}{const t=i("Graphics",["cursor","selection"]);t.setAll({fillOpacity:.15}),Yr(t,"fill",e,"alternativeBackground")}i("Axis").setAll({start:0,end:1,minZoomCount:1,maxZoomCount:1/0,maxZoomFactor:1e3,maxDeviation:.1,snapTooltip:!0,tooltipLocation:.5,panX:!0,panY:!0,zoomX:!0,zoomY:!0,fixAxisSize:!0}),i("AxisLabel").setAll({location:.5,multiLocation:0,centerX:ct,centerY:ct,paddingTop:3,paddingBottom:3,paddingLeft:5,paddingRight:5}),i("Container",["axis","header"]).setAll({layer:30}),i("Rectangle",["axis","header","background"]).setAll({crisp:!0});{const t=i("AxisRenderer");t.setAll({crisp:!0,strokeOpacity:0}),Yr(t,"stroke",e,"grid")}i("AxisRendererX").setAll({minGridDistance:120,opposite:!1,inversed:!1,cellStartLocation:0,cellEndLocation:1,width:lt}),i("AxisRendererY").setAll({minGridDistance:40,opposite:!1,inversed:!1,cellStartLocation:0,cellEndLocation:1,height:lt});{const t=i("Rectangle",["axis","thumb"]);t.setAll({fillOpacity:0}),Yr(t,"fill",e,"alternativeBackground"),t.states.create("hover",{fillOpacity:.1})}i("Rectangle",["axis","thumb","x"]).setAll({cursorOverStyle:"ew-resize"}),i("Rectangle",["axis","thumb","y"]).setAll({cursorOverStyle:"ns-resize"});{const t=i("Grid");t.setAll({location:0,strokeOpacity:.15,crisp:!0}),Yr(t,"stroke",e,"grid")}{const t=i("Grid",["minor"]);t.setAll({location:0,strokeOpacity:.07,crisp:!0}),Yr(t,"stroke",e,"grid")}i("Grid",["base"]).setAll({strokeOpacity:.3});{const t=i("Graphics",["axis","fill"]);t.setAll({visible:!1,isMeasured:!1,position:"absolute",fillOpacity:.05}),Yr(t,"fill",e,"alternativeBackground")}i("Graphics",["axis","fill","range"]).setAll({isMeasured:!0}),i("Graphics",["series","fill","range"]).setAll({visible:!1,isMeasured:!0}),i("Grid",["series","range"]).setAll({visible:!1}),i("AxisTick",["series","range"]).setAll({visible:!1}),i("AxisLabel",["series","range"]).setAll({visible:!1});{const t=i("AxisTick");t.setAll({location:.5,multiLocation:0,strokeOpacity:1,isMeasured:!1,position:"absolute",visible:!1}),Yr(t,"stroke",e,"grid")}i("CategoryAxis").setAll({startLocation:0,endLocation:1,fillRule:(e,t)=>{const i=e.get("axisFill");i&&(bt(t)&&t%2!=0?i.setPrivate("visible",!1):i.setPrivate("visible",!0))}});const r=[{timeUnit:"millisecond",count:1},{timeUnit:"millisecond",count:5},{timeUnit:"millisecond",count:10},{timeUnit:"millisecond",count:50},{timeUnit:"millisecond",count:100},{timeUnit:"millisecond",count:500},{timeUnit:"second",count:1},{timeUnit:"second",count:5},{timeUnit:"second",count:10},{timeUnit:"second",count:30},{timeUnit:"minute",count:1},{timeUnit:"minute",count:5},{timeUnit:"minute",count:10},{timeUnit:"minute",count:15},{timeUnit:"minute",count:30},{timeUnit:"hour",count:1},{timeUnit:"hour",count:3},{timeUnit:"hour",count:6},{timeUnit:"hour",count:12},{timeUnit:"day",count:1},{timeUnit:"day",count:2},{timeUnit:"day",count:3},{timeUnit:"day",count:4},{timeUnit:"day",count:5},{timeUnit:"week",count:1},{timeUnit:"month",count:1},{timeUnit:"month",count:2},{timeUnit:"month",count:3},{timeUnit:"month",count:6},{timeUnit:"year",count:1},{timeUnit:"year",count:2},{timeUnit:"year",count:5},{timeUnit:"year",count:10},{timeUnit:"year",count:50},{timeUnit:"year",count:100},{timeUnit:"year",count:200},{timeUnit:"year",count:500},{timeUnit:"year",count:1e3},{timeUnit:"year",count:2e3},{timeUnit:"year",count:5e3},{timeUnit:"year",count:1e4},{timeUnit:"year",count:1e5}],a={millisecond:t.translate("_date_millisecond"),second:t.translate("_date_second"),minute:t.translate("_date_minute"),hour:t.translate("_date_hour"),day:t.translate("_date_day"),week:t.translate("_date_day"),month:t.translate("_date_month"),year:t.translate("_date_year")},s={millisecond:t.translate("_date_millisecond"),second:t.translate("_date_second"),minute:t.translate("_date_minute"),hour:t.translate("_date_day"),day:t.translate("_date_day"),week:t.translate("_date_day"),month:t.translate("_date_month")+" "+t.translate("_date_year"),year:t.translate("_date_year")},n={millisecond:t.translate("_date_millisecond_full"),second:t.translate("_date_second_full"),minute:t.translate("_date_minute_full"),hour:t.translate("_date_hour_full"),day:t.translate("_date_day_full"),week:t.translate("_date_week_full"),month:t.translate("_date_month_full"),year:t.translate("_date_year")};i("CategoryDateAxis").setAll({markUnitChange:!0,gridIntervals:Dt(r),dateFormats:Nt(a),periodChangeDateFormats:Nt(s)}),i("DateAxis").setAll({maxZoomFactor:null,strictMinMax:!0,startLocation:0,endLocation:1,markUnitChange:!0,groupData:!1,groupCount:500,gridIntervals:Dt(r),dateFormats:Nt(a),periodChangeDateFormats:Nt(s),tooltipDateFormats:n,groupIntervals:[{timeUnit:"millisecond",count:1},{timeUnit:"millisecond",count:10},{timeUnit:"millisecond",count:100},{timeUnit:"second",count:1},{timeUnit:"second",count:10},{timeUnit:"minute",count:1},{timeUnit:"minute",count:10},{timeUnit:"hour",count:1},{timeUnit:"day",count:1},{timeUnit:"week",count:1},{timeUnit:"month",count:1},{timeUnit:"year",count:1}],fillRule:e=>{const t=e.get("axisFill");if(t){const i=e.component,r=e.get("value"),a=e.get("endValue"),s=i.intervalDuration(),n=i.getPrivate("baseInterval"),o=i.getPrivate("gridInterval",n);let l=i.getPrivate("min",0);if(l=Qa(new Date(l),o.timeUnit,o.count,this._root.locale.firstDayOfWeek,this._root.utc,void 0,this._root.timezone).getTime(),null!=r&&null!=a){const e=Math.round(Math.round((r-l)/s))/2;e==Math.round(e)?t.setPrivate("visible",!0):t.setPrivate("visible",!1)}}}}),i("GaplessDateAxis").setAll({fillRule:e=>{const t=e.get("axisFill");if(t){const i=e.get("index");let r=!1;bt(i)&&i%2!=0||(r=!0),t.setPrivate("visible",r)}}}),i("ValueAxis").setAll({baseValue:0,logarithmic:!1,strictMinMax:!1,autoZoom:!0,fillRule:e=>{const t=e.get("axisFill");if(t){const i=e.component,r=e.get("value"),a=i.getPrivate("step");bt(r)&&bt(a)&&(nr(r/a/2,5)==Math.round(r/a/2)?t.setPrivate("visible",!1):t.setPrivate("visible",!0))}}}),i("DurationAxis").setAll({baseUnit:"second"}),i("XYSeries").setAll({maskBullets:!0,stackToNegative:!0,locationX:.5,locationY:.5,snapTooltip:!1,openValueXGrouped:"open",openValueYGrouped:"open",valueXGrouped:"close",valueYGrouped:"close",seriesTooltipTarget:"series"}),i("BaseColumnSeries").setAll({adjustBulletPosition:!0}),i("ColumnSeries").setAll({clustered:!0}),i("RoundedRectangle",["series","column"]).setAll({position:"absolute",isMeasured:!1,width:nt(70),height:nt(70),strokeWidth:1,strokeOpacity:1,cornerRadiusBL:0,cornerRadiusTL:0,cornerRadiusBR:0,cornerRadiusTR:0,fillOpacity:1,role:"figure"}),i("LineSeries").setAll({connect:!0,autoGapCount:1.1,stackToNegative:!1}),i("Graphics",["series","stroke"]).setAll({position:"absolute",strokeWidth:1,strokeOpacity:1,isMeasured:!1}),i("Graphics",["series","fill"]).setAll({visible:!1,fillOpacity:0,position:"absolute",strokeWidth:0,strokeOpacity:0,isMeasured:!1}),i("Graphics",["line","series","legend","marker","stroke"]).setAll({draw:(e,t)=>{const i=t.parent;if(i){const t=i.height(),r=i.width();e.moveTo(0,t/2),e.lineTo(r,t/2)}}}),Yr(i("Graphics",["line","series","legend","marker","stroke"]).states.create("disabled",{}),"stroke",e,"disabled"),i("Graphics",["line","series","legend","marker","fill"]).setAll({draw:(e,t)=>{const i=t.parent;if(i){const t=i.height(),r=i.width();e.moveTo(0,0),e.lineTo(r,0),e.lineTo(r,t),e.lineTo(0,t),e.lineTo(0,0)}}}),Yr(i("Graphics",["line","series","legend","marker","fill"]).states.create("disabled",{}),"stroke",e,"disabled"),i("SmoothedXYLineSeries").setAll({tension:.5}),i("SmoothedXLineSeries").setAll({tension:.5}),i("SmoothedYLineSeries").setAll({tension:.5}),i("Candlestick").setAll({position:"absolute",isMeasured:!1,width:nt(50),height:nt(50),strokeWidth:1,strokeOpacity:1,cornerRadiusBL:0,cornerRadiusTL:0,cornerRadiusBR:0,cornerRadiusTR:0,fillOpacity:1,role:"figure"}),i("OHLC").setAll({width:nt(80),height:nt(80)}),i("CandlestickSeries").setAll({lowValueXGrouped:"low",lowValueYGrouped:"low",highValueXGrouped:"high",highValueYGrouped:"high",openValueXGrouped:"open",openValueYGrouped:"open",valueXGrouped:"close",valueYGrouped:"close"});{const t=i("Rectangle",["column","autocolor"]).states.create("riseFromOpen",{});Yr(t,"fill",e,"positive"),Yr(t,"stroke",e,"positive")}{const t=i("Rectangle",["column","autocolor"]).states.create("dropFromOpen",{});Yr(t,"fill",e,"negative"),Yr(t,"stroke",e,"negative")}i("Rectangle",["column","autocolor","pro"]).states.create("riseFromOpen",{fillOpacity:0}),i("Rectangle",["column","autocolor","pro"]).states.create("dropFromOpen",{fillOpacity:1});{const t=i("Rectangle",["column","autocolor","pro"]).states.create("riseFromPrevious",{});Yr(t,"fill",e,"positive"),Yr(t,"stroke",e,"positive")}{const t=i("Rectangle",["column","autocolor","pro"]).states.create("dropFromPrevious",{});Yr(t,"fill",e,"negative"),Yr(t,"stroke",e,"negative")}i("RoundedRectangle",["rangegrip"]).setAll({strokeOpacity:0,fillOpacity:0,strokeWidth:1,width:12,height:12});{const t=i("Graphics",["rangegrip","button","icon"]);t.setAll({interactive:!1,crisp:!0,strokeOpacity:.5,draw:e=>{e.moveTo(0,.5),e.lineTo(0,12.5),e.moveTo(2,.5),e.lineTo(2,12.5),e.moveTo(4,.5),e.lineTo(4,12.5)}}),Yr(t,"stroke",e,"secondaryButtonText")}i("Button",["rangegrip"]).setAll({draggable:!0,paddingTop:0,paddingBottom:0}),i("Button",["rangegrip","vertical"]).setAll({rotation:90,cursorOverStyle:"ns-resize",centerX:ct}),i("Button",["rangegrip","horizontal"]).setAll({cursorOverStyle:"ew-resize",centerX:ct}),i("Button",["rangegrip","vertical","left"]).setAll({centerY:lt}),i("Button",["rangegrip","vertical","right"]).setAll({centerY:0}),i("Button",["rangegrip","horizontal","top"]).setAll({centerY:0}),i("Button",["rangegrip","horizontal","bottom"]).setAll({centerY:lt})}}class ts extends Er{constructor(){super(...arguments),Object.defineProperty(this,"chartContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Er.new(this._root,{width:lt,height:lt,interactiveChildren:!1}))}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:Er.new(this._root,{interactiveChildren:!1,isMeasured:!1,position:"absolute",width:lt,height:lt})})}}Object.defineProperty(ts,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chart"}),Object.defineProperty(ts,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Er.classNames.concat([ts.className])});class is extends ts{constructor(){super(...arguments),Object.defineProperty(this,"seriesContainer",{enumerable:!0,configurable:!0,writable:!0,value:Er.new(this._root,{width:lt,height:lt,isMeasured:!1})}),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:new Li})}_afterNew(){super._afterNew(),this._disposers.push(this.series);const e=this.seriesContainer.children;this._disposers.push(this.series.events.onAll((t=>{if("clear"===t.type){At(t.oldValues,(e=>{this._removeSeries(e)}));const e=this.get("colors");e&&e.reset();const i=this.get("patterns");i&&i.reset()}else if("push"===t.type)e.moveValue(t.newValue),this._processSeries(t.newValue);else if("setIndex"===t.type)e.setIndex(t.index,t.newValue),this._processSeries(t.newValue);else if("insertIndex"===t.type)e.insertIndex(t.index,t.newValue),this._processSeries(t.newValue);else if("removeIndex"===t.type)this._removeSeries(t.oldValue);else if("moveIndex"===t.type)e.moveValue(t.value,t.newIndex),this._processSeries(t.value);else{if("swap"!==t.type)throw new Error("Unknown IListEvent type");{const i=t.a,r=t.b,a=this.series.indexOf(i),s=this.series.indexOf(r);e.moveValue(i,s),e.moveValue(r,a),this.series.each((e=>{this._processSeries(e),e.markDirtyValues()}))}}})))}_processSeries(e){e.chart=this,e._placeBulletsContainer(this)}_removeSeries(e){e._handleRemoved(),e.isDisposed()||(this.seriesContainer.children.removeValue(e),e._removeBulletsContainer())}}Object.defineProperty(is,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SerialChart"}),Object.defineProperty(is,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ts.classNames.concat([is.className])});class rs extends is{constructor(){super(...arguments),Object.defineProperty(this,"xAxes",{enumerable:!0,configurable:!0,writable:!0,value:new Li}),Object.defineProperty(this,"yAxes",{enumerable:!0,configurable:!0,writable:!0,value:new Li}),Object.defineProperty(this,"topAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.chartContainer.children.push(Er.new(this._root,{width:lt,layout:this._root.verticalLayout}))}),Object.defineProperty(this,"yAxesAndPlotContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.chartContainer.children.push(Er.new(this._root,{width:lt,height:lt,layout:this._root.horizontalLayout}))}),Object.defineProperty(this,"bottomAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.chartContainer.children.push(Er.new(this._root,{width:lt,layout:this._root.verticalLayout}))}),Object.defineProperty(this,"leftAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.yAxesAndPlotContainer.children.push(Er.new(this._root,{height:lt,layout:this._root.horizontalLayout}))}),Object.defineProperty(this,"plotsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.yAxesAndPlotContainer.children.push(Er.new(this._root,{width:lt,height:lt,maskContent:!1}))}),Object.defineProperty(this,"plotContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotsContainer.children.push(Er.new(this._root,{width:lt,height:lt}))}),Object.defineProperty(this,"topPlotContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotsContainer.children.push(Er.new(this._root,{width:lt,height:lt}))}),Object.defineProperty(this,"gridContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotContainer.children.push(Er.new(this._root,{width:lt,height:lt,isMeasured:!1}))}),Object.defineProperty(this,"topGridContainer",{enumerable:!0,configurable:!0,writable:!0,value:Er.new(this._root,{width:lt,height:lt,isMeasured:!1})}),Object.defineProperty(this,"rightAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.yAxesAndPlotContainer.children.push(Er.new(this._root,{height:lt,layout:this._root.horizontalLayout}))}),Object.defineProperty(this,"axisHeadersContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotContainer.children.push(Er.new(this._root,{}))}),Object.defineProperty(this,"zoomOutButton",{enumerable:!0,configurable:!0,writable:!0,value:this.topPlotContainer.children.push(Ka.new(this._root,{themeTags:["zoom"],icon:mr.new(this._root,{themeTags:["button","icon"]})}))}),Object.defineProperty(this,"_movePoint",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(this,"_wheelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_otherCharts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_movePoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_downStartX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downEndX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downStartY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downEndY",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this._defaultThemes.push(es.new(this._root)),super._afterNew(),this._disposers.push(this.xAxes),this._disposers.push(this.yAxes);const e=this._root;let t=this._root.verticalLayout;const i=this.zoomOutButton;i.events.on("click",(()=>{this.zoomOut()})),i.hide(0),i.states.lookup("default").set("opacity",1),this.chartContainer.set("layout",t);const r=this.plotContainer;r.children.push(this.seriesContainer),this._disposers.push(this._processAxis(this.xAxes,this.bottomAxesContainer)),this._disposers.push(this._processAxis(this.yAxes,this.leftAxesContainer)),r.children.push(this.topGridContainer),r.children.push(this.bulletsContainer),r.set("interactive",!0),r.set("interactiveChildren",!1),r.set("background",br.new(e,{themeTags:["plotbackground","xy","background"]})),this._disposers.push(r.events.on("pointerdown",(e=>{this._handlePlotDown(e)}))),this._disposers.push(r.events.on("globalpointerup",(e=>{this._handlePlotUp(e)}))),this._disposers.push(r.events.on("globalpointermove",(e=>{this._handlePlotMove(e)}))),this._maskGrid(),this._setUpTouch()}_beforeChanged(){super._beforeChanged(),(this.isDirty("pinchZoomX")||this.isDirty("pinchZoomY")||this.get("panX")||this.get("panY"))&&this._setUpTouch()}_setUpTouch(){this.plotContainer._display.cancelTouch||(this.plotContainer._display.cancelTouch=!!(this.get("pinchZoomX")||this.get("pinchZoomY")||this.get("panX")||this.get("panY")))}_maskGrid(){this.gridContainer.set("maskContent",!0),this.topGridContainer.set("maskContent",!0)}_removeSeries(e){e._unstack(),e._posXDp&&e._posXDp.dispose(),e._posYDp&&e._posYDp.dispose(),e.set("baseAxis",void 0);const t=e.get("xAxis");t&&(St(t.series,e),t.markDirtyExtremes());const i=e.get("yAxis");i&&(St(i.series,e),i.markDirtyExtremes());const r=this.get("cursor");if(r){const t=r.get("snapToSeries");t&&St(t,e)}super._removeSeries(e)}handleWheel(e){const t=this.get("wheelX"),i=this.get("wheelY"),r=this.plotContainer,a=e.originalEvent;let s=!1;if(!Qt(a,this))return;s=!0;const n=r.toLocal(e.point),o=this.get("wheelStep",.2),l=a.deltaY/100,c=a.deltaX/100,h=this.get("wheelZoomPositionX"),u=this.get("wheelZoomPositionY");"zoomX"!==t&&"zoomXY"!==t||0==c||this.xAxes.each((e=>{if(e.get("zoomX")){let t=e.get("start"),i=e.get("end"),a=e.fixPosition(n.x/r.width());null!=h&&(a=h);let l=e.get("maxDeviation",0),u=Math.min(1+l,Math.max(-l,t-o*(i-t)*c*a)),d=Math.max(-l,Math.min(1+l,i+o*(i-t)*c*(1-a)));u==t&&d==i&&(s=!1),1/(d-u)<e.getPrivate("maxZoomFactor",1/0)/e.get("minZoomCount",1)?this._handleWheelAnimation(e.zoom(u,d)):s=!1}})),"zoomX"!==i&&"zoomXY"!==i||0==l||this.xAxes.each((e=>{if(e.get("zoomX")){let t=e.get("start"),i=e.get("end"),a=e.fixPosition(n.x/r.width());null!=h&&(a=h);let c=e.get("maxDeviation",0),u=Math.min(1+c,Math.max(-c,t-o*(i-t)*l*a)),d=Math.max(-c,Math.min(1+c,i+o*(i-t)*l*(1-a)));u==t&&d==i&&(s=!1),1/(d-u)<e.getPrivate("maxZoomFactor",1/0)/e.get("minZoomCount",1)?this._handleWheelAnimation(e.zoom(u,d)):s=!1}})),"zoomY"!==t&&"zoomXY"!==t||0==c||this.yAxes.each((e=>{if(e.get("zoomY")){let t=e.get("start"),i=e.get("end"),a=e.fixPosition(n.y/r.height());null!=u&&(a=u);let l=e.get("maxDeviation",0),h=Math.min(1+l,Math.max(-l,t-o*(i-t)*c*a)),d=Math.max(-l,Math.min(1+l,i+o*(i-t)*c*(1-a)));h==t&&d==i&&(s=!1),1/(d-h)<e.getPrivate("maxZoomFactor",1/0)/e.get("minZoomCount",1)?this._handleWheelAnimation(e.zoom(h,d)):s=!1}})),"zoomY"!==i&&"zoomXY"!==i||0==l||this.yAxes.each((e=>{if(e.get("zoomY")){let t=e.get("start"),i=e.get("end"),a=e.fixPosition(n.y/r.height());null!=u&&(a=u);let c=e.get("maxDeviation",0),h=Math.min(1+c,Math.max(-c,t-o*(i-t)*l*a)),d=Math.max(-c,Math.min(1+c,i+o*(i-t)*l*(1-a)));h==t&&d==i&&(s=!1),1/(d-h)<e.getPrivate("maxZoomFactor",1/0)/e.get("minZoomCount",1)?this._handleWheelAnimation(e.zoom(h,d)):s=!1}})),"panX"!==t&&"panXY"!==t||0==c||this.xAxes.each((e=>{if(e.get("panX")){let t=e.get("start"),i=e.get("end"),r=this._getWheelSign(e)*o*(i-t)*c,a=t+r,n=i+r,l=this._fixWheel(a,n);a=l[0],n=l[1],a==t&&n==i&&(s=!1),this._handleWheelAnimation(e.zoom(a,n))}})),"panX"!==i&&"panXY"!==i||0==l||this.xAxes.each((e=>{if(e.get("panX")){let t=e.get("start"),i=e.get("end"),r=this._getWheelSign(e)*o*(i-t)*l,a=t+r,n=i+r,c=this._fixWheel(a,n);a=c[0],n=c[1],a==t&&n==i&&(s=!1),this._handleWheelAnimation(e.zoom(a,n))}})),"panY"!==t&&"panXY"!==t||0==c||this.yAxes.each((e=>{if(e.get("panY")){let t=e.get("start"),i=e.get("end"),r=this._getWheelSign(e)*o*(i-t)*c,a=t+r,n=i+r,l=this._fixWheel(a,n);a=l[0],n=l[1],a==t&&n==i&&(s=!1),this._handleWheelAnimation(e.zoom(a,n))}})),"panY"!==i&&"panXY"!==i||0==l||this.yAxes.each((e=>{if(e.get("panY")){let t=e.get("start"),i=e.get("end"),r=this._getWheelSign(e)*o*(i-t)*l,a=t-r,n=i-r,c=this._fixWheel(a,n);a=c[0],n=c[1],a==t&&n==i&&(s=!1),this._handleWheelAnimation(e.zoom(a,n))}})),s&&a.preventDefault()}_handleSetWheel(){const e=this.get("wheelX"),t=this.get("wheelY"),i=this.plotContainer;"none"!==e||"none"!==t?(this._wheelDp=i.events.on("wheel",(i=>{const r=i.originalEvent;("none"!==e&&0!=Math.abs(r.deltaX)||"none"!==t&&0!=Math.abs(r.deltaY))&&this.handleWheel(i)})),this._disposers.push(this._wheelDp)):this._wheelDp&&this._wheelDp.dispose()}_getWheelSign(e){let t=1;return e.get("renderer").get("inversed")&&(t=-1),t}_fixWheel(e,t){const i=t-e;return e<0&&(t=(e=0)+i),t>1&&(e=(t=1)-i),[e,t]}_handlePlotDown(e){const t=e.originalEvent;if(2==t.button)return;const i=this.plotContainer;let r=i.toLocal(e.point);if((this.get("pinchZoomX")||this.get("pinchZoomY"))&&t.pointerId&&Ft(i._downPoints).length>0){const e=this.xAxes.getIndex(0),t=this.yAxes.getIndex(0);e&&(this._downStartX=e.get("start",0),this._downEndX=e.get("end",1)),t&&(this._downStartY=t.get("start",0),this._downEndY=t.get("end",1))}if((this.get("panX")||this.get("panY"))&&r.x>=0&&r.y>=0&&r.x<=i.width()&&r.y<=this.height()){this._downPoint={x:t.clientX,y:t.clientY};const i=this.get("panX"),r=this.get("panY");i&&this.xAxes.each((e=>{e._panStart=e.get("start"),e._panEnd=e.get("end")})),r&&this.yAxes.each((e=>{e._panStart=e.get("start"),e._panEnd=e.get("end")}));const a="panstarted";this.events.isEnabled(a)&&this.events.dispatch(a,{type:a,target:this,originalEvent:e.originalEvent})}}_handleWheelAnimation(e){e?e.events.on("stopped",(()=>{this._dispatchWheelAnimation()})):this._dispatchWheelAnimation()}_dispatchWheelAnimation(){const e="wheelended";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this})}_handlePlotUp(e){const t=this._downPoint;if(t&&(this.get("panX")||this.get("panY"))){if(e.originalEvent.clientX==t.x&&e.originalEvent.clientY==t.y){const t="pancancelled";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent})}const i="panended";this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this,originalEvent:e.originalEvent})}this._downPoint=void 0,this.xAxes.each((e=>{e._isPanning=!1})),this.yAxes.each((e=>{e._isPanning=!1}))}_handlePlotMove(e){const t=this.plotContainer;if(this.get("pinchZoomX")||this.get("pinchZoomY")){const i=e.originalEvent.pointerId;if(i&&(this._movePoints[i]=e.point,Ft(t._downPoints).length>1))return void this._handlePinch()}let i=this._downPoint;if(i){i=t.toLocal(this._root.documentPointToRoot(i));let r=t.toLocal(e.point);const a=this.get("panX"),s=this.get("panY");if(a){let e=this.get("scrollbarX");e&&e.events.disableType("rangechanged"),this.xAxes.each((e=>{if(e.get("panX")){e._isPanning=!0;let a=e._panStart,s=e._panEnd,n=(s-a)*(i.x-r.x)/t.width();e.get("renderer").get("inversed")&&(n*=-1);let o=a+n,l=s+n;l-o<1+2*e.get("maxDeviation",1)&&(e.set("start",o),e.set("end",l))}})),e&&e.events.enableType("rangechanged")}if(s){let e=this.get("scrollbarY");e&&e.events.disableType("rangechanged"),this.yAxes.each((e=>{if(e.get("panY")){e._isPanning=!0;let a=e._panStart,s=e._panEnd,n=(s-a)*(i.y-r.y)/t.height();e.get("renderer").get("inversed")&&(n*=-1);let o=a-n,l=s-n;l-o<1+2*e.get("maxDeviation",1)&&(e.set("start",o),e.set("end",l))}})),e&&e.events.enableType("rangechanged")}}}_handlePinch(){const e=this.plotContainer;let t=0,i=[],r=[];if(Bt(e._downPoints,((e,a)=>{i[t]=a;let s=this._movePoints[e];s&&(r[t]=s),t++})),i.length>1&&r.length>1){const t=e.width(),a=e.height();let s=i[0],n=i[1],o=r[0],l=r[1];if(s&&n&&o&&l){if(o=e.toLocal(o),l=e.toLocal(l),s=e.toLocal(s),n=e.toLocal(n),this.get("pinchZoomX")){const e=this._downStartX,i=this._downEndX;if(null!=e&&null!=i){s.x>n.x&&([s,n]=[n,s],[o,l]=[l,o]);let r=e+s.x/t*(i-e),a=e+n.x/t*(i-e),c=e+o.x/t*(i-e),h=e+l.x/t*(i-e),u=Math.max(.001,a-r)/Math.max(.001,h-c),d=e*u+r-c*u,f=i*u+a-h*u;this.xAxes.each((e=>{let t=e.fixPosition(d),i=e.fixPosition(f);e.zoom(t,i,0)}))}}if(this.get("pinchZoomY")){const e=this._downStartY,t=this._downEndY;if(null!=e&&null!=t){s.y<n.y&&([s,n]=[n,s],[o,l]=[l,o]);let i=e+(1-s.y/a)*(t-e),r=e+(1-n.y/a)*(t-e),c=e+(1-o.y/a)*(t-e),h=e+(1-l.y/a)*(t-e),u=Math.max(.001,r-i)/Math.max(.001,h-c),d=e*u+i-c*u,f=t*u+r-h*u;this.yAxes.each((e=>{let t=e.fixPosition(d),i=e.fixPosition(f);e.zoom(t,i,0)}))}}}}}_handleCursorPosition(){const e=this.get("cursor");if(e){const t=e.getPrivate("point");let i=e.get("snapToSeries");if(e._downPoint&&(i=void 0),i&&t){const r=e.get("snapToSeriesBy"),a=[];At(i,(e=>{if(!e.isHidden()&&!e.isHiding())if("x!"!=r&&"y!"!=r){const t=e.startIndex(),i=e.endIndex();for(let r=t;r<i;r++){const t=e.dataItems[r];t&&!t.isHidden()&&a.push(t)}}else{const t=e.get("tooltipDataItem");t&&a.push(t)}}));let s,n=1/0;if(At(a,(e=>{const i=e.get("point");if(i){let a=0;a="x"==r||"x!"==r?Math.abs(t.x-i.x):"y"==r||"y!"==r?Math.abs(t.y-i.y):Math.hypot(t.x-i.x,t.y-i.y),a<n&&(n=a,s=e)}})),At(i,(e=>{const t=e.get("tooltip");t&&t._setDataItem(void 0)})),s){let t=s.component;t.showDataItemTooltip(s),t.setRaw("tooltipDataItem",s);const i=s.get("point");i&&e.handleMove(t.toGlobal({x:i.x-t.x(),y:i.y-t.y()}),!0)}}}}_updateCursor(){let e=this.get("cursor");e&&e.updateCursor()}_addCursor(e){this.plotContainer.children.push(e)}_prepareChildren(){if(super._prepareChildren(),this.series.each((e=>{this._colorize(e)})),(this.isDirty("wheelX")||this.isDirty("wheelY"))&&this._handleSetWheel(),this.isDirty("cursor")){const e=this._prevSettings.cursor,t=this.get("cursor");t!==e&&(this._disposeProperty("cursor"),e&&e.dispose(),t&&(t._setChart(this),this._addCursor(t),this._pushPropertyDisposer("cursor",t.events.on("selectended",(()=>{this._handleCursorSelectEnd()})))),this._prevSettings.cursor=t)}if(this.isDirty("scrollbarX")){const e=this._prevSettings.scrollbarX,t=this.get("scrollbarX");t!==e&&(this._disposeProperty("scrollbarX"),e&&e.dispose(),t&&(t.parent||this.topAxesContainer.children.push(t),this._pushPropertyDisposer("scrollbarX",t.events.on("rangechanged",(e=>{this._handleScrollbar(this.xAxes,e.start,e.end,e.grip)}))),this._pushPropertyDisposer("scrollbarX",t.events.on("released",(()=>{this.xAxes.each((e=>{e.get("zoomable")&&this._handleAxisSelection(e)}))}))),t.setPrivate("positionTextFunction",(e=>{const t=this.xAxes.getIndex(0);return t&&t.getTooltipText(e,!1)||""}))),this._prevSettings.scrollbarX=t)}if(this.isDirty("scrollbarY")){const e=this._prevSettings.scrollbarY,t=this.get("scrollbarY");t!==e&&(this._disposeProperty("scrollbarY"),e&&e.dispose(),t&&(t.parent||this.rightAxesContainer.children.push(t),this._pushPropertyDisposer("scrollbarY",t.events.on("rangechanged",(e=>{this._handleScrollbar(this.yAxes,e.start,e.end,e.grip)}))),this._pushPropertyDisposer("scrollbarY",t.events.on("released",(()=>{this.yAxes.each((e=>{e.get("zoomable")&&this._handleAxisSelection(e)}))}))),t.setPrivate("positionTextFunction",(e=>{const t=this.yAxes.getIndex(0);return t&&t.getTooltipText(e,!1)||""}))),this._prevSettings.scrollbarY=t)}this._handleZoomOut()}_processSeries(e){super._processSeries(e);const t=e.get("xAxis"),i=e.get("yAxis");Et(t.series,e),Et(i.series,e),e._posXDp=e.addDisposer(t.events.on("positionchanged",(()=>{e._fixPosition()}))),e._posXDp=e.addDisposer(i.events.on("positionchanged",(()=>{e._fixPosition()}))),e.get("baseAxis")||(i.isType("CategoryAxis")||i.isType("DateAxis")?e.set("baseAxis",i):e.set("baseAxis",t)),e.get("stacked")&&(e._markDirtyKey("stacked"),At(e.dataItems,(e=>{e.set("stackToItemY",void 0),e.set("stackToItemX",void 0)}))),e._markDirtyAxes(),i.markDirtyExtremes(),t.markDirtyExtremes(),t._seriesAdded=!0,i._seriesAdded=!0,this._colorize(e)}_colorize(e){const t=this.get("colors");if(t&&null==e.get("fill")){const i=t.next();e._setSoft("stroke",i),e._setSoft("fill",i)}const i=this.get("patterns");if(i&&null==e.get("fillPattern")){const t=i.next();e._setSoft("fillPattern",t)}}_handleCursorSelectEnd(){const e=this.get("cursor"),t=e.get("behavior"),i=e.getPrivate("downPositionX",0),r=e.getPrivate("downPositionY",0),a=Math.min(1,Math.max(0,e.getPrivate("positionX",.5))),s=Math.min(1,Math.max(0,e.getPrivate("positionY",.5)));this.xAxes.each((e=>{if("zoomX"===t||"zoomXY"===t){let t=e.toAxisPosition(i),r=e.toAxisPosition(a);e.zoom(t,r)}e.setPrivate("updateScrollbar",!0)})),this.yAxes.each((e=>{if("zoomY"===t||"zoomXY"===t){let t=e.toAxisPosition(r),i=e.toAxisPosition(s);e.zoom(t,i)}e.setPrivate("updateScrollbar",!0)}))}_handleScrollbar(e,t,i,r){e.each((e=>{let a=e.fixPosition(t),s=e.fixPosition(i),n=e.zoom(a,s,void 0,r);const o="updateScrollbar";e.setPrivateRaw(o,!1),n?n.events.on("stopped",(()=>{e.setPrivateRaw(o,!0)})):e.setPrivateRaw(o,!0)}))}_processAxis(e,t){return e.events.onAll((e=>{if("clear"===e.type)At(e.oldValues,(e=>{this._removeAxis(e)}));else if("push"===e.type)t.children.push(e.newValue),e.newValue.processChart(this);else if("setIndex"===e.type)t.children.setIndex(e.index,e.newValue),e.newValue.processChart(this);else if("insertIndex"===e.type)t.children.insertIndex(e.index,e.newValue),e.newValue.processChart(this);else if("removeIndex"===e.type)this._removeAxis(e.oldValue);else{if("moveIndex"!==e.type)throw new Error("Unknown IListEvent type");t.children.moveValue(e.value,e.newIndex),e.value.processChart(this)}}))}_removeAxis(e){if(!e.isDisposed()){const t=e.parent;t&&t.children.removeValue(e);const i=e.gridContainer,r=i.parent;r&&r.children.removeValue(i);const a=e.topGridContainer,s=a.parent;s&&s.children.removeValue(a)}}_updateChartLayout(){const e=this.leftAxesContainer.width(),t=this.rightAxesContainer.width(),i=this.bottomAxesContainer;i.set("paddingLeft",e),i.set("paddingRight",t);const r=this.topAxesContainer;r.set("paddingLeft",e),r.set("paddingRight",t)}processAxis(e){this.get("cursor")&&(this.addDisposer(e.on("start",(()=>{this._updateCursor()}))),this.addDisposer(e.on("end",(()=>{this._updateCursor()}))))}_handleAxisSelection(e,t){let i=e.fixPosition(e.get("start",0)),r=e.fixPosition(e.get("end",1));if(i>r&&([i,r]=[r,i]),-1!=this.xAxes.indexOf(e)){if(t||e.getPrivate("updateScrollbar")){let e=this.get("scrollbarX");!e||e.getPrivate("isBusy")&&!t||(e.setRaw("start",i),e.setRaw("end",r),e.updateGrips())}}else if(-1!=this.yAxes.indexOf(e)&&(t||e.getPrivate("updateScrollbar"))){let e=this.get("scrollbarY");!e||e.getPrivate("isBusy")&&!t||(e.setRaw("start",i),e.setRaw("end",r),e.updateGrips())}this._handleZoomOut()}_handleZoomOut(){let e=this.zoomOutButton;if(e&&e.parent){let t=!1;this.xAxes.each((e=>{0==nr(e.get("start",0),6)&&1==nr(e.get("end",1),6)||(t=!0)})),this.yAxes.each((e=>{0==nr(e.get("start",0),6)&&1==nr(e.get("end",1),6)||(t=!0)})),t?e.isHidden()&&e.show():e.hide()}}inPlot(e){const t=this.plotContainer,i=this.getPrivate("otherCharts",this._otherCharts),r=t.toGlobal(e);if(e.x>=-.5&&e.y>=-.5&&e.x<=t.width()+.5&&e.y<=t.height()+.5)return!0;if(i)for(let e=i.length-1;e>=0;e--){const t=i[e];if(t!=this){const e=t.plotContainer,i=this._root.rootPointToDocument(r),a=t._root.documentPointToRoot(i),s=e.toLocal(a);if(s.x>=-.1&&s.y>=-.1&&s.x<=e.width()+.1&&s.y<=e.height()+.1)return!0}}return!1}arrangeTooltips(){const e=this.plotContainer,t=e.width(),i=e.height();let r=this.height();const a=this._root.tooltipContainer.get("layerMargin");a&&a.bottom>r&&(r=a.bottom);let s=e._display.toGlobal({x:0,y:0}),n=e._display.toGlobal({x:t,y:i});const o=[];let l,c,h=0,u=1/0,d=this._movePoint,f=this.get("maxTooltipDistance"),p=this.get("maxTooltipDistanceBy","xy");bt(f)&&this.series.each((e=>{if(!e.isHidden()){const t=e.get("tooltip");if(t){let i=t.get("pointTo");if(i){let t=Math.hypot(d.x-i.x,d.y-i.y);"x"==p?t=Math.abs(d.x-i.x):"y"==p&&(t=Math.abs(d.y-i.y)),t<u&&(u=t,l=e,c=i)}}}}));const g=[];if(this.series.each((e=>{const t=e.get("tooltip");if(t&&!t.get("forceHidden")){let i=!1,r=t.get("pointTo");if(r){if(f>=0){let r=t.get("pointTo");if(r&&c&&e!=l){let e=Math.hypot(c.x-r.x,c.y-r.y);"x"==p?e=Math.abs(c.x-r.x):"y"==p&&(e=Math.abs(c.y-r.y)),e>f&&(i=!0)}}else-1==f&&e!=l&&(i=!0);this.inPlot(this._tooltipToLocal(r))&&t.dataItem?i||(h+=r.y):i=!0,i||e.isHidden()||e.isHiding()?t.hide(0):(t.show(),o.push(t),g.push(e))}}})),this.setPrivate("tooltipSeries",g),this.get("arrangeTooltips")){const e=this._root.tooltipContainer,t=o.length;if(h/t>i/2+s.y){o.sort(((e,t)=>Xi(t.get("pointTo").y,e.get("pointTo").y)));let t=n.y;if(At(o,(i=>{let r=i.height(),a=i.get("centerY");a instanceof st&&(r*=a.value),r+=i.get("marginBottom",0),i.set("bounds",{left:s.x,top:s.y,right:n.x,bottom:t}),i.setPrivate("customData",{left:s.x,top:s.y,right:n.x,bottom:t}),t=Math.min(t-r,i._fy-r),i.parent==e&&e.children.moveValue(i,0)})),t<0){o.reverse();let e=t;At(o,(i=>{let r=i.get("bounds");if(r){let a=r.top-t,s=r.bottom-t;a<e&&(a=e,s=a+i.height()),i.set("bounds",{left:r.left,top:a,right:r.right,bottom:s}),e=r.bottom-t+i.get("marginBottom",0)}}))}}else{o.reverse(),o.sort(((e,t)=>Xi(e.get("pointTo").y,t.get("pointTo").y)));let t=0;if(At(o,(i=>{let a=i.height(),o=i.get("centerY");o instanceof st&&(a*=o.value),a+=i.get("marginBottom",0),i.set("bounds",{left:s.x,top:t,right:n.x,bottom:Math.max(s.y+r,t+a)}),i.parent==e&&e.children.moveValue(i,0),t=Math.max(t+a,i._fy+a)})),t>r){o.reverse();let e=r;At(o,(i=>{let a=i.get("bounds");if(a){let s=a.top-(r-t),n=a.bottom-(r-t);n>e&&(n=e,s=n-i.height()),i.set("bounds",{left:a.left,top:s,right:a.right,bottom:n}),e=n-i.height()-i.get("marginBottom",0)}}))}}}}_tooltipToLocal(e){return this.plotContainer.toLocal(e)}zoomOut(){this.xAxes.each((e=>{e.setPrivate("updateScrollbar",!0),e.zoom(0,1)})),this.yAxes.each((e=>{e.setPrivate("updateScrollbar",!0),e.zoom(0,1)}))}_dispose(){super._dispose();const e=this.get("cursor");e&&e.dispose()}}Object.defineProperty(rs,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYChart"}),Object.defineProperty(rs,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:is.classNames.concat([rs.className])});class as extends Ii{constructor(){super(...arguments),Object.defineProperty(this,"processor",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}incrementRef(){}decrementRef(){}_onPush(e){this.processor&&this.processor.processRow(e),super._onPush(e)}_onInsertIndex(e,t){this.processor&&this.processor.processRow(t),super._onInsertIndex(e,t)}_onSetIndex(e,t,i){this.processor&&this.processor.processRow(i),super._onSetIndex(e,t,i)}}class ss extends qi{constructor(e,t,i){super(i),Object.defineProperty(this,"component",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dataContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bullets",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"open",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"close",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.dataContext=t,this.component=e,this._settings.visible=!0,this._checkDirty()}markDirty(){this.component.markDirtyValues(this)}_startAnimation(){this.component._root._addAnimation(this)}_animationTime(){return this.component._root.animationTime}_dispose(){this.component&&this.component.disposeDataItem(this),super._dispose()}show(e){this.setRaw("visible",!0),this.component&&this.component.showDataItem(this,e)}hide(e){this.setRaw("visible",!1),this.component&&this.component.hideDataItem(this,e)}isHidden(){return!this.get("visible")}}class ns extends Er{constructor(){super(...arguments),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:new as}),Object.defineProperty(this,"_dataItems",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_mainDataItems",{enumerable:!0,configurable:!0,writable:!0,value:this._dataItems}),Object.defineProperty(this,"valueFields",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"fields",{enumerable:!0,configurable:!0,writable:!0,value:["id"]}),Object.defineProperty(this,"_valueFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueFieldsF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fieldsF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valuesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataChanged",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inited",{enumerable:!0,configurable:!0,writable:!0,value:!1})}set data(e){e.incrementRef(),this._data.decrementRef(),this._data=e}get data(){return this._data}_dispose(){super._dispose(),this._data.decrementRef()}_onDataClear(){}_afterNew(){super._afterNew(),this._data.incrementRef(),this._updateFields(),this._disposers.push(this.data.events.onAll((e=>{const t=this._mainDataItems;if(this.markDirtyValues(),this._markDirtyGroup(),this._dataChanged=!0,"clear"===e.type)At(t,(e=>{e.dispose()})),t.length=0,this._onDataClear();else if("push"===e.type){const i=new ss(this,e.newValue,this._makeDataItem(e.newValue));t.push(i),this.processDataItem(i)}else if("setIndex"===e.type){const i=t[e.index],r=this._makeDataItem(e.newValue);i.bullets&&0==i.bullets.length&&(i.bullets=void 0),Ft(r).forEach((e=>{i.animate({key:e,to:r[e],duration:this.get("interpolationDuration",0),easing:this.get("interpolationEasing")})})),i.dataContext=e.newValue}else if("insertIndex"===e.type){const i=new ss(this,e.newValue,this._makeDataItem(e.newValue));t.splice(e.index,0,i),this.processDataItem(i)}else if("removeIndex"===e.type)t[e.index].dispose(),t.splice(e.index,1);else{if("moveIndex"!==e.type)throw new Error("Unknown IStreamEvent type");{const i=t[e.oldIndex];t.splice(e.oldIndex,1),t.splice(e.newIndex,0,i)}}this._afterDataChange()})))}_updateFields(){this.valueFields&&(this._valueFields=[],this._valueFieldsF={},At(this.valueFields,(e=>{this.get(e+"Field")&&(this._valueFields.push(e),this._valueFieldsF[e]={fieldKey:e+"Field",workingKey:e+"Working"})}))),this.fields&&(this._fields=[],this._fieldsF={},At(this.fields,(e=>{this.get(e+"Field")&&(this._fields.push(e),this._fieldsF[e]=e+"Field")})))}get dataItems(){return this._dataItems}processDataItem(e){}_makeDataItem(e){const t={};return this._valueFields&&At(this._valueFields,(i=>{const r=this.get(this._valueFieldsF[i].fieldKey);t[i]=e[r],t[this._valueFieldsF[i].workingKey]=t[i]})),this._fields&&At(this._fields,(i=>{const r=this.get(this._fieldsF[i]);t[i]=e[r]})),t}makeDataItem(e,t){let i=new ss(this,t,e);return this.processDataItem(i),i}pushDataItem(e,t){const i=this.makeDataItem(e,t);return this._mainDataItems.push(i),i}disposeDataItem(e){}showDataItem(e,t){return at(this,void 0,void 0,(function*(){e.set("visible",!0)}))}hideDataItem(e,t){return at(this,void 0,void 0,(function*(){e.set("visible",!1)}))}_clearDirty(){super._clearDirty(),this._valuesDirty=!1}_afterDataChange(){}_afterChanged(){if(super._afterChanged(),this._dataChanged){const e="datavalidated";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this}),this._dataChanged=!1}this.inited=!0}markDirtyValues(e){this.markDirty(),this._valuesDirty=!0}_markDirtyGroup(){this._dataGrouped=!1}markDirtySize(){this._sizeDirty=!0,this.markDirty()}}Object.defineProperty(ns,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Component"}),Object.defineProperty(ns,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Er.classNames.concat([ns.className])});class os extends ns{constructor(){super(...arguments),Object.defineProperty(this,"_series",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_isPanning",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"minorDataItems",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"labelsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Er.new(this._root,{}))}),Object.defineProperty(this,"gridContainer",{enumerable:!0,configurable:!0,writable:!0,value:Er.new(this._root,{width:lt,height:lt})}),Object.defineProperty(this,"topGridContainer",{enumerable:!0,configurable:!0,writable:!0,value:Er.new(this._root,{width:lt,height:lt})}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Er.new(this._root,{isMeasured:!1,width:lt,height:lt,position:"absolute"}))}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rangesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_panStart",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_panEnd",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_sAnimation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_eAnimation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_skipSync",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"axisRanges",{enumerable:!0,configurable:!0,writable:!0,value:new Ii}),Object.defineProperty(this,"_seriesAxisRanges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"ghostLabel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_cursorPosition",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"_snapToSeries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_seriesValuesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_seriesAdded",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"axisHeader",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Er.new(this._root,{themeTags:["axis","header"],position:"absolute",background:br.new(this._root,{themeTags:["header","background"],fill:this._root.interfaceColors.get("background")})}))}),Object.defineProperty(this,"_bullets",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_dispose(){this.gridContainer.dispose(),this.topGridContainer.dispose(),this.bulletsContainer.dispose(),this.labelsContainer.dispose(),this.axisHeader.dispose(),super._dispose()}_afterNew(){super._afterNew(),this.setPrivate("updateScrollbar",!0),this._disposers.push(this.axisRanges.events.onAll((e=>{if("clear"===e.type)At(e.oldValues,(e=>{this.disposeDataItem(e)}));else if("push"===e.type)this._processAxisRange(e.newValue,["range"]);else if("setIndex"===e.type)this._processAxisRange(e.newValue,["range"]);else if("insertIndex"===e.type)this._processAxisRange(e.newValue,["range"]);else if("removeIndex"===e.type)this.disposeDataItem(e.oldValue);else{if("moveIndex"!==e.type)throw new Error("Unknown IStreamEvent type");this._processAxisRange(e.value,["range"])}})));const e=this.get("renderer");e&&(e.axis=this,e.processAxis()),this.children.push(e),this.ghostLabel=e.makeLabel(new ss(this,void 0,{}),[]),this.ghostLabel.adapters.disable("text"),this.ghostLabel.setAll({opacity:0,tooltipText:void 0,tooltipHTML:void 0,interactive:!1}),this.ghostLabel.events.disable()}_updateFinals(e,t){}zoom(e,t,i,r){if(this.get("zoomable",!0))if(this._updateFinals(e,t),this.get("start")!==e||this.get("end")!=t){let a=this._sAnimation,s=this._eAnimation,n=this.get("maxDeviation",.5)*Math.min(1,t-e);e<-n&&(e=-n),t>1+n&&(t=1+n),e>t&&([e,t]=[t,e]),bt(i)||(i=this.get("interpolationDuration",0)),r||(r="end");let o=this.getPrivate("maxZoomFactor",this.get("maxZoomFactor",100)),l=o;1===t&&0!==e&&(r=e<this.get("start",0)?"start":"end"),0===e&&1!==t&&(r=t>this.get("end",1)?"end":"start");let c=this.get("minZoomCount",0),h=this.get("maxZoomCount",1/0);bt(c)&&(o=l/c);let u=1;if(bt(h)&&(u=l/h),"start"===r?(h>0&&1/(t-e)<u&&(t=e+1/u),1/(t-e)>o&&(t=e+1/o),t>1&&t-e<1/o&&(e=t-1/o)):(h>0&&1/(t-e)<u&&(e=t-1/u),1/(t-e)>o&&(e=t-1/o),e<0&&t-e<1/o&&(t=e+1/o)),1/(t-e)>o&&(t=e+1/o),1/(t-e)>o&&(e=t-1/o),null!=h&&null!=c&&e==this.get("start")&&t==this.get("end")){const e=this.chart;e&&e._handleAxisSelection(this,!0)}if((a&&a.playing&&a.to==e||this.get("start")==e)&&(s&&s.playing&&s.to==t||this.get("end")==t))return;if(i>0){let r,a,s=this.get("interpolationEasing");if(this.get("start")!=e&&(r=this.animate({key:"start",to:e,duration:i,easing:s})),this.get("end")!=t&&(a=this.animate({key:"end",to:t,duration:i,easing:s})),this._sAnimation=r,this._eAnimation=a,r)return r;if(a)return a}else this.set("start",e),this.set("end",t)}else this._sAnimation&&this._sAnimation.stop(),this._eAnimation&&this._eAnimation.stop()}get series(){return this._series}_processAxisRange(e,t){e.setRaw("isRange",!0),this._createAssets(e,t),this._rangesDirty=!0,this._prepareDataItem(e);const i=e.get("above"),r=this.topGridContainer,a=e.get("grid");i&&a&&r.children.moveValue(a);const s=e.get("axisFill");i&&s&&r.children.moveValue(s)}_prepareDataItem(e,t){}markDirtyExtremes(){}markDirtySelectionExtremes(){}_calculateTotals(){}_updateAxisRanges(){this._bullets={},this.axisRanges.each((e=>{this._prepareDataItem(e)})),At(this._seriesAxisRanges,(e=>{this._prepareDataItem(e)}))}_prepareChildren(){if(super._prepareChildren(),this.get("fixAxisSize")?this.ghostLabel.set("visible",!0):this.ghostLabel.set("visible",!1),this.isDirty("start")||this.isDirty("end")){const e=this.chart;e&&e._updateCursor();let t=this.get("start",0),i=this.get("end",1),r=this.get("maxDeviation",.5)*Math.min(1,i-t);if(t<-r){let e=t+r;t=-r,this.setRaw("start",t),this.isDirty("end")&&this.setRaw("end",i-e)}if(i>1+r){let e=i-1-r;i=1+r,this.setRaw("end",i),this.isDirty("start")&&this.setRaw("start",t-e)}}const e=this.get("renderer");if(e._start=this.get("start"),e._end=this.get("end"),e._inversed=e.get("inversed",!1),e._axisLength=e.axisLength()/(e._end-e._start),e._updateLC(),this.isDirty("tooltip")){const t=this.get("tooltip");if(t){const i=e.get("themeTags");t.addTag("axis"),t.addTag(this.className.toLowerCase()),t._applyThemes(),i&&(t.set("themeTags",wi(t.get("themeTags"),i)),t.label._applyThemes())}}}_updateTooltipBounds(){const e=this.get("tooltip");e&&this.get("renderer").updateTooltipBounds(e)}_updateBounds(){super._updateBounds(),this._updateTooltipBounds()}processChart(e){this.chart=e,this.get("renderer").chart=e,e.gridContainer.children.push(this.gridContainer),e.topGridContainer.children.push(this.topGridContainer),e.axisHeadersContainer.children.push(this.axisHeader),this.on("start",(()=>{e._handleAxisSelection(this)})),this.on("end",(()=>{e._handleAxisSelection(this)})),e.plotContainer.onPrivate("width",(()=>{this.markDirtySize()})),e.plotContainer.onPrivate("height",(()=>{this.markDirtySize()})),e.processAxis(this)}hideDataItem(e){return this._toggleFHDataItem(e,!0),super.hideDataItem(e)}showDataItem(e){return this._toggleFHDataItem(e,!1),super.showDataItem(e)}_toggleFHDataItem(e,t){const i="forceHidden",r=e.get("label");r&&r.set(i,t);const a=e.get("grid");a&&a.set(i,t);const s=e.get("tick");s&&s.set(i,t);const n=e.get("axisFill");n&&n.set(i,t);const o=e.get("bullet");if(o){const e=o.get("sprite");e&&e.set(i,t)}}_toggleDataItem(e,t){const i=e.get("label"),r="visible";i&&i.setPrivate(r,t);const a=e.get("grid");a&&a.setPrivate(r,t);const s=e.get("tick");s&&s.setPrivate(r,t);const n=e.get("axisFill");n&&n.setPrivate(r,t);const o=e.get("bullet");if(o){const e=o.get("sprite");e&&e.setPrivate(r,t)}}_createAssets(e,t,i){var r,a,s;const n=this.get("renderer");let o="minor";const l=e.get("label");if(l){let a=l.get("themeTags"),s=!1;i?-1==(null==a?void 0:a.indexOf(o))&&(s=!0):-1!=(null==a?void 0:a.indexOf(o))&&(s=!0),s&&(null===(r=l.parent)||void 0===r||r.children.removeValue(l),n.makeLabel(e,t),l.dispose(),n.labels.removeValue(l))}else n.makeLabel(e,t);const c=e.get("grid");if(c){let r=c.get("themeTags"),s=!1;i?-1==(null==r?void 0:r.indexOf(o))&&(s=!0):-1!=(null==r?void 0:r.indexOf(o))&&(s=!0),s&&(null===(a=c.parent)||void 0===a||a.children.removeValue(c),n.makeGrid(e,t),c.dispose(),n.grid.removeValue(c))}else n.makeGrid(e,t);const h=e.get("tick");if(h){let r=!1,a=h.get("themeTags");i?-1==(null==a?void 0:a.indexOf(o))&&(r=!0):-1!=(null==a?void 0:a.indexOf(o))&&(r=!0),r&&(null===(s=h.parent)||void 0===s||s.children.removeValue(h),n.makeTick(e,t),h.dispose(),n.ticks.removeValue(h))}else n.makeTick(e,t);i||e.get("axisFill")||n.makeAxisFill(e,t),this._processBullet(e)}_processBullet(e){let t=e.get("bullet"),i=this.get("bullet");if(t||!i||e.get("isRange")||(t=i(this._root,this,e)),t){t.axis=this;const i=t.get("sprite");i&&(i._setDataItem(e),e.setRaw("bullet",t),i.parent||this.bulletsContainer.children.push(i))}}_afterChanged(){super._afterChanged();const e=this.chart;e&&(e._updateChartLayout(),e.axisHeadersContainer.markDirtySize()),this.get("renderer")._updatePositions(),this._seriesAdded=!1}disposeDataItem(e){super.disposeDataItem(e);const t=this.get("renderer"),i=e.get("label");i&&(t.labels.removeValue(i),i.dispose());const r=e.get("tick");r&&(t.ticks.removeValue(r),r.dispose());const a=e.get("grid");a&&(t.grid.removeValue(a),a.dispose());const s=e.get("axisFill");s&&(t.axisFills.removeValue(s),s.dispose());const n=e.get("bullet");n&&n.dispose()}_updateGhost(){this.setPrivate("cellWidth",this.getCellWidthPosition()*this.get("renderer").axisLength());const e=this.ghostLabel;if(!e.isHidden()){const t=e.localBounds(),i=Math.ceil(t.right-t.left);let r=e.get("text");At(this.dataItems,(e=>{const t=e.get("label");if(t&&!t.isHidden()){const e=t.localBounds();Math.ceil(e.right-e.left)>i&&(r=t.text._getText())}})),e.set("text",r)}let t=this.get("start",0),i=this.get("end",1);this.get("renderer").updateLabel(e,t+.5*(i-t))}_handleCursorPosition(e,t){e=this.get("renderer").toAxisPosition(e),this._cursorPosition=e,this._snapToSeries=t,this.updateTooltip()}updateTooltip(){const e=this._snapToSeries;let t=this._cursorPosition;const i=this.get("tooltip"),r=this.get("renderer");bt(t)&&(At(this.series,(i=>{if(i.get("baseAxis")===this){const r=this.getSeriesItem(i,t,this.get("tooltipLocation"));e&&-1!=e.indexOf(i)?(i.updateLegendMarker(r),i.updateLegendValue(r),i._settings.tooltipDataItem=r):(i.showDataItemTooltip(r),i.setRaw("tooltipDataItem",r))}})),this.get("snapTooltip")&&(t=this.roundAxisPosition(t,this.get("tooltipLocation",.5))),this.setPrivateRaw("tooltipPosition",t),i&&(r.updateTooltipBounds(i),ut(t)?i.hide(0):(this._updateTooltipText(i,t),r.positionTooltip(i,t),t<this.get("start",0)||t>this.get("end",1)?i.hide(0):i.show(0))))}_updateTooltipText(e,t){e.label.set("text",this.getTooltipText(t))}roundAxisPosition(e,t){return e}_handleSeriesRemoved(){}handleCursorShow(){let e=this.get("tooltip");e&&e.show()}handleCursorHide(){let e=this.get("tooltip");e&&e.hide()}processSeriesDataItem(e,t){}_clearDirty(){super._clearDirty(),this._sizeDirty=!1,this._rangesDirty=!1}coordinateToPosition(e){const t=this.get("renderer");return t.toAxisPosition(e/t.axisLength())}toAxisPosition(e){return this.get("renderer").toAxisPosition(e)}toGlobalPosition(e){return this.get("renderer").toGlobalPosition(e)}fixPosition(e){return this.get("renderer").fixPosition(e)}shouldGap(e,t,i,r){return!1}createAxisRange(e){return this.axisRanges.push(e)}_groupSeriesData(e){}getCellWidthPosition(){return.05}}Object.defineProperty(os,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Axis"}),Object.defineProperty(os,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ns.classNames.concat([os.className])});class ls extends os{constructor(){super(...arguments),Object.defineProperty(this,"_dirtyExtremes",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dirtySelectionExtremes",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dseHandled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_deltaMinMax",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_minReal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_maxReal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minRealLog",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_baseValue",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_syncDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minLogAdjusted",{enumerable:!0,configurable:!0,writable:!0,value:1})}markDirtyExtremes(){this._dirtyExtremes=!0,this.markDirty()}markDirtySelectionExtremes(){this._dirtySelectionExtremes=!0,this.markDirty()}_afterNew(){this._settings.themeTags=wi(this._settings.themeTags,["axis"]),this.setPrivateRaw("name","value"),this.addTag("value"),super._afterNew()}_prepareChildren(){if(super._prepareChildren(),this.isDirty("syncWithAxis")){this._prevSettings.syncWithAxis&&this._syncDp&&this._syncDp.dispose();let e=this.get("syncWithAxis");e&&(this._syncDp=new Wt([e.onPrivate("selectionMinFinal",(()=>{this._dirtySelectionExtremes=!0})),e.onPrivate("selectionMaxFinal",(()=>{this._dirtySelectionExtremes=!0}))]))}let e=!1;if((this.isDirty("min")||this.isDirty("max")||this.isDirty("maxPrecision")||this.isDirty("numberFormat"))&&(e=!0,this.ghostLabel.set("text","")),(this._sizeDirty||this._dirtyExtremes||this._valuesDirty||e||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("extraMin")||this.isDirty("extraMax")||this.isDirty("logarithmic")||this.isDirty("treatZeroAs")||this.isDirty("baseValue")||this.isDirty("strictMinMax")||this.isDirty("strictMinMaxSelection"))&&(this._getMinMax(),this._dirtyExtremes=!1),this._handleSizeDirty(),this._dirtySelectionExtremes&&!this._isPanning&&this.get("autoZoom",!0)){const e=this.chart;let t=!1;if(e){const i=this.get("renderer").getPrivate("letter");"Y"==i?e.xAxes.each((e=>{"ValueAxis"!=e.className&&(t=!0)})):"X"==i&&e.yAxes.each((e=>{"ValueAxis"!=e.className&&(t=!0)}))}t&&this._getSelectionMinMax(),this._dirtySelectionExtremes=!1}this._groupData(),(this._sizeDirty||this._valuesDirty||this.isDirty("start")||this.isDirty("end")||this.isPrivateDirty("min")||this.isPrivateDirty("selectionMax")||this.isPrivateDirty("selectionMin")||this.isPrivateDirty("max")||this.isPrivateDirty("step")||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("logarithmic"))&&(this._handleRangeChange(),this._prepareAxisItems(),this._updateAxisRanges()),this._baseValue=this.baseValue()}_handleSizeDirty(){this._sizeDirty&&!this._dseHandled&&(this._dirtySelectionExtremes=!0,this._dseHandled=!0)}_clearDirty(){super._clearDirty(),this._dseHandled=!1}_groupData(){}_formatText(e){const t=this.get("numberFormat"),i=this.getNumberFormatter();let r="";return r=t?i.format(e,t):i.format(e,void 0,this.getPrivate("stepDecimalPlaces")),r}_prepareAxisItems(){const e=this.getPrivate("min"),t=this.getPrivate("max");if(bt(e)&&bt(t)){const t=this.get("logarithmic"),i=this.getPrivate("step"),r=this.getPrivate("selectionMin"),a=this.getPrivate("selectionMax")+i;let s=r-i,n=1,o=e;if(t){if(s=this._minLogAdjusted,s<r)for(;s<r;)s+=i;o=s,o<=0&&(o=1,i<1&&(o=bt(this._minRealLog)?this._minRealLog:Math.pow(10,-50))),n=Math.log(a-i)*Math.LOG10E-Math.log(o)*Math.LOG10E,n>2&&(s=Math.pow(10,Math.log(o)*Math.LOG10E-50))}const l=this.get("renderer"),c=l.get("minorLabelsEnabled"),h=l.get("minorGridEnabled",c);let u=Math.pow(10,Math.floor(Math.log(Math.abs(i))*Math.LOG10E));const d=Math.round(i/u);let f=2;nr(d/5,10)%1==0&&(f=5),nr(d/10,10)%1==0&&(f=10);let p=i/f,g=0,m=0,b=-1/0;for(;s<a;){let e;this.dataItems.length<g+1?(e=new ss(this,void 0,{}),this._dataItems.push(e),this.processDataItem(e)):e=this.dataItems[g],this._createAssets(e,[]),this._toggleDataItem(e,!0),e.setRaw("value",s);const r=e.get("label");r&&r.set("text",this._formatText(s)),this._prepareDataItem(e);let a=s;if(t&&n>2?a=Math.pow(10,Math.log(o)*Math.LOG10E+g-50):a+=i,h){let e=s+p;for(t&&(n>2&&(p=this._adjustMinMax(s,a,10).step),e=s+p);e<a-1e-11*i;){let t;this.minorDataItems.length<m+1?(t=new ss(this,void 0,{}),this.minorDataItems.push(t),this.processDataItem(t)):t=this.minorDataItems[m],this._createAssets(t,["minor"],!0),this._toggleDataItem(t,!0),t.setRaw("value",e);const i=t.get("label");i&&(c?i.set("text",this._formatText(e)):i.setPrivate("visible",!1)),this._prepareDataItem(t),e+=p,m++}}if(s=a,b==s)break;let l=Math.pow(10,Math.floor(Math.log(Math.abs(i))*Math.LOG10E));l<1&&!t&&(s=nr(s,Math.round(Math.abs(Math.log(Math.abs(l))*Math.LOG10E))+2)),g++,b=s}for(let e=g;e<this.dataItems.length;e++)this._toggleDataItem(this.dataItems[e],!1);for(let e=m;e<this.minorDataItems.length;e++)this._toggleDataItem(this.minorDataItems[e],!1);At(this.series,(e=>{e.inited&&e._markDirtyAxes()})),this._updateGhost()}}_prepareDataItem(e,t){let i=this.get("renderer"),r=e.get("value"),a=e.get("endValue"),s=this.valueToPosition(r),n=s,o=this.valueToPosition(r+this.getPrivate("step"));bt(a)&&(n=this.valueToPosition(a),o=n),e.get("isRange")&&null==a&&(o=s);let l=n,c=e.get("labelEndValue");null!=c&&(l=this.valueToPosition(c)),i.updateLabel(e.get("label"),s,l,t);const h=e.get("grid");if(i.updateGrid(h,s,n),h&&(r==this.get("baseValue",0)?(h.addTag("base"),h._applyThemes()):h.hasTag("base")&&(h.removeTag("base"),h._applyThemes())),i.updateTick(e.get("tick"),s,l,t),i.updateFill(e.get("axisFill"),s,o),this._processBullet(e),i.updateBullet(e.get("bullet"),s,n),!e.get("isRange")){const t=this.get("fillRule");t&&t(e)}}_handleRangeChange(){let e=this.positionToValue(this.get("start",0)),t=this.positionToValue(this.get("end",1));const i=this.get("renderer").gridCount();let r=this._adjustMinMax(e,t,i,!0),a=ri(r.step);this.setPrivateRaw("stepDecimalPlaces",a),e=nr(e,a),t=nr(t,a),r=this._adjustMinMax(e,t,i,!0);let s=r.step;e=r.min,t=r.max,this.getPrivate("selectionMin")===e&&this.getPrivate("selectionMax")===t&&this.getPrivate("step")===s||(this.setPrivateRaw("selectionMin",e),this.setPrivateRaw("selectionMax",t),this.setPrivateRaw("step",s))}positionToValue(e){const t=this.getPrivate("min"),i=this.getPrivate("max");return this.get("logarithmic")?Math.pow(Math.E,(e*(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E)+Math.log(t)*Math.LOG10E)/Math.LOG10E):e*(i-t)+t}valueToPosition(e){const t=this.getPrivate("min"),i=this.getPrivate("max");if(this.get("logarithmic")){if(e<=0){let t=this.get("treatZeroAs");bt(t)&&(e=t)}return(Math.log(e)*Math.LOG10E-Math.log(t)*Math.LOG10E)/(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E)}return(e-t)/(i-t)}valueToFinalPosition(e){const t=this.getPrivate("minFinal"),i=this.getPrivate("maxFinal");if(this.get("logarithmic")){if(e<=0){let t=this.get("treatZeroAs");bt(t)&&(e=t)}return(Math.log(e)*Math.LOG10E-Math.log(t)*Math.LOG10E)/(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E)}return(e-t)/(i-t)}getX(e,t,i){e=i+(e-i)*t;const r=this.valueToPosition(e);return this._settings.renderer.positionToCoordinate(r)}getY(e,t,i){e=i+(e-i)*t;const r=this.valueToPosition(e);return this._settings.renderer.positionToCoordinate(r)}getDataItemCoordinateX(e,t,i,r){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(e,t,i,r))}getDataItemPositionX(e,t,i,r){let a=e.get(t);return a=e.get("stackToItemX")?a*r+e.component.getStackedXValueWorking(e,t):this._baseValue+(a-this._baseValue)*r,this.valueToPosition(a)}getDataItemCoordinateY(e,t,i,r){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(e,t,i,r))}getDataItemPositionY(e,t,i,r){let a=e.get(t);return a=e.get("stackToItemY")?a*r+e.component.getStackedYValueWorking(e,t):this._baseValue+(a-this._baseValue)*r,this.valueToPosition(a)}basePosition(){return this.valueToPosition(this.baseValue())}baseValue(){const e=Math.min(this.getPrivate("minFinal",-1/0),this.getPrivate("selectionMin",-1/0)),t=Math.max(this.getPrivate("maxFinal",1/0),this.getPrivate("selectionMax",1/0));let i=this.get("baseValue",0);return i<e&&(i=e),i>t&&(i=t),i}cellEndValue(e){return e}fixSmallStep(e){return 1+e===1?(e*=2,this.fixSmallStep(e)):e}_fixMin(e){return e}_fixMax(e){return e}_calculateTotals(){if(this.get("calculateTotals")){let e=this.series[0];if(e){let t=e.startIndex();if(e.dataItems.length>0){t>0&&t--;let i,r,a=e.endIndex();a<e.dataItems.length&&a++,e.get("yAxis")==this?(i="valueY",r="vcy"):e.get("xAxis")==this&&(i="valueX",r="vcx");let s=i+"Working";if(i)for(let e=t;e<a;e++){let t=0,a=0;At(this.series,(i=>{if(!i.get("excludeFromTotal")){let n=i.dataItems[e];if(n){let e=n.get(s)*i.get(r);ut(e)||(t+=e,a+=Math.abs(e))}}})),At(this.series,(n=>{if(!n.get("excludeFromTotal")){let o=n.dataItems[e];if(o){let e=o.get(s)*n.get(r);ut(e)||(o.set(i+"Total",a),o.set(i+"Sum",t),o.set(i+"TotalPercent",e/a*100))}}}))}}}}}_getSelectionMinMax(){const e=this.getPrivate("minFinal"),t=this.getPrivate("maxFinal"),i=this.get("min"),r=this.get("max");let a=this.get("extraMin",0),s=this.get("extraMax",0);this.get("logarithmic")&&(null==this.get("extraMin")&&(a=.1),null==this.get("extraMax")&&(s=.2));const n=this.get("renderer").gridCount(),o=this.get("strictMinMaxSelection");let l=this.get("strictMinMax");if(bt(e)&&bt(t)){let c=t,h=e;if(At(this.series,(e=>{if(!e.get("ignoreMinMax")){let t,i;const r=e.getPrivate("outOfSelection");if(e.get("xAxis")===this){if(!r){let r=e.getPrivate("minX"),a=e.getPrivate("maxX");0==e.startIndex()&&e.endIndex()==e.dataItems.length||(r=void 0,a=void 0),t=e.getPrivate("selectionMinX",r),i=e.getPrivate("selectionMaxX",a)}}else if(e.get("yAxis")===this&&!r){let r=e.getPrivate("minY"),a=e.getPrivate("maxY");0==e.startIndex()&&e.endIndex()==e.dataItems.length||(r=void 0,a=void 0),t=e.getPrivate("selectionMinY",r),i=e.getPrivate("selectionMaxY",a)}e.isHidden()||e.isShowing()||(bt(t)&&(c=Math.min(c,t)),bt(i)&&(h=Math.max(h,i)))}})),this.axisRanges.each((e=>{if(e.get("affectsMinMax")){let t=e.get("value");null!=t&&(c=Math.min(c,t),h=Math.max(h,t)),t=e.get("endValue"),null!=t&&(c=Math.min(c,t),h=Math.max(h,t))}})),c>h&&([c,h]=[h,c]),bt(i)?c=l?i:e:l&&bt(this._minReal)&&(c=this._minReal),bt(r)?h=l?r:t:l&&bt(this._maxReal)&&(h=this._maxReal),c===h){let t=c;if(c-=this._deltaMinMax,h+=this._deltaMinMax,c<e){let i=t-e;0==i&&(i=this._deltaMinMax),c=t-i,h=t+i,l=!0}let i=this._adjustMinMax(c,h,n,l);c=i.min,h=i.max}let u=c,d=h,f=h-c;c-=f*a,h+=f*s;let p=this._adjustMinMax(c,h,n);c=p.min,h=p.max,c=or(c,e,t),h=or(h,e,t),p=this._adjustMinMax(c,h,n,!0),l||(c=p.min,h=p.max);const g=this.get("syncWithAxis");if(g&&(p=this._syncAxes(c,h,p.step,g.getPrivate("selectionMinFinal",g.getPrivate("minFinal",0)),g.getPrivate("selectionMaxFinal",g.getPrivate("maxFinal",1)),g.getPrivate("selectionStepFinal",g.getPrivate("step",1))),p.min<e&&(p.min=e),p.max>t&&(p.max=t),c=p.min,h=p.max),l&&(bt(i)&&(c=Math.max(c,i)),bt(r)&&(h=Math.min(h,r))),o&&(c=u-(d-u)*a,h=d+(d-u)*s),l){c=bt(i)?i:u,h=bt(r)?r:d,h-c<=1e-8&&(c-=this._deltaMinMax,h+=this._deltaMinMax);let e=h-c;c-=e*a,h+=e*s}this.get("logarithmic")&&(c<=0&&(c=u*(1-Math.min(a,.99))),c<e&&(c=e),h>t&&(h=t));let m=Math.min(20,Math.ceil(Math.log(this.getPrivate("maxZoomFactor",100)+1)/Math.LN10)+2),b=nr(this.valueToFinalPosition(c),m),v=nr(this.valueToFinalPosition(h),m);this.setPrivateRaw("selectionMinFinal",c),this.setPrivateRaw("selectionMaxFinal",h),this.setPrivateRaw("selectionStepFinal",p.step),this.zoom(b,v)}}_getMinMax(){let e=this.get("min"),t=this.get("max"),i=1/0,r=-1/0,a=this.get("extraMin",0),s=this.get("extraMax",0);this.get("logarithmic")&&(null==this.get("extraMin")&&(a=.1),null==this.get("extraMax")&&(s=.2));let n=1/0;if(At(this.series,(e=>{if(!e.get("ignoreMinMax")){let t,a;if(e.get("xAxis")===this?(t=e.getPrivate("minX"),a=e.getPrivate("maxX")):e.get("yAxis")===this&&(t=e.getPrivate("minY"),a=e.getPrivate("maxY")),bt(t)&&bt(a)){i=Math.min(i,t),r=Math.max(r,a);let e=a-t;e<=0&&(e=Math.abs(a/100)),e<n&&(n=e)}}})),this.axisRanges.each((e=>{if(e.get("affectsMinMax")){let t=e.get("value");null!=t&&(i=Math.min(i,t),r=Math.max(r,t)),t=e.get("endValue"),null!=t&&(i=Math.min(i,t),r=Math.max(r,t))}})),this.get("logarithmic")){let e=this.get("treatZeroAs");bt(e)&&i<=0&&(i=e),i<=0&&new Error("Logarithmic value axis can not have values <= 0.")}if(0===i&&0===r&&(r=.9,i=-.9),bt(e)&&(i=e),bt(t)&&(r=t),i===1/0||r===-1/0)return this.setPrivate("minFinal",void 0),void this.setPrivate("maxFinal",void 0);i>r&&([i,r]=[r,i]);const o=i,l=r;let c=this.adapters.fold("min",i),h=this.adapters.fold("max",r);this._minRealLog=i,bt(c)&&(i=c),bt(h)&&(r=h),i=this._fixMin(i),r=this._fixMax(r),r-i<=1/Math.pow(10,15)&&(r-i!=0?this._deltaMinMax=(r-i)/2:this._getDelta(r),i-=this._deltaMinMax,r+=this._deltaMinMax),i-=(r-i)*a,r+=(r-i)*s,this.get("logarithmic")&&(i<0&&o>=0&&(i=0),r>0&&l<=0&&(r=0)),this._minReal=i,this._maxReal=r;let u=this.get("strictMinMax"),d=this.get("strictMinMaxSelection",!1);d&&(u=d);let f=u;bt(t)&&(f=!0);let p=this.get("renderer").gridCount(),g=this._adjustMinMax(i,r,p,f);if(i=g.min,r=g.max,g=this._adjustMinMax(i,r,p,!0),i=g.min,r=g.max,u){i=bt(e)?e:this._minReal,r=bt(t)?t:this._maxReal,r-i<=1e-8&&(i-=this._deltaMinMax,r+=this._deltaMinMax);let n=r-i;i-=n*a,r+=n*s}c=this.adapters.fold("min",i),h=this.adapters.fold("max",r),bt(c)&&(i=c),bt(h)&&(r=h),n==1/0&&(n=r-i);let m=Math.round(Math.abs(Math.log(Math.abs(r-i))*Math.LOG10E))+5;i=nr(i,m),r=nr(r,m);const b=this.get("syncWithAxis");if(b&&(g=this._syncAxes(i,r,g.step,b.getPrivate("minFinal",b.getPrivate("min",0)),b.getPrivate("maxFinal",b.getPrivate("max",1)),b.getPrivate("step",1)),i=g.min,r=g.max),this.setPrivateRaw("maxZoomFactor",Math.max(1,Math.ceil((r-i)/n*this.get("maxZoomFactor",100)))),this._fixZoomFactor(),this.get("logarithmic")&&(this._minLogAdjusted=i,i=this._minReal,r=this._maxReal,i<=0&&(i=o*(1-Math.min(a,.99)))),bt(i)&&bt(r)&&(this.getPrivate("minFinal")!==i||this.getPrivate("maxFinal")!==r)){this.setPrivate("minFinal",i),this.setPrivate("maxFinal",r),this._saveMinMax(i,r);const e=this.get("interpolationDuration",0),t=this.get("interpolationEasing");this.animatePrivate({key:"min",to:i,duration:e,easing:t}),this.animatePrivate({key:"max",to:r,duration:e,easing:t})}}_fixZoomFactor(){}_getDelta(e){let t=Math.log(Math.abs(e))*Math.LOG10E,i=Math.pow(10,Math.floor(t));i/=10,this._deltaMinMax=i}_saveMinMax(e,t){}_adjustMinMax(e,t,i,r){i<=1&&(i=1),i=Math.round(i);let a=e,s=t,n=t-e;0===n&&(n=Math.abs(t));let o=Math.log(Math.abs(n))*Math.LOG10E,l=Math.pow(10,Math.floor(o));l/=10;let c=l;r&&(c=0),r?(e=Math.floor(e/l)*l,t=Math.ceil(t/l)*l):(e=Math.ceil(e/l)*l-c,t=Math.floor(t/l)*l+c),e<0&&a>=0&&(e=0),t>0&&s<=0&&(t=0),o=Math.log(Math.abs(n))*Math.LOG10E,l=Math.pow(10,Math.floor(o)),l/=100;let h=Math.ceil(n/i/l)*l,u=Math.pow(10,Math.floor(Math.log(Math.abs(h))*Math.LOG10E)),d=Math.ceil(h/u);d>5?d=10:d<=5&&d>2&&(d=5),h=Math.ceil(h/(u*d))*u*d;let f=this.get("maxPrecision");if(bt(f)){let e=function(e,t){if(!bt(t)||t<=0)return Math.ceil(e);{let i=Math.pow(10,t);return Math.ceil(e*i)/i}}(h,f);f<Number.MAX_VALUE&&h!==e&&(h=e,0==h&&(h=1))}let p=0;u<1&&(p=Math.round(Math.abs(Math.log(Math.abs(u))*Math.LOG10E))+1,h=nr(h,p));let g,m=Math.floor(e/h);return e=nr(h*m,p),g=r?Math.floor(t/h):Math.ceil(t/h),g===m&&g++,(t=nr(h*g,p))<s&&(t+=h),e>a&&(e-=h),h=this.fixSmallStep(h),{min:e,max:t,step:h}}getTooltipText(e,t){const i=this.get("tooltipNumberFormat",this.get("numberFormat")),r=this.getNumberFormatter(),a=this.get("extraTooltipPrecision",0),s=this.getPrivate("stepDecimalPlaces",0)+a,n=nr(this.positionToValue(e),s);return i?r.format(n,i):r.format(n,void 0,s)}getSeriesItem(e,t){let i,r,a=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),s=this.positionToValue(t);if(At(e.dataItems,((e,t)=>{const n=Math.abs(e.get(a)-s);(void 0===i||n<r)&&(i=t,r=n)})),null!=i)return e.dataItems[i]}zoomToValues(e,t,i){const r=this.getPrivate("minFinal",0),a=this.getPrivate("maxFinal",0);null!=this.getPrivate("min")&&null!=this.getPrivate("max")&&this.zoom((e-r)/(a-r),(t-r)/(a-r),i)}_syncAxes(e,t,i,r,a,s){if(this.get("syncWithAxis")){let n=Math.round(a-r)/s,o=Math.round((t-e)/i),l=this.get("renderer").gridCount();if(bt(n)&&bt(o)){let r=!1,a=0,s=.01*(t-e),o=e,c=t,h=i;for(;1!=r;)if(r=this._checkSync(o,c,h,n),a++,a>500&&(r=!0),r)e=o,t=c,i=h;else{a/3==Math.round(a/3)?(o=e-s*a,e>=0&&o<0&&(o=0)):(c=t+s*a,c<=0&&c>0&&(c=0));let i=this._adjustMinMax(o,c,l,!0);o=i.min,c=i.max,h=i.step}}}return{min:e,max:t,step:i}}_checkSync(e,t,i,r){let a=(t-e)/i;for(let e=1;e<r;e++)if(nr(a/e,1)==r||a*e==r)return!0;return!1}getCellWidthPosition(){let e=this.getPrivate("selectionMax",this.getPrivate("max")),t=this.getPrivate("selectionMin",this.getPrivate("min"));return bt(e)&&bt(t)?this.getPrivate("step",1)/(e-t):.05}nextPosition(e){null==e&&(e=1),"Y"==this.get("renderer").getPrivate("letter")&&(e*=-1);let t=this.positionToValue(this.getPrivate("tooltipPosition",0));return t+=this.getPrivate("step",1)*e,t=or(t,this.getPrivate("selectionMin",0),this.getPrivate("selectionMax",1)),this.toGlobalPosition(this.valueToPosition(t))}}function cs(e,t){for(let i=0,r=t.length;i<r;i++){const r=t[i];if(r.length>0){let t=r[0];if(t.length>0){let i=t[0];e.moveTo(i.x,i.y);for(let t=0,i=r.length;t<i;t++)hs(e,r[t])}}}}function hs(e,t){for(let i=0,r=t.length;i<r;i++){const r=t[i];e.lineTo(r.x,r.y)}}Object.defineProperty(ls,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ValueAxis"}),Object.defineProperty(ls,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:os.classNames.concat([ls.className])});class us extends mr{_beforeChanged(){super._beforeChanged(),(this.isDirty("points")||this.isDirty("segments")||this._sizeDirty||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){const e=this.get("points"),t=this.get("segments");if(e&&e.length>0){let t=e[0];this._display.moveTo(t.x,t.y),cs(this._display,[[e]])}else if(t)cs(this._display,t);else if(!this.get("draw")){let e=this.width(),t=this.height();this._display.moveTo(0,0),this._display.lineTo(e,t)}}}}Object.defineProperty(us,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Line"}),Object.defineProperty(us,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:mr.classNames.concat([us.className])});class ds extends us{}Object.defineProperty(ds,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Tick"}),Object.defineProperty(ds,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:us.classNames.concat([ds.className])});class fs extends ds{constructor(){super(...arguments),Object.defineProperty(this,"_tickPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}Object.defineProperty(fs,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisTick"}),Object.defineProperty(fs,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ds.classNames.concat([fs.className])});class ps extends mr{_beforeChanged(){super._beforeChanged(),(this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}}Object.defineProperty(ps,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Grid"}),Object.defineProperty(ps,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:mr.classNames.concat([ps.className])});class gs extends Lr{constructor(){super(...arguments),Object.defineProperty(this,"_tickPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}Object.defineProperty(gs,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisLabel"}),Object.defineProperty(gs,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Lr.classNames.concat([gs.className])});class ms extends mr{constructor(){super(...arguments),Object.defineProperty(this,"_axisLength",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"_start",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_end",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_inversed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_minSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_lc",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_ls",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_thumbDownPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ticks",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new Fi(ir.new({}),(()=>fs._new(this._root,{themeTags:wi(this.ticks.template.get("themeTags",[]),this.get("themeTags",[]))},[this.ticks.template]))))}),Object.defineProperty(this,"grid",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new Fi(ir.new({}),(()=>ps._new(this._root,{themeTags:wi(this.grid.template.get("themeTags",[]),this.get("themeTags",[]))},[this.grid.template]))))}),Object.defineProperty(this,"axisFills",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new Fi(ir.new({}),(()=>mr._new(this._root,{themeTags:wi(this.axisFills.template.get("themeTags",["axis","fill"]),this.get("themeTags",[]))},[this.axisFills.template]))))}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new Fi(ir.new({}),(()=>gs._new(this._root,{themeTags:wi(this.labels.template.get("themeTags",[]),this.get("themeTags",[]))},[this.labels.template]))))}),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}makeTick(e,t){const i=this.ticks.make();return i._setDataItem(e),e.setRaw("tick",i),i.set("themeTags",wi(i.get("themeTags"),t)),this.axis.labelsContainer.children.push(i),this.ticks.push(i),i}makeGrid(e,t){const i=this.grid.make();return i._setDataItem(e),e.setRaw("grid",i),i.set("themeTags",wi(i.get("themeTags"),t)),this.axis.gridContainer.children.push(i),this.grid.push(i),i}makeAxisFill(e,t){const i=this.axisFills.make();return i._setDataItem(e),i.set("themeTags",wi(i.get("themeTags"),t)),this.axis.gridContainer.children.push(i),e.setRaw("axisFill",i),this.axisFills.push(i),i}makeLabel(e,t){const i=this.labels.make();return i.set("themeTags",wi(i.get("themeTags"),t)),this.axis.labelsContainer.children.moveValue(i,0),i._setDataItem(e),e.setRaw("label",i),this.labels.push(i),i}axisLength(){return 0}gridCount(){return this.axisLength()/this.get("minGridDistance",50)}_updatePositions(){}_afterNew(){super._afterNew(),this.set("isMeasured",!1);const e=this.thumb;e&&(this._disposers.push(e.events.on("pointerdown",(e=>{this._handleThumbDown(e)}))),this._disposers.push(e.events.on("globalpointerup",(e=>{this._handleThumbUp(e)}))),this._disposers.push(e.events.on("globalpointermove",(e=>{this._handleThumbMove(e)}))))}_beforeChanged(){super._beforeChanged(),this.isDirty("minGridDistance")&&this.root.events.once("frameended",(()=>{this.axis.markDirtySize()}))}_changed(){if(super._changed(),this.isDirty("pan")){const e=this.thumb;if(e){const t=this.axis.labelsContainer,i=this.get("pan");"zoom"==i?t.children.push(e):"none"==i&&t.children.removeValue(e)}}}_handleThumbDown(e){this._thumbDownPoint=this.toLocal(e.point);const t=this.axis;this._downStart=t.get("start"),this._downEnd=t.get("end")}_handleThumbUp(e){this._thumbDownPoint=void 0}_handleThumbMove(e){const t=this._thumbDownPoint;if(t){const i=this.toLocal(e.point),r=this._downStart,a=this._downEnd,s=this._getPan(i,t)*Math.min(1,a-r)/2*this.get("panSensitivity",1);this.axis.zoom(r-s,a+s,0)}}_getPan(e,t){return 0}positionToCoordinate(e){return this._inversed?(this._end-e)*this._axisLength:(e-this._start)*this._axisLength}updateTooltipBounds(e){}_updateSize(){this.markDirty(),this._clear=!0}toAxisPosition(e){const t=this._start||0,i=this._end||1;return e*=i-t,this.get("inversed")?i-e:t+e}toGlobalPosition(e){const t=this._start||0,i=this._end||1;return this.get("inversed")?e=i-e:e-=t,e/(i-t)}fixPosition(e){return this.get("inversed")?1-e:e}_updateLC(){}toggleVisibility(e,t,i,r){let a=this.axis;const s=a.get("start",0),n=a.get("end",1);t<s+(n-s)*(i-1e-4)||t>s+(n-s)*(r+1e-4)?e.setPrivate("visible",!1):e.setPrivate("visible",!0)}_positionTooltip(e,t){const i=this.chart;i&&(e.set("pointTo",this._display.toGlobal(t)),i.inPlot(t)||e.hide())}processAxis(){}}Object.defineProperty(ms,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRenderer"}),Object.defineProperty(ms,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:mr.classNames.concat([ms.className])});class bs extends ms{constructor(){super(...arguments),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:br.new(this._root,{width:lt,isMeasured:!1,themeTags:["axis","x","thumb"]})})}_afterNew(){this._settings.themeTags=wi(this._settings.themeTags,["renderer","x"]),super._afterNew(),this.setPrivateRaw("letter","X");const e=this.grid.template;e.set("height",lt),e.set("width",0),e.set("draw",((e,t)=>{e.moveTo(0,0),e.lineTo(0,t.height())})),this.set("draw",((e,t)=>{e.moveTo(0,0),e.lineTo(t.width(),0)}))}_changed(){super._changed();const e=this.axis;e.ghostLabel.setPrivate("visible",!this.get("inside")),e.ghostLabel.set("x",-1e3);const t="opposite",i="inside";if(this.isDirty(t)||this.isDirty(i)){const r=this.chart,a=e.children;if(this.get(i)?e.addTag(i):e.removeTag(i),r){if(this.get(t)){const i=r.topAxesContainer.children;-1==i.indexOf(e)&&i.insertIndex(0,e),e.addTag(t),a.moveValue(this)}else{const i=r.bottomAxesContainer.children;-1==i.indexOf(e)&&i.moveValue(e),e.removeTag(t),a.moveValue(this,0)}e.ghostLabel._applyThemes(),this.labels.each((e=>{e._applyThemes()})),this.root._markDirtyRedraw()}e.markDirtySize()}this.thumb.setPrivate("height",e.labelsContainer.height())}_getPan(e,t){return(t.x-e.x)/this.width()}toAxisPosition(e){const t=this._start||0,i=this._end||1;return e=(e-=this._ls)*(i-t)/this._lc,this.get("inversed")?i-e:t+e}toGlobalPosition(e){const t=this._start||0,i=this._end||1;return this.get("inversed")?e=i-e:e-=t,(e=e/(i-t)*this._lc)+this._ls}_updateLC(){const e=this.axis,t=e.parent;if(t){const i=t.innerWidth();this._lc=this.axisLength()/i,this._ls=(e.x()-t.get("paddingLeft",0))/i}}_updatePositions(){const e=this.axis,t=e.x()-ii(e.get("centerX",0),e.width())-e.parent.get("paddingLeft",0);e.gridContainer.set("x",t),e.topGridContainer.set("x",t),e.bulletsContainer.set("y",this.y());const i=e.chart;if(i){const t=i.plotContainer,r=e.axisHeader;let a=e.get("marginLeft",0),s=e.x()-a;const n=e.parent;n&&(s-=n.get("paddingLeft",0)),r.children.length>0?(a=e.axisHeader.width(),e.set("marginLeft",a+1)):r.set("width",a),r.setAll({x:s,y:-1,height:t.height()+2})}}processAxis(){super.processAxis();const e=this.axis;null==e.get("width")&&e.set("width",lt);const t=this._root.verticalLayout;e.set("layout",t),e.labelsContainer.set("width",lt),e.axisHeader.setAll({layout:t})}axisLength(){return this.axis.width()}positionToPoint(e){return{x:this.positionToCoordinate(e),y:0}}updateTick(e,t,i,r){if(e){bt(t)||(t=0);let a=.5;a=bt(r)&&r>1?e.get("multiLocation",a):e.get("location",a),bt(i)&&i!=t&&(t+=(i-t)*a),e.set("x",this.positionToCoordinate(t));let s=e.get("length",0);const n=e.get("inside",this.get("inside",!1));this.get("opposite")?(e.set("y",lt),n||(s*=-1)):(e.set("y",0),n&&(s*=-1)),e.set("draw",(e=>{e.moveTo(0,0),e.lineTo(0,s)})),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateLabel(e,t,i,r){if(e){let a=.5;a=bt(r)&&r>1?e.get("multiLocation",a):e.get("location",a),bt(t)||(t=0);const s=e.get("inside",this.get("inside",!1));this.get("opposite")?s?(e.set("position","absolute"),e.set("y",0)):(e.set("position","relative"),e.set("y",lt)):s?(e.set("y",0),e.set("position","absolute")):(e.set("y",void 0),e.set("position","relative")),bt(i)&&i!=t&&(t+=(i-t)*a),e.set("x",this.positionToCoordinate(t)),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateGrid(e,t,i){if(e){bt(t)||(t=0);let r=e.get("location",.5);bt(i)&&i!=t&&(t+=(i-t)*r),e.set("x",this.positionToCoordinate(t)),this.toggleVisibility(e,t,0,1)}}updateBullet(e,t,i){if(e){const r=e.get("sprite");if(r){bt(t)||(t=0);let a=e.get("location",.5);bt(i)&&i!=t&&(t+=(i-t)*a);let s=this.axis.roundAxisPosition(t,a),n=this.axis._bullets[s],o=-1;if(this.get("opposite")&&(o=1),e.get("stacked"))if(n){let e=n.get("sprite");e&&r.set("y",e.y()+e.height()*o)}else r.set("y",0);this.axis._bullets[s]=e,r.set("x",this.positionToCoordinate(t)),this.toggleVisibility(r,t,0,1)}}}updateFill(e,t,i){if(e){bt(t)||(t=0),bt(i)||(i=1);let r=this.positionToCoordinate(t),a=this.positionToCoordinate(i);this.fillDrawMethod(e,r,a)}}fillDrawMethod(e,t,i){e.set("draw",(e=>{const r=this.axis.gridContainer.height(),a=this.width();i<t&&([i,t]=[t,i]),t>a||i<0||(e.moveTo(t,0),e.lineTo(i,0),e.lineTo(i,r),e.lineTo(t,r),e.lineTo(t,0))}))}positionTooltip(e,t){this._positionTooltip(e,{x:this.positionToCoordinate(t),y:0})}updateTooltipBounds(e){const t=this.get("inside"),i=1e5;let r=this._display.toGlobal({x:0,y:0}),a=r.x,s=0,n=this.axisLength(),o=i,l="up";this.get("opposite")?t?(l="up",s=r.y,o=i):(l="down",s=r.y-i,o=i):t?(l="down",s=r.y-i,o=i):(l="up",s=r.y,o=i);const c={left:a,right:a+n,top:s,bottom:s+o};xi(c,e.get("bounds"))||(e.set("bounds",c),e.set("pointerOrientation",l))}}Object.defineProperty(bs,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRendererX"}),Object.defineProperty(bs,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ms.classNames.concat([bs.className])});class vs extends ms{constructor(){super(...arguments),Object.defineProperty(this,"_downY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:br.new(this._root,{height:lt,isMeasured:!1,themeTags:["axis","y","thumb"]})})}_afterNew(){this._settings.themeTags=wi(this._settings.themeTags,["renderer","y"]),this._settings.opposite&&this._settings.themeTags.push("opposite"),super._afterNew(),this.setPrivateRaw("letter","Y");const e=this.grid.template;e.set("width",lt),e.set("height",0),e.set("draw",((e,t)=>{e.moveTo(0,0),e.lineTo(t.width(),0)})),this.set("draw",((e,t)=>{e.moveTo(0,0),e.lineTo(0,t.height())}))}_getPan(e,t){return(e.y-t.y)/this.height()}_changed(){super._changed();const e=this.axis;e.ghostLabel.setPrivate("visible",!this.get("inside")),e.ghostLabel.set("y",-1e3);const t=this.thumb,i="opposite",r="inside",a=this.chart;if(this.isDirty(i)||this.isDirty(r)){const t=e.children;if(this.get(r)?e.addTag(r):e.removeTag(r),a){if(this.get(i)){const r=a.rightAxesContainer.children;-1==r.indexOf(e)&&r.moveValue(e,0),e.addTag(i),t.moveValue(this,0)}else{const r=a.leftAxesContainer.children;-1==r.indexOf(e)&&r.moveValue(e),e.removeTag(i),t.moveValue(this)}e.ghostLabel._applyThemes(),this.labels.each((e=>{e._applyThemes()})),this.root._markDirtyRedraw()}e.markDirtySize()}const s=e.labelsContainer.width();a&&(this.get(i)?t.set("centerX",0):t.set("centerX",s)),t.setPrivate("width",s)}processAxis(){super.processAxis();const e=this.axis;null==e.get("height")&&e.set("height",lt);const t=this._root.horizontalLayout;e.set("layout",t),e.labelsContainer.set("height",lt),e.axisHeader.set("layout",t)}_updatePositions(){const e=this.axis,t=e.y()-ii(e.get("centerY",0),e.height());e.gridContainer.set("y",t),e.topGridContainer.set("y",t),e.bulletsContainer.set("x",this.x());const i=e.chart;if(i){const t=i.plotContainer,r=e.axisHeader;let a=e.get("marginTop",0);r.children.length>0?(a=e.axisHeader.height(),e.set("marginTop",a+1)):r.set("height",a),r.setAll({y:e.y()-a,x:-1,width:t.width()+2})}}axisLength(){return this.axis.innerHeight()}positionToPoint(e){return{x:0,y:this.positionToCoordinate(e)}}updateLabel(e,t,i,r){if(e){bt(t)||(t=0);let a=.5;a=bt(r)&&r>1?e.get("multiLocation",a):e.get("location",a);const s=this.get("opposite"),n=e.get("inside",this.get("inside",!1));s?(e.set("x",0),n?e.set("position","absolute"):e.set("position","relative")):n?(e.set("x",0),e.set("position","absolute")):(e.set("x",void 0),e.set("position","relative")),bt(i)&&i!=t&&(t+=(i-t)*a),e.set("y",this.positionToCoordinate(t)),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateGrid(e,t,i){if(e){bt(t)||(t=0);let r=e.get("location",.5);bt(i)&&i!=t&&(t+=(i-t)*r),e.set("y",this.positionToCoordinate(t)),this.toggleVisibility(e,t,0,1)}}updateTick(e,t,i,r){if(e){bt(t)||(t=0);let a=.5;a=bt(r)&&r>1?e.get("multiLocation",a):e.get("location",a),bt(i)&&i!=t&&(t+=(i-t)*a),e.set("y",this.positionToCoordinate(t));let s=e.get("length",0);const n=e.get("inside",this.get("inside",!1));this.get("opposite")?(e.set("x",0),n&&(s*=-1)):n||(s*=-1),e.set("draw",(e=>{e.moveTo(0,0),e.lineTo(s,0)})),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateBullet(e,t,i){if(e){const r=e.get("sprite");if(r){bt(t)||(t=0);let a=e.get("location",.5);bt(i)&&i!=t&&(t+=(i-t)*a);let s=this.axis.roundAxisPosition(t,a),n=this.axis._bullets[s],o=1;if(this.get("opposite")&&(o=-1),e.get("stacked"))if(n){let e=n.get("sprite");e&&r.set("x",e.x()+e.width()*o)}else r.set("x",0);this.axis._bullets[s]=e,r.set("y",this.positionToCoordinate(t)),this.toggleVisibility(r,t,0,1)}}}updateFill(e,t,i){if(e){bt(t)||(t=0),bt(i)||(i=1);let r=this.positionToCoordinate(t),a=this.positionToCoordinate(i);this.fillDrawMethod(e,r,a)}}fillDrawMethod(e,t,i){e.set("draw",(e=>{const r=this.axis.gridContainer.width(),a=this.height();i<t&&([i,t]=[t,i]),t>a||i<0||(e.moveTo(0,t),e.lineTo(r,t),e.lineTo(r,i),e.lineTo(0,i),e.lineTo(0,t))}))}positionToCoordinate(e){return this._inversed?(e-this._start)*this._axisLength:(this._end-e)*this._axisLength}positionTooltip(e,t){this._positionTooltip(e,{x:0,y:this.positionToCoordinate(t)})}updateTooltipBounds(e){const t=this.get("inside"),i=1e5;let r=this._display.toGlobal({x:0,y:0}),a=r.y,s=0,n=this.axisLength(),o=i,l="right";this.get("opposite")?t?(l="right",s=r.x-i,o=i):(l="left",s=r.x,o=i):t?(l="left",s=r.x,o=i):(l="right",s=r.x-i,o=i);const c={left:s,right:s+o,top:a,bottom:a+n};xi(c,e.get("bounds"))||(e.set("bounds",c),e.set("pointerOrientation",l))}_updateLC(){const e=this.axis,t=e.parent;if(t){const i=t.innerHeight();this._lc=this.axisLength()/i,this._ls=e.y()/i}}toAxisPosition(e){const t=this._start||0,i=this._end||1;return e=(e-=this._ls)*(i-t)/this._lc,this.get("inversed")?t+e:i-e}toGlobalPosition(e){const t=this._start||0,i=this._end||1;return this.get("inversed")?e-=t:e=i-e,(e=e/(i-t)*this._lc)+this._ls}fixPosition(e){return this.get("inversed")?e:1-e}}Object.defineProperty(vs,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRendererY"}),Object.defineProperty(vs,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ms.classNames.concat([vs.className])});class ys extends ns{constructor(){super(...arguments),Object.defineProperty(this,"_aggregatesCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_selectionAggregatesCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataProcessed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_psi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pei",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bullets",{enumerable:!0,configurable:!0,writable:!0,value:new Ii}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:Er.new(this._root,{width:lt,height:lt,position:"absolute"})})}_afterNew(){this.valueFields.push("value","customValue"),super._afterNew(),this.setPrivate("customData",{}),this._disposers.push(this.bullets.events.onAll((e=>{if("clear"===e.type)this._handleBullets(this.dataItems);else if("push"===e.type)this._handleBullets(this.dataItems);else if("setIndex"===e.type)this._handleBullets(this.dataItems);else if("insertIndex"===e.type)this._handleBullets(this.dataItems);else if("removeIndex"===e.type)this._handleBullets(this.dataItems);else{if("moveIndex"!==e.type)throw new Error("Unknown IListEvent type");this._handleBullets(this.dataItems)}})))}_dispose(){this.bulletsContainer.dispose(),super._dispose()}startIndex(){let e=this.dataItems.length;return Math.min(this.getPrivate("startIndex",0),e)}endIndex(){let e=this.dataItems.length;return Math.min(this.getPrivate("endIndex",e),e)}_handleBullets(e){At(e,(e=>{const t=e.bullets;t&&(At(t,(e=>{e.dispose()})),e.bullets=void 0)})),this.markDirtyValues()}getDataItemById(e){return It(this.dataItems,(t=>t.get("id")==e))}_makeBullets(e){this._shouldMakeBullet(e)&&(e.bullets=[],this.bullets.each((t=>{this._makeBullet(e,t)})))}_shouldMakeBullet(e){return!0}_makeBullet(e,t,i){const r=t(this._root,this,e);return r&&(r._index=i,this._makeBulletReal(e,r)),r}_makeBulletReal(e,t){let i=t.get("sprite");i&&(i._setDataItem(e),i.setRaw("position","absolute"),this.bulletsContainer.children.push(i)),t.series=this,e.bullets.push(t)}addBullet(e,t){e.bullets||(e.bullets=[]),t&&this._makeBulletReal(e,t)}_clearDirty(){super._clearDirty(),this._aggregatesCalculated=!1,this._selectionAggregatesCalculated=!1}_prepareChildren(){super._prepareChildren();let e=this.startIndex(),t=this.endIndex();if(this.isDirty("name")&&this.updateLegendValue(),this.isDirty("heatRules")&&(this._valuesDirty=!0),this.isPrivateDirty("baseValueSeries")){const e=this.getPrivate("baseValueSeries");e&&this._disposers.push(e.onPrivate("startIndex",(()=>{this.markDirtyValues()})))}if(this.get("calculateAggregates")&&(this._valuesDirty&&!this._dataProcessed&&(this._aggregatesCalculated||(this._calculateAggregates(0,this.dataItems.length),this._aggregatesCalculated=!0,0!=e&&(this._psi=void 0))),this._psi==e&&this._pei==t&&!this.isPrivateDirty("adjustedStartIndex")||this._selectionAggregatesCalculated||(0===e&&t===this.dataItems.length&&this._aggregatesCalculated||this._calculateAggregates(e,t),this._selectionAggregatesCalculated=!0)),this.isDirty("tooltip")){let e=this.get("tooltip");e&&(e.hide(0),e.set("tooltipTarget",this))}if(this.isDirty("fill")||this.isDirty("stroke")){let e;const t=this.get("legendDataItem");if(t&&(e=t.get("markerRectangle"),e&&this.isVisible())){if(this.isDirty("stroke")){let t=this.get("stroke");e.set("stroke",t)}if(this.isDirty("fill")){let t=this.get("fill");e.set("fill",t)}}this.updateLegendMarker(void 0)}if(this.bullets.length>0){let e=this.startIndex(),t=this.endIndex();t<this.dataItems.length&&t++;for(let i=e;i<t;i++){let e=this.dataItems[i];e.bullets||this._makeBullets(e)}}}_handleRemoved(){}_adjustStartIndex(e){return e}_calculateAggregates(e,t){let i=this._valueFields;if(!i)throw new Error("No value fields are set for the series.");const r={},a={},s={},n={},o={},l={},c={},h={},u={};At(i,(e=>{r[e]=0,a[e]=0,s[e]=0})),At(i,(i=>{let d=i+"Change",f=i+"ChangePercent",p=i+"ChangePrevious",g=i+"ChangePreviousPercent",m=i+"ChangeSelection",b=i+"ChangeSelectionPercent",v="valueY";"valueX"!=i&&"openValueX"!=i&&"lowValueX"!=i&&"highValueX"!=i||(v="valueX");const y=this.getPrivate("baseValueSeries"),_=this.getPrivate("adjustedStartIndex",e);for(let w=_;w<t;w++){const t=this.dataItems[w];if(t){let _=t.get(i);null!=_&&(s[i]++,r[i]+=_,a[i]+=Math.abs(_),h[i]=r[i]/s[i],(n[i]>_||null==n[i])&&(n[i]=_),(o[i]<_||null==o[i])&&(o[i]=_),c[i]=_,null==l[i]&&(l[i]=_,u[i]=_,y&&(l[v]=y._getBase(v))),0===e&&(t.setRaw(d,_-l[v]),t.setRaw(f,(_-l[v])/l[v]*100)),t.setRaw(p,_-u[v]),t.setRaw(g,(_-u[v])/u[v]*100),t.setRaw(m,_-l[v]),t.setRaw(b,(_-l[v])/l[v]*100),u[i]=_)}}if(t<this.dataItems.length-1){const e=this.dataItems[t];if(e){let t=e.get(i);e.setRaw(p,t-u[v]),e.setRaw(g,(t-u[v])/u[v]*100),e.setRaw(m,t-l[v]),e.setRaw(b,(t-l[v])/l[v]*100)}}e>0&&e--,delete u[i];for(let t=e;t<_;t++){const e=this.dataItems[t];if(e){let t=e.get(i);null==u[i]&&(u[i]=t),null!=t&&(e.setRaw(p,t-u[v]),e.setRaw(g,(t-u[v])/u[v]*100),e.setRaw(m,t-l[v]),e.setRaw(b,(t-l[v])/l[v]*100),u[i]=t)}}})),At(i,(e=>{this.setPrivate(e+"AverageSelection",h[e]),this.setPrivate(e+"CountSelection",s[e]),this.setPrivate(e+"SumSelection",r[e]),this.setPrivate(e+"AbsoluteSumSelection",a[e]),this.setPrivate(e+"LowSelection",n[e]),this.setPrivate(e+"HighSelection",o[e]),this.setPrivate(e+"OpenSelection",l[e]),this.setPrivate(e+"CloseSelection",c[e])})),0===e&&t===this.dataItems.length&&At(i,(e=>{this.setPrivate(e+"Average",h[e]),this.setPrivate(e+"Count",s[e]),this.setPrivate(e+"Sum",r[e]),this.setPrivate(e+"AbsoluteSum",a[e]),this.setPrivate(e+"Low",n[e]),this.setPrivate(e+"High",o[e]),this.setPrivate(e+"Open",l[e]),this.setPrivate(e+"Close",c[e])}))}_updateChildren(){super._updateChildren(),this._psi=this.startIndex(),this._pei=this.endIndex(),this.isDirty("visible")&&this.bulletsContainer.set("visible",this.get("visible"));const e=this.get("heatRules");if(this._valuesDirty&&e&&e.length>0&&At(e,(e=>{const t=e.minValue||this.getPrivate(e.dataField+"Low")||0,i=e.maxValue||this.getPrivate(e.dataField+"High")||0;At(e.target._entities,(r=>{const a=r.dataItem.get(e.dataField);if(!bt(a)){e.neutral&&r.set(e.key,e.neutral);const t=r.states;if(t){const i=t.lookup("default");i&&e.neutral&&i.set(e.key,e.neutral)}if(!e.customFunction)return}if(e.customFunction)e.customFunction.call(this,r,t,i,a);else{let s,n;s=e.logarithmic?(Math.log(a)*Math.LOG10E-Math.log(t)*Math.LOG10E)/(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E):(a-t)/(i-t),!bt(a)||bt(s)&&Math.abs(s)!=1/0||(s=.5),bt(e.min)?n=e.min+(e.max-e.min)*s:e.min instanceof ki?n=ki.interpolate(s,e.min,e.max):e.min instanceof st&&(n=Ci(s,e.min,e.max)),r.set(e.key,n);const o=r.states;if(o){const t=o.lookup("default");t&&t.set(e.key,n)}}}))})),this.get("visible")){let e=this.dataItems.length,t=this.startIndex(),i=this.endIndex();i<e&&i++,t>0&&t--;for(let e=0;e<t;e++)this._hideBullets(this.dataItems[e]);for(let e=t;e<i;e++)this._positionBullets(this.dataItems[e]);for(let t=i;t<e;t++)this._hideBullets(this.dataItems[t])}}_positionBullets(e){e.bullets&&At(e.bullets,(e=>{this._positionBullet(e);const t=e.get("sprite");e.get("dynamic")&&(t&&(t._markDirtyKey("fill"),t.markDirtySize()),t instanceof Er&&t.walkChildren((e=>{e._markDirtyKey("fill"),e.markDirtySize(),e instanceof Lr&&e.text.markDirtyText()}))),t instanceof Lr&&t.get("populateText")&&t.text.markDirtyText()}))}_hideBullets(e){e.bullets&&At(e.bullets,(e=>{let t=e.get("sprite");t&&t.setPrivate("visible",!1)}))}_positionBullet(e){}_placeBulletsContainer(e){e.bulletsContainer.children.moveValue(this.bulletsContainer)}_removeBulletsContainer(){const e=this.bulletsContainer;e.parent&&e.parent.children.removeValue(e)}disposeDataItem(e){const t=e.bullets;t&&At(t,(e=>{e.dispose()}))}_getItemReaderLabel(){return""}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return at(this,void 0,void 0,(function*(){const r=[i.showDataItem.call(this,e,t)],a=e.bullets;a&&At(a,(e=>{const i=e.get("sprite");i&&r.push(i.show(t))})),yield Promise.all(r)}))}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return at(this,void 0,void 0,(function*(){const r=[i.hideDataItem.call(this,e,t)],a=e.bullets;a&&At(a,(e=>{const i=e.get("sprite");i&&r.push(i.hide(t))})),yield Promise.all(r)}))}_sequencedShowHide(e,t){return at(this,void 0,void 0,(function*(){if(this.get("sequencedInterpolation"))if(bt(t)||(t=this.get("interpolationDuration",0)),t>0){const i=this.startIndex(),r=this.endIndex();yield Promise.all(xt(this.dataItems,((a,s)=>at(this,void 0,void 0,(function*(){let n=t||0;(s<i-10||s>r+10)&&(n=0);let o=this.get("sequencedDelay",0)+n/(r-i);var l;yield(l=o*(s-i),new Promise(((e,t)=>{setTimeout(e,l)}))),e?yield this.showDataItem(a,n):yield this.hideDataItem(a,n)})))))}else yield Promise.all(xt(this.dataItems,(t=>e?this.showDataItem(t,0):this.hideDataItem(t,0))))}))}updateLegendValue(e){if(e){const t=e.get("legendDataItem");if(t){const i=t.get("valueLabel");if(i){const t=i.text;let r="";i._setDataItem(e),r=this.get("legendValueText",t.get("text","")),i.set("text",r),t.markDirtyText()}const r=t.get("label");if(r){const t=r.text;let i="";r._setDataItem(e),i=this.get("legendLabelText",t.get("text","")),r.set("text",i),t.markDirtyText()}}}}updateLegendMarker(e){}_onHide(){super._onHide();const e=this.getTooltip();e&&e.hide()}hoverDataItem(e){}unhoverDataItem(e){}_getBase(e){const t=this.dataItems[this.startIndex()];return t?t.get(e):0}}Object.defineProperty(ys,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Series"}),Object.defineProperty(ys,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ns.classNames.concat([ys.className])});class _s extends ys{constructor(){super(...arguments),Object.defineProperty(this,"_xField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_xOpenField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yOpenField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_xLowField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_xHighField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yLowField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yHighField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_axesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_stackDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_selectionProcessed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataSets",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_mainContainerMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_bullets",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"mainContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Er.new(this._root,{}))}),Object.defineProperty(this,"axisRanges",{enumerable:!0,configurable:!0,writable:!0,value:new Ii}),Object.defineProperty(this,"_skipped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_couldStackTo",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_reallyStackedTo",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_stackedSeries",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_aLocationX0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_aLocationX1",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_aLocationY0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_aLocationY1",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_showBullets",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"valueXFields",{enumerable:!0,configurable:!0,writable:!0,value:["valueX","openValueX","lowValueX","highValueX"]}),Object.defineProperty(this,"valueYFields",{enumerable:!0,configurable:!0,writable:!0,value:["valueY","openValueY","lowValueY","highValueY"]}),Object.defineProperty(this,"_valueXFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueYFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueXShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueYShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__valueXShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__valueYShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_emptyDataItem",{enumerable:!0,configurable:!0,writable:!0,value:new ss(this,void 0,{})}),Object.defineProperty(this,"_dataSetId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipFieldX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipFieldY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_posXDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_posYDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this.fields.push("categoryX","categoryY","openCategoryX","openCategoryY"),this.valueFields.push("valueX","valueY","openValueX","openValueY","lowValueX","lowValueY","highValueX","highValueY"),this._setRawDefault("vcx",1),this._setRawDefault("vcy",1),this._setRawDefault("valueXShow","valueXWorking"),this._setRawDefault("valueYShow","valueYWorking"),this._setRawDefault("openValueXShow","openValueXWorking"),this._setRawDefault("openValueYShow","openValueYWorking"),this._setRawDefault("lowValueXShow","lowValueXWorking"),this._setRawDefault("lowValueYShow","lowValueYWorking"),this._setRawDefault("highValueXShow","highValueXWorking"),this._setRawDefault("highValueYShow","highValueYWorking"),this._setRawDefault("lowValueXGrouped","low"),this._setRawDefault("lowValueYGrouped","low"),this._setRawDefault("highValueXGrouped","high"),this._setRawDefault("highValueYGrouped","high"),super._afterNew(),this.set("maskContent",!0),this._disposers.push(this.axisRanges.events.onAll((e=>{if("clear"===e.type)At(e.oldValues,(e=>{this._removeAxisRange(e)}));else if("push"===e.type)this._processAxisRange(e.newValue);else if("setIndex"===e.type)this._processAxisRange(e.newValue);else if("insertIndex"===e.type)this._processAxisRange(e.newValue);else if("removeIndex"===e.type)this._removeAxisRange(e.oldValue);else{if("moveIndex"!==e.type)throw new Error("Unknown IStreamEvent type");this._processAxisRange(e.value)}}))),this.states.create("hidden",{opacity:1,visible:!1}),this.onPrivate("startIndex",(()=>{this.root.events.once("frameended",(()=>{this.updateLegendValue()}))})),this.onPrivate("endIndex",(()=>{this.root.events.once("frameended",(()=>{this.updateLegendValue()}))})),this._makeFieldNames()}_processAxisRange(e){const t=Er.new(this._root,{});e.container=t,this.children.push(t),e.series=this;const i=e.axisDataItem;i.setRaw("isRange",!0);const r=i.component;if(r){r._processAxisRange(i,["range","series"]);const e=i.get("bullet");if(e){const t=e.get("sprite");t&&t.setPrivate("visible",!1)}const a=i.get("axisFill");a&&t.set("mask",a),r._seriesAxisRanges.push(i)}}_removeAxisRange(e){const t=e.axisDataItem,i=t.component;i.disposeDataItem(t),St(i._seriesAxisRanges,t);const r=e.container;r&&r.dispose()}_updateFields(){super._updateFields(),this._valueXFields=[],this._valueYFields=[],this._valueXShowFields=[],this._valueYShowFields=[],this.__valueXShowFields=[],this.__valueYShowFields=[],this.valueXFields&&At(this.valueXFields,(e=>{if(this.get(e+"Field")){this._valueXFields.push(e);let t=this.get(e+"Show");this.__valueXShowFields.push(t),-1!=t.indexOf("Working")?this._valueXShowFields.push(t.split("Working")[0]):this._valueXShowFields.push(t)}})),this.valueYFields&&At(this.valueYFields,(e=>{if(this.get(e+"Field")){this._valueYFields.push(e);let t=this.get(e+"Show");this.__valueYShowFields.push(t),-1!=t.indexOf("Working")?this._valueYShowFields.push(t.split("Working")[0]):this._valueYShowFields.push(t)}}))}_dispose(){super._dispose(),this._bullets={};const e=this.chart;e&&e.series.removeValue(this),Pt(this.get("xAxis").series,this),Pt(this.get("yAxis").series,this)}_min(e,t){let i=(a=t,null==(r=this.getPrivate(e))?a:null==a?r:a<r?a:r);var r,a;this.setPrivate(e,i)}_max(e,t){let i=(a=t,null==(r=this.getPrivate(e))?a:null==a?r:a>r?a:r);var r,a;this.setPrivate(e,i)}_shouldMakeBullet(e){const t=this.get("xAxis"),i=this.get("yAxis"),r=this.get("baseAxis");if(!t.inited||!i.inited)return!1;const a=this.get("minBulletDistance",0);if(a>0){let e=this.startIndex(),s=this.endIndex()-e;if(t==r){if(t.get("renderer").axisLength()/s<a/5)return!1}else if(i==r&&i.get("renderer").axisLength()/s<a/5)return!1}return null!=e.get(this._xField)&&null!=e.get(this._yField)}_makeFieldNames(){const e=this.get("xAxis"),t=this.get("yAxis"),i=e.getPrivate("name"),r=mi(i),a=t.getPrivate("name"),s=mi(a),n=e.get("renderer").getPrivate("letter"),o=t.get("renderer").getPrivate("letter"),l="open",c="low",h="high",u="Show";"ValueAxis"===e.className?(this._xField=this.get(i+n+u),this._xOpenField=this.get(l+r+n+u),this._xLowField=this.get(c+r+n+u),this._xHighField=this.get(h+r+n+u)):(this._xField=i+n,this._xOpenField=l+r+n,this._xLowField=c+r+n,this._xHighField=h+r+n),"ValueAxis"===t.className?(this._yField=this.get(a+o+u),this._yOpenField=this.get(l+s+o+u),this._yLowField=this.get(c+s+o+u),this._yHighField=this.get(h+s+o+u)):(this._yField=a+o,this._yOpenField=l+s+o,this._yLowField=c+s+o,this._yHighField=h+s+o)}_fixVC(){const e=this.get("xAxis"),t=this.get("yAxis"),i=this.get("baseAxis"),r=this.states.lookup("hidden"),a=this.get("sequencedInterpolation");if(r){let s=0;a&&(s=.999999999999),e===i?r.set("vcy",s):(t===i||r.set("vcy",s),r.set("vcx",s))}}_handleMaskBullets(){this.isDirty("maskBullets")&&this.bulletsContainer.set("maskContent",this.get("maskBullets"))}_fixPosition(){const e=this.get("xAxis"),t=this.get("yAxis");this.set("x",e.x()-ii(e.get("centerX",0),e.width())-e.parent.get("paddingLeft",0)),this.set("y",t.y()-ii(t.get("centerY",0),t.height())-t.parent.get("paddingTop",0)),this.bulletsContainer.set("y",this.y()),this.bulletsContainer.set("x",this.x())}_prepareChildren(){super._prepareChildren(),this._bullets={},(this.isDirty("valueYShow")||this.isDirty("valueXShow")||this.isDirty("openValueYShow")||this.isDirty("openValueXShow")||this.isDirty("lowValueYShow")||this.isDirty("lowValueXShow")||this.isDirty("highValueYShow")||this.isDirty("highValueXShow"))&&(this._updateFields(),this._makeFieldNames(),this._valuesDirty=!0),(this.isDirty("xAxis")||this.isDirty("yAxis"))&&(this._valuesDirty=!0),this.set("width",this.get("xAxis").width()),this.set("height",this.get("yAxis").height()),this._handleMaskBullets();const e=this.get("xAxis"),t=this.get("yAxis"),i=this.get("baseAxis");let r,a;switch(this.get("tooltipPositionX")){case"open":r=this._xOpenField;break;case"low":r=this._xLowField;break;case"high":r=this._xHighField;break;default:r=this._xField}switch(this._tooltipFieldX=r,this.get("tooltipPositionY")){case"open":a=this._yOpenField;break;case"low":a=this._yLowField;break;case"high":a=this._yHighField;break;default:a=this._yField}this._tooltipFieldY=a,this.isDirty("baseAxis")&&this._fixVC(),this._fixPosition();const s=this.get("stacked");if(this.isDirty("stacked")&&(s?this._valuesDirty&&!this._dataProcessed||this._stack():this._unstack()),this._valuesDirty&&!this._dataProcessed&&(this._dataProcessed=!0,s&&this._stack(),At(this.dataItems,(i=>{At(this._valueXShowFields,(e=>{let t=i.get(e);null!=t&&(s&&(t+=this.getStackedXValue(i,e)),this._min("minX",t),this._max("maxX",t))})),At(this._valueYShowFields,(e=>{let t=i.get(e);null!=t&&(s&&(t+=this.getStackedYValue(i,e)),this._min("minY",t),this._max("maxY",t))})),e.processSeriesDataItem(i,this._valueXFields),t.processSeriesDataItem(i,this._valueYFields)})),e._seriesValuesDirty=!0,t._seriesValuesDirty=!0,this.get("ignoreMinMax")||((this.isPrivateDirty("minX")||this.isPrivateDirty("maxX"))&&e.markDirtyExtremes(),(this.isPrivateDirty("minY")||this.isPrivateDirty("maxY"))&&t.markDirtyExtremes()),this._markStakedDirtyStack(),this.get("tooltipDataItem")||this.updateLegendValue(void 0)),(this.isDirty("vcx")||this.isDirty("vcy"))&&this._markStakedDirtyStack(),this._dataGrouped||(e._groupSeriesData(this),t._groupSeriesData(this),this._dataGrouped=!0),this._valuesDirty||this.isPrivateDirty("startIndex")||this.isPrivateDirty("adjustedStartIndex")||this.isPrivateDirty("endIndex")||this.isDirty("vcx")||this.isDirty("vcy")||this._stackDirty||this._sizeDirty){let r=this.startIndex(),a=this.endIndex(),s=this.get("minBulletDistance",0);if(s>0&&i&&(i.get("renderer").axisLength()/(a-r)>s?this._showBullets=!0:this._showBullets=!1),(this._psi!=r||this._pei!=a||this.isDirty("vcx")||this.isDirty("vcy")||this.isPrivateDirty("adjustedStartIndex")||this._stackDirty||this._valuesDirty)&&!this._selectionProcessed){this._selectionProcessed=!0;const s=this.get("vcx",1),n=this.get("vcy",1),o=this.get("stacked",!1),l=this.getPrivate("outOfSelection");if(i===e||!i)if(t._calculateTotals(),this.setPrivateRaw("selectionMinY",void 0),this.setPrivateRaw("selectionMaxY",void 0),l)t.markDirtySelectionExtremes();else for(let e=r;e<a;e++)this.processYSelectionDataItem(this.dataItems[e],n,o);if(i===t||!i)if(e._calculateTotals(),this.setPrivateRaw("selectionMinX",void 0),this.setPrivateRaw("selectionMaxX",void 0),l)t.markDirtySelectionExtremes();else for(let e=r;e<a;e++)this.processXSelectionDataItem(this.dataItems[e],s,o);if((i===e||!i)&&("valueYWorking"!==this.get("valueYShow")||this.get("useSelectionExtremes"))){const e=this.getPrivate("selectionMinY");null!=e&&(this.setPrivateRaw("minY",e),t.markDirtyExtremes());const i=this.getPrivate("selectionMaxY");null!=i&&(this.setPrivateRaw("maxY",i),t.markDirtyExtremes())}if((i===t||!i)&&("valueXWorking"!==this.get("valueXShow")||this.get("useSelectionExtremes"))){const i=this.getPrivate("selectionMinX");null!=i&&(this.setPrivateRaw("minX",i),t.markDirtyExtremes());const r=this.getPrivate("selectionMaxX");null!=r&&(this.setPrivateRaw("maxX",r),e.markDirtyExtremes())}(this.isPrivateDirty("selectionMinX")||this.isPrivateDirty("selectionMaxX"))&&e.markDirtySelectionExtremes(),(this.isPrivateDirty("selectionMinY")||this.isPrivateDirty("selectionMaxY"))&&t.markDirtySelectionExtremes()}}}_makeRangeMask(){if(this.axisRanges.length>0){let e=this._mainContainerMask;null==e&&(e=this.children.push(mr.new(this._root,{})),this._mainContainerMask=e,e.set("draw",((t,i)=>{const r=this.parent;if(r){const e=this._root.container.width(),a=this._root.container.height();t.moveTo(-e,-a),t.lineTo(-e,2*a),t.lineTo(2*e,2*a),t.lineTo(2*e,-a),t.lineTo(-e,-a),this.axisRanges.each((e=>{const a=e.axisDataItem.get("axisFill");if(r&&a){let e=a.get("draw");e&&e(t,i)}}))}this.mainContainer._display.mask=e._display}))),e.markDirty(),e._markDirtyKey("fill")}else this.mainContainer._display.mask=null}_updateChildren(){super._updateChildren(),this._x=this.x(),this._y=this.y(),this._makeRangeMask()}_stack(){const e=this.chart;if(e){const t=e.series.indexOf(this);if(this._couldStackTo=[],t>0){let i;for(let r=t-1;r>=0&&(i=e.series.getIndex(r),i.get("xAxis")!==this.get("xAxis")||i.get("yAxis")!==this.get("yAxis")||i.className!==this.className||(this._couldStackTo.push(i),i.get("stacked")));r--);}this._stackDataItems()}}_unstack(){Bt(this._reallyStackedTo,((e,t)=>{delete t._stackedSeries[this.uid]})),this._reallyStackedTo={},At(this.dataItems,(e=>{e.setRaw("stackToItemY",void 0),e.setRaw("stackToItemX",void 0)}))}_handleRemoved(){const e=this.get("xAxis");e&&e._handleSeriesRemoved();const t=this.get("yAxis");t&&t._handleSeriesRemoved()}_stackDataItems(){const e=this.get("baseAxis"),t=this.get("xAxis"),i=this.get("yAxis");let r,a;e===t?(r="valueY",a="stackToItemY"):e===i&&(r="valueX",a="stackToItemX");let s=this._couldStackTo.length,n=0;const o=this.get("stackToNegative");this._reallyStackedTo={},At(this.dataItems,(e=>{for(let t=0;t<s;t++){let i=this._couldStackTo[t],l=i.dataItems[n],c=e.get(r);if(l){let n=l.get(r);if(o){if(!bt(c))break;if(bt(n)){if(t==s-1&&e.setRaw(a,void 0),c>=0&&n>=0){e.setRaw(a,l),this._reallyStackedTo[i.uid]=i,i._stackedSeries[this.uid]=this;break}if(c<0&&n<0){e.setRaw(a,l),this._reallyStackedTo[i.uid]=i,i._stackedSeries[this.uid]=this;break}}}else if(bt(c)&&bt(n)){e.setRaw(a,l),this._reallyStackedTo[i.uid]=i,i._stackedSeries[this.uid]=this;break}}}n++}))}processXSelectionDataItem(e,t,i){At(this.__valueXShowFields,(r=>{let a=e.get(r);null!=a&&(i&&(a+=this.getStackedXValueWorking(e,r)),this._min("selectionMinX",a),this._max("selectionMaxX",a*t))}))}processYSelectionDataItem(e,t,i){At(this.__valueYShowFields,(r=>{let a=e.get(r);null!=a&&(i&&(a+=this.getStackedYValueWorking(e,r)),this._min("selectionMinY",a),this._max("selectionMaxY",a*t))}))}getStackedYValueWorking(e,t){const i=e.get("stackToItemY");if(i){const e=i.component;return i.get(t,0)*e.get("vcy",1)+this.getStackedYValueWorking(i,t)}return 0}getStackedXValueWorking(e,t){const i=e.get("stackToItemX");if(i){const e=i.component;return i.get(t,0)*e.get("vcx",1)+this.getStackedXValueWorking(i,t)}return 0}getStackedYValue(e,t){const i=e.get("stackToItemY");return i?i.get(t,0)+this.getStackedYValue(i,t):0}getStackedXValue(e,t){const i=e.get("stackToItemX");return i?i.get(t,0)+this.getStackedXValue(i,t):0}createLegendMarker(e){this.updateLegendMarker()}_markDirtyAxes(){this._axesDirty=!0,this.markDirty()}_markDataSetDirty(){this._afterDataChange(),this._valuesDirty=!0,this._dataProcessed=!1,this._aggregatesCalculated=!1,this.markDirty()}_clearDirty(){super._clearDirty(),this._axesDirty=!1,this._selectionProcessed=!1,this._stackDirty=!1,this._dataProcessed=!1}_positionBullet(e){let t=e.get("sprite");if(t){let i=t.dataItem,r=e.get("locationX",i.get("locationX",.5)),a=e.get("locationY",i.get("locationY",.5)),s=this.get("xAxis"),n=this.get("yAxis"),o=s.getDataItemPositionX(i,this._xField,r,this.get("vcx",1)),l=n.getDataItemPositionY(i,this._yField,a,this.get("vcy",1)),c=this.getPoint(o,l),h=i.get("left",c.x),u=i.get("right",c.x),d=i.get("top",c.y),f=i.get("bottom",c.y),p=0,g=0,m=u-h,b=f-d;if(this._shouldShowBullet(o,l)){t.setPrivate("visible",!e.getPrivate("hidden"));let s=e.get("field");const n=this.get("baseAxis"),u=this.get("xAxis"),d=this.get("yAxis");if(null!=s){let e;n==u?("value"==s?e=this._yField:"open"==s?e=this._yOpenField:"high"==s?e=this._yHighField:"low"==s&&(e=this._yLowField),e&&(l=d.getDataItemPositionY(i,e,0,this.get("vcy",1)),c=d.get("renderer").positionToPoint(l),g=c.y,p=h+m*r)):("value"==s?e=this._xField:"open"==s?e=this._xOpenField:"high"==s?e=this._xHighField:"low"==s&&(e=this._xLowField),e&&(o=u.getDataItemPositionX(i,e,0,this.get("vcx",1)),c=u.get("renderer").positionToPoint(o),p=c.x,g=f-b*a))}else p=h+m*r,g=f-b*a;const v=e.get("stacked");if(v){const e=this.chart;if(n==u){let i=this._bullets[o+"_"+l];if(i){let r=i.bounds(),a=t.localBounds(),s=g;g=r.top,"down"==v?g=r.bottom-a.top:"auto"==v?e&&(s<e.plotContainer.height()/2?g=r.bottom-a.top:g+=a.bottom):g+=a.bottom}this._bullets[o+"_"+l]=t}else{let i=this._bullets[o+"_"+l];if(i){let r=i.bounds(),a=t.localBounds(),s=p;p=r.right,"down"==v?p=r.left-a.right:"auto"==v?e&&(s<e.plotContainer.width()/2?p=r.left-a.right:p-=a.left):p-=a.left}this._bullets[o+"_"+l]=t}}t.isType("Label")&&(t.setPrivate("maxWidth",Math.abs(m)),t.setPrivate("maxHeight",Math.abs(b))),t.setAll({x:p,y:g})}else t.setPrivate("visible",!1)}}_shouldShowBullet(e,t){return this._showBullets}setDataSet(e){if(this._dataSets[e]){this._handleDataSetChange(),this._dataItems=this._dataSets[e],this._markDataSetDirty(),this._dataSetId=e;const t="datasetchanged";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,id:e})}}resetGrouping(){Bt(this._dataSets,((e,t)=>{t!=this._mainDataItems&&At(t,(e=>{this.disposeDataItem(e)}))})),this._dataSets={},this._dataItems=this.mainDataItems}_handleDataSetChange(){At(this._dataItems,(e=>{let t=e.bullets;t&&At(t,(e=>{if(e){let t=e.get("sprite");t&&t.setPrivate("visible",!1)}}))})),this._selectionProcessed=!1}show(e){const t=Object.create(null,{show:{get:()=>super.show}});return at(this,void 0,void 0,(function*(){this._fixVC();let i=[];i.push(t.show.call(this,e).then((()=>{this._isShowing=!1;let e=this.get("xAxis"),t=this.get("yAxis"),i=this.get("baseAxis");t!==i&&t.markDirtySelectionExtremes(),e!==i&&e.markDirtySelectionExtremes()}))),i.push(this.bulletsContainer.show(e)),i.push(this._sequencedShowHide(!0,e)),yield Promise.all(i)}))}hide(e){const t=Object.create(null,{hide:{get:()=>super.hide}});return at(this,void 0,void 0,(function*(){this._fixVC();let i=[];i.push(t.hide.call(this,e).then((()=>{this._isHiding=!1}))),i.push(this.bulletsContainer.hide(e)),i.push(this._sequencedShowHide(!1,e)),yield Promise.all(i)}))}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return at(this,void 0,void 0,(function*(){const r=[i.showDataItem.call(this,e,t)];bt(t)||(t=this.get("stateAnimationDuration",0));const a=this.get("stateAnimationEasing");At(this._valueFields,(i=>{r.push(e.animate({key:i+"Working",to:e.get(i),duration:t,easing:a}).waitForStop())})),yield Promise.all(r)}))}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return at(this,void 0,void 0,(function*(){const r=[i.hideDataItem.call(this,e,t)],a=this.states.create("hidden",{});bt(t)||(t=a.get("stateAnimationDuration",this.get("stateAnimationDuration",0)));const s=a.get("stateAnimationEasing",this.get("stateAnimationEasing")),n=this.get("xAxis"),o=this.get("yAxis"),l=this.get("baseAxis"),c=this.get("stacked");if(l!==n&&l||At(this._valueYFields,(i=>{let a=o.getPrivate("min"),n=o.baseValue();bt(a)&&a>n&&(n=a),c&&(n=0),null!=e.get(i)&&r.push(e.animate({key:i+"Working",to:n,duration:t,easing:s}).waitForStop())})),l===o||!l){let i=n.getPrivate("min"),a=n.baseValue();bt(i)&&i>a&&(a=i),c&&(a=0),At(this._valueXFields,(i=>{null!=e.get(i)&&r.push(e.animate({key:i+"Working",to:a,duration:t,easing:s}).waitForStop())}))}yield Promise.all(r)}))}_markDirtyStack(){this._stackDirty=!0,this.markDirty(),this._markStakedDirtyStack()}_markStakedDirtyStack(){const e=this._stackedSeries;e&&Bt(e,((e,t)=>{t._stackDirty||t._markDirtyStack()}))}_afterChanged(){super._afterChanged(),this._skipped&&(this._markDirtyAxes(),this._skipped=!1)}showDataItemTooltip(e){this.getPrivate("doNotUpdateLegend")||(this.updateLegendMarker(e),this.updateLegendValue(e));const t=this.get("tooltip");if(t)if(!this.isHidden()&&this.get("visible")){if(t._setDataItem(e),e){let i=this.get("locationX",0),r=this.get("locationY",1),a=e.get("locationX",i),s=e.get("locationY",r);const n=this.get("xAxis"),o=this.get("yAxis"),l=this.get("vcx",1),c=this.get("vcy",1),h=n.getDataItemPositionX(e,this._tooltipFieldX,this._aLocationX0+(this._aLocationX1-this._aLocationX0)*a,l),u=o.getDataItemPositionY(e,this._tooltipFieldY,this._aLocationY0+(this._aLocationY1-this._aLocationY0)*s,c),d=this.getPoint(h,u);let f=!0;if(At(this._valueFields,(t=>{null==e.get(t)&&(f=!1)})),f){const i=this.chart;i&&i.inPlot(d)?(t.label.text.markDirtyText(),t.set("tooltipTarget",this._getTooltipTarget(e)),t.set("pointTo",this._display.toGlobal({x:d.x,y:d.y}))):t._setDataItem(void 0)}else t._setDataItem(void 0)}}else this.hideTooltip()}hideTooltip(){const e=this.get("tooltip");return e&&e.set("tooltipTarget",this),super.hideTooltip()}_getTooltipTarget(e){if("bullet"==this.get("seriesTooltipTarget")){const t=e.bullets;if(t&&t.length>0){const e=t[0].get("sprite");if(e)return e}}return this}updateLegendValue(e){const t=this.get("legendDataItem");if(t){const i=t.get("label");if(i){let t="";e?(i._setDataItem(e),t=this.get("legendLabelText",i.get("text",this.get("name","")))):(i._setDataItem(this._emptyDataItem),t=this.get("legendRangeLabelText",this.get("legendLabelText",i.get("text",this.get("name",""))))),i.set("text",t)}const r=t.get("valueLabel");if(r){let t="";e?(r._setDataItem(e),t=this.get("legendValueText",r.get("text",""))):(r._setDataItem(this._emptyDataItem),t=this.get("legendRangeValueText",r.get("text",""))),r.set("text",t)}}}_getItemReaderLabel(){let e="X: {"+this._xField;return this.get("xAxis").isType("DateAxis")&&(e+=".formatDate()"),e+="}; Y: {"+this._yField,this.get("yAxis").isType("DateAxis")&&(e+=".formatDate()"),e+="}",e}getPoint(e,t){let i=this.get("xAxis").get("renderer").positionToCoordinate(e),r=this.get("yAxis").get("renderer").positionToCoordinate(t),a=999999999;return r<-a&&(r=-a),r>a&&(r=a),i<-a&&(i=-a),i>a&&(i=a),{x:i,y:r}}_shouldInclude(e){return!0}handleCursorHide(){this.hideTooltip(),this.updateLegendValue(void 0),this.updateLegendMarker(void 0)}_afterDataChange(){super._afterDataChange(),this.get("xAxis")._markDirtyKey("start"),this.get("yAxis")._markDirtyKey("start"),this.resetExtremes()}resetExtremes(){this.setPrivate("selectionMinX",void 0),this.setPrivate("selectionMaxX",void 0),this.setPrivate("selectionMinY",void 0),this.setPrivate("selectionMaxY",void 0),this.setPrivate("minX",void 0),this.setPrivate("minY",void 0),this.setPrivate("maxX",void 0),this.setPrivate("maxY",void 0)}createAxisRange(e){return this.axisRanges.push({axisDataItem:e})}get mainDataItems(){return this._mainDataItems}_adjustStartIndex(e){const t=this.get("xAxis");if(this.get("baseAxis")==t&&t.isType("DateAxis")){const i=t.baseDuration(),r=t.getPrivate("selectionMin",t.getPrivate("min",0)),a=i*this.get("locationX",.5);let s=-1/0;for(;s<r;){const t=this.dataItems[e];if(!t)break;{const i=t.open;if(s=i?i.valueX:t.get("valueX",0),s+=a,!(s<r))break;e++}}}return e}}function ws(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function xs(e){return function(){return e}}function As(e){this._context=e}function Ts(e){return new As(e)}Object.defineProperty(_s,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYSeries"}),Object.defineProperty(_s,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ys.classNames.concat([_s.className])}),Array.prototype.slice,As.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};const ks=Math.PI,Ss=2*ks,Ps=1e-6,Es=Ss-Ps;function Cs(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}class Ds{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?Cs:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Cs;const i=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*i)/i+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,i,r){this._append`Q${+e},${+t},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(e,t,i,r,a,s){this._append`C${+e},${+t},${+i},${+r},${this._x1=+a},${this._y1=+s}`}arcTo(e,t,i,r,a){if(e=+e,t=+t,i=+i,r=+r,(a=+a)<0)throw new Error(`negative radius: ${a}`);let s=this._x1,n=this._y1,o=i-e,l=r-t,c=s-e,h=n-t,u=c*c+h*h;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(u>Ps)if(Math.abs(h*o-l*c)>Ps&&a){let d=i-s,f=r-n,p=o*o+l*l,g=d*d+f*f,m=Math.sqrt(p),b=Math.sqrt(u),v=a*Math.tan((ks-Math.acos((p+u-g)/(2*m*b)))/2),y=v/b,_=v/m;Math.abs(y-1)>Ps&&this._append`L${e+y*c},${t+y*h}`,this._append`A${a},${a},0,0,${+(h*d>c*f)},${this._x1=e+_*o},${this._y1=t+_*l}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,i,r,a,s){if(e=+e,t=+t,s=!!s,(i=+i)<0)throw new Error(`negative radius: ${i}`);let n=i*Math.cos(r),o=i*Math.sin(r),l=e+n,c=t+o,h=1^s,u=s?r-a:a-r;null===this._x1?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Ps||Math.abs(this._y1-c)>Ps)&&this._append`L${l},${c}`,i&&(u<0&&(u=u%Ss+Ss),u>Es?this._append`A${i},${i},0,1,${h},${e-n},${t-o}A${i},${i},0,1,${h},${this._x1=l},${this._y1=c}`:u>Ps&&this._append`A${i},${i},0,${+(u>=ks)},${h},${this._x1=e+i*Math.cos(a)},${this._y1=t+i*Math.sin(a)}`)}rect(e,t,i,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}}function Os(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(null==i)t=null;else{const e=Math.floor(i);if(!(e>=0))throw new RangeError(`invalid digits: ${i}`);t=e}return e},()=>new Ds(t)}function Rs(e){return e[0]}function Ms(e){return e[1]}function Is(e,t){var i=xs(!0),r=null,a=Ts,s=null,n=Os(o);function o(o){var l,c,h,u=(o=ws(o)).length,d=!1;for(null==r&&(s=a(h=n())),l=0;l<=u;++l)!(l<u&&i(c=o[l],l,o))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(c,l,o),+t(c,l,o));if(h)return s=null,h+""||null}return e="function"==typeof e?e:void 0===e?Rs:xs(e),t="function"==typeof t?t:void 0===t?Ms:xs(t),o.x=function(t){return arguments.length?(e="function"==typeof t?t:xs(+t),o):e},o.y=function(e){return arguments.length?(t="function"==typeof e?e:xs(+e),o):t},o.defined=function(e){return arguments.length?(i="function"==typeof e?e:xs(!!e),o):i},o.curve=function(e){return arguments.length?(a=e,null!=r&&(s=a(r)),o):a},o.context=function(e){return arguments.length?(null==e?r=s=null:s=a(r=e),o):r},o}function Ls(e,t,i){var r=null,a=xs(!0),s=null,n=Ts,o=null,l=Os(c);function c(c){var h,u,d,f,p,g=(c=ws(c)).length,m=!1,b=new Array(g),v=new Array(g);for(null==s&&(o=n(p=l())),h=0;h<=g;++h){if(!(h<g&&a(f=c[h],h,c))===m)if(m=!m)u=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),d=h-1;d>=u;--d)o.point(b[d],v[d]);o.lineEnd(),o.areaEnd()}m&&(b[h]=+e(f,h,c),v[h]=+t(f,h,c),o.point(r?+r(f,h,c):b[h],i?+i(f,h,c):v[h]))}if(p)return o=null,p+""||null}function h(){return Is().defined(a).curve(n).context(s)}return e="function"==typeof e?e:void 0===e?Rs:xs(+e),t="function"==typeof t?t:xs(void 0===t?0:+t),i="function"==typeof i?i:void 0===i?Ms:xs(+i),c.x=function(t){return arguments.length?(e="function"==typeof t?t:xs(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"==typeof t?t:xs(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:xs(+e),c):r},c.y=function(e){return arguments.length?(t="function"==typeof e?e:xs(+e),i=null,c):t},c.y0=function(e){return arguments.length?(t="function"==typeof e?e:xs(+e),c):t},c.y1=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:xs(+e),c):i},c.lineX0=c.lineY0=function(){return h().x(e).y(t)},c.lineY1=function(){return h().x(e).y(i)},c.lineX1=function(){return h().x(r).y(t)},c.defined=function(e){return arguments.length?(a="function"==typeof e?e:xs(!!e),c):a},c.curve=function(e){return arguments.length?(n=e,null!=s&&(o=n(s)),c):n},c.context=function(e){return arguments.length?(null==e?s=o=null:o=n(s=e),c):s},c}class Fs extends _s{constructor(){super(...arguments),Object.defineProperty(this,"_endIndex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:Is()}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:Ls()}),Object.defineProperty(this,"_legendStroke",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_legendFill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strokes",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new Fi(ir.new({}),(()=>mr._new(this._root,{themeTags:wi(this.strokes.template.get("themeTags",[]),["line","series","stroke"])},[this.strokes.template]))))}),Object.defineProperty(this,"fills",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new Fi(ir.new({}),(()=>mr._new(this._root,{themeTags:wi(this.strokes.template.get("themeTags",[]),["line","series","fill"])},[this.fills.template]))))}),Object.defineProperty(this,"_fillTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_previousPoint",{enumerable:!0,configurable:!0,writable:!0,value:[0,0,0,0]}),Object.defineProperty(this,"_dindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_sindex",{enumerable:!0,configurable:!0,writable:!0,value:0})}_afterNew(){this._fillGenerator.y0((function(e){return e[3]})),this._fillGenerator.x0((function(e){return e[2]})),this._fillGenerator.y1((function(e){return e[1]})),this._fillGenerator.x1((function(e){return e[0]})),super._afterNew()}makeStroke(e){const t=this.mainContainer.children.push(e.make());return e.push(t),t}makeFill(e){const t=this.mainContainer.children.push(e.make());return e.push(t),t}_updateChildren(){this._strokeTemplate=void 0,this._fillTemplate=void 0;let e=this.get("xAxis"),t=this.get("yAxis");if(this.isDirty("stroke")){const e=this.get("stroke");this.strokes.template.set("stroke",e);const t=this._legendStroke;t&&t.states.lookup("default").set("stroke",e)}if(this.isDirty("fill")){const e=this.get("fill");this.fills.template.set("fill",e);const t=this._legendFill;t&&t.states.lookup("default").set("fill",e)}if(this.isDirty("fillPattern")){const e=this.get("fillPattern");this.fills.template.set("fillPattern",e);const t=this._legendFill;t&&t.states.lookup("default").set("fillPattern",e)}if(this.isDirty("curveFactory")){const e=this.get("curveFactory");e&&(this._strokeGenerator.curve(e),this._fillGenerator.curve(e))}if(e.inited&&t.inited){if(this._axesDirty||this._valuesDirty||this._stackDirty||this.isDirty("vcx")||this.isDirty("vcy")||this._sizeDirty||this.isDirty("connect")||this.isDirty("curveFactory")){this.fills.each((e=>{e.setPrivate("visible",!1)})),this.strokes.each((e=>{e.setPrivate("visible",!1)})),this.axisRanges.each((e=>{let t=e.fills;t&&t.each((e=>{e.setPrivate("visible",!1)}));let i=e.strokes;i&&i.each((e=>{e.setPrivate("visible",!1)}))}));let e=this.startIndex(),t=this.strokes.template.get("templateField"),i=this.fills.template.get("templateField"),r=!0,a=!0;t&&(r=!1),i&&(a=!1);for(let s=e-1;s>=0;s--){let n=this.dataItems[s],o=!0,l=n.dataContext;if(t&&l[t]&&(r=!0),i&&l[i]&&(a=!0),At(this._valueFields,(e=>{bt(n.get(e))||(o=!1)})),o&&r&&a){e=s;break}}let s=this.dataItems.length,n=this.endIndex();if(n<s){n++;for(let e=n;e<s;e++){let t=this.dataItems[e],i=!0;if(At(this._valueFields,(e=>{bt(t.get(e))||(i=!1)})),i){n=e+1;break}}}if(e>0&&e--,this._endIndex=n,this._clearGraphics(),this._sindex=0,this._dindex=e,1==this.dataItems.length)this._startSegment(0);else for(;this._dindex<n-1;)this._startSegment(this._dindex),this._sindex++}}else this._skipped=!0;super._updateChildren()}_clearGraphics(){this.strokes.clear(),this.fills.clear(),this.axisRanges.each((e=>{e.fills.clear(),e.strokes.clear()}))}_startSegment(e){let t=this._endIndex,i=t;const r=this.get("autoGapCount"),a=this.get("connect"),s=this.makeFill(this.fills),n=this._fillTemplate,o=this.fills.template;n&&n!=o&&(s.template=n),s.setPrivate("visible",!0);const l=this.makeStroke(this.strokes),c=this._strokeTemplate;c&&c!=this.strokes.template&&(l.template=c),l.setPrivate("visible",!0);let h=this.get("xAxis"),u=this.get("yAxis"),d=this.get("baseAxis"),f=this.get("vcx",1),p=this.get("vcy",1),g=this._xField,m=this._yField,b=this._xOpenField,v=this._yOpenField;const y=this.get("openValueXField"),_=this.get("openValueYField");y||(b=this._xField),_||(v=this._yField);const w=this.get("stacked"),x=h.basePosition(),A=u.basePosition();let T;T=d===u?this._yField:this._xField;const k=[];let S=[];k.push(S);const P=this.strokes.template.get("templateField"),E=this.fills.template.get("templateField");let C=this.get("locationX",.5),D=this.get("locationY",.5),O=this.get("openLocationX",C),R=this.get("openLocationY",D);const M=this.get("minDistance",0);let I,L=this.fills.template.get("visible");this.axisRanges.length>0&&(L=!0);let F=!1;(w||y||_)&&(F=!0);const N={points:S,segments:k,stacked:w,getOpen:F,basePosX:x,basePosY:A,fillVisible:L,xField:g,yField:m,xOpenField:b,yOpenField:v,vcx:f,vcy:p,baseAxis:d,xAxis:h,yAxis:u,locationX:C,locationY:D,openLocationX:O,openLocationY:R,minDistance:M};let B=this._strokeTemplate,j=this._fillTemplate;for(I=e;I<i;I++){this._dindex=I;const t=this._dataItems[I];let n=t.get(g),o=t.get(m);if(null==n||null==o?a||(S=[],k.push(S),N.points=S):this._getPoints(t,N),P){let r=t.dataContext[P];if(r){if(r instanceof ir||(r=ir.new(r)),this._strokeTemplate=r,I>e){i=I;break}B=r,l.template=r}}if(E){let r=t.dataContext[E];if(r){if(r instanceof ir||(r=ir.new(r)),this._fillTemplate=r,I>e){i=I;break}j=r,s.template=r}}if(!a){let e=this.dataItems[I+1];e&&d.shouldGap(t,e,r,T)&&(S=[],k.push(S),N.points=S)}}s.setRaw("userData",[e,I]),l.setRaw("userData",[e,I]),I===t&&this._endLine(S,k[0][0]),l&&this._drawStroke(l,k),s&&this._drawFill(s,k),this.axisRanges.each((t=>{const i=t.container,r=t.fills,a=this.makeFill(r);i&&i.children.push(a),a.setPrivate("visible",!0),this._drawFill(a,k);const s=t.strokes,n=this.makeStroke(s);i&&i.children.push(n),B&&B!=this.strokes.template&&(n.template=B),j&&j!=this.fills.template&&(a.template=j),n.setPrivate("visible",!0),this._drawStroke(n,k),a.setRaw("userData",[e,I]),n.setRaw("userData",[e,I])}))}_getPoints(e,t){let i=t.points,r=e.get("locationX",t.locationX),a=e.get("locationY",t.locationY),s=t.xAxis.getDataItemPositionX(e,t.xField,r,t.vcx),n=t.yAxis.getDataItemPositionY(e,t.yField,a,t.vcy);if(this._shouldInclude(s)){const r=this.getPoint(s,n),a=[r.x,r.y];if(r.x+=this._x,r.y+=this._y,e.set("point",r),t.fillVisible){let i=s,r=n;if(t.baseAxis===t.xAxis?r=t.basePosY:t.baseAxis===t.yAxis&&(i=t.basePosX),t.getOpen){let a=e.get(t.xOpenField),s=e.get(t.yOpenField);if(null!=a&&null!=s){let a=e.get("openLocationX",t.openLocationX),s=e.get("openLocationY",t.openLocationY);if(t.stacked){let n=e.get("stackToItemX"),o=e.get("stackToItemY");n?(i=t.xAxis.getDataItemPositionX(n,t.xField,a,n.component.get("vcx")),ut(i)&&(i=t.basePosX)):i=t.yAxis===t.baseAxis?t.basePosX:t.xAxis.getDataItemPositionX(e,t.xOpenField,a,t.vcx),o?(r=t.yAxis.getDataItemPositionY(o,t.yField,s,o.component.get("vcy")),ut(r)&&(r=t.basePosY)):r=t.xAxis===t.baseAxis?t.basePosY:t.yAxis.getDataItemPositionY(e,t.yOpenField,s,t.vcy)}else i=t.xAxis.getDataItemPositionX(e,t.xOpenField,a,t.vcx),r=t.yAxis.getDataItemPositionY(e,t.yOpenField,s,t.vcy)}}let o=this.getPoint(i,r);a[2]=o.x,a[3]=o.y}if(t.minDistance>0){const e=a[0],r=a[1],s=a[2],n=a[3],o=this._previousPoint,l=o[0],c=o[1],h=o[2],u=o[3];(Math.hypot(e-l,r-c)>t.minDistance||s&&n&&Math.hypot(s-h,n-u)>t.minDistance)&&(i.push(a),this._previousPoint=a)}else i.push(a)}}_endLine(e,t){}_drawStroke(e,t){e.get("visible")&&!e.get("forceHidden")&&e.set("draw",(e=>{At(t,(t=>{this._strokeGenerator.context(e),this._strokeGenerator(t)}))}))}_drawFill(e,t){e.get("visible")&&!e.get("forceHidden")&&e.set("draw",(e=>{At(t,(t=>{this._fillGenerator.context(e),this._fillGenerator(t)}))}))}_processAxisRange(e){super._processAxisRange(e),e.fills=new Fi(ir.new({}),(()=>mr._new(this._root,{themeTags:wi(e.fills.template.get("themeTags",[]),["line","series","fill"])},[this.fills.template,e.fills.template]))),e.strokes=new Fi(ir.new({}),(()=>mr._new(this._root,{themeTags:wi(e.strokes.template.get("themeTags",[]),["line","series","stroke"])},[this.strokes.template,e.strokes.template])))}createLegendMarker(e){const t=this.get("legendDataItem");if(t){const e=t.get("marker"),i=t.get("markerRectangle");i&&i.setPrivate("visible",!1),e.set("background",br.new(e._root,{fillOpacity:0,fill:Ti(0)}));const r=e.children.push(mr._new(e._root,{themeTags:["line","series","legend","marker","stroke"],interactive:!1},[this.strokes.template]));this._legendStroke=r;const a=e.children.push(mr._new(e._root,{themeTags:["line","series","legend","marker","fill"]},[this.fills.template]));this._legendFill=a;const s=this._root.interfaceColors.get("disabled");if(r.states.create("disabled",{fill:s,stroke:s}),a.states.create("disabled",{fill:s,stroke:s}),this.bullets.length>0){const t=this.bullets.getIndex(0);if(t){const i=t(e._root,this,new ss(this,{legend:!0},{}));if(i){const t=i.get("sprite");t instanceof mr&&t.states.create("disabled",{fill:s,stroke:s}),t&&(t.set("tooltipText",void 0),t.set("tooltipHTML",void 0),e.children.push(t),t.setAll({x:e.width()/2,y:e.height()/2}),e.events.on("boundschanged",(()=>{t.setAll({x:e.width()/2,y:e.height()/2})})))}}}}}}Object.defineProperty(Fs,"className",{enumerable:!0,configurable:!0,writable:!0,value:"LineSeries"}),Object.defineProperty(Fs,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:_s.classNames.concat([Fs.className])});class Ns extends Er{constructor(){super(...arguments),Object.defineProperty(this,"_alwaysShow",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lineX",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ps.new(this._root,{themeTags:["x"]}))}),Object.defineProperty(this,"lineY",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ps.new(this._root,{themeTags:["y"]}))}),Object.defineProperty(this,"selection",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(mr.new(this._root,{themeTags:["selection","cursor"],layer:30}))}),Object.defineProperty(this,"_movePoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_lastPoint",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(this,"_lastPoint2",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(this,"_tooltipX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_tooltipY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_toX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_toY",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this._settings.themeTags=wi(this._settings.themeTags,["xy","cursor"]),super._afterNew(),this.setAll({width:lt,height:lt,isMeasured:!0,position:"absolute"}),this.states.create("hidden",{visible:!0,opacity:0}),this._drawLines(),this.setPrivateRaw("visible",!1),this._disposers.push(this.setTimeout((()=>{this.setPrivate("visible",!0)}),500)),this._disposers.push(this.lineX.events.on("positionchanged",(()=>{this._handleXLine()}))),this._disposers.push(this.lineY.events.on("positionchanged",(()=>{this._handleYLine()}))),this._disposers.push(this.lineX.events.on("focus",(()=>this._handleLineFocus()))),this._disposers.push(this.lineX.events.on("blur",(()=>this._handleLineBlur()))),this._disposers.push(this.lineY.events.on("focus",(()=>this._handleLineFocus()))),this._disposers.push(this.lineY.events.on("blur",(()=>this._handleLineBlur()))),Yt("keyboardevents")&&this._disposers.push($t(document,"keydown",(e=>{this._handleLineMove(ti(e),e.ctrlKey)})))}_setUpTouch(){const e=this.chart;e&&(e.plotContainer._display.cancelTouch="none"!=this.get("behavior"))}_handleXLine(){let e=this.lineX.x(),t=!0;(e<0||e>this.width())&&(t=!1),this.lineX.setPrivate("visible",t)}_handleYLine(){let e=this.lineY.y(),t=!0;(e<0||e>this.height())&&(t=!1),this.lineY.setPrivate("visible",t)}_handleLineMove(e,t){let i="";const r=this.chart;let a;if(r&&r.xAxes.length){this._root.focused(this.lineX)?(i="positionX",a=r.xAxes.getIndex(0)):this._root.focused(this.lineY)&&(a=r.yAxes.getIndex(0),i="positionY");let s=1;if(t&&(s=5),a){let t,r=a.get("renderer").get("inversed",!1);"ArrowRight"==e||"ArrowDown"==e?t=1:"ArrowLeft"==e||"ArrowUp"==e?t=-1:"Tab"==e&&(t=0),null!=t&&(r&&(t*=-1),this.set(i,a.nextPosition(t*s)))}}}_handleLineFocus(){this._alwaysShow=this.get("alwaysShow",!1),this.setAll({positionX:this.getPrivate("positionX",0),positionY:this.getPrivate("positionY",0),alwaysShow:!0}),this._handleLineMove("Tab")}_handleLineBlur(){(this.lineX.isFocus()||this.lineY.isFocus())&&this.setAll({positionX:void 0,positionY:void 0,alwaysShow:this._alwaysShow})}_prepareChildren(){if(super._prepareChildren(),this.isDirty("xAxis")){this._tooltipX=!1;const e=this.get("xAxis");if(e){const t=e.get("tooltip");t&&(this._tooltipX=!0,this._disposers.push(t.on("pointTo",(()=>{this._updateXLine(t)}))))}}if(this.isDirty("yAxis")){this._tooltipY=!1;const e=this.get("yAxis");if(e){const t=e.get("tooltip");t&&(this._tooltipY=!0,this._disposers.push(t.on("pointTo",(()=>{this._updateYLine(t)}))))}}}_handleSyncWith(){const e=this.chart;if(e){const t=this.get("syncWith"),i=[];t&&At(t,(e=>{const t=e.chart;t&&i.push(t)})),e._otherCharts=i}}_updateChildren(){if(super._updateChildren(),this._handleSyncWith(),this.isDirty("positionX")||this.isDirty("positionY")){const e=this.get("positionX"),t=this.get("positionY");null==e&&null==t?this.hide(0):(this._movePoint=this.toGlobal(this._getPoint(this.get("positionX",0),this.get("positionY",0))),this.handleMove())}}_updateXLine(e){let t=nr(this._display.toLocal(e.get("pointTo",{x:0,y:0})).x,3);this._toX!=t&&(this.lineX.animate({key:"x",to:t,duration:e.get("animationDuration",0),easing:e.get("animationEasing")}),this._toX=t)}_updateYLine(e){let t=nr(this._display.toLocal(e.get("pointTo",{x:0,y:0})).y,3);this._toY!=t&&(this.lineY.animate({key:"y",to:t,duration:e.get("animationDuration",0),easing:e.get("animationEasing")}),this._toY=t)}_drawLines(){this.lineX.set("draw",(e=>{e.moveTo(0,0),e.lineTo(0,this.height())})),this.lineY.set("draw",(e=>{e.moveTo(0,0),e.lineTo(this.width(),0)}))}updateCursor(){this.get("alwaysShow")&&(this._movePoint=this.toGlobal(this._getPoint(this.get("positionX",0),this.get("positionY",0)))),this.handleMove()}_setChart(e){this.chart=e,this._handleSyncWith();const t=e.plotContainer;this.events.on("boundschanged",(()=>{this._disposers.push(this.setTimeout((()=>{this.updateCursor()}),50))})),Yt("touchevents")&&(this._disposers.push(t.events.on("click",(e=>{qt(e.originalEvent)&&this._handleMove(e)}))),this._setUpTouch()),this._disposers.push(t.events.on("pointerdown",(e=>{this._handleCursorDown(e)}))),this._disposers.push(t.events.on("globalpointerup",(e=>{this._handleCursorUp(e),e.native||this.isHidden()||this._handleMove(e)}))),this._disposers.push(t.events.on("globalpointermove",(e=>{(this.get("syncWith")||0!=Ft(t._downPoints).length||e.native||!this.isHidden())&&(this._handleMove(e),Math.hypot(this._lastPoint2.x-e.point.x,this._lastPoint2.y-e.point.y)>1&&(this._handleLineBlur(),this._lastPoint2=e.point))})));const i=this.parent;i&&i.children.moveValue(this.selection)}_inPlot(e){const t=this.chart;return!!t&&t.inPlot(e)}_handleCursorDown(e){if(2==e.originalEvent.button)return;const t=e.point;let i=this._display.toLocal(t);const r=this.chart;if(this.selection.set("draw",(()=>{})),r&&this._inPlot(i)){if(this._downPoint=i,"none"!=this.get("behavior")){this.selection.show();const t="selectstarted";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent})}let t=this._getPosition(i).x,r=this._getPosition(i).y;this.setPrivate("downPositionX",t),this.setPrivate("downPositionY",r)}}_handleCursorUp(e){if(this._downPoint){const t=this.get("behavior","none");if("none"!=t){"z"===t.charAt(0)&&this.selection.hide();const i=e.point;let r=this._display.toLocal(i);const a=this._downPoint,s=this.get("moveThreshold",1);if(r&&a){let i=!1;if("zoomX"!==t&&"zoomXY"!==t&&"selectX"!==t&&"selectXY"!==t||Math.abs(r.x-a.x)>s&&(i=!0),"zoomY"!==t&&"zoomXY"!==t&&"selectY"!==t&&"selectXY"!==t||Math.abs(r.y-a.y)>s&&(i=!0),i){const t="selectended";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent})}else{const t="selectcancelled";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent})}}}}this._downPoint=void 0}_handleMove(e){if(this.getPrivate("visible")){const t=this.chart;if(t&&Ft(t.plotContainer._downPoints).length>1)return void this.set("forceHidden",!0);this.set("forceHidden",!1);const i=e.point,r=this._lastPoint;if(Math.round(r.x)===Math.round(i.x)&&Math.round(r.y)===Math.round(i.y))return;this._lastPoint=i,this.setPrivate("lastPoint",i),this.handleMove({x:i.x,y:i.y},!1,e.originalEvent)}}_getPosition(e){return{x:e.x/this.width(),y:e.y/this.height()}}handleMove(e,t,i){e||(e=this._movePoint);const r=this.get("alwaysShow");if(!e)return void this.hide(0);this._movePoint=e;let a=this._display.toLocal(e),s=this.chart;if(s&&(this._inPlot(a)||this._downPoint)){s._movePoint=e,this.isHidden()&&(this.show(),"z"==this.get("behavior","").charAt(0)&&this.selection.set("draw",(()=>{})));let n=a.x,o=a.y,l=this._getPosition(a);this.setPrivate("point",a);let c=this.get("snapToSeries");this._downPoint&&(c=void 0);let h=this.get("positionX"),u=l.x;bt(h)&&(u=h);let d=this.get("positionY"),f=l.y;bt(d)&&(f=d),this.setPrivate("positionX",u),this.setPrivate("positionY",f);const p=this._getPoint(u,f);if(n=p.x,o=p.y,s.xAxes.each((e=>{e._handleCursorPosition(u,c),r&&e.handleCursorShow()})),s.yAxes.each((e=>{e._handleCursorPosition(f,c),r&&e.handleCursorShow()})),!t){s._handleCursorPosition();const t="cursormoved";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,point:e,originalEvent:i})}this._updateLines(n,o),s.arrangeTooltips()}else if(!this._downPoint&&!r){this.hide(0);const e="cursorhidden";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this})}this._downPoint&&"none"!=this.get("behavior")&&this._updateSelection(a)}_getPoint(e,t){return{x:this.width()*e,y:this.height()*t}}_updateLines(e,t){this._tooltipX||this.lineX.set("x",e),this._tooltipY||this.lineY.set("y",t),this._drawLines()}_updateSelection(e){const t=this.selection,i=this.get("behavior"),r=this.width(),a=this.height();e.x<0&&(e.x=0),e.x>r&&(e.x=r),e.y<0&&(e.y=0),e.y>a&&(e.y=a),t.set("draw",(t=>{const s=this._downPoint;s&&("zoomXY"===i||"selectXY"===i?(t.moveTo(s.x,s.y),t.lineTo(s.x,e.y),t.lineTo(e.x,e.y),t.lineTo(e.x,s.y),t.lineTo(s.x,s.y)):"zoomX"===i||"selectX"===i?(t.moveTo(s.x,0),t.lineTo(s.x,a),t.lineTo(e.x,a),t.lineTo(e.x,0),t.lineTo(s.x,0)):"zoomY"!==i&&"selectY"!==i||(t.moveTo(0,s.y),t.lineTo(r,s.y),t.lineTo(r,e.y),t.lineTo(0,e.y),t.lineTo(0,s.y)))}))}_onHide(){if(this.isHidden()){let e=this.chart;e&&(e.xAxes.each((e=>{e.handleCursorHide()})),e.yAxes.each((e=>{e.handleCursorHide()})),e.series.each((e=>{e.handleCursorHide()})))}super._onHide()}_onShow(){if(!this.isHidden()){let e=this.chart;e&&(e.xAxes.each((e=>{e.handleCursorShow()})),e.yAxes.each((e=>{e.handleCursorShow()})))}super._onShow()}_dispose(){super._dispose(),this.selection.dispose()}}Object.defineProperty(Ns,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYCursor"}),Object.defineProperty(Ns,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Er.classNames.concat([Ns.className])});const Bs=class extends Xr{setupDefaultRules(){super.setupDefaultRules(),this.rule("Component").setAll({interpolationDuration:600}),this.rule("Hierarchy").set("animationDuration",600),this.rule("Scrollbar").set("animationDuration",600),this.rule("Tooltip").set("animationDuration",300),this.rule("MapChart").set("animationDuration",1e3),this.rule("MapChart").set("wheelDuration",300),this.rule("Entity").setAll({stateAnimationDuration:600}),this.rule("Sprite").states.create("default",{stateAnimationDuration:600}),this.rule("Tooltip",["axis"]).setAll({animationDuration:200}),this.rule("WordCloud").set("animationDuration",500),this.rule("Polygon").set("animationDuration",600),this.rule("ArcDiagram").set("animationDuration",600)}};var js=i(3418),zs=i.n(js),Us=i(6795),Hs=i.n(Us),Ws=i(8071),Vs=i.n(Ws),$s=i(4351),Xs=i.n($s),Ys=i(3346),Gs=i.n(Ys),Ks=i(3250),qs=i.n(Ks),Zs=i(1438),Js=i.n(Zs),Qs=i(7761),en=i(2542),tn=i(1591);async function rn(e,t,i,r){console.log(t,"Base path geometry");let a=[];await i.forEach((i=>{const r=i.afstand||0,s=Qs.offset(t,r);if(console.log(s,"Offset line geometry"),s){const t=i.hoogte||0,r=s.paths.map((e=>e.map((e=>[e[0],e[1],t])))),n=new(zs())({geometry:new(Hs())({paths:r,spatialReference:Js().WebMercator}),symbol:{type:"simple-line",style:"solid",color:"grey",width:1}});e.graphicsLayerTemp.add(n),i.locatie?a[i.locatie]=n.geometry:console.log("Row name is missing in the data.",i)}})),a.buitenkruin&&a.binnenkruin&&an(e,"buitenkruin","binnenkruin",a),i.some((e=>e.locatie?.toLowerCase().includes("berm")))?(a.buitenkruin&&a.bovenkant_buitenberm&&an(e,"buitenkruin","bovenkant_buitenberm",a),a.binnenkruin&&a.bovenkant_binnenberm&&an(e,"binnenkruin","bovenkant_binnenberm",a),a.bovenkant_buitenberm&&a.onderkant_buitenberm&&an(e,"bovenkant_buitenberm","onderkant_buitenberm",a),a.onderkant_buitenberm&&a.buitenteen&&an(e,"onderkant_buitenberm","buitenteen",a),a.bovenkant_binnenberm&&a.onderkant_binnenberm&&an(e,"bovenkant_binnenberm","onderkant_binnenberm",a),a.onderkant_binnenberm&&a.binnenteen&&an(e,"onderkant_binnenberm","binnenteen",a)):(a.buitenkruin&&a.binnenkruin&&an(e,"buitenkruin","binnenkruin",[128,0,0,.9]),a.buitenkruin&&a.buitenteen&&an(e,"buitenkruin","buitenteen",a),a.binnenkruin&&a.binnenteen&&an(e,"binnenkruin","binnenteen",a)),console.log(e.uniqueParts,"Unique parts");const s=tn.merge(e.meshes),n=new(zs())({geometry:s,symbol:{type:"mesh-3d",symbolLayers:[{type:"fill"}]}});e.graphicsLayerMesh.add(n),e.mergedMesh=s,e.meshGraphic=n}function an(e,t,i,r){const a=r[t],s=r[i];if(!a||!s)return void console.warn(`Could not find lines for ${t} and/or ${i}`);const n=a.paths[0],o=s.paths[0].slice().reverse();let l=n.concat(o);l.push(n[0]);let c=l.map((e=>[e[0],e[1]]));const h=new(Vs())({rings:[l],spatialReference:a.spatialReference}),u=new(Vs())({rings:[c],spatialReference:a.spatialReference}),d=`${t}-${i}`,f=new(zs())({geometry:u,attributes:{name:d}}),p=new(zs())({geometry:h,attributes:{name:d}});e.graphicsLayerTemp.add(p),e.designLayer2D.applyEdits({addFeatures:[f]}).catch((e=>{console.error("Error adding 2D polygon to design layer:",e)})),e.uniqueParts.push(d),console.log(e.designLayer2D,"Design layer 2D"),function(e,t){const i=qs().createFromPolygon(t,{});i.spatialReference=t.spatialReference,e.meshes.push(i)}(e,h)}function sn(e,t,i,r){const a=[];let s=Math.floor(t/i),n=e,o=0;for(let e=0;e<s;e++)a.push({offset:n,offsetInSegment:o,segment:r}),n+=i,o+=i;return a}var nn=i(6718),on=i(9781),ln=i(7034),cn=i(771);const hn=e=>{let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,(t/100).toFixed(2)};function un(e){return(0,ke.Ay)("MuiPaper",e)}(0,w.A)("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const dn=["className","component","elevation","square","variant"],fn=(0,L.Ay)("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],!i.square&&t.rounded,"elevation"===i.variant&&t[`elevation${i.elevation}`]]}})((({theme:e,ownerState:t})=>{var i;return(0,l.A)({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow")},!t.square&&{borderRadius:e.shape.borderRadius},"outlined"===t.variant&&{border:`1px solid ${(e.vars||e).palette.divider}`},"elevation"===t.variant&&(0,l.A)({boxShadow:(e.vars||e).shadows[t.elevation]},!e.vars&&"dark"===e.palette.mode&&{backgroundImage:`linear-gradient(${(0,cn.X4)("#fff",hn(t.elevation))}, ${(0,cn.X4)("#fff",hn(t.elevation))})`},e.vars&&{backgroundImage:null==(i=e.vars.overlays)?void 0:i[t.elevation]}))})),pn=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiPaper"}),{className:a,component:s="div",elevation:n=1,square:o=!1,variant:h="elevation"}=i,u=(0,c.A)(i,dn),f=(0,l.A)({},i,{component:s,elevation:n,square:o,variant:h}),p=(e=>{const{square:t,elevation:i,variant:r,classes:a}=e,s={root:["root",r,!t&&"rounded","elevation"===r&&`elevation${i}`]};return(0,R.A)(s,un,a)})(f);return(0,r.jsx)(fn,(0,l.A)({as:s,ownerState:f,className:(0,d.A)(p.root,a),ref:t},u))}));function gn(e){return(0,ke.Ay)("MuiTypography",e)}(0,w.A)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const mn=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],bn=(0,L.Ay)("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.variant&&t[i.variant],"inherit"!==i.align&&t[`align${(0,qe.A)(i.align)}`],i.noWrap&&t.noWrap,i.gutterBottom&&t.gutterBottom,i.paragraph&&t.paragraph]}})((({theme:e,ownerState:t})=>(0,l.A)({margin:0},"inherit"===t.variant&&{font:"inherit"},"inherit"!==t.variant&&e.typography[t.variant],"inherit"!==t.align&&{textAlign:t.align},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.paragraph&&{marginBottom:16}))),vn={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},yn={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},_n=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTypography"}),a=(e=>yn[e]||e)(i.color),s=(0,g.A)((0,l.A)({},i,{color:a})),{align:n="inherit",className:o,component:h,gutterBottom:u=!1,noWrap:f=!1,paragraph:p=!1,variant:m="body1",variantMapping:b=vn}=s,v=(0,c.A)(s,mn),y=(0,l.A)({},s,{align:n,color:a,className:o,component:h,gutterBottom:u,noWrap:f,paragraph:p,variant:m,variantMapping:b}),_=h||(p?"p":b[m]||vn[m])||"span",w=(e=>{const{align:t,gutterBottom:i,noWrap:r,paragraph:a,variant:s,classes:n}=e,o={root:["root",s,"inherit"!==e.align&&`align${(0,qe.A)(t)}`,i&&"gutterBottom",r&&"noWrap",a&&"paragraph"]};return(0,R.A)(o,gn,n)})(y);return(0,r.jsx)(bn,(0,l.A)({as:_,ref:t,ownerState:y,className:(0,d.A)(w.root,o)},v))})),wn=_n;function xn(e){return(0,ke.Ay)("MuiIconButton",e)}const An=(0,w.A)("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),Tn=["edge","children","className","color","disabled","disableFocusRipple","size"],kn=(0,L.Ay)(De,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,"default"!==i.color&&t[`color${(0,qe.A)(i.color)}`],i.edge&&t[`edge${(0,qe.A)(i.edge)}`],t[`size${(0,qe.A)(i.size)}`]]}})((({theme:e,ownerState:t})=>(0,l.A)({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest})},!t.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,cn.X4)(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===t.edge&&{marginLeft:"small"===t.size?-3:-12},"end"===t.edge&&{marginRight:"small"===t.size?-3:-12})),(({theme:e,ownerState:t})=>{var i;const r=null==(i=(e.vars||e).palette)?void 0:i[t.color];return(0,l.A)({},"inherit"===t.color&&{color:"inherit"},"inherit"!==t.color&&"default"!==t.color&&(0,l.A)({color:null==r?void 0:r.main},!t.disableRipple&&{"&:hover":(0,l.A)({},r&&{backgroundColor:e.vars?`rgba(${r.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,cn.X4)(r.main,e.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),"small"===t.size&&{padding:5,fontSize:e.typography.pxToRem(18)},"large"===t.size&&{padding:12,fontSize:e.typography.pxToRem(28)},{[`&.${An.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled}})})),Sn=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiIconButton"}),{edge:a=!1,children:s,className:n,color:o="default",disabled:h=!1,disableFocusRipple:u=!1,size:f="medium"}=i,p=(0,c.A)(i,Tn),g=(0,l.A)({},i,{edge:a,color:o,disabled:h,disableFocusRipple:u,size:f}),m=(e=>{const{classes:t,disabled:i,color:r,edge:a,size:s}=e,n={root:["root",i&&"disabled","default"!==r&&`color${(0,qe.A)(r)}`,a&&`edge${(0,qe.A)(a)}`,`size${(0,qe.A)(s)}`]};return(0,R.A)(n,xn,t)})(g);return(0,r.jsx)(kn,(0,l.A)({className:(0,d.A)(m.root,n),centerRipple:!0,focusRipple:!u,disabled:h,ref:t},p,{ownerState:g,children:s}))})),Pn=Sn;var En=i(7379),Cn=i(9770);function Dn(e){return(0,ke.Ay)("MuiButton",e)}const On=(0,w.A)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Rn=h.createContext({}),Mn=h.createContext(void 0),In=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Ln=e=>(0,l.A)({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),Fn=(0,L.Ay)(De,{shouldForwardProp:e=>(0,Cn.A)(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],t[`${i.variant}${(0,qe.A)(i.color)}`],t[`size${(0,qe.A)(i.size)}`],t[`${i.variant}Size${(0,qe.A)(i.size)}`],"inherit"===i.color&&t.colorInherit,i.disableElevation&&t.disableElevation,i.fullWidth&&t.fullWidth]}})((({theme:e,ownerState:t})=>{var i,r;const a="light"===e.palette.mode?e.palette.grey[300]:e.palette.grey[800],s="light"===e.palette.mode?e.palette.grey.A100:e.palette.grey[700];return(0,l.A)({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":(0,l.A)({textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,cn.X4)(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===t.variant&&"inherit"!==t.color&&{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,cn.X4)(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===t.variant&&"inherit"!==t.color&&{border:`1px solid ${(e.vars||e).palette[t.color].main}`,backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,cn.X4)(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===t.variant&&{backgroundColor:e.vars?e.vars.palette.Button.inheritContainedHoverBg:s,boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2],backgroundColor:(e.vars||e).palette.grey[300]}},"contained"===t.variant&&"inherit"!==t.color&&{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}}),"&:active":(0,l.A)({},"contained"===t.variant&&{boxShadow:(e.vars||e).shadows[8]}),[`&.${On.focusVisible}`]:(0,l.A)({},"contained"===t.variant&&{boxShadow:(e.vars||e).shadows[6]}),[`&.${On.disabled}`]:(0,l.A)({color:(e.vars||e).palette.action.disabled},"outlined"===t.variant&&{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"contained"===t.variant&&{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground})},"text"===t.variant&&{padding:"6px 8px"},"text"===t.variant&&"inherit"!==t.color&&{color:(e.vars||e).palette[t.color].main},"outlined"===t.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===t.variant&&"inherit"!==t.color&&{color:(e.vars||e).palette[t.color].main,border:e.vars?`1px solid rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:`1px solid ${(0,cn.X4)(e.palette[t.color].main,.5)}`},"contained"===t.variant&&{color:e.vars?e.vars.palette.text.primary:null==(i=(r=e.palette).getContrastText)?void 0:i.call(r,e.palette.grey[300]),backgroundColor:e.vars?e.vars.palette.Button.inheritContainedBg:a,boxShadow:(e.vars||e).shadows[2]},"contained"===t.variant&&"inherit"!==t.color&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main},"inherit"===t.color&&{color:"inherit",borderColor:"currentColor"},"small"===t.size&&"text"===t.variant&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},"large"===t.size&&"text"===t.variant&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},"small"===t.size&&"outlined"===t.variant&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},"large"===t.size&&"outlined"===t.variant&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},"small"===t.size&&"contained"===t.variant&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},"large"===t.size&&"contained"===t.variant&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},t.fullWidth&&{width:"100%"})}),(({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${On.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${On.disabled}`]:{boxShadow:"none"}})),Nn=(0,L.Ay)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.startIcon,t[`iconSize${(0,qe.A)(i.size)}`]]}})((({ownerState:e})=>(0,l.A)({display:"inherit",marginRight:8,marginLeft:-4},"small"===e.size&&{marginLeft:-2},Ln(e)))),Bn=(0,L.Ay)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.endIcon,t[`iconSize${(0,qe.A)(i.size)}`]]}})((({ownerState:e})=>(0,l.A)({display:"inherit",marginRight:-4,marginLeft:8},"small"===e.size&&{marginRight:-2},Ln(e)))),jn=h.forwardRef((function(e,t){const i=h.useContext(Rn),a=h.useContext(Mn),s=(0,En.A)(i,e),n=(0,F.A)({props:s,name:"MuiButton"}),{children:o,color:u="primary",component:f="button",className:p,disabled:g=!1,disableElevation:m=!1,disableFocusRipple:b=!1,endIcon:v,focusVisibleClassName:y,fullWidth:_=!1,size:w="medium",startIcon:x,type:A,variant:T="text"}=n,k=(0,c.A)(n,In),S=(0,l.A)({},n,{color:u,component:f,disabled:g,disableElevation:m,disableFocusRipple:b,fullWidth:_,size:w,type:A,variant:T}),P=(e=>{const{color:t,disableElevation:i,fullWidth:r,size:a,variant:s,classes:n}=e,o={root:["root",s,`${s}${(0,qe.A)(t)}`,`size${(0,qe.A)(a)}`,`${s}Size${(0,qe.A)(a)}`,`color${(0,qe.A)(t)}`,i&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${(0,qe.A)(a)}`],endIcon:["icon","endIcon",`iconSize${(0,qe.A)(a)}`]},c=(0,R.A)(o,Dn,n);return(0,l.A)({},n,c)})(S),E=x&&(0,r.jsx)(Nn,{className:P.startIcon,ownerState:S,children:x}),C=v&&(0,r.jsx)(Bn,{className:P.endIcon,ownerState:S,children:v}),D=a||"";return(0,r.jsxs)(Fn,(0,l.A)({ownerState:S,className:(0,d.A)(i.className,P.root,p,D),component:f,disabled:g,focusRipple:!b,focusVisibleClassName:(0,d.A)(P.focusVisible,y),ref:t,type:A},k,{classes:P,children:[E,o,C]}))})),zn=jn;function Un(e){return(0,ke.Ay)("MuiTableContainer",e)}(0,w.A)("MuiTableContainer",["root"]);const Hn=["className","component"],Wn=(0,L.Ay)("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,t)=>t.root})({width:"100%",overflowX:"auto"}),Vn=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTableContainer"}),{className:a,component:s="div"}=i,n=(0,c.A)(i,Hn),o=(0,l.A)({},i,{component:s}),h=(e=>{const{classes:t}=e;return(0,R.A)({root:["root"]},Un,t)})(o);return(0,r.jsx)(Wn,(0,l.A)({ref:t,as:s,className:(0,d.A)(h.root,a),ownerState:o},n))})),$n=h.createContext();function Xn(e){return(0,ke.Ay)("MuiTable",e)}(0,w.A)("MuiTable",["root","stickyHeader"]);const Yn=["className","component","padding","size","stickyHeader"],Gn=(0,L.Ay)("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.stickyHeader&&t.stickyHeader]}})((({theme:e,ownerState:t})=>(0,l.A)({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":(0,l.A)({},e.typography.body2,{padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"})},t.stickyHeader&&{borderCollapse:"separate"}))),Kn="table",qn=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTable"}),{className:a,component:s=Kn,padding:n="normal",size:o="medium",stickyHeader:u=!1}=i,f=(0,c.A)(i,Yn),p=(0,l.A)({},i,{component:s,padding:n,size:o,stickyHeader:u}),g=(e=>{const{classes:t,stickyHeader:i}=e,r={root:["root",i&&"stickyHeader"]};return(0,R.A)(r,Xn,t)})(p),m=h.useMemo((()=>({padding:n,size:o,stickyHeader:u})),[n,o,u]);return(0,r.jsx)($n.Provider,{value:m,children:(0,r.jsx)(Gn,(0,l.A)({as:s,role:s===Kn?null:"table",ref:t,className:(0,d.A)(g.root,a),ownerState:p},f))})})),Zn=h.createContext();function Jn(e){return(0,ke.Ay)("MuiTableHead",e)}(0,w.A)("MuiTableHead",["root"]);const Qn=["className","component"],eo=(0,L.Ay)("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-header-group"}),to={variant:"head"},io="thead",ro=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTableHead"}),{className:a,component:s=io}=i,n=(0,c.A)(i,Qn),o=(0,l.A)({},i,{component:s}),h=(e=>{const{classes:t}=e;return(0,R.A)({root:["root"]},Jn,t)})(o);return(0,r.jsx)(Zn.Provider,{value:to,children:(0,r.jsx)(eo,(0,l.A)({as:s,className:(0,d.A)(h.root,a),ref:t,role:s===io?null:"rowgroup",ownerState:o},n))})}));function ao(e){return(0,ke.Ay)("MuiTableRow",e)}const so=(0,w.A)("MuiTableRow",["root","selected","hover","head","footer"]),no=["className","component","hover","selected"],oo=(0,L.Ay)("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.head&&t.head,i.footer&&t.footer]}})((({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${so.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${so.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:(0,cn.X4)(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:(0,cn.X4)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)}}}))),lo="tr",co=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTableRow"}),{className:a,component:s=lo,hover:n=!1,selected:o=!1}=i,u=(0,c.A)(i,no),f=h.useContext(Zn),p=(0,l.A)({},i,{component:s,hover:n,selected:o,head:f&&"head"===f.variant,footer:f&&"footer"===f.variant}),g=(e=>{const{classes:t,selected:i,hover:r,head:a,footer:s}=e,n={root:["root",i&&"selected",r&&"hover",a&&"head",s&&"footer"]};return(0,R.A)(n,ao,t)})(p);return(0,r.jsx)(oo,(0,l.A)({as:s,ref:t,className:(0,d.A)(g.root,a),role:s===lo?null:"row",ownerState:p},u))})),ho=co;function uo(e){return(0,ke.Ay)("MuiTableCell",e)}const fo=(0,w.A)("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),po=["align","className","component","padding","scope","size","sortDirection","variant"],go=(0,L.Ay)("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],t[`size${(0,qe.A)(i.size)}`],"normal"!==i.padding&&t[`padding${(0,qe.A)(i.padding)}`],"inherit"!==i.align&&t[`align${(0,qe.A)(i.align)}`],i.stickyHeader&&t.stickyHeader]}})((({theme:e,ownerState:t})=>(0,l.A)({},e.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid\n    ${"light"===e.palette.mode?(0,cn.a)((0,cn.X4)(e.palette.divider,1),.88):(0,cn.e$)((0,cn.X4)(e.palette.divider,1),.68)}`,textAlign:"left",padding:16},"head"===t.variant&&{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium},"body"===t.variant&&{color:(e.vars||e).palette.text.primary},"footer"===t.variant&&{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)},"small"===t.size&&{padding:"6px 16px",[`&.${fo.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}},"checkbox"===t.padding&&{width:48,padding:"0 0 0 4px"},"none"===t.padding&&{padding:0},"left"===t.align&&{textAlign:"left"},"center"===t.align&&{textAlign:"center"},"right"===t.align&&{textAlign:"right",flexDirection:"row-reverse"},"justify"===t.align&&{textAlign:"justify"},t.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default}))),mo=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTableCell"}),{align:a="inherit",className:s,component:n,padding:o,scope:u,size:f,sortDirection:p,variant:g}=i,m=(0,c.A)(i,po),b=h.useContext($n),v=h.useContext(Zn),y=v&&"head"===v.variant;let _;_=n||(y?"th":"td");let w=u;"td"===_?w=void 0:!w&&y&&(w="col");const x=g||v&&v.variant,A=(0,l.A)({},i,{align:a,component:_,padding:o||(b&&b.padding?b.padding:"normal"),size:f||(b&&b.size?b.size:"medium"),sortDirection:p,stickyHeader:"head"===x&&b&&b.stickyHeader,variant:x}),T=(e=>{const{classes:t,variant:i,align:r,padding:a,size:s,stickyHeader:n}=e,o={root:["root",i,n&&"stickyHeader","inherit"!==r&&`align${(0,qe.A)(r)}`,"normal"!==a&&`padding${(0,qe.A)(a)}`,`size${(0,qe.A)(s)}`]};return(0,R.A)(o,uo,t)})(A);let k=null;return p&&(k="asc"===p?"ascending":"descending"),(0,r.jsx)(go,(0,l.A)({as:_,ref:t,className:(0,d.A)(T.root,s),"aria-sort":k,scope:w,ownerState:A},m))})),bo=mo;function vo(e){return(0,ke.Ay)("MuiTableBody",e)}(0,w.A)("MuiTableBody",["root"]);const yo=["className","component"],_o=(0,L.Ay)("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-row-group"}),wo={variant:"body"},xo="tbody",Ao=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTableBody"}),{className:a,component:s=xo}=i,n=(0,c.A)(i,yo),o=(0,l.A)({},i,{component:s}),h=(e=>{const{classes:t}=e;return(0,R.A)({root:["root"]},vo,t)})(o);return(0,r.jsx)(Zn.Provider,{value:wo,children:(0,r.jsx)(_o,(0,l.A)({className:(0,d.A)(h.root,a),as:s,ref:t,role:s===xo?null:"rowgroup",ownerState:o},n))})}));var To=i(1317),ko=i(9453),So=i(4661);const Po=h.createContext({});function Eo(e){return(0,ke.Ay)("MuiList",e)}(0,w.A)("MuiList",["root","padding","dense","subheader"]);const Co=["children","className","component","dense","disablePadding","subheader"],Do=(0,L.Ay)("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,!i.disablePadding&&t.padding,i.dense&&t.dense,i.subheader&&t.subheader]}})((({ownerState:e})=>(0,l.A)({listStyle:"none",margin:0,padding:0,position:"relative"},!e.disablePadding&&{paddingTop:8,paddingBottom:8},e.subheader&&{paddingTop:0}))),Oo=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiList"}),{children:a,className:s,component:n="ul",dense:o=!1,disablePadding:u=!1,subheader:f}=i,p=(0,c.A)(i,Co),g=h.useMemo((()=>({dense:o})),[o]),m=(0,l.A)({},i,{component:n,dense:o,disablePadding:u}),b=(e=>{const{classes:t,disablePadding:i,dense:r,subheader:a}=e,s={root:["root",!i&&"padding",r&&"dense",a&&"subheader"]};return(0,R.A)(s,Eo,t)})(m);return(0,r.jsx)(Po.Provider,{value:g,children:(0,r.jsxs)(Do,(0,l.A)({as:n,className:(0,d.A)(b.root,s),ref:t,ownerState:m},p,{children:[f,a]}))})}));function Ro(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}const Mo=Ro,Io=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function Lo(e,t,i){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:i?null:e.firstChild}function Fo(e,t,i){return e===t?i?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:i?null:e.lastChild}function No(e,t){if(void 0===t)return!0;let i=e.innerText;return void 0===i&&(i=e.textContent),i=i.trim().toLowerCase(),0!==i.length&&(t.repeating?i[0]===t.keys[0]:0===i.indexOf(t.keys.join("")))}function Bo(e,t,i,r,a,s){let n=!1,o=a(e,t,!!t&&i);for(;o;){if(o===e.firstChild){if(n)return!1;n=!0}const t=!r&&(o.disabled||"true"===o.getAttribute("aria-disabled"));if(o.hasAttribute("tabindex")&&No(o,s)&&!t)return o.focus(),!0;o=a(e,o,i)}return!1}const jo=h.forwardRef((function(e,t){const{actions:i,autoFocus:a=!1,autoFocusItem:s=!1,children:n,className:o,disabledItemsFocusable:u=!1,disableListWrap:d=!1,onKeyDown:f,variant:p="selectedMenu"}=e,g=(0,c.A)(e,Io),m=h.useRef(null),b=h.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});(0,V.A)((()=>{a&&m.current.focus()}),[a]),h.useImperativeHandle(i,(()=>({adjustStyleForScrollbar:(e,{direction:t})=>{const i=!m.current.style.width;if(e.clientHeight<m.current.clientHeight&&i){const i=`${Mo((0,Be.A)(e))}px`;m.current.style["rtl"===t?"paddingLeft":"paddingRight"]=i,m.current.style.width=`calc(100% + ${i})`}return m.current}})),[]);const v=(0,J.A)(m,t);let y=-1;h.Children.forEach(n,((e,t)=>{h.isValidElement(e)?(e.props.disabled||("selectedMenu"===p&&e.props.selected||-1===y)&&(y=t),y===t&&(e.props.disabled||e.props.muiSkipListHighlight||e.type.muiSkipListHighlight)&&(y+=1,y>=n.length&&(y=-1))):y===t&&(y+=1,y>=n.length&&(y=-1))}));const _=h.Children.map(n,((e,t)=>{if(t===y){const t={};return s&&(t.autoFocus=!0),void 0===e.props.tabIndex&&"selectedMenu"===p&&(t.tabIndex=0),h.cloneElement(e,t)}return e}));return(0,r.jsx)(Oo,(0,l.A)({role:"menu",ref:v,className:o,onKeyDown:e=>{const t=m.current,i=e.key,r=(0,Be.A)(t).activeElement;if("ArrowDown"===i)e.preventDefault(),Bo(t,r,d,u,Lo);else if("ArrowUp"===i)e.preventDefault(),Bo(t,r,d,u,Fo);else if("Home"===i)e.preventDefault(),Bo(t,null,d,u,Lo);else if("End"===i)e.preventDefault(),Bo(t,null,d,u,Fo);else if(1===i.length){const a=b.current,s=i.toLowerCase(),n=performance.now();a.keys.length>0&&(n-a.lastTime>500?(a.keys=[],a.repeating=!0,a.previousKeyMatched=!0):a.repeating&&s!==a.keys[0]&&(a.repeating=!1)),a.lastTime=n,a.keys.push(s);const o=r&&!a.repeating&&No(r,a);a.previousKeyMatched&&(o||Bo(t,r,!1,u,Lo,a))?e.preventDefault():a.previousKeyMatched=!1}f&&f(e)},tabIndex:a?0:-1},g,{children:_}))}));var zo=i(8398),Uo=i.n(zo);var Ho="unmounted",Wo="exited",Vo="entering",$o="entered",Xo="exiting",Yo=function(e){function t(t,i){var r;r=e.call(this,t,i)||this;var a,s=i&&!i.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?s?(a=Wo,r.appearStatus=Vo):a=$o:a=t.unmountOnExit||t.mountOnEnter?Ho:Wo,r.state={status:a},r.nextCallback=null,r}ie(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Ho?{status:Wo}:null};var i=t.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(e){var t=null;if(e!==this.props){var i=this.state.status;this.props.in?i!==Vo&&i!==$o&&(t=Vo):i!==Vo&&i!==$o||(t=Xo)}this.updateStatus(!1,t)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var e,t,i,r=this.props.timeout;return e=t=i=r,null!=r&&"number"!=typeof r&&(e=r.exit,t=r.enter,i=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:i}},i.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Vo){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:Uo().findDOMNode(this);i&&function(e){e.scrollTop}(i)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Wo&&this.setState({status:Ho})},i.performEnter=function(e){var t=this,i=this.props.enter,r=this.context?this.context.isMounting:e,a=this.props.nodeRef?[r]:[Uo().findDOMNode(this),r],s=a[0],n=a[1],o=this.getTimeouts(),l=r?o.appear:o.enter;e||i?(this.props.onEnter(s,n),this.safeSetState({status:Vo},(function(){t.props.onEntering(s,n),t.onTransitionEnd(l,(function(){t.safeSetState({status:$o},(function(){t.props.onEntered(s,n)}))}))}))):this.safeSetState({status:$o},(function(){t.props.onEntered(s)}))},i.performExit=function(){var e=this,t=this.props.exit,i=this.getTimeouts(),r=this.props.nodeRef?void 0:Uo().findDOMNode(this);t?(this.props.onExit(r),this.safeSetState({status:Xo},(function(){e.props.onExiting(r),e.onTransitionEnd(i.exit,(function(){e.safeSetState({status:Wo},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:Wo},(function(){e.props.onExited(r)}))},i.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},i.setNextCallback=function(e){var t=this,i=!0;return this.nextCallback=function(r){i&&(i=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},i.onTransitionEnd=function(e,t){this.setNextCallback(t);var i=this.props.nodeRef?this.props.nodeRef.current:Uo().findDOMNode(this),r=null==e&&!this.props.addEndListener;if(i&&!r){if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],s=a[0],n=a[1];this.props.addEndListener(s,n)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},i.render=function(){var e=this.state.status;if(e===Ho)return null;var t=this.props,i=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,c.A)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return u().createElement(re.Provider,{value:null},"function"==typeof i?i(e,r):u().cloneElement(u().Children.only(i),r))},t}(u().Component);function Go(){}Yo.contextType=re,Yo.propTypes={},Yo.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Go,onEntering:Go,onEntered:Go,onExit:Go,onExiting:Go,onExited:Go},Yo.UNMOUNTED=Ho,Yo.EXITED=Wo,Yo.ENTERING=Vo,Yo.ENTERED=$o,Yo.EXITING=Xo;const Ko=Yo,qo=e=>e.scrollTop;function Zo(e,t){var i,r;const{timeout:a,easing:s,style:n={}}=e;return{duration:null!=(i=n.transitionDuration)?i:"number"==typeof a?a:a[t.mode]||0,easing:null!=(r=n.transitionTimingFunction)?r:"object"==typeof s?s[t.mode]:s,delay:n.transitionDelay}}const Jo=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Qo(e){return`scale(${e}, ${e**2})`}const el={entering:{opacity:1,transform:Qo(1)},entered:{opacity:1,transform:"none"}},tl="undefined"!=typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),il=h.forwardRef((function(e,t){const{addEndListener:i,appear:a=!0,children:s,easing:n,in:o,onEnter:u,onEntered:d,onEntering:f,onExit:p,onExited:g,onExiting:m,style:b,timeout:v="auto",TransitionComponent:y=Ko}=e,_=(0,c.A)(e,Jo),w=(0,ue.A)(),x=h.useRef(),A=B(),T=h.useRef(null),k=(0,J.A)(T,s.ref,t),S=e=>t=>{if(e){const i=T.current;void 0===t?e(i):e(i,t)}},P=S(f),E=S(((e,t)=>{qo(e);const{duration:i,delay:r,easing:a}=Zo({style:b,timeout:v,easing:n},{mode:"enter"});let s;"auto"===v?(s=A.transitions.getAutoHeightDuration(e.clientHeight),x.current=s):s=i,e.style.transition=[A.transitions.create("opacity",{duration:s,delay:r}),A.transitions.create("transform",{duration:tl?s:.666*s,delay:r,easing:a})].join(","),u&&u(e,t)})),C=S(d),D=S(m),O=S((e=>{const{duration:t,delay:i,easing:r}=Zo({style:b,timeout:v,easing:n},{mode:"exit"});let a;"auto"===v?(a=A.transitions.getAutoHeightDuration(e.clientHeight),x.current=a):a=t,e.style.transition=[A.transitions.create("opacity",{duration:a,delay:i}),A.transitions.create("transform",{duration:tl?a:.666*a,delay:tl?i:i||.333*a,easing:r})].join(","),e.style.opacity=0,e.style.transform=Qo(.75),p&&p(e)})),R=S(g);return(0,r.jsx)(y,(0,l.A)({appear:a,in:o,nodeRef:T,onEnter:E,onEntered:C,onEntering:P,onExit:O,onExited:R,onExiting:D,addEndListener:e=>{"auto"===v&&w.start(x.current||0,e),i&&i(T.current,e)},timeout:"auto"===v?null:v},_,{children:(e,t)=>h.cloneElement(s,(0,l.A)({style:(0,l.A)({opacity:0,transform:Qo(.75),visibility:"exited"!==e||o?void 0:"hidden"},el[e],b,s.props.style),ref:k},t))}))}));il.muiSupportAuto=!0;const rl=il;var al=i(2325),sl=i(1547),nl=i(6673),ol=i(4877);function ll(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function cl(e){return parseInt((0,ol.A)(e).getComputedStyle(e).paddingRight,10)||0}function hl(e,t,i,r,a){const s=[t,i,...r];[].forEach.call(e.children,(e=>{const t=-1===s.indexOf(e),i=!function(e){const t=-1!==["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName),i="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||i}(e);t&&i&&ll(e,a)}))}function ul(e,t){let i=-1;return e.some(((e,r)=>!!t(e)&&(i=r,!0))),i}const dl=new class{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,t){let i=this.modals.indexOf(e);if(-1!==i)return i;i=this.modals.length,this.modals.push(e),e.modalRef&&ll(e.modalRef,!1);const r=function(e){const t=[];return[].forEach.call(e.children,(e=>{"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);hl(t,e.mount,e.modalRef,r,!0);const a=ul(this.containers,(e=>e.container===t));return-1!==a?(this.containers[a].modals.push(e),i):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:r}),i)}mount(e,t){const i=ul(this.containers,(t=>-1!==t.modals.indexOf(e))),r=this.containers[i];r.restore||(r.restore=function(e,t){const i=[],r=e.container;if(!t.disableScrollLock){if(function(e){const t=(0,al.A)(e);return t.body===e?(0,ol.A)(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(r)){const e=Ro((0,al.A)(r));i.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${cl(r)+e}px`;const t=(0,al.A)(r).querySelectorAll(".mui-fixed");[].forEach.call(t,(t=>{i.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight=`${cl(t)+e}px`}))}let e;if(r.parentNode instanceof DocumentFragment)e=(0,al.A)(r).body;else{const t=r.parentElement,i=(0,ol.A)(r);e="HTML"===(null==t?void 0:t.nodeName)&&"scroll"===i.getComputedStyle(t).overflowY?t:r}i.push({value:e.style.overflow,property:"overflow",el:e},{value:e.style.overflowX,property:"overflow-x",el:e},{value:e.style.overflowY,property:"overflow-y",el:e}),e.style.overflow="hidden"}return()=>{i.forEach((({value:e,el:t,property:i})=>{e?t.style.setProperty(i,e):t.style.removeProperty(i)}))}}(r,t))}remove(e,t=!0){const i=this.modals.indexOf(e);if(-1===i)return i;const r=ul(this.containers,(t=>-1!==t.modals.indexOf(e))),a=this.containers[r];if(a.modals.splice(a.modals.indexOf(e),1),this.modals.splice(i,1),0===a.modals.length)a.restore&&a.restore(),e.modalRef&&ll(e.modalRef,t),hl(a.container,e.mount,e.modalRef,a.hiddenSiblings,!1),this.containers.splice(r,1);else{const e=a.modals[a.modals.length-1];e.modalRef&&ll(e.modalRef,!1)}return i}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}};const fl=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function pl(e){const t=[],i=[];return Array.from(e.querySelectorAll(fl)).forEach(((e,r)=>{const a=function(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==a&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;const t=t=>e.ownerDocument.querySelector(`input[type="radio"]${t}`);let i=t(`[name="${e.name}"]:checked`);return i||(i=t(`[name="${e.name}"]`)),i!==e}(e))}(e)&&(0===a?t.push(e):i.push({documentOrder:r,tabIndex:a,node:e}))})),i.sort(((e,t)=>e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex)).map((e=>e.node)).concat(t)}function gl(){return!0}function ml(e){const{children:t,disableAutoFocus:i=!1,disableEnforceFocus:a=!1,disableRestoreFocus:s=!1,getTabbable:n=pl,isEnabled:o=gl,open:l}=e,c=h.useRef(!1),u=h.useRef(null),d=h.useRef(null),f=h.useRef(null),p=h.useRef(null),g=h.useRef(!1),m=h.useRef(null),b=(0,S.A)(t.ref,m),v=h.useRef(null);h.useEffect((()=>{l&&m.current&&(g.current=!i)}),[i,l]),h.useEffect((()=>{if(!l||!m.current)return;const e=(0,al.A)(m.current);return m.current.contains(e.activeElement)||(m.current.hasAttribute("tabIndex")||m.current.setAttribute("tabIndex","-1"),g.current&&m.current.focus()),()=>{s||(f.current&&f.current.focus&&(c.current=!0,f.current.focus()),f.current=null)}}),[l]),h.useEffect((()=>{if(!l||!m.current)return;const e=(0,al.A)(m.current),t=t=>{v.current=t,!a&&o()&&"Tab"===t.key&&e.activeElement===m.current&&t.shiftKey&&(c.current=!0,d.current&&d.current.focus())},i=()=>{const t=m.current;if(null===t)return;if(!e.hasFocus()||!o()||c.current)return void(c.current=!1);if(t.contains(e.activeElement))return;if(a&&e.activeElement!==u.current&&e.activeElement!==d.current)return;if(e.activeElement!==p.current)p.current=null;else if(null!==p.current)return;if(!g.current)return;let i=[];if(e.activeElement!==u.current&&e.activeElement!==d.current||(i=n(m.current)),i.length>0){var r,s;const e=Boolean((null==(r=v.current)?void 0:r.shiftKey)&&"Tab"===(null==(s=v.current)?void 0:s.key)),t=i[0],a=i[i.length-1];"string"!=typeof t&&"string"!=typeof a&&(e?a.focus():t.focus())}else t.focus()};e.addEventListener("focusin",i),e.addEventListener("keydown",t,!0);const r=setInterval((()=>{e.activeElement&&"BODY"===e.activeElement.tagName&&i()}),50);return()=>{clearInterval(r),e.removeEventListener("focusin",i),e.removeEventListener("keydown",t,!0)}}),[i,a,s,o,l,n]);const y=e=>{null===f.current&&(f.current=e.relatedTarget),g.current=!0};return(0,r.jsxs)(h.Fragment,{children:[(0,r.jsx)("div",{tabIndex:l?0:-1,onFocus:y,ref:u,"data-testid":"sentinelStart"}),h.cloneElement(t,{ref:b,onFocus:e=>{null===f.current&&(f.current=e.relatedTarget),g.current=!0,p.current=e.target;const i=t.props.onFocus;i&&i(e)}}),(0,r.jsx)("div",{tabIndex:l?0:-1,onFocus:y,ref:d,"data-testid":"sentinelEnd"})]})}var bl=i(1529),vl=i(7365);const yl=h.forwardRef((function(e,t){const{children:i,container:a,disablePortal:s=!1}=e,[n,o]=h.useState(null),l=(0,S.A)(h.isValidElement(i)?i.ref:null,t);if((0,bl.A)((()=>{s||o(function(e){return"function"==typeof e?e():e}(a)||document.body)}),[a,s]),(0,bl.A)((()=>{if(n&&!s)return(0,vl.A)(t,n),()=>{(0,vl.A)(t,null)}}),[t,n,s]),s){if(h.isValidElement(i)){const e={ref:l};return h.cloneElement(i,e)}return(0,r.jsx)(h.Fragment,{children:i})}return(0,r.jsx)(h.Fragment,{children:n?zo.createPortal(i,n):n})})),_l=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],wl={entering:{opacity:1},entered:{opacity:1}},xl=h.forwardRef((function(e,t){const i=B(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{addEndListener:s,appear:n=!0,children:o,easing:u,in:d,onEnter:f,onEntered:p,onEntering:g,onExit:m,onExited:b,onExiting:v,style:y,timeout:_=a,TransitionComponent:w=Ko}=e,x=(0,c.A)(e,_l),A=h.useRef(null),T=(0,J.A)(A,o.ref,t),k=e=>t=>{if(e){const i=A.current;void 0===t?e(i):e(i,t)}},S=k(g),P=k(((e,t)=>{qo(e);const r=Zo({style:y,timeout:_,easing:u},{mode:"enter"});e.style.webkitTransition=i.transitions.create("opacity",r),e.style.transition=i.transitions.create("opacity",r),f&&f(e,t)})),E=k(p),C=k(v),D=k((e=>{const t=Zo({style:y,timeout:_,easing:u},{mode:"exit"});e.style.webkitTransition=i.transitions.create("opacity",t),e.style.transition=i.transitions.create("opacity",t),m&&m(e)})),O=k(b);return(0,r.jsx)(w,(0,l.A)({appear:n,in:d,nodeRef:A,onEnter:P,onEntered:E,onEntering:S,onExit:D,onExited:O,onExiting:C,addEndListener:e=>{s&&s(A.current,e)},timeout:_},x,{children:(e,t)=>h.cloneElement(o,(0,l.A)({style:(0,l.A)({opacity:0,visibility:"exited"!==e||d?void 0:"hidden"},wl[e],y,o.props.style),ref:T},t))}))})),Al=xl;function Tl(e){return(0,ke.Ay)("MuiBackdrop",e)}(0,w.A)("MuiBackdrop",["root","invisible"]);const kl=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Sl=(0,L.Ay)("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.invisible&&t.invisible]}})((({ownerState:e})=>(0,l.A)({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},e.invisible&&{backgroundColor:"transparent"}))),Pl=h.forwardRef((function(e,t){var i,a,s;const n=(0,F.A)({props:e,name:"MuiBackdrop"}),{children:o,className:h,component:u="div",components:f={},componentsProps:p={},invisible:g=!1,open:m,slotProps:b={},slots:v={},TransitionComponent:y=Al,transitionDuration:_}=n,w=(0,c.A)(n,kl),x=(0,l.A)({},n,{component:u,invisible:g}),A=(e=>{const{classes:t,invisible:i}=e,r={root:["root",i&&"invisible"]};return(0,R.A)(r,Tl,t)})(x),T=null!=(i=b.root)?i:p.root;return(0,r.jsx)(y,(0,l.A)({in:m,timeout:_},w,{children:(0,r.jsx)(Sl,(0,l.A)({"aria-hidden":!0},T,{as:null!=(a=null!=(s=v.root)?s:f.Root)?a:u,className:(0,d.A)(A.root,h,null==T?void 0:T.className),ownerState:(0,l.A)({},x,null==T?void 0:T.ownerState),classes:A,ref:t,children:o}))}))}));function El(e){return(0,ke.Ay)("MuiModal",e)}(0,w.A)("MuiModal",["root","hidden","backdrop"]);const Cl=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],Dl=(0,L.Ay)("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,!i.open&&i.exited&&t.hidden]}})((({theme:e,ownerState:t})=>(0,l.A)({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0},!t.open&&t.exited&&{visibility:"hidden"}))),Ol=(0,L.Ay)(Pl,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),Rl=h.forwardRef((function(e,t){var i,a,s,n,o,u;const f=(0,F.A)({name:"MuiModal",props:e}),{BackdropComponent:p=Ol,BackdropProps:g,className:m,closeAfterTransition:b=!1,children:v,container:y,component:_,components:w={},componentsProps:x={},disableAutoFocus:A=!1,disableEnforceFocus:T=!1,disableEscapeKeyDown:k=!1,disablePortal:P=!1,disableRestoreFocus:C=!1,disableScrollLock:D=!1,hideBackdrop:M=!1,keepMounted:I=!1,onBackdropClick:L,open:N,slotProps:B,slots:j}=f,z=(0,c.A)(f,Cl),U=(0,l.A)({},f,{closeAfterTransition:b,disableAutoFocus:A,disableEnforceFocus:T,disableEscapeKeyDown:k,disablePortal:P,disableRestoreFocus:C,disableScrollLock:D,hideBackdrop:M,keepMounted:I}),{getRootProps:H,getBackdropProps:W,getTransitionProps:V,portalRef:$,isTopModal:X,exited:Y,hasTransition:G}=function(e){const{container:t,disableEscapeKeyDown:i=!1,disableScrollLock:r=!1,manager:a=dl,closeAfterTransition:s=!1,onTransitionEnter:n,onTransitionExited:o,children:c,onClose:u,open:d,rootRef:f}=e,p=h.useRef({}),g=h.useRef(null),m=h.useRef(null),b=(0,S.A)(m,f),[v,y]=h.useState(!d),_=function(e){return!!e&&e.props.hasOwnProperty("in")}(c);let w=!0;"false"!==e["aria-hidden"]&&!1!==e["aria-hidden"]||(w=!1);const x=()=>(p.current.modalRef=m.current,p.current.mount=g.current,p.current),A=()=>{a.mount(x(),{disableScrollLock:r}),m.current&&(m.current.scrollTop=0)},T=(0,sl.A)((()=>{const e=function(e){return"function"==typeof e?e():e}(t)||(0,al.A)(g.current).body;a.add(x(),e),m.current&&A()})),k=h.useCallback((()=>a.isTopModal(x())),[a]),P=(0,sl.A)((e=>{g.current=e,e&&(d&&k()?A():m.current&&ll(m.current,w))})),C=h.useCallback((()=>{a.remove(x(),w)}),[w,a]);h.useEffect((()=>()=>{C()}),[C]),h.useEffect((()=>{d?T():_&&s||C()}),[d,C,_,s,T]);const D=e=>t=>{var r;null==(r=e.onKeyDown)||r.call(e,t),"Escape"===t.key&&229!==t.which&&k()&&(i||(t.stopPropagation(),u&&u(t,"escapeKeyDown")))},O=e=>t=>{var i;null==(i=e.onClick)||i.call(e,t),t.target===t.currentTarget&&u&&u(t,"backdropClick")};return{getRootProps:(t={})=>{const i=E(e);delete i.onTransitionEnter,delete i.onTransitionExited;const r=(0,l.A)({},i,t);return(0,l.A)({role:"presentation"},r,{onKeyDown:D(r),ref:b})},getBackdropProps:(e={})=>{const t=e;return(0,l.A)({"aria-hidden":!0},t,{onClick:O(t),open:d})},getTransitionProps:()=>({onEnter:(0,nl.A)((()=>{y(!1),n&&n()}),null==c?void 0:c.props.onEnter),onExited:(0,nl.A)((()=>{y(!0),o&&o(),s&&C()}),null==c?void 0:c.props.onExited)}),rootRef:b,portalRef:P,isTopModal:k,exited:v,hasTransition:_}}((0,l.A)({},U,{rootRef:t})),K=(0,l.A)({},U,{exited:Y}),q=(e=>{const{open:t,exited:i,classes:r}=e,a={root:["root",!t&&i&&"hidden"],backdrop:["backdrop"]};return(0,R.A)(a,El,r)})(K),Z={};if(void 0===v.props.tabIndex&&(Z.tabIndex="-1"),G){const{onEnter:e,onExited:t}=V();Z.onEnter=e,Z.onExited=t}const J=null!=(i=null!=(a=null==j?void 0:j.root)?a:w.Root)?i:Dl,Q=null!=(s=null!=(n=null==j?void 0:j.backdrop)?n:w.Backdrop)?s:p,ee=null!=(o=null==B?void 0:B.root)?o:x.root,te=null!=(u=null==B?void 0:B.backdrop)?u:x.backdrop,ie=O({elementType:J,externalSlotProps:ee,externalForwardedProps:z,getSlotProps:H,additionalProps:{ref:t,as:_},ownerState:K,className:(0,d.A)(m,null==ee?void 0:ee.className,null==q?void 0:q.root,!K.open&&K.exited&&(null==q?void 0:q.hidden))}),re=O({elementType:Q,externalSlotProps:te,additionalProps:g,getSlotProps:e=>W((0,l.A)({},e,{onClick:t=>{L&&L(t),null!=e&&e.onClick&&e.onClick(t)}})),className:(0,d.A)(null==te?void 0:te.className,null==g?void 0:g.className,null==q?void 0:q.backdrop),ownerState:K});return I||N||G&&!Y?(0,r.jsx)(yl,{ref:$,container:y,disablePortal:P,children:(0,r.jsxs)(J,(0,l.A)({},ie,{children:[!M&&p?(0,r.jsx)(Q,(0,l.A)({},re)):null,(0,r.jsx)(ml,{disableEnforceFocus:T,disableAutoFocus:A,disableRestoreFocus:C,isEnabled:X,open:N,children:h.cloneElement(v,Z)})]}))}):null})),Ml=Rl;function Il(e){return(0,ke.Ay)("MuiPopover",e)}(0,w.A)("MuiPopover",["root","paper"]);const Ll=["onEntering"],Fl=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Nl=["slotProps"];function Bl(e,t){let i=0;return"number"==typeof t?i=t:"center"===t?i=e.height/2:"bottom"===t&&(i=e.height),i}function jl(e,t){let i=0;return"number"==typeof t?i=t:"center"===t?i=e.width/2:"right"===t&&(i=e.width),i}function zl(e){return[e.horizontal,e.vertical].map((e=>"number"==typeof e?`${e}px`:e)).join(" ")}function Ul(e){return"function"==typeof e?e():e}const Hl=(0,L.Ay)(Ml,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Wl=(0,L.Ay)(pn,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Vl=h.forwardRef((function(e,t){var i,a,s;const n=(0,F.A)({props:e,name:"MuiPopover"}),{action:o,anchorEl:u,anchorOrigin:f={vertical:"top",horizontal:"left"},anchorPosition:p,anchorReference:g="anchorEl",children:m,className:b,container:v,elevation:y=8,marginThreshold:_=16,open:w,PaperProps:x={},slots:A,slotProps:T,transformOrigin:k={vertical:"top",horizontal:"left"},TransitionComponent:S=rl,transitionDuration:E="auto",TransitionProps:{onEntering:C}={},disableScrollLock:D=!1}=n,M=(0,c.A)(n.TransitionProps,Ll),I=(0,c.A)(n,Fl),L=null!=(i=null==T?void 0:T.paper)?i:x,N=h.useRef(),B=(0,J.A)(N,L.ref),z=(0,l.A)({},n,{anchorOrigin:f,anchorReference:g,elevation:y,marginThreshold:_,externalPaperSlotProps:L,transformOrigin:k,TransitionComponent:S,transitionDuration:E,TransitionProps:M}),U=(e=>{const{classes:t}=e;return(0,R.A)({root:["root"],paper:["paper"]},Il,t)})(z),H=h.useCallback((()=>{if("anchorPosition"===g)return p;const e=Ul(u),t=(e&&1===e.nodeType?e:(0,Be.A)(N.current).body).getBoundingClientRect();return{top:t.top+Bl(t,f.vertical),left:t.left+jl(t,f.horizontal)}}),[u,f.horizontal,f.vertical,p,g]),W=h.useCallback((e=>({vertical:Bl(e,k.vertical),horizontal:jl(e,k.horizontal)})),[k.horizontal,k.vertical]),V=h.useCallback((e=>{const t={width:e.offsetWidth,height:e.offsetHeight},i=W(t);if("none"===g)return{top:null,left:null,transformOrigin:zl(i)};const r=H();let a=r.top-i.vertical,s=r.left-i.horizontal;const n=a+t.height,o=s+t.width,l=(0,X.A)(Ul(u)),c=l.innerHeight-_,h=l.innerWidth-_;if(null!==_&&a<_){const e=a-_;a-=e,i.vertical+=e}else if(null!==_&&n>c){const e=n-c;a-=e,i.vertical+=e}if(null!==_&&s<_){const e=s-_;s-=e,i.horizontal+=e}else if(o>h){const e=o-h;s-=e,i.horizontal+=e}return{top:`${Math.round(a)}px`,left:`${Math.round(s)}px`,transformOrigin:zl(i)}}),[u,g,H,W,_]),[$,Y]=h.useState(w),G=h.useCallback((()=>{const e=N.current;if(!e)return;const t=V(e);null!==t.top&&(e.style.top=t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,Y(!0)}),[V]);h.useEffect((()=>(D&&window.addEventListener("scroll",G),()=>window.removeEventListener("scroll",G))),[u,D,G]),h.useEffect((()=>{w&&G()})),h.useImperativeHandle(o,(()=>w?{updatePosition:()=>{G()}}:null),[w,G]),h.useEffect((()=>{if(!w)return;const e=(0,j.A)((()=>{G()})),t=(0,X.A)(u);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}}),[u,w,G]);let K=E;"auto"!==E||S.muiSupportAuto||(K=void 0);const q=v||(u?(0,Be.A)(Ul(u)).body:void 0),Z=null!=(a=null==A?void 0:A.root)?a:Hl,Q=null!=(s=null==A?void 0:A.paper)?s:Wl,ee=O({elementType:Q,externalSlotProps:(0,l.A)({},L,{style:$?L.style:(0,l.A)({},L.style,{opacity:0})}),additionalProps:{elevation:y,ref:B},ownerState:z,className:(0,d.A)(U.paper,null==L?void 0:L.className)}),te=O({elementType:Z,externalSlotProps:(null==T?void 0:T.root)||{},externalForwardedProps:I,additionalProps:{ref:t,slotProps:{backdrop:{invisible:!0}},container:q,open:w},ownerState:z,className:(0,d.A)(U.root,b)}),{slotProps:ie}=te,re=(0,c.A)(te,Nl);return(0,r.jsx)(Z,(0,l.A)({},re,!P(Z)&&{slotProps:ie,disableScrollLock:D},{children:(0,r.jsx)(S,(0,l.A)({appear:!0,in:w,onEntering:(e,t)=>{C&&C(e,t),G()},onExited:()=>{Y(!1)},timeout:K},M,{children:(0,r.jsx)(Q,(0,l.A)({},ee,{children:m}))}))}))}));function $l(e){return(0,ke.Ay)("MuiMenu",e)}(0,w.A)("MuiMenu",["root","paper","list"]);const Xl=["onEntering"],Yl=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],Gl={vertical:"top",horizontal:"right"},Kl={vertical:"top",horizontal:"left"},ql=(0,L.Ay)(Vl,{shouldForwardProp:e=>(0,Cn.A)(e)||"classes"===e,name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Zl=(0,L.Ay)(Wl,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Jl=(0,L.Ay)(jo,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),Ql=h.forwardRef((function(e,t){var i,a;const s=(0,F.A)({props:e,name:"MuiMenu"}),{autoFocus:n=!0,children:o,className:u,disableAutoFocusItem:f=!1,MenuListProps:p={},onClose:g,open:m,PaperProps:b={},PopoverClasses:v,transitionDuration:y="auto",TransitionProps:{onEntering:_}={},variant:w="selectedMenu",slots:x={},slotProps:A={}}=s,T=(0,c.A)(s.TransitionProps,Xl),k=(0,c.A)(s,Yl),S=I(),P=(0,l.A)({},s,{autoFocus:n,disableAutoFocusItem:f,MenuListProps:p,onEntering:_,PaperProps:b,transitionDuration:y,TransitionProps:T,variant:w}),E=(e=>{const{classes:t}=e;return(0,R.A)({root:["root"],paper:["paper"],list:["list"]},$l,t)})(P),C=n&&!f&&m,D=h.useRef(null);let M=-1;h.Children.map(o,((e,t)=>{h.isValidElement(e)&&(e.props.disabled||("selectedMenu"===w&&e.props.selected||-1===M)&&(M=t))}));const L=null!=(i=x.paper)?i:Zl,N=null!=(a=A.paper)?a:b,B=O({elementType:x.root,externalSlotProps:A.root,ownerState:P,className:[E.root,u]}),j=O({elementType:L,externalSlotProps:N,ownerState:P,className:E.paper});return(0,r.jsx)(ql,(0,l.A)({onClose:g,anchorOrigin:{vertical:"bottom",horizontal:S?"right":"left"},transformOrigin:S?Gl:Kl,slots:{paper:L,root:x.root},slotProps:{root:B,paper:j},open:m,ref:t,transitionDuration:y,TransitionProps:(0,l.A)({onEntering:(e,t)=>{D.current&&D.current.adjustStyleForScrollbar(e,{direction:S?"rtl":"ltr"}),_&&_(e,t)}},T),ownerState:P},k,{classes:v,children:(0,r.jsx)(Jl,(0,l.A)({onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),g&&g(e,"tabKeyDown"))},actions:D,autoFocus:n&&(-1===M||f),autoFocusItem:C,variant:w},p,{className:(0,d.A)(E.list,p.className),children:o}))}))}));function ec(e){return(0,ke.Ay)("MuiNativeSelect",e)}const tc=(0,w.A)("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),ic=["className","disabled","error","IconComponent","inputRef","variant"],rc=({ownerState:e,theme:t})=>(0,l.A)({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":(0,l.A)({},t.vars?{backgroundColor:`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:"light"===t.palette.mode?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${tc.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},"filled"===e.variant&&{"&&&":{paddingRight:32}},"outlined"===e.variant&&{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}),ac=(0,L.Ay)("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Cn.A,overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.select,t[i.variant],i.error&&t.error,{[`&.${tc.multiple}`]:t.multiple}]}})(rc),sc=({ownerState:e,theme:t})=>(0,l.A)({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${tc.disabled}`]:{color:(t.vars||t).palette.action.disabled}},e.open&&{transform:"rotate(180deg)"},"filled"===e.variant&&{right:7},"outlined"===e.variant&&{right:7}),nc=(0,L.Ay)("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.icon,i.variant&&t[`icon${(0,qe.A)(i.variant)}`],i.open&&t.iconOpen]}})(sc),oc=h.forwardRef((function(e,t){const{className:i,disabled:a,error:s,IconComponent:n,inputRef:o,variant:u="standard"}=e,f=(0,c.A)(e,ic),p=(0,l.A)({},e,{disabled:a,variant:u,error:s}),g=(e=>{const{classes:t,variant:i,disabled:r,multiple:a,open:s,error:n}=e,o={select:["select",i,r&&"disabled",a&&"multiple",n&&"error"],icon:["icon",`icon${(0,qe.A)(i)}`,s&&"iconOpen",r&&"disabled"]};return(0,R.A)(o,ec,t)})(p);return(0,r.jsxs)(h.Fragment,{children:[(0,r.jsx)(ac,(0,l.A)({ownerState:p,className:(0,d.A)(g.select,i),disabled:a,ref:o||t},f)),e.multiple?null:(0,r.jsx)(nc,{as:n,ownerState:p,className:g.icon})]})}));function lc(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function cc(e,t=!1){return e&&(lc(e.value)&&""!==e.value||t&&lc(e.defaultValue)&&""!==e.defaultValue)}var hc=i(4438),uc=i(1381);function dc(e){return(0,ke.Ay)("MuiSelect",e)}const fc=(0,w.A)("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var pc;const gc=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],mc=(0,L.Ay)("div",{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[{[`&.${fc.select}`]:t.select},{[`&.${fc.select}`]:t[i.variant]},{[`&.${fc.error}`]:t.error},{[`&.${fc.multiple}`]:t.multiple}]}})(rc,{[`&.${fc.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),bc=(0,L.Ay)("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.icon,i.variant&&t[`icon${(0,qe.A)(i.variant)}`],i.open&&t.iconOpen]}})(sc),vc=(0,L.Ay)("input",{shouldForwardProp:e=>(0,hc.A)(e)&&"classes"!==e,name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function yc(e,t){return"object"==typeof t&&null!==t?e===t:String(e)===String(t)}function _c(e){return null==e||"string"==typeof e&&!e.trim()}const wc=h.forwardRef((function(e,t){var i;const{"aria-describedby":a,"aria-label":s,autoFocus:n,autoWidth:o,children:u,className:f,defaultOpen:p,defaultValue:g,disabled:m,displayEmpty:b,error:v=!1,IconComponent:y,inputRef:_,labelId:w,MenuProps:x={},multiple:A,name:T,onBlur:k,onChange:S,onClose:P,onFocus:E,onOpen:C,open:D,readOnly:O,renderValue:M,SelectDisplayProps:I={},tabIndex:L,value:F,variant:N="standard"}=e,B=(0,c.A)(e,gc),[j,z]=(0,uc.A)({controlled:F,default:g,name:"Select"}),[U,H]=(0,uc.A)({controlled:D,default:p,name:"Select"}),W=h.useRef(null),V=h.useRef(null),[$,X]=h.useState(null),{current:Y}=h.useRef(null!=D),[G,K]=h.useState(),q=(0,J.A)(t,_),Z=h.useCallback((e=>{V.current=e,e&&X(e)}),[]),Q=null==$?void 0:$.parentNode;h.useImperativeHandle(q,(()=>({focus:()=>{V.current.focus()},node:W.current,value:j})),[j]),h.useEffect((()=>{p&&U&&$&&!Y&&(K(o?null:Q.clientWidth),V.current.focus())}),[$,o]),h.useEffect((()=>{n&&V.current.focus()}),[n]),h.useEffect((()=>{if(!w)return;const e=(0,Be.A)(V.current).getElementById(w);if(e){const t=()=>{getSelection().isCollapsed&&V.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}}),[w]);const ee=(e,t)=>{e?C&&C(t):P&&P(t),Y||(K(o?null:Q.clientWidth),H(e))},te=h.Children.toArray(u),ie=e=>t=>{let i;if(t.currentTarget.hasAttribute("tabindex")){if(A){i=Array.isArray(j)?j.slice():[];const t=j.indexOf(e.props.value);-1===t?i.push(e.props.value):i.splice(t,1)}else i=e.props.value;if(e.props.onClick&&e.props.onClick(t),j!==i&&(z(i),S)){const r=t.nativeEvent||t,a=new r.constructor(r.type,r);Object.defineProperty(a,"target",{writable:!0,value:{value:i,name:T}}),S(a,e)}A||ee(!1,t)}},re=null!==$&&U;let ae,se;delete B["aria-invalid"];const ne=[];let oe=!1,le=!1;(cc({value:j})||b)&&(M?ae=M(j):oe=!0);const ce=te.map((e=>{if(!h.isValidElement(e))return null;let t;if(A){if(!Array.isArray(j))throw new Error((0,ko.A)(2));t=j.some((t=>yc(t,e.props.value))),t&&oe&&ne.push(e.props.children)}else t=yc(j,e.props.value),t&&oe&&(se=e.props.children);return t&&(le=!0),h.cloneElement(e,{"aria-selected":t?"true":"false",onClick:ie(e),onKeyUp:t=>{" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:t,value:void 0,"data-value":e.props.value})}));oe&&(ae=A?0===ne.length?null:ne.reduce(((e,t,i)=>(e.push(t),i<ne.length-1&&e.push(", "),e)),[]):se);let he,ue=G;!o&&Y&&$&&(ue=Q.clientWidth),he=void 0!==L?L:m?null:0;const de=I.id||(T?`mui-component-select-${T}`:void 0),fe=(0,l.A)({},e,{variant:N,value:j,open:re,error:v}),pe=(e=>{const{classes:t,variant:i,disabled:r,multiple:a,open:s,error:n}=e,o={select:["select",i,r&&"disabled",a&&"multiple",n&&"error"],icon:["icon",`icon${(0,qe.A)(i)}`,s&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return(0,R.A)(o,dc,t)})(fe),ge=(0,l.A)({},x.PaperProps,null==(i=x.slotProps)?void 0:i.paper),me=(0,So.A)();return(0,r.jsxs)(h.Fragment,{children:[(0,r.jsx)(mc,(0,l.A)({ref:Z,tabIndex:he,role:"combobox","aria-controls":me,"aria-disabled":m?"true":void 0,"aria-expanded":re?"true":"false","aria-haspopup":"listbox","aria-label":s,"aria-labelledby":[w,de].filter(Boolean).join(" ")||void 0,"aria-describedby":a,onKeyDown:e=>{O||-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),ee(!0,e))},onMouseDown:m||O?null:e=>{0===e.button&&(e.preventDefault(),V.current.focus(),ee(!0,e))},onBlur:e=>{!re&&k&&(Object.defineProperty(e,"target",{writable:!0,value:{value:j,name:T}}),k(e))},onFocus:E},I,{ownerState:fe,className:(0,d.A)(I.className,pe.select,f),id:de,children:_c(ae)?pc||(pc=(0,r.jsx)("span",{className:"notranslate",children:"​"})):ae})),(0,r.jsx)(vc,(0,l.A)({"aria-invalid":v,value:Array.isArray(j)?j.join(","):j,name:T,ref:W,"aria-hidden":!0,onChange:e=>{const t=te.find((t=>t.props.value===e.target.value));void 0!==t&&(z(t.props.value),S&&S(e,t))},tabIndex:-1,disabled:m,className:pe.nativeInput,autoFocus:n,ownerState:fe},B)),(0,r.jsx)(bc,{as:y,className:pe.icon,ownerState:fe}),(0,r.jsx)(Ql,(0,l.A)({id:`menu-${T||""}`,anchorEl:Q,open:re,onClose:e=>{ee(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},x,{MenuListProps:(0,l.A)({"aria-labelledby":w,role:"listbox","aria-multiselectable":A?"true":void 0,disableListWrap:!0,id:me},x.MenuListProps),slotProps:(0,l.A)({},x.slotProps,{paper:(0,l.A)({},ge,{style:(0,l.A)({minWidth:ue},null!=ge?ge.style:null)})}),children:ce}))]})}));function xc({props:e,states:t,muiFormControl:i}){return t.reduce(((t,r)=>(t[r]=e[r],i&&void 0===e[r]&&(t[r]=i[r]),t)),{})}const Ac=h.createContext(void 0);function Tc(){return h.useContext(Ac)}const kc=(0,K.A)((0,r.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown");var Sc=i(4705);const Pc=["onChange","maxRows","minRows","style","value"];function Ec(e){return parseInt(e,10)||0}const Cc={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"},Dc=h.forwardRef((function(e,t){const{onChange:i,maxRows:a,minRows:s=1,style:n,value:o}=e,u=(0,c.A)(e,Pc),{current:d}=h.useRef(null!=o),f=h.useRef(null),p=(0,S.A)(t,f),g=h.useRef(null),m=h.useCallback((()=>{const t=f.current,i=(0,ol.A)(t).getComputedStyle(t);if("0px"===i.width)return{outerHeightStyle:0,overflowing:!1};const r=g.current;r.style.width=i.width,r.value=t.value||e.placeholder||"x","\n"===r.value.slice(-1)&&(r.value+=" ");const n=i.boxSizing,o=Ec(i.paddingBottom)+Ec(i.paddingTop),l=Ec(i.borderBottomWidth)+Ec(i.borderTopWidth),c=r.scrollHeight;r.value="x";const h=r.scrollHeight;let u=c;return s&&(u=Math.max(Number(s)*h,u)),a&&(u=Math.min(Number(a)*h,u)),u=Math.max(u,h),{outerHeightStyle:u+("border-box"===n?o+l:0),overflowing:Math.abs(u-c)<=1}}),[a,s,e.placeholder]),b=h.useCallback((()=>{const e=m();if(null==(t=e)||0===Object.keys(t).length||0===t.outerHeightStyle&&!t.overflowing)return;var t;const i=f.current;i.style.height=`${e.outerHeightStyle}px`,i.style.overflow=e.overflowing?"hidden":""}),[m]);return(0,bl.A)((()=>{const e=()=>{b()};const t=(0,Sc.A)(e),i=f.current,r=(0,ol.A)(i);let a;return r.addEventListener("resize",t),"undefined"!=typeof ResizeObserver&&(a=new ResizeObserver(e),a.observe(i)),()=>{t.clear(),cancelAnimationFrame(undefined),r.removeEventListener("resize",t),a&&a.disconnect()}}),[m,b]),(0,bl.A)((()=>{b()})),(0,r.jsxs)(h.Fragment,{children:[(0,r.jsx)("textarea",(0,l.A)({value:o,onChange:e=>{d||b(),i&&i(e)},ref:p,rows:s,style:n},u)),(0,r.jsx)("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:g,tabIndex:-1,style:(0,l.A)({},Cc,n,{paddingTop:0,paddingBottom:0})})]})}));var Oc=i(9940);const Rc=function({styles:e,themeId:t,defaultTheme:i={}}){const a=(0,m.A)(i),s="function"==typeof e?e(t&&a[t]||a):e;return(0,r.jsx)(Oc.A,{styles:s})},Mc=function(e){return(0,r.jsx)(Rc,(0,l.A)({},e,{defaultTheme:N.A,themeId:_.A}))};function Ic(e){return(0,ke.Ay)("MuiInputBase",e)}const Lc=(0,w.A)("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),Fc=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],Nc=(e,t)=>{const{ownerState:i}=e;return[t.root,i.formControl&&t.formControl,i.startAdornment&&t.adornedStart,i.endAdornment&&t.adornedEnd,i.error&&t.error,"small"===i.size&&t.sizeSmall,i.multiline&&t.multiline,i.color&&t[`color${(0,qe.A)(i.color)}`],i.fullWidth&&t.fullWidth,i.hiddenLabel&&t.hiddenLabel]},Bc=(e,t)=>{const{ownerState:i}=e;return[t.input,"small"===i.size&&t.inputSizeSmall,i.multiline&&t.inputMultiline,"search"===i.type&&t.inputTypeSearch,i.startAdornment&&t.inputAdornedStart,i.endAdornment&&t.inputAdornedEnd,i.hiddenLabel&&t.inputHiddenLabel]},jc=(0,L.Ay)("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Nc})((({theme:e,ownerState:t})=>(0,l.A)({},e.typography.body1,{color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Lc.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"}},t.multiline&&(0,l.A)({padding:"4px 0 5px"},"small"===t.size&&{paddingTop:1}),t.fullWidth&&{width:"100%"}))),zc=(0,L.Ay)("input",{name:"MuiInputBase",slot:"Input",overridesResolver:Bc})((({theme:e,ownerState:t})=>{const i="light"===e.palette.mode,r=(0,l.A)({color:"currentColor"},e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:i?.42:.5},{transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})}),a={opacity:"0 !important"},s=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:i?.42:.5};return(0,l.A)({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Lc.formControl} &`]:{"&::-webkit-input-placeholder":a,"&::-moz-placeholder":a,"&:-ms-input-placeholder":a,"&::-ms-input-placeholder":a,"&:focus::-webkit-input-placeholder":s,"&:focus::-moz-placeholder":s,"&:focus:-ms-input-placeholder":s,"&:focus::-ms-input-placeholder":s},[`&.${Lc.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},"small"===t.size&&{paddingTop:1},t.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===t.type&&{MozAppearance:"textfield"})})),Uc=(0,r.jsx)(Mc,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),Hc=h.forwardRef((function(e,t){var i;const a=(0,F.A)({props:e,name:"MuiInputBase"}),{"aria-describedby":s,autoComplete:n,autoFocus:o,className:u,components:f={},componentsProps:p={},defaultValue:g,disabled:m,disableInjectingGlobalStyles:b,endAdornment:v,fullWidth:y=!1,id:_,inputComponent:w="input",inputProps:x={},inputRef:A,maxRows:T,minRows:k,multiline:S=!1,name:E,onBlur:C,onChange:D,onClick:O,onFocus:M,onKeyDown:I,onKeyUp:L,placeholder:N,readOnly:B,renderSuffix:j,rows:z,slotProps:U={},slots:H={},startAdornment:W,type:$="text",value:X}=a,Y=(0,c.A)(a,Fc),G=null!=x.value?x.value:X,{current:K}=h.useRef(null!=G),q=h.useRef(),Z=h.useCallback((e=>{}),[]),Q=(0,J.A)(q,A,x.ref,Z),[ee,te]=h.useState(!1),ie=Tc(),re=xc({props:a,muiFormControl:ie,states:["color","disabled","error","hiddenLabel","size","required","filled"]});re.focused=ie?ie.focused:ee,h.useEffect((()=>{!ie&&m&&ee&&(te(!1),C&&C())}),[ie,m,ee,C]);const ae=ie&&ie.onFilled,se=ie&&ie.onEmpty,ne=h.useCallback((e=>{cc(e)?ae&&ae():se&&se()}),[ae,se]);(0,V.A)((()=>{K&&ne({value:G})}),[G,ne,K]),h.useEffect((()=>{ne(q.current)}),[]);let oe=w,le=x;S&&"input"===oe&&(le=z?(0,l.A)({type:void 0,minRows:z,maxRows:z},le):(0,l.A)({type:void 0,maxRows:T,minRows:k},le),oe=Dc),h.useEffect((()=>{ie&&ie.setAdornedStart(Boolean(W))}),[ie,W]);const ce=(0,l.A)({},a,{color:re.color||"primary",disabled:re.disabled,endAdornment:v,error:re.error,focused:re.focused,formControl:ie,fullWidth:y,hiddenLabel:re.hiddenLabel,multiline:S,size:re.size,startAdornment:W,type:$}),he=(e=>{const{classes:t,color:i,disabled:r,error:a,endAdornment:s,focused:n,formControl:o,fullWidth:l,hiddenLabel:c,multiline:h,readOnly:u,size:d,startAdornment:f,type:p}=e,g={root:["root",`color${(0,qe.A)(i)}`,r&&"disabled",a&&"error",l&&"fullWidth",n&&"focused",o&&"formControl",d&&"medium"!==d&&`size${(0,qe.A)(d)}`,h&&"multiline",f&&"adornedStart",s&&"adornedEnd",c&&"hiddenLabel",u&&"readOnly"],input:["input",r&&"disabled","search"===p&&"inputTypeSearch",h&&"inputMultiline","small"===d&&"inputSizeSmall",c&&"inputHiddenLabel",f&&"inputAdornedStart",s&&"inputAdornedEnd",u&&"readOnly"]};return(0,R.A)(g,Ic,t)})(ce),ue=H.root||f.Root||jc,de=U.root||p.root||{},fe=H.input||f.Input||zc;return le=(0,l.A)({},le,null!=(i=U.input)?i:p.input),(0,r.jsxs)(h.Fragment,{children:[!b&&Uc,(0,r.jsxs)(ue,(0,l.A)({},de,!P(ue)&&{ownerState:(0,l.A)({},ce,de.ownerState)},{ref:t,onClick:e=>{q.current&&e.currentTarget===e.target&&q.current.focus(),O&&O(e)}},Y,{className:(0,d.A)(he.root,de.className,u,B&&"MuiInputBase-readOnly"),children:[W,(0,r.jsx)(Ac.Provider,{value:null,children:(0,r.jsx)(fe,(0,l.A)({ownerState:ce,"aria-invalid":re.error,"aria-describedby":s,autoComplete:n,autoFocus:o,defaultValue:g,disabled:re.disabled,id:_,onAnimationStart:e=>{ne("mui-auto-fill-cancel"===e.animationName?q.current:{value:"x"})},name:E,placeholder:N,readOnly:B,required:re.required,rows:z,value:G,onKeyDown:I,onKeyUp:L,type:$},le,!P(fe)&&{as:oe,ownerState:(0,l.A)({},ce,le.ownerState)},{ref:Q,className:(0,d.A)(he.input,le.className,B&&"MuiInputBase-readOnly"),onBlur:e=>{C&&C(e),x.onBlur&&x.onBlur(e),ie&&ie.onBlur?ie.onBlur(e):te(!1)},onChange:(e,...t)=>{if(!K){const t=e.target||q.current;if(null==t)throw new Error((0,ko.A)(1));ne({value:t.value})}x.onChange&&x.onChange(e,...t),D&&D(e,...t)},onFocus:e=>{re.disabled?e.stopPropagation():(M&&M(e),x.onFocus&&x.onFocus(e),ie&&ie.onFocus?ie.onFocus(e):te(!0))}}))}),v,j?j((0,l.A)({},re,{startAdornment:W})):null]}))]})})),Wc=Hc;function Vc(e){return(0,ke.Ay)("MuiInput",e)}const $c=(0,l.A)({},Lc,(0,w.A)("MuiInput",["root","underline","input"])),Xc=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],Yc=(0,L.Ay)(jc,{shouldForwardProp:e=>(0,Cn.A)(e)||"classes"===e,name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[...Nc(e,t),!i.disableUnderline&&t.underline]}})((({theme:e,ownerState:t})=>{let i="light"===e.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(i=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),(0,l.A)({position:"relative"},t.formControl&&{"label + &":{marginTop:16}},!t.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[t.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${$c.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${$c.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${i}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${$c.disabled}, .${$c.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${i}`}},[`&.${$c.disabled}:before`]:{borderBottomStyle:"dotted"}})})),Gc=(0,L.Ay)(zc,{name:"MuiInput",slot:"Input",overridesResolver:Bc})({}),Kc=h.forwardRef((function(e,t){var i,a,s,n;const o=(0,F.A)({props:e,name:"MuiInput"}),{disableUnderline:h,components:u={},componentsProps:d,fullWidth:f=!1,inputComponent:p="input",multiline:g=!1,slotProps:m,slots:b={},type:v="text"}=o,y=(0,c.A)(o,Xc),_=(e=>{const{classes:t,disableUnderline:i}=e,r={root:["root",!i&&"underline"],input:["input"]},a=(0,R.A)(r,Vc,t);return(0,l.A)({},t,a)})(o),w={root:{ownerState:{disableUnderline:h}}},x=(null!=m?m:d)?(0,To.A)(null!=m?m:d,w):w,A=null!=(i=null!=(a=b.root)?a:u.Root)?i:Yc,T=null!=(s=null!=(n=b.input)?n:u.Input)?s:Gc;return(0,r.jsx)(Wc,(0,l.A)({slots:{root:A,input:T},slotProps:x,fullWidth:f,inputComponent:p,multiline:g,ref:t,type:v},y,{classes:_}))}));Kc.muiName="Input";const qc=Kc;function Zc(e){return(0,ke.Ay)("MuiFilledInput",e)}const Jc=(0,l.A)({},Lc,(0,w.A)("MuiFilledInput",["root","underline","input"])),Qc=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],eh=(0,L.Ay)(jc,{shouldForwardProp:e=>(0,Cn.A)(e)||"classes"===e,name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[...Nc(e,t),!i.disableUnderline&&t.underline]}})((({theme:e,ownerState:t})=>{var i;const r="light"===e.palette.mode,a=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",s=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",n=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",o=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return(0,l.A)({position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:s,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:n,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:s}},[`&.${Jc.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:s},[`&.${Jc.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:o}},!t.disableUnderline&&{"&::after":{borderBottom:`2px solid ${null==(i=(e.vars||e).palette[t.color||"primary"])?void 0:i.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Jc.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Jc.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:a}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Jc.disabled}, .${Jc.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${Jc.disabled}:before`]:{borderBottomStyle:"dotted"}},t.startAdornment&&{paddingLeft:12},t.endAdornment&&{paddingRight:12},t.multiline&&(0,l.A)({padding:"25px 12px 8px"},"small"===t.size&&{paddingTop:21,paddingBottom:4},t.hiddenLabel&&{paddingTop:16,paddingBottom:17},t.hiddenLabel&&"small"===t.size&&{paddingTop:8,paddingBottom:9}))})),th=(0,L.Ay)(zc,{name:"MuiFilledInput",slot:"Input",overridesResolver:Bc})((({theme:e,ownerState:t})=>(0,l.A)({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===e.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===e.palette.mode?null:"#fff",caretColor:"light"===e.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===t.size&&{paddingTop:21,paddingBottom:4},t.hiddenLabel&&{paddingTop:16,paddingBottom:17},t.startAdornment&&{paddingLeft:0},t.endAdornment&&{paddingRight:0},t.hiddenLabel&&"small"===t.size&&{paddingTop:8,paddingBottom:9},t.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}))),ih=h.forwardRef((function(e,t){var i,a,s,n;const o=(0,F.A)({props:e,name:"MuiFilledInput"}),{components:h={},componentsProps:u,fullWidth:d=!1,inputComponent:f="input",multiline:p=!1,slotProps:g,slots:m={},type:b="text"}=o,v=(0,c.A)(o,Qc),y=(0,l.A)({},o,{fullWidth:d,inputComponent:f,multiline:p,type:b}),_=(e=>{const{classes:t,disableUnderline:i}=e,r={root:["root",!i&&"underline"],input:["input"]},a=(0,R.A)(r,Zc,t);return(0,l.A)({},t,a)})(o),w={root:{ownerState:y},input:{ownerState:y}},x=(null!=g?g:u)?(0,To.A)(w,null!=g?g:u):w,A=null!=(i=null!=(a=m.root)?a:h.Root)?i:eh,T=null!=(s=null!=(n=m.input)?n:h.Input)?s:th;return(0,r.jsx)(Wc,(0,l.A)({slots:{root:A,input:T},componentsProps:x,fullWidth:d,inputComponent:f,multiline:p,ref:t,type:b},v,{classes:_}))}));ih.muiName="Input";const rh=ih;var ah;const sh=["children","classes","className","label","notched"],nh=(0,L.Ay)("fieldset",{shouldForwardProp:Cn.A})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),oh=(0,L.Ay)("legend",{shouldForwardProp:Cn.A})((({ownerState:e,theme:t})=>(0,l.A)({float:"unset",width:"auto",overflow:"hidden"},!e.withLabel&&{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})},e.withLabel&&(0,l.A)({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},e.notched&&{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}))));function lh(e){return(0,ke.Ay)("MuiOutlinedInput",e)}const ch=(0,l.A)({},Lc,(0,w.A)("MuiOutlinedInput",["root","notchedOutline","input"])),hh=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],uh=(0,L.Ay)(jc,{shouldForwardProp:e=>(0,Cn.A)(e)||"classes"===e,name:"MuiOutlinedInput",slot:"Root",overridesResolver:Nc})((({theme:e,ownerState:t})=>{const i="light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return(0,l.A)({position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${ch.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${ch.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:i}},[`&.${ch.focused} .${ch.notchedOutline}`]:{borderColor:(e.vars||e).palette[t.color].main,borderWidth:2},[`&.${ch.error} .${ch.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${ch.disabled} .${ch.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}},t.startAdornment&&{paddingLeft:14},t.endAdornment&&{paddingRight:14},t.multiline&&(0,l.A)({padding:"16.5px 14px"},"small"===t.size&&{padding:"8.5px 14px"}))})),dh=(0,L.Ay)((function(e){const{className:t,label:i,notched:a}=e,s=(0,c.A)(e,sh),n=null!=i&&""!==i,o=(0,l.A)({},e,{notched:a,withLabel:n});return(0,r.jsx)(nh,(0,l.A)({"aria-hidden":!0,className:t,ownerState:o},s,{children:(0,r.jsx)(oh,{ownerState:o,children:n?(0,r.jsx)("span",{children:i}):ah||(ah=(0,r.jsx)("span",{className:"notranslate",children:"​"}))})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})((({theme:e})=>{const t="light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:t}})),fh=(0,L.Ay)(zc,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:Bc})((({theme:e,ownerState:t})=>(0,l.A)({padding:"16.5px 14px"},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===e.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===e.palette.mode?null:"#fff",caretColor:"light"===e.palette.mode?null:"#fff",borderRadius:"inherit"}},e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===t.size&&{padding:"8.5px 14px"},t.multiline&&{padding:0},t.startAdornment&&{paddingLeft:0},t.endAdornment&&{paddingRight:0}))),ph=h.forwardRef((function(e,t){var i,a,s,n,o;const u=(0,F.A)({props:e,name:"MuiOutlinedInput"}),{components:d={},fullWidth:f=!1,inputComponent:p="input",label:g,multiline:m=!1,notched:b,slots:v={},type:y="text"}=u,_=(0,c.A)(u,hh),w=(e=>{const{classes:t}=e,i=(0,R.A)({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},lh,t);return(0,l.A)({},t,i)})(u),x=Tc(),A=xc({props:u,muiFormControl:x,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),T=(0,l.A)({},u,{color:A.color||"primary",disabled:A.disabled,error:A.error,focused:A.focused,formControl:x,fullWidth:f,hiddenLabel:A.hiddenLabel,multiline:m,size:A.size,type:y}),k=null!=(i=null!=(a=v.root)?a:d.Root)?i:uh,S=null!=(s=null!=(n=v.input)?n:d.Input)?s:fh;return(0,r.jsx)(Wc,(0,l.A)({slots:{root:k,input:S},renderSuffix:e=>(0,r.jsx)(dh,{ownerState:T,className:w.notchedOutline,label:null!=g&&""!==g&&A.required?o||(o=(0,r.jsxs)(h.Fragment,{children:[g," ","*"]})):g,notched:void 0!==b?b:Boolean(e.startAdornment||e.filled||e.focused)}),fullWidth:f,inputComponent:p,multiline:m,ref:t,type:y},_,{classes:(0,l.A)({},w,{notchedOutline:null})}))}));ph.muiName="Input";const gh=ph,mh=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],bh=["root"],vh={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>(0,Cn.A)(e)&&"variant"!==e,slot:"Root"},yh=(0,L.Ay)(qc,vh)(""),_h=(0,L.Ay)(gh,vh)(""),wh=(0,L.Ay)(rh,vh)(""),xh=h.forwardRef((function(e,t){const i=(0,F.A)({name:"MuiSelect",props:e}),{autoWidth:a=!1,children:s,classes:n={},className:o,defaultOpen:u=!1,displayEmpty:f=!1,IconComponent:p=kc,id:g,input:m,inputProps:b,label:v,labelId:y,MenuProps:_,multiple:w=!1,native:x=!1,onClose:A,onOpen:T,open:k,renderValue:S,SelectDisplayProps:P,variant:E="outlined"}=i,C=(0,c.A)(i,mh),D=x?oc:wc,O=xc({props:i,muiFormControl:Tc(),states:["variant","error"]}),R=O.variant||E,M=(0,l.A)({},i,{variant:R,classes:n}),I=(e=>{const{classes:t}=e;return t})(M),L=(0,c.A)(I,bh),N=m||{standard:(0,r.jsx)(yh,{ownerState:M}),outlined:(0,r.jsx)(_h,{label:v,ownerState:M}),filled:(0,r.jsx)(wh,{ownerState:M})}[R],B=(0,J.A)(t,N.ref);return(0,r.jsx)(h.Fragment,{children:h.cloneElement(N,(0,l.A)({inputComponent:D,inputProps:(0,l.A)({children:s,error:O.error,IconComponent:p,variant:R,type:void 0,multiple:w},x?{id:g}:{autoWidth:a,defaultOpen:u,displayEmpty:f,labelId:y,MenuProps:_,onClose:A,onOpen:T,open:k,renderValue:S,SelectDisplayProps:(0,l.A)({id:g},P)},b,{classes:b?(0,To.A)(L,b.classes):L},m?m.props.inputProps:{})},(w&&x||f)&&"outlined"===R?{notched:!0}:{},{ref:B,className:(0,d.A)(N.props.className,o,I.root)},!m&&{variant:R},C))})}));xh.muiName="Select";const Ah=xh,Th=(0,w.A)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),kh=(0,w.A)("MuiListItemIcon",["root","alignItemsFlexStart"]),Sh=(0,w.A)("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function Ph(e){return(0,ke.Ay)("MuiMenuItem",e)}const Eh=(0,w.A)("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Ch=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Dh=(0,L.Ay)(De,{shouldForwardProp:e=>(0,Cn.A)(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.dense&&t.dense,i.divider&&t.divider,!i.disableGutters&&t.gutters]}})((({theme:e,ownerState:t})=>(0,l.A)({},e.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!t.disableGutters&&{paddingLeft:16,paddingRight:16},t.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Eh.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:(0,cn.X4)(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${Eh.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:(0,cn.X4)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${Eh.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:(0,cn.X4)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:(0,cn.X4)(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${Eh.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${Eh.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${Th.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${Th.inset}`]:{marginLeft:52},[`& .${Sh.root}`]:{marginTop:0,marginBottom:0},[`& .${Sh.inset}`]:{paddingLeft:36},[`& .${kh.root}`]:{minWidth:36}},!t.dense&&{[e.breakpoints.up("sm")]:{minHeight:"auto"}},t.dense&&(0,l.A)({minHeight:32,paddingTop:4,paddingBottom:4},e.typography.body2,{[`& .${kh.root} svg`]:{fontSize:"1.25rem"}})))),Oh=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiMenuItem"}),{autoFocus:a=!1,component:s="li",dense:n=!1,divider:o=!1,disableGutters:u=!1,focusVisibleClassName:f,role:p="menuitem",tabIndex:g,className:m}=i,b=(0,c.A)(i,Ch),v=h.useContext(Po),y=h.useMemo((()=>({dense:n||v.dense||!1,disableGutters:u})),[v.dense,n,u]),_=h.useRef(null);(0,V.A)((()=>{a&&_.current&&_.current.focus()}),[a]);const w=(0,l.A)({},i,{dense:y.dense,divider:o,disableGutters:u}),x=(e=>{const{disabled:t,dense:i,divider:r,disableGutters:a,selected:s,classes:n}=e,o={root:["root",i&&"dense",t&&"disabled",!a&&"gutters",r&&"divider",s&&"selected"]},c=(0,R.A)(o,Ph,n);return(0,l.A)({},n,c)})(i),A=(0,J.A)(_,t);let T;return i.disabled||(T=void 0!==g?g:-1),(0,r.jsx)(Po.Provider,{value:y,children:(0,r.jsx)(Dh,(0,l.A)({ref:A,role:p,tabIndex:T,component:s,focusVisibleClassName:(0,d.A)(x.focusVisible,f),className:(0,d.A)(x.root,m)},b,{ownerState:w,classes:x}))})}));function Rh(e){return(0,ke.Ay)("MuiFormLabel",e)}const Mh=(0,w.A)("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Ih=["children","className","color","component","disabled","error","filled","focused","required"],Lh=(0,L.Ay)("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:e},t)=>(0,l.A)({},t.root,"secondary"===e.color&&t.colorSecondary,e.filled&&t.filled)})((({theme:e,ownerState:t})=>(0,l.A)({color:(e.vars||e).palette.text.secondary},e.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${Mh.focused}`]:{color:(e.vars||e).palette[t.color].main},[`&.${Mh.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${Mh.error}`]:{color:(e.vars||e).palette.error.main}}))),Fh=(0,L.Ay)("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((({theme:e})=>({[`&.${Mh.error}`]:{color:(e.vars||e).palette.error.main}}))),Nh=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiFormLabel"}),{children:a,className:s,component:n="label"}=i,o=(0,c.A)(i,Ih),h=xc({props:i,muiFormControl:Tc(),states:["color","required","focused","disabled","error","filled"]}),u=(0,l.A)({},i,{color:h.color||"primary",component:n,disabled:h.disabled,error:h.error,filled:h.filled,focused:h.focused,required:h.required}),f=(e=>{const{classes:t,color:i,focused:r,disabled:a,error:s,filled:n,required:o}=e,l={root:["root",`color${(0,qe.A)(i)}`,a&&"disabled",s&&"error",n&&"filled",r&&"focused",o&&"required"],asterisk:["asterisk",s&&"error"]};return(0,R.A)(l,Rh,t)})(u);return(0,r.jsxs)(Lh,(0,l.A)({as:n,ownerState:u,className:(0,d.A)(f.root,s),ref:t},o,{children:[a,h.required&&(0,r.jsxs)(Fh,{ownerState:u,"aria-hidden":!0,className:f.asterisk,children:[" ","*"]})]}))})),Bh=Nh;function jh(e){return(0,ke.Ay)("MuiInputLabel",e)}(0,w.A)("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const zh=["disableAnimation","margin","shrink","variant","className"],Uh=(0,L.Ay)(Bh,{shouldForwardProp:e=>(0,Cn.A)(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[{[`& .${Mh.asterisk}`]:t.asterisk},t.root,i.formControl&&t.formControl,"small"===i.size&&t.sizeSmall,i.shrink&&t.shrink,!i.disableAnimation&&t.animated,i.focused&&t.focused,t[i.variant]]}})((({theme:e,ownerState:t})=>(0,l.A)({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},t.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===t.size&&{transform:"translate(0, 17px) scale(1)"},t.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!t.disableAnimation&&{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})},"filled"===t.variant&&(0,l.A)({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===t.size&&{transform:"translate(12px, 13px) scale(1)"},t.shrink&&(0,l.A)({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===t.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===t.variant&&(0,l.A)({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===t.size&&{transform:"translate(14px, 9px) scale(1)"},t.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"})))),Hh=h.forwardRef((function(e,t){const i=(0,F.A)({name:"MuiInputLabel",props:e}),{disableAnimation:a=!1,shrink:s,className:n}=i,o=(0,c.A)(i,zh),h=Tc();let u=s;void 0===u&&h&&(u=h.filled||h.focused||h.adornedStart);const f=xc({props:i,muiFormControl:h,states:["size","variant","required","focused"]}),p=(0,l.A)({},i,{disableAnimation:a,formControl:h,shrink:u,size:f.size,variant:f.variant,required:f.required,focused:f.focused}),g=(e=>{const{classes:t,formControl:i,size:r,shrink:a,disableAnimation:s,variant:n,required:o}=e,c={root:["root",i&&"formControl",!s&&"animated",a&&"shrink",r&&"normal"!==r&&`size${(0,qe.A)(r)}`,n],asterisk:[o&&"asterisk"]},h=(0,R.A)(c,jh,t);return(0,l.A)({},t,h)})(p);return(0,r.jsx)(Uh,(0,l.A)({"data-shrink":u,ownerState:p,ref:t,className:(0,d.A)(g.root,n)},o,{classes:g}))}));var Wh=i(8593);function Vh(e){return(0,ke.Ay)("MuiFormControl",e)}(0,w.A)("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const $h=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Xh=(0,L.Ay)("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:e},t)=>(0,l.A)({},t.root,t[`margin${(0,qe.A)(e.margin)}`],e.fullWidth&&t.fullWidth)})((({ownerState:e})=>(0,l.A)({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},"normal"===e.margin&&{marginTop:16,marginBottom:8},"dense"===e.margin&&{marginTop:8,marginBottom:4},e.fullWidth&&{width:"100%"}))),Yh=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiFormControl"}),{children:a,className:s,color:n="primary",component:o="div",disabled:u=!1,error:f=!1,focused:p,fullWidth:g=!1,hiddenLabel:m=!1,margin:b="none",required:v=!1,size:y="medium",variant:_="outlined"}=i,w=(0,c.A)(i,$h),x=(0,l.A)({},i,{color:n,component:o,disabled:u,error:f,fullWidth:g,hiddenLabel:m,margin:b,required:v,size:y,variant:_}),A=(e=>{const{classes:t,margin:i,fullWidth:r}=e,a={root:["root","none"!==i&&`margin${(0,qe.A)(i)}`,r&&"fullWidth"]};return(0,R.A)(a,Vh,t)})(x),[T,k]=h.useState((()=>{let e=!1;return a&&h.Children.forEach(a,(t=>{if(!(0,Wh.A)(t,["Input","Select"]))return;const i=(0,Wh.A)(t,["Select"])?t.props.input:t;i&&i.props.startAdornment&&(e=!0)})),e})),[S,P]=h.useState((()=>{let e=!1;return a&&h.Children.forEach(a,(t=>{(0,Wh.A)(t,["Input","Select"])&&(cc(t.props,!0)||cc(t.props.inputProps,!0))&&(e=!0)})),e})),[E,C]=h.useState(!1);u&&E&&C(!1);const D=void 0===p||u?E:p;let O;const M=h.useMemo((()=>({adornedStart:T,setAdornedStart:k,color:n,disabled:u,error:f,filled:S,focused:D,fullWidth:g,hiddenLabel:m,size:y,onBlur:()=>{C(!1)},onEmpty:()=>{P(!1)},onFilled:()=>{P(!0)},onFocus:()=>{C(!0)},registerEffect:O,required:v,variant:_})),[T,n,u,f,S,D,g,m,O,v,y,_]);return(0,r.jsx)(Ac.Provider,{value:M,children:(0,r.jsx)(Xh,(0,l.A)({as:o,ownerState:x,className:(0,d.A)(A.root,s),ref:t},w,{children:a}))})})),Gh=Yh;function Kh(e){return(0,ke.Ay)("MuiFormHelperText",e)}const qh=(0,w.A)("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var Zh;const Jh=["children","className","component","disabled","error","filled","focused","margin","required","variant"],Qh=(0,L.Ay)("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.size&&t[`size${(0,qe.A)(i.size)}`],i.contained&&t.contained,i.filled&&t.filled]}})((({theme:e,ownerState:t})=>(0,l.A)({color:(e.vars||e).palette.text.secondary},e.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${qh.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${qh.error}`]:{color:(e.vars||e).palette.error.main}},"small"===t.size&&{marginTop:4},t.contained&&{marginLeft:14,marginRight:14}))),eu=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiFormHelperText"}),{children:a,className:s,component:n="p"}=i,o=(0,c.A)(i,Jh),h=xc({props:i,muiFormControl:Tc(),states:["variant","size","disabled","error","filled","focused","required"]}),u=(0,l.A)({},i,{component:n,contained:"filled"===h.variant||"outlined"===h.variant,variant:h.variant,size:h.size,disabled:h.disabled,error:h.error,filled:h.filled,focused:h.focused,required:h.required}),f=(e=>{const{classes:t,contained:i,size:r,disabled:a,error:s,filled:n,focused:o,required:l}=e,c={root:["root",a&&"disabled",s&&"error",r&&`size${(0,qe.A)(r)}`,i&&"contained",o&&"focused",n&&"filled",l&&"required"]};return(0,R.A)(c,Kh,t)})(u);return(0,r.jsx)(Qh,(0,l.A)({as:n,ownerState:u,className:(0,d.A)(f.root,s),ref:t},o,{children:" "===a?Zh||(Zh=(0,r.jsx)("span",{className:"notranslate",children:"​"})):a}))}));function tu(e){return(0,ke.Ay)("MuiTextField",e)}(0,w.A)("MuiTextField",["root"]);const iu=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],ru={standard:qc,filled:rh,outlined:gh},au=(0,L.Ay)(Gh,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),su=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiTextField"}),{autoComplete:a,autoFocus:s=!1,children:n,className:o,color:h="primary",defaultValue:u,disabled:f=!1,error:p=!1,FormHelperTextProps:g,fullWidth:m=!1,helperText:b,id:v,InputLabelProps:y,inputProps:_,InputProps:w,inputRef:x,label:A,maxRows:T,minRows:k,multiline:S=!1,name:P,onBlur:E,onChange:C,onFocus:D,placeholder:O,required:M=!1,rows:I,select:L=!1,SelectProps:N,type:B,value:j,variant:z="outlined"}=i,U=(0,c.A)(i,iu),H=(0,l.A)({},i,{autoFocus:s,color:h,disabled:f,error:p,fullWidth:m,multiline:S,required:M,select:L,variant:z}),W=(e=>{const{classes:t}=e;return(0,R.A)({root:["root"]},tu,t)})(H),V={};"outlined"===z&&(y&&void 0!==y.shrink&&(V.notched=y.shrink),V.label=A),L&&(N&&N.native||(V.id=void 0),V["aria-describedby"]=void 0);const $=(0,So.A)(v),X=b&&$?`${$}-helper-text`:void 0,Y=A&&$?`${$}-label`:void 0,G=ru[z],K=(0,r.jsx)(G,(0,l.A)({"aria-describedby":X,autoComplete:a,autoFocus:s,defaultValue:u,fullWidth:m,multiline:S,name:P,rows:I,maxRows:T,minRows:k,type:B,value:j,id:$,inputRef:x,onBlur:E,onChange:C,onFocus:D,placeholder:O,inputProps:_},V,w));return(0,r.jsxs)(au,(0,l.A)({className:(0,d.A)(W.root,o),disabled:f,error:p,fullWidth:m,ref:t,required:M,color:h,variant:z,ownerState:H},U,{children:[null!=A&&""!==A&&(0,r.jsx)(Hh,(0,l.A)({htmlFor:$,id:Y},y,{children:A})),L?(0,r.jsx)(Ah,(0,l.A)({"aria-describedby":X,id:$,labelId:Y,value:j,input:K},N,{children:n})):K,b&&(0,r.jsx)(eu,(0,l.A)({id:X},g,{children:b}))]}))})),nu=su,ou=({setdesignPanelVisible:e,activeTab:t,setActiveTab:i,mapLeftBorder:a,mapRightBorder:s,chartContainerRef:n,model:o,handleCellChange:l})=>(0,r.jsxs)(pn,{elevation:3,sx:{position:"fixed",bottom:0,left:a,width:s-a,height:"50%",zIndex:10,p:0,borderRadius:"5px",backgroundColor:"#ffffff",boxShadow:"0px 6px 15px rgba(0, 0, 0, 0.15)",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)(wn,{variant:"h6",sx:{fontWeight:"bold",color:"#ffffff",backgroundColor:"#1976d2",px:2,py:1,fontSize:"12px",borderTopLeftRadius:"4px",borderTopRightRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:["Design overzicht",(0,r.jsx)(Pn,{"aria-label":"close",onClick:()=>e(!1),size:"medium",sx:{color:"#ffffff"},children:(0,r.jsx)(on.A,{})})]}),(0,r.jsx)(Ke,{value:o.activeSheet,onChange:(e,t)=>(e=>{const t=o.activeSheet,i=o.chartData?[...o.chartData]:[];o.allChartData[t]=i,o.activeSheet=e;const r=o.allChartData[e]?[...o.allChartData[e]]:[];o.chartData=r,console.log("Switched to sheet:",e,o.chartData)})(t),indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",sx:{flexShrink:0},children:Object.keys(o.allChartData||{}).map((e=>(0,r.jsx)(tt,{label:e,value:e,sx:{fontSize:"11px",backgroundColor:o.activeSheet===e?"#e0e0e0":"#f5f5f5",color:o.activeSheet===e?"#000":"#555","&:hover":{backgroundColor:"#d6d6d6"}}},e)))}),(0,r.jsxs)(Ke,{value:t,onChange:(e,t)=>i(t),indicatorColor:"primary",textColor:"primary",variant:"fullWidth",sx:{flexShrink:0},children:[(0,r.jsx)(tt,{label:"Dwarsprofiel",sx:{fontSize:"11px"}}),(0,r.jsx)(tt,{label:"Invoerdata"})]}),0===t&&(0,r.jsx)(k,{ref:n,sx:{flexGrow:1,width:"100%",overflow:"hidden"}}),1===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k,{sx:{display:"flex",justifyContent:"space-between",padding:"8px",backgroundColor:"#f5f5f5"},children:(0,r.jsx)(zn,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(nn.A,{}),onClick:()=>{o.chartData=[...o.chartData,{locatie:"",afstand:"",hoogte:""}]},children:"Voeg nieuwe rij toe"})}),(0,r.jsx)(Vn,{sx:{flexGrow:1,overflow:"auto"},children:(0,r.jsxs)(qn,{stickyHeader:!0,children:[(0,r.jsx)(ro,{children:(0,r.jsxs)(ho,{children:[o.chartData?.length>0&&Object.keys(o.chartData[0]||{}).map((e=>(0,r.jsx)(bo,{align:"center",sx:{fontSize:"11px"},children:e.charAt(0).toUpperCase()+e.slice(1)},e))),(0,r.jsx)(bo,{align:"center",sx:{fontSize:"11px"},children:"Acties"})]})}),(0,r.jsx)(Ao,{children:o.chartData?.map(((e,t)=>{const i=`afstand-${e.afstand??t}`;return(0,r.jsxs)(ho,{children:[Object.entries(e||{}).map((([e,a],s)=>(0,r.jsx)(bo,{align:"center",children:0===s?(0,r.jsx)(Ah,{value:a,onChange:i=>l(t,e,i.target.value),variant:"outlined",size:"small",fullWidth:!0,children:o.dwpLocations.map((e=>(0,r.jsx)(Oh,{value:e,children:e},e)))}):"string"==typeof a||"number"==typeof a?(0,r.jsx)(nu,{defaultValue:isNaN(a)?"":a,onBlur:i=>l(t,e,i.target.value),variant:"outlined",size:"small"}):(0,r.jsx)("span",{children:"Invalid Data"})},`${i}-${e}`))),(0,r.jsx)(bo,{align:"center",children:(0,r.jsx)(Pn,{color:"error",size:"small",onClick:()=>(e=>{o.chartData=o.chartData.filter(((t,i)=>i!==e))})(t),children:(0,r.jsx)(ln.A,{})})})]},e.id||i)}))})]})},o.activeSheet)]})]}),lu=({setcrossSectionPanelVisible:e,mapLeftBorder:t,mapRightBorder:i,crossSectionChartContainerRef:a,model:s})=>((0,h.useEffect)((()=>(console.log("Component mounted",a.current),()=>{console.log("Component unmounted")})),[a]),(0,r.jsxs)(pn,{elevation:3,sx:{position:"fixed",bottom:0,left:t,width:i-t,height:"50%",zIndex:10,p:0,borderRadius:"5px",backgroundColor:"#ffffff",boxShadow:"0px 6px 15px rgba(0, 0, 0, 0.15)",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)(wn,{variant:"h6",sx:{fontWeight:"bold",color:"#ffffff",backgroundColor:"#1976d2",px:2,py:1,fontSize:"12px",borderTopLeftRadius:"4px",borderTopRightRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:["Dwarsprofiel overzicht",(0,r.jsx)(Pn,{"aria-label":"close",onClick:()=>e(!1),size:"medium",sx:{color:"#ffffff"},children:(0,r.jsx)(on.A,{})})]}),(0,r.jsx)(k,{ref:a,sx:{flexGrow:1,width:"100%",overflow:"hidden"}})]}));var cu=i(2092),hu=i(3684),uu=i(8597),du=i(6815),fu=i(4664),pu=i(3679),gu=i(594),mu=i(5532),bu=i(6078),vu=i(8749);const yu=["ownerState"],_u=["variants"],wu=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function xu(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const Au=(0,vu.A)(),Tu=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function ku({defaultTheme:e,theme:t,themeId:i}){return r=t,0===Object.keys(r).length?e:t[i]||t;var r}function Su(e){return e?(t,i)=>i[e]:null}function Pu(e,t){let{ownerState:i}=t,r=(0,c.A)(t,yu);const a="function"==typeof e?e((0,l.A)({ownerState:i},r)):e;if(Array.isArray(a))return a.flatMap((e=>Pu(e,(0,l.A)({ownerState:i},r))));if(a&&"object"==typeof a&&Array.isArray(a.variants)){const{variants:e=[]}=a;let t=(0,c.A)(a,_u);return e.forEach((e=>{let a=!0;"function"==typeof e.props?a=e.props((0,l.A)({ownerState:i},r,i)):Object.keys(e.props).forEach((t=>{(null==i?void 0:i[t])!==e.props[t]&&r[t]!==e.props[t]&&(a=!1)})),a&&(Array.isArray(t)||(t=[t]),t.push("function"==typeof e.style?e.style((0,l.A)({ownerState:i},r,i)):e.style))})),t}return a}const Eu=function(e={}){const{themeId:t,defaultTheme:i=Au,rootShouldForwardProp:r=xu,slotShouldForwardProp:a=xu}=e,s=e=>(0,p.A)((0,l.A)({},e,{theme:ku((0,l.A)({},e,{defaultTheme:i,themeId:t}))}));return s.__mui_systemSx=!0,(e,n={})=>{(0,f.internal_processStyles)(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:o,slot:h,skipVariantsResolver:u,skipSx:d,overridesResolver:p=Su(Tu(h))}=n,g=(0,c.A)(n,wu),m=void 0!==u?u:h&&"Root"!==h&&"root"!==h||!1,b=d||!1;let v=xu;"Root"===h||"root"===h?v=r:h?v=a:function(e){return"string"==typeof e&&e.charCodeAt(0)>96}(e)&&(v=void 0);const y=(0,f.default)(e,(0,l.A)({shouldForwardProp:v,label:void 0},g)),_=e=>"function"==typeof e&&e.__emotion_real!==e||(0,To.Q)(e)?r=>Pu(e,(0,l.A)({},r,{theme:ku({theme:r.theme,defaultTheme:i,themeId:t})})):e,w=(r,...a)=>{let n=_(r);const c=a?a.map(_):[];o&&p&&c.push((e=>{const r=ku((0,l.A)({},e,{defaultTheme:i,themeId:t}));if(!r.components||!r.components[o]||!r.components[o].styleOverrides)return null;const a=r.components[o].styleOverrides,s={};return Object.entries(a).forEach((([t,i])=>{s[t]=Pu(i,(0,l.A)({},e,{theme:r}))})),p(e,s)})),o&&!m&&c.push((e=>{var r;const a=ku((0,l.A)({},e,{defaultTheme:i,themeId:t}));return Pu({variants:null==a||null==(r=a.components)||null==(r=r[o])?void 0:r.variants},(0,l.A)({},e,{theme:a}))})),b||c.push(s);const h=c.length-a.length;if(Array.isArray(r)&&h>0){const e=new Array(h).fill("");n=[...r,...e],n.raw=[...r.raw,...e]}const u=y(n,...c);return e.muiName&&(u.muiName=e.muiName),u};return y.withConfig&&(w.withConfig=y.withConfig),w}}(),Cu=Eu;var Du=i(6606),Ou=i(9452),Ru=i(8248);const Mu=["component","direction","spacing","divider","children","className","useFlexGap"],Iu=(0,vu.A)(),Lu=Cu("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function Fu(e){return(0,Du.A)({props:e,name:"MuiStack",defaultTheme:Iu})}function Nu(e,t){const i=h.Children.toArray(e).filter(Boolean);return i.reduce(((e,r,a)=>(e.push(r),a<i.length-1&&e.push(h.cloneElement(t,{key:`separator-${a}`})),e)),[])}const Bu=({ownerState:e,theme:t})=>{let i=(0,l.A)({display:"flex",flexDirection:"column"},(0,Ou.NI)({theme:t},(0,Ou.kW)({values:e.direction,breakpoints:t.breakpoints.values}),(e=>({flexDirection:e}))));if(e.spacing){const r=(0,Ru.LX)(t),a=Object.keys(t.breakpoints.values).reduce(((t,i)=>(("object"==typeof e.spacing&&null!=e.spacing[i]||"object"==typeof e.direction&&null!=e.direction[i])&&(t[i]=!0),t)),{}),s=(0,Ou.kW)({values:e.direction,base:a}),n=(0,Ou.kW)({values:e.spacing,base:a});"object"==typeof s&&Object.keys(s).forEach(((e,t,i)=>{if(!s[e]){const r=t>0?s[i[t-1]]:"column";s[e]=r}}));const o=(t,i)=>{return e.useFlexGap?{gap:(0,Ru._W)(r,t)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${a=i?s[i]:e.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[a]}`]:(0,Ru._W)(r,t)}};var a};i=(0,To.A)(i,(0,Ou.NI)({theme:t},n,o))}return i=(0,Ou.iZ)(t.breakpoints,i),i},ju=function(e={}){const{createStyledComponent:t=Lu,useThemeProps:i=Fu,componentName:a="MuiStack"}=e,s=t(Bu),n=h.forwardRef((function(e,t){const n=i(e),o=(0,g.A)(n),{component:h="div",direction:u="column",spacing:f=0,divider:p,children:m,className:b,useFlexGap:v=!1}=o,y=(0,c.A)(o,Mu),_={direction:u,spacing:f,useFlexGap:v},w=(0,R.A)({root:["root"]},(e=>(0,ke.Ay)(a,e)),{});return(0,r.jsx)(s,(0,l.A)({as:h,ownerState:_,ref:t,className:(0,d.A)(w.root,b)},y,{children:p?Nu(m,p):m}))}));return n}({createStyledComponent:(0,L.Ay)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>(0,F.A)({props:e,name:"MuiStack"})}),zu=ju;function Uu(e){return(0,ke.Ay)("MuiButtonGroup",e)}const Hu=(0,w.A)("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),Wu=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],Vu=(0,L.Ay)("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[{[`& .${Hu.grouped}`]:t.grouped},{[`& .${Hu.grouped}`]:t[`grouped${(0,qe.A)(i.orientation)}`]},{[`& .${Hu.grouped}`]:t[`grouped${(0,qe.A)(i.variant)}`]},{[`& .${Hu.grouped}`]:t[`grouped${(0,qe.A)(i.variant)}${(0,qe.A)(i.orientation)}`]},{[`& .${Hu.grouped}`]:t[`grouped${(0,qe.A)(i.variant)}${(0,qe.A)(i.color)}`]},{[`& .${Hu.firstButton}`]:t.firstButton},{[`& .${Hu.lastButton}`]:t.lastButton},{[`& .${Hu.middleButton}`]:t.middleButton},t.root,t[i.variant],!0===i.disableElevation&&t.disableElevation,i.fullWidth&&t.fullWidth,"vertical"===i.orientation&&t.vertical]}})((({theme:e,ownerState:t})=>(0,l.A)({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},"contained"===t.variant&&{boxShadow:(e.vars||e).shadows[2]},t.disableElevation&&{boxShadow:"none"},t.fullWidth&&{width:"100%"},"vertical"===t.orientation&&{flexDirection:"column"},{[`& .${Hu.grouped}`]:(0,l.A)({minWidth:40,"&:hover":(0,l.A)({},"contained"===t.variant&&{boxShadow:"none"})},"contained"===t.variant&&{boxShadow:"none"}),[`& .${Hu.firstButton},& .${Hu.middleButton}`]:(0,l.A)({},"horizontal"===t.orientation&&{borderTopRightRadius:0,borderBottomRightRadius:0},"vertical"===t.orientation&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},"text"===t.variant&&"horizontal"===t.orientation&&{borderRight:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:"1px solid "+("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),[`&.${Hu.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}},"text"===t.variant&&"vertical"===t.orientation&&{borderBottom:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:"1px solid "+("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),[`&.${Hu.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}},"text"===t.variant&&"inherit"!==t.color&&{borderColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:(0,cn.X4)(e.palette[t.color].main,.5)},"outlined"===t.variant&&"horizontal"===t.orientation&&{borderRightColor:"transparent"},"outlined"===t.variant&&"vertical"===t.orientation&&{borderBottomColor:"transparent"},"contained"===t.variant&&"horizontal"===t.orientation&&{borderRight:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${Hu.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}},"contained"===t.variant&&"vertical"===t.orientation&&{borderBottom:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${Hu.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}},"contained"===t.variant&&"inherit"!==t.color&&{borderColor:(e.vars||e).palette[t.color].dark},{"&:hover":(0,l.A)({},"outlined"===t.variant&&"horizontal"===t.orientation&&{borderRightColor:"currentColor"},"outlined"===t.variant&&"vertical"===t.orientation&&{borderBottomColor:"currentColor"})}),[`& .${Hu.lastButton},& .${Hu.middleButton}`]:(0,l.A)({},"horizontal"===t.orientation&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},"vertical"===t.orientation&&{borderTopRightRadius:0,borderTopLeftRadius:0},"outlined"===t.variant&&"horizontal"===t.orientation&&{marginLeft:-1},"outlined"===t.variant&&"vertical"===t.orientation&&{marginTop:-1})}))),$u=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiButtonGroup"}),{children:a,className:s,color:n="primary",component:o="div",disabled:u=!1,disableElevation:f=!1,disableFocusRipple:p=!1,disableRipple:g=!1,fullWidth:m=!1,orientation:b="horizontal",size:v="medium",variant:y="outlined"}=i,_=(0,c.A)(i,Wu),w=(0,l.A)({},i,{color:n,component:o,disabled:u,disableElevation:f,disableFocusRipple:p,disableRipple:g,fullWidth:m,orientation:b,size:v,variant:y}),x=(e=>{const{classes:t,color:i,disabled:r,disableElevation:a,fullWidth:s,orientation:n,variant:o}=e,l={root:["root",o,"vertical"===n&&"vertical",s&&"fullWidth",a&&"disableElevation"],grouped:["grouped",`grouped${(0,qe.A)(n)}`,`grouped${(0,qe.A)(o)}`,`grouped${(0,qe.A)(o)}${(0,qe.A)(n)}`,`grouped${(0,qe.A)(o)}${(0,qe.A)(i)}`,r&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return(0,R.A)(l,Uu,t)})(w),A=h.useMemo((()=>({className:x.grouped,color:n,disabled:u,disableElevation:f,disableFocusRipple:p,disableRipple:g,fullWidth:m,size:v,variant:y})),[n,u,f,p,g,m,v,y,x.grouped]),T=function(e){return h.Children.toArray(e).filter((e=>h.isValidElement(e)))}(a),k=T.length,S=e=>{const t=0===e,i=e===k-1;return t&&i?"":t?x.firstButton:i?x.lastButton:x.middleButton};return(0,r.jsx)(Vu,(0,l.A)({as:o,role:"group",className:(0,d.A)(x.root,s),ref:t,ownerState:w},_,{children:(0,r.jsx)(Rn.Provider,{value:A,children:T.map(((e,t)=>(0,r.jsx)(Mn.Provider,{value:S(t),children:e},t)))})}))})),Xu=$u;function Yu(e){return(0,ke.Ay)("MuiLinearProgress",e)}(0,w.A)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const Gu=["className","color","value","valueBuffer","variant"];let Ku,qu,Zu,Ju,Qu,ed,td=e=>e;const id=(0,he.i7)(Ku||(Ku=td`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`)),rd=(0,he.i7)(qu||(qu=td`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`)),ad=(0,he.i7)(Zu||(Zu=td`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`)),sd=(e,t)=>"inherit"===t?"currentColor":e.vars?e.vars.palette.LinearProgress[`${t}Bg`]:"light"===e.palette.mode?(0,cn.a)(e.palette[t].main,.62):(0,cn.e$)(e.palette[t].main,.5),nd=(0,L.Ay)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[`color${(0,qe.A)(i.color)}`],t[i.variant]]}})((({ownerState:e,theme:t})=>(0,l.A)({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:sd(t,e.color)},"inherit"===e.color&&"buffer"!==e.variant&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},"buffer"===e.variant&&{backgroundColor:"transparent"},"query"===e.variant&&{transform:"rotate(180deg)"}))),od=(0,L.Ay)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.dashed,t[`dashedColor${(0,qe.A)(i.color)}`]]}})((({ownerState:e,theme:t})=>{const i=sd(t,e.color);return(0,l.A)({position:"absolute",marginTop:0,height:"100%",width:"100%"},"inherit"===e.color&&{opacity:.3},{backgroundImage:`radial-gradient(${i} 0%, ${i} 16%, transparent 42%)`,backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})}),(0,he.AH)(Ju||(Ju=td`
    animation: ${0} 3s infinite linear;
  `),ad)),ld=(0,L.Ay)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.bar,t[`barColor${(0,qe.A)(i.color)}`],("indeterminate"===i.variant||"query"===i.variant)&&t.bar1Indeterminate,"determinate"===i.variant&&t.bar1Determinate,"buffer"===i.variant&&t.bar1Buffer]}})((({ownerState:e,theme:t})=>(0,l.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:"inherit"===e.color?"currentColor":(t.vars||t).palette[e.color].main},"determinate"===e.variant&&{transition:"transform .4s linear"},"buffer"===e.variant&&{zIndex:1,transition:"transform .4s linear"})),(({ownerState:e})=>("indeterminate"===e.variant||"query"===e.variant)&&(0,he.AH)(Qu||(Qu=td`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    `),id))),cd=(0,L.Ay)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.bar,t[`barColor${(0,qe.A)(i.color)}`],("indeterminate"===i.variant||"query"===i.variant)&&t.bar2Indeterminate,"buffer"===i.variant&&t.bar2Buffer]}})((({ownerState:e,theme:t})=>(0,l.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},"buffer"!==e.variant&&{backgroundColor:"inherit"===e.color?"currentColor":(t.vars||t).palette[e.color].main},"inherit"===e.color&&{opacity:.3},"buffer"===e.variant&&{backgroundColor:sd(t,e.color),transition:"transform .4s linear"})),(({ownerState:e})=>("indeterminate"===e.variant||"query"===e.variant)&&(0,he.AH)(ed||(ed=td`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
    `),rd))),hd=h.forwardRef((function(e,t){const i=(0,F.A)({props:e,name:"MuiLinearProgress"}),{className:a,color:s="primary",value:n,valueBuffer:o,variant:h="indeterminate"}=i,u=(0,c.A)(i,Gu),f=(0,l.A)({},i,{color:s,variant:h}),p=(e=>{const{classes:t,variant:i,color:r}=e,a={root:["root",`color${(0,qe.A)(r)}`,i],dashed:["dashed",`dashedColor${(0,qe.A)(r)}`],bar1:["bar",`barColor${(0,qe.A)(r)}`,("indeterminate"===i||"query"===i)&&"bar1Indeterminate","determinate"===i&&"bar1Determinate","buffer"===i&&"bar1Buffer"],bar2:["bar","buffer"!==i&&`barColor${(0,qe.A)(r)}`,"buffer"===i&&`color${(0,qe.A)(r)}`,("indeterminate"===i||"query"===i)&&"bar2Indeterminate","buffer"===i&&"bar2Buffer"]};return(0,R.A)(a,Yu,t)})(f),g=I(),m={},b={bar1:{},bar2:{}};if(("determinate"===h||"buffer"===h)&&void 0!==n){m["aria-valuenow"]=Math.round(n),m["aria-valuemin"]=0,m["aria-valuemax"]=100;let e=n-100;g&&(e=-e),b.bar1.transform=`translateX(${e}%)`}if("buffer"===h&&void 0!==o){let e=(o||0)-100;g&&(e=-e),b.bar2.transform=`translateX(${e}%)`}return(0,r.jsxs)(nd,(0,l.A)({className:(0,d.A)(p.root,a),ownerState:f,role:"progressbar"},m,{ref:t},u,{children:["buffer"===h?(0,r.jsx)(od,{className:p.dashed,ownerState:f}):null,(0,r.jsx)(ld,{className:p.bar1,ownerState:f,style:b.bar1}),"determinate"===h?null:(0,r.jsx)(cd,{className:p.bar2,ownerState:f,style:b.bar2})]}))})),ud=hd,dd={outline:1,padding:1,borderRadius:1,outlineColor:"#D3D3D3"},fd=({model:e,isLayerListVisible:t,setSelectedLineLayerId:i,handleUploadGeoJSON:a,handleSelectFromMap:s,handleFileChange:n,handleClearGraphics:o,handleGridChange:l,handleExcelUpload:c,handleClearExcel:h,handleOpenOverview:u,handleCreateCrossSection:d,handleCreateDesign:f,handleExportGraphics:p,handleClearDesign:g,loading:m})=>(0,r.jsxs)(zu,{spacing:1,children:[(0,r.jsxs)(zu,{spacing:2,sx:dd,children:[(0,r.jsxs)(Xu,{fullWidth:!0,children:[(0,r.jsx)(zn,{disabled:!e.sketchViewModel,color:"primary",onClick:()=>{e.startDrawingLine(e.graphicsLayerLine)},startIcon:(0,r.jsx)(uu.A,{}),variant:"contained",sx:{flexDirection:"column",padding:"8px 4px",fontSize:"9px"},children:"Teken lijn"}),(0,r.jsx)(zn,{color:"primary",onClick:a,startIcon:(0,r.jsx)(bu.A,{}),variant:"contained",disabled:!e.map,sx:{flexDirection:"column",padding:"8px 4px",fontSize:"9px"},children:"Upload GeoJSON"}),(0,r.jsx)(zn,{color:"primary",onClick:s,startIcon:(0,r.jsx)(pu.A,{}),variant:"contained",disabled:!e.map,sx:{flexDirection:"column",padding:"8px 4px",fontSize:"9px"},children:"Kies uit kaart"})]}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(Gh,{sx:{marginTop:2,fontSize:"11px"},size:"small",children:[(0,r.jsx)(Hh,{id:"line-layer-label",sx:{fontSize:"11px"},children:"Ontwerplijn"}),(0,r.jsx)(Ah,{value:e.selectedLineLayerId,onChange:e=>i(e.target.value),displayEmpty:!0,fullWidth:!0,variant:"outlined",sx:{fontSize:"11px"},children:e.lineFeatureLayers.map((e=>(0,r.jsx)(Oh,{value:e.id,sx:{fontSize:"11px"},children:e.title},e.id)))})]}),e.selectedDijkvakLayerFields.length>0&&(0,r.jsxs)(Gh,{sx:{marginTop:2,fontSize:"14px"},size:"small",children:[(0,r.jsx)(Hh,{id:"dijkvak-field-label",sx:{fontSize:"11px"},children:"Dijkvak-id veld"}),(0,r.jsx)(Ah,{value:e.selectedDijkvakField||"",onChange:t=>{e.selectedDijkvakField=t.target.value},displayEmpty:!0,fullWidth:!0,variant:"outlined",sx:{fontSize:"11px"},children:e.selectedDijkvakLayerFields.map((e=>(0,r.jsx)(Oh,{value:e,sx:{fontSize:"11px"},children:e},e)))})]})]}),(0,r.jsx)(zn,{disabled:!e.graphicsLayerLine?.graphics.length,variant:"outlined",color:"primary",onClick:o,startIcon:(0,r.jsx)(cu.A,{}),fullWidth:!0,children:"Verwijder lijn"})]}),(0,r.jsxs)(zu,{spacing:1,sx:dd,children:[(0,r.jsx)("input",{id:"geojson-upload",type:"file",accept:".geojson",hidden:!0,onChange:n}),(0,r.jsxs)(zn,{variant:"contained",component:"label",startIcon:(0,r.jsx)(mu.A,{}),color:"primary",fullWidth:!0,children:["Upload Excel",(0,r.jsx)("input",{type:"file",accept:".xlsx, .xls",hidden:!0,onChange:c})]}),(0,r.jsx)(zn,{disabled:!e.chartData?.length,variant:"outlined",color:"secondary",startIcon:(0,r.jsx)(cu.A,{}),onClick:h,fullWidth:!0,children:"Verwijder Excel"})]}),(0,r.jsxs)(zu,{spacing:1.5,sx:dd,children:[(0,r.jsx)(zn,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(du.A,{}),onClick:u,fullWidth:!0,disabled:!e.chartData?.length||e.designPanelVisible,children:"Toon ontwerp-paneel"}),(0,r.jsx)(nu,{value:e.gridSize,label:"Gridgrootte [m]",type:"number",variant:"outlined",size:"medium",onChange:l,sx:{marginTop:4},InputProps:{sx:{fontSize:"12px",lineHeight:"2"}},InputLabelProps:{sx:{fontSize:"12px"}}}),(0,r.jsx)(zn,{disabled:!e.chartData?.length||!e.graphicsLayerLine?.graphics.length,variant:"contained",color:"primary",startIcon:(0,r.jsx)(gu.A,{}),onClick:f,fullWidth:!0,children:"Uitrollen in 3D"}),(0,r.jsx)(zn,{disabled:!e.chartData?.length||!e.graphicsLayerLine?.graphics.length||!e.selectedDijkvakField,variant:"contained",color:"primary",startIcon:(0,r.jsx)(gu.A,{}),onClick:f,fullWidth:!0,children:"Uitrollen over dijkvakken"}),(0,r.jsx)(zn,{disabled:!e.graphicsLayerTemp?.graphics.length,variant:"contained",color:"secondary",startIcon:(0,r.jsx)(hu.A,{}),onClick:p,fullWidth:!0,children:"Download ontwerpdata (GeoJSON)"}),(0,r.jsx)(zn,{disabled:!e.graphicsLayerTemp?.graphics.length,variant:"outlined",color:"primary",startIcon:(0,r.jsx)(cu.A,{}),onClick:g,fullWidth:!0,children:"Verwijder uitrol"}),(0,r.jsxs)("div",{style:{position:"relative"},children:[m&&(0,r.jsx)(ud,{sx:{position:"absolute",top:0,left:0,width:"100%",zIndex:1}}),(0,r.jsx)(Vn,{sx:{marginTop:2,opacity:m?.5:1},children:(0,r.jsx)(qn,{children:(0,r.jsxs)(Ao,{children:[(0,r.jsxs)(ho,{children:[(0,r.jsx)(bo,{sx:{fontSize:11},align:"left",children:"Totaal volume verschil [m³]"}),(0,r.jsx)(bo,{sx:{fontSize:11},align:"right",children:e.totalVolumeDifference??"-"})]}),(0,r.jsxs)(ho,{children:[(0,r.jsx)(bo,{sx:{fontSize:11},align:"left",children:"Uitgravingsvolume [m³]"}),(0,r.jsx)(bo,{sx:{fontSize:11},align:"right",children:e.excavationVolume??"-"})]}),(0,r.jsxs)(ho,{children:[(0,r.jsx)(bo,{sx:{fontSize:11},align:"left",children:"Opvulvolume [m³]"}),(0,r.jsx)(bo,{sx:{fontSize:11},align:"right",children:e.fillVolume??"-"})]})]})})})]})]}),(0,r.jsx)(zu,{spacing:1.5,sx:dd,children:(0,r.jsx)(zn,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(fu.A,{}),onClick:d(),fullWidth:!0,children:"Maak dwarsprofiel"})})]});var pd=i(5961);async function gd(e,t){const i=e.map.allLayers.items.find((e=>e.title===t));if(!i)return console.warn("BAG panden layer not found!"),[];const r=e.graphicsLayerTemp.graphics.items.map((e=>e.geometry)),a=r.length>1?pd.union(r):r[0];if(!a)return console.warn("No geometry to query with."),[];const s=i.createQuery();s.returnGeometry=!0,s.outFields=["*"],s.geometry=a,s.spatialRelationship="intersects";try{const e=await i.queryFeatures(s);return console.log("Intersecting features:",e),e.features}catch(e){return console.error("Error querying features:",e),[]}}const md=({model:e})=>((0,rt.useWatchAndRerender)(e,"intersectingPanden"),(0,rt.useWatchAndRerender)(e,"intersectingBomen"),(0,rt.useWatchAndRerender)(e,"intersectingPercelen"),(0,r.jsxs)(zu,{spacing:2,children:[(0,r.jsx)(zn,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(s.A,{}),onClick:async()=>{e.messages.commands.ui.displayBusyState.execute({}).catch((e=>{console.error("Error displaying busy state:",e)})),await gd(e,"BAG 2D").then((t=>{e.intersectingPanden=t,console.log("Intersecting panden:",t)})).catch((e=>{console.error("Error fetching intersecting features:",e)})),await gd(e,"Bomenregister 2015").then((t=>{e.intersectingBomen=t,console.log("Intersecting bomen:",t)})).catch((e=>{console.error("Error fetching intersecting features:",e)})),await gd(e,"DKK - perceel").then((t=>{e.intersectingPercelen=t,console.log("Intersecting percelen:",t)})).catch((e=>{console.error("Error fetching intersecting features:",e)})),e.messages.commands.ui.hideBusyState.execute().catch((e=>{console.error("Error displaying busy state:",e)}))},fullWidth:!0,children:"Voer effectenanalyse uit"}),(0,r.jsx)(Vn,{component:pn,sx:{},children:(0,r.jsxs)(qn,{children:[(0,r.jsx)(ro,{children:(0,r.jsxs)(ho,{children:[(0,r.jsx)(bo,{sx:{fontSize:"11px",fontWeight:"bold"},children:"Thema"}),(0,r.jsx)(bo,{align:"right",sx:{fontSize:"11px",fontWeight:"bold"},children:"Aantal geraakte elementen"})]})}),(0,r.jsxs)(Ao,{children:[(0,r.jsxs)(ho,{children:[(0,r.jsx)(bo,{sx:{fontSize:"11px"},children:"BAG panden"}),(0,r.jsx)(bo,{sx:{fontSize:"11px"},align:"right",children:e.intersectingPanden?.length})]}),(0,r.jsxs)(ho,{children:[(0,r.jsx)(bo,{sx:{fontSize:"11px"},children:"Bomen"}),(0,r.jsx)(bo,{sx:{fontSize:"11px"},align:"right",children:e.intersectingBomen?.length})]}),(0,r.jsxs)(ho,{children:[(0,r.jsx)(bo,{sx:{fontSize:"11px"},children:"Percelen"}),(0,r.jsx)(bo,{sx:{fontSize:"11px"},align:"right",children:e.intersectingPercelen?.length})]})]})]})})]})),bd=e=>{const{model:t}=e,i=(0,h.useRef)({}),l=(0,h.useRef)(null),c=(0,h.useRef)(null),[d,f]=(0,h.useState)(0),[p,g]=(0,h.useState)(window.innerWidth),[m,b]=(0,h.useState)(0),[v,y]=(0,h.useState)(!1),[_,w]=u().useState(0),[x,A]=(0,h.useState)(!1);function T(e){t.crossSectionPanelVisible=e,e||(t.userLinePoints=[])}function S(e){t.designPanelVisible=e,t.crossSectionPanelVisible=!1}const P=(0,h.useRef)(null),E=(0,h.useRef)(null),C=(0,h.useRef)(null),D=(0,h.useRef)(null);function O(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function R(e){const{children:t,value:i,index:a,...s}=e;return(0,r.jsx)("div",{role:"tabpanel",hidden:i!==a,id:`simple-tabpanel-${a}`,"aria-labelledby":`simple-tab-${a}`,...s,children:i===a&&(0,r.jsx)(k,{sx:{p:3},children:t})})}return(0,h.useEffect)((()=>{const e=(()=>{const e=document.querySelector(".gcx-map");if(e){const t=new ResizeObserver((t=>{for(const i of t)if(i.contentRect){const t=e.getBoundingClientRect().left,i=e.getBoundingClientRect().right;f(t),g(i)}}));return t.observe(e),()=>t.disconnect()}})();return()=>{e&&e()}}),[]),(0,h.useEffect)((()=>(function(e,t,i,r){if(0!==t||!e.chartData||!i.current)return void console.log(t,e.chartData,i.current,"Chart not initialized");e.chartRoot=$a.new(i.current);const a=e.chartRoot;a.setThemes([Bs.new(a)]);const s=a.container.children.push(rs.new(a,{panX:!0,panY:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0}));try{a._logo.dispose()}catch{}const n=s.xAxes.push(ls.new(a,{renderer:bs.new(a,{}),tooltip:Nr.new(a,{})})),o=s.yAxes.push(ls.new(a,{renderer:vs.new(a,{}),tooltip:Nr.new(a,{})})),l=s.series.push(Fs.new(a,{name:"Hoogte vs Afstand",xAxis:n,yAxis:o,valueYField:"hoogte",valueXField:"afstand",tooltip:Nr.new(a,{labelText:"{valueY}"})}));l.data.setAll(e.chartData),r.current=l,l.strokes.template.setAll({strokeWidth:2}),l.bullets.push(((t,i,r)=>{const a=Xa.new(t,{radius:5,fill:t.interfaceColors.get("background"),stroke:i.get("fill"),strokeWidth:2,draggable:!0,interactive:!0,cursorOverStyle:"pointer"}),s=(e,t)=>Math.round(e/t)*t;return a.events.on("dragstop",(()=>{const t=o.positionToValue(o.coordinateToPosition(a.y())),i=n.positionToValue(n.coordinateToPosition(a.x())),l=s(i,.5),c=s(t,.5);r.set("valueY",c),r.set("valueX",l);const h=e.chartData.findIndex((e=>e.afstand===r.dataContext.afstand));console.log(h),-1!==h&&(e.chartData[h].hoogte=c,e.chartData[h].afstand=l,e.chartData=[...e.chartData],e.allChartData[e.activeSheet]=[...e.chartData])})),Ya.new(t,{sprite:a})})),s.set("cursor",Ns.new(a,{}))}(t,m,l,P),()=>{t.chartRoot&&(t.chartRoot.dispose(),console.log("Chart disposed"))})),[t.overviewVisible,t,m,l,t.chartData]),(0,h.useEffect)((()=>(i.current.model!==t&&console.log("model changed"),i.current.crossSectionChartRoot!==t.crossSectionChartRoot&&console.log("model.crossSectionChartRoot changed"),i.current.crossSectionChartContainerRef!==c&&console.log("crossSectionChartContainerRef changed"),i.current.crossSectionChartData!==t.crossSectionChartData&&console.log("model.crossSectionChartData changed"),i.current.meshSeriesData!==t.meshSeriesData&&console.log("model.meshSeriesData changed"),i.current={model:t,crossSectionChartRoot:t.crossSectionChartRoot,crossSectionChartContainerRef:c,crossSectionChartData:t.crossSectionChartData,meshSeriesData:t.meshSeriesData},function(e,t,i){const{chartSeriesRef:r,meshSeriesRef:a,userSeriesRef:s}=i;if(!e.crossSectionChartData||!t?.current)return void console.log(e.crossSectionChartData,t?.current,"Chart not initialized");e.crossSectionChartRoot=$a.new(t.current);const n=e.crossSectionChartRoot;n.setThemes([Bs.new(n)]);const o=n.container.children.push(rs.new(n,{panX:!0,panY:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0}));try{n._logo.dispose()}catch{}const l=o.xAxes.push(ls.new(n,{renderer:bs.new(n,{}),tooltip:Nr.new(n,{})})),c=o.yAxes.push(ls.new(n,{renderer:vs.new(n,{}),tooltip:Nr.new(n,{})})),h=o.series.push(Fs.new(n,{name:"Hoogte vs Afstand",xAxis:l,yAxis:c,valueYField:"hoogte",valueXField:"afstand",tooltip:Nr.new(n,{labelText:"Grond hoogte: {valueY}"}),stroke:Ti(16750848)}));h.data.setAll(e.crossSectionChartData),r.current=h,h.strokes.template.setAll({strokeWidth:3});const u=o.series.push(Fs.new(n,{name:"Mesh Hoogte vs Afstand",xAxis:l,yAxis:c,valueYField:"hoogte",valueXField:"afstand",tooltip:Nr.new(n,{labelText:"Ontwerp hoogte: {valueY}"}),stroke:Ti(8947848)}));e.meshSeriesData?.length&&(u.data.setAll(e.meshSeriesData),console.log(e.meshSeriesData,"Mesh series data has been set")),a.current=u,u.strokes.template.setAll({strokeWidth:3});const d=o.series.push(Fs.new(n,{name:"User Drawn Line",xAxis:l,yAxis:c,valueYField:"hoogte",valueXField:"afstand",stroke:Ti(8388736),tooltip:Nr.new(n,{labelText:"{valueY}"})}));function f(){e.slopeLabels.forEach((e=>e.dispose())),e.slopeLabels=[];const t=e.userLinePoints;if(t&&!(t.length<2))for(let i=1;i<t.length;i++){const r=t[i-1],a=t[i],s=a.afstand-r.afstand,h=a.hoogte-r.hoogte;let u;u=0===h?"∞":Math.abs(s/h).toFixed(2);const d=`1:${u}`,f=(r.afstand+a.afstand)/2,p=(r.hoogte+a.hoogte)/2;console.log(f,p,"Midpoint coordinates for slope label");const g=o.plotContainer.children.push(Lr.new(n,{text:d,x:l.get("renderer").positionToCoordinate(l.valueToPosition(f)),y:c.get("renderer").positionToCoordinate(c.valueToPosition(p)),centerX:ct,centerY:ct,background:br.new(n,{fill:Ti(16777215),fillOpacity:.7}),paddingLeft:2,paddingRight:2,paddingTop:1,paddingBottom:1,fontSize:14}));console.log(g,"Slope label created: ",d),e.slopeLabels.push(g)}}d.bullets.push(((e,t,i)=>Ya.new(e,{sprite:Xa.new(e,{radius:6,fill:Ti(8388736),stroke:Ti(16777215),strokeWidth:2})}))),d.strokes.template.setAll({stroke:Ti(8388736),strokeWidth:2}),o.plotContainer.events.on("click",(t=>{const i=o.plotContainer.toLocal(t.point),r=l.positionToValue(l.coordinateToPosition(i.x)),a=c.positionToValue(c.coordinateToPosition(i.y));e.userLinePoints.push({afstand:r,hoogte:a}),d.data.setAll(e.userLinePoints),f()})),o.events.on("boundschanged",(()=>{f()})),l.on("start",(()=>{console.log("X Axis end event triggered"),f()})),c.on("start",(()=>{f()})),d.strokes.template.setAll({stroke:Ti(52224),strokeWidth:2}),o.children.push(Ka.new(n,{label:Lr.new(n,{text:"Verwijder taludlijn",fontSize:14}),x:50,y:35,centerX:ot,centerY:ot})).events.on("click",(()=>{e.userLinePoints=[],d.data.setAll([]),e.slopeLabels&&(e.slopeLabels.forEach((e=>e.dispose())),e.slopeLabels=[])})),o.set("cursor",Ns.new(n,{}))}(t,c,{chartSeriesRef:E,meshSeriesRef:C,userSeriesRef:D}),()=>{t.crossSectionChartRoot&&(t.crossSectionChartRoot.dispose(),console.log("Cross-section chart disposed"))})),[t,c,t.crossSectionChartData,t.meshSeriesData]),(0,rt.useWatchAndRerender)(t,"excavationVolume"),(0,rt.useWatchAndRerender)(t,"fillVolume)"),(0,rt.useWatchAndRerender)(t,"totalVolumeDifference"),(0,rt.useWatchAndRerender)(t,"graphicsLayerLine.graphics.length"),(0,rt.useWatchAndRerender)(t,"graphicsLayerTemp.graphics.length"),(0,rt.useWatchAndRerender)(t,"chartData.length"),(0,rt.useWatchAndRerender)(t,"overviewVisible"),(0,rt.useWatchAndRerender)(t,"selectedLineLayerId"),(0,rt.useWatchAndRerender)(t,"gridSize"),(0,rt.useWatchAndRerender)(t,"activeSheet"),(0,rt.useWatchAndRerender)(t,"activeTab"),(0,rt.useWatchAndRerender)(t,"selectedDijkvakField"),(0,rt.useWatchAndRerender)(t,"chartData"),(0,rt.useWatchAndRerender)(t,"allChartData"),(0,rt.useWatchAndRerender)(t,"crossSectionChartData"),(0,rt.useWatchAndRerender)(t,"crossSectionChartData.length"),(0,rt.useWatchAndRerender)(t,"crossSectionPanelVisible"),(0,rt.useWatchAndRerender)(t,"designPanelVisible"),(0,r.jsxs)(it.LayoutElement,{...e,style:{width:"100%",overflowY:"scroll"},children:[(0,r.jsxs)(k,{sx:{width:"100%"},children:[(0,r.jsx)(k,{sx:{borderBottom:1,borderColor:"divider"},children:(0,r.jsxs)(Ke,{value:_,onChange:(e,t)=>{w(t)},variant:"scrollable",scrollButtons:"auto","aria-label":"scrollable auto tabs example",children:[(0,r.jsx)(tt,{icon:(0,r.jsx)(a.A,{}),label:"Dimensioneren",...O(0)}),(0,r.jsx)(tt,{icon:(0,r.jsx)(s.A,{}),label:"Effecten",...O(1)}),(0,r.jsx)(tt,{icon:(0,r.jsx)(n.A,{}),label:"Kosten",...O(2)}),(0,r.jsx)(tt,{icon:(0,r.jsx)(o.A,{}),label:"Afwegen",...O(3)})]})}),(0,r.jsx)(R,{value:_,index:0,children:(0,r.jsx)(fd,{model:t,isLayerListVisible:x,setSelectedLineLayerId:e=>{t.selectedLineLayerId=e,t.graphicsLayerLine.removeAll(),function(e){e.map.layers.find((t=>t.id===e.selectedLineLayerId)).queryFeatures({where:"1=1",returnGeometry:!0,outFields:["*"]}).then((async t=>{const i=t.features;i.length>0?i.forEach((t=>{const i=t.geometry;en.load().then((()=>{const r=en.project(i,new(Js())({wkid:3857}));e.graphicsLayerLine.add(new(zs())({geometry:r,symbol:e.lineLayerSymbol,attributes:t.attributes}))}))})):console.warn("No features found in the selected feature layer.")})).catch((e=>{console.error("Error querying feature layer:",e)}))}(t);const i=t.lineFeatureLayers.find((t=>t.id===e));if(i){const e=i.fields.map((e=>e.name));t.selectedDijkvakLayerFields=e}},handleUploadGeoJSON:()=>{document.getElementById("geojson-upload")?.click()},handleSelectFromMap:()=>{t.lineFeatureLayers?.length>0?A(!0):console.warn("No line feature layers available.")},handleFileChange:e=>{const i=e.target.files?.[0];i&&t.handleGeoJSONUpload(i)},handleClearGraphics:()=>{t.graphicsLayerLine.removeAll(),t.selectedLineLayerId=null,t.selectedDijkvakField=null},handleGridChange:e=>{t.gridSize=parseFloat(e.target.value)},handleExcelUpload:e=>{S(!0),t.handleExcelUpload(e)},handleClearExcel:()=>{t.chartData=null},handleOpenOverview:()=>{S(!0),T(!1);const e=[...t.chartData];t.chartData=e,P.current?.data.setAll(t.chartData)},handleCreateDesign:async()=>{y(!0);try{await async function(e){let t,i=[];e.selectedDijkvakField?(console.log("do stuff here..."),e.graphicsLayerLine.graphics.items.forEach((async r=>{const a=r.attributes;if(a[e.selectedDijkvakField]){const s=a[e.selectedDijkvakField];i=e.allChartData[s],t=r.geometry,console.log(s,"Dijkvak value"),console.log(i,"Chart data"),console.log(t,"Base path geometry"),await rn(e,r.geometry,e.allChartData[s])}}))):(t=e.graphicsLayerLine.graphics.items[0].geometry,i=e.chartData,rn(e,t,i))}(t),await async function(e){const t=e.gridSize;let i=await tn.createElevationSampler(e.mergedMesh);console.log("Elevation sampler created:",i);const r=e.meshGraphic.geometry.extent,a=[],s=[];for(let e=r.xmin;e<=r.xmax;e+=t)for(let n=r.ymin;n<=r.ymax;n+=t){const t=i.elevationAt(e,n);t&&(a.push([e,n,t]),s.push([e,n]))}if(console.log("All points processed:",a),0===a.length)return void console.warn("No points were processed. Ensure the mesh geometries and grid size are correct.");const n=new(Gs())({points:s,spatialReference:Js().WebMercator}),o=await e.elevationLayer.queryElevation(n,{returnSampleInfo:!0});console.log("Ground elevation query result:",o);let l=0,c=0,h=0;o.geometry.points.forEach((([t,i,r],s)=>{const n=(a[s][2]-r)*e.gridSize*e.gridSize;n>0?h+=n:c+=Math.abs(n),l+=n})),e.excavationVolume=c.toFixed(2),e.fillVolume=h.toFixed(2),e.totalVolumeDifference=l.toFixed(2),console.log("Total volume difference:",l,"m³"),console.log("Total cut volume:",c,"m³"),console.log("Total fill volume:",h,"m³")}(t),console.log("All done...")}catch(e){console.error("Error during design creation or volume calculation:",e)}finally{y(!1)}},handleExportGraphics:()=>{!function(e){const t={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:4326"}},features:[]};en.load().then((()=>{e.graphicsLayerTemp.graphics.forEach((e=>{const i=e.geometry;if(i){const r=en.project(i,new(Js())({wkid:4326}));if(r){let i={type:"Feature",geometry:null,properties:e.attributes||{}};Array.isArray(r)||"polygon"!==r.type||(i.geometry={type:"Polygon",coordinates:r.rings},t.features.push(i))}}}));const i=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(i),a=document.createElement("a");a.href=r,a.download="ontwerp_export.geojson",document.body.appendChild(a),a.click(),document.body.removeChild(a)}))}(t)},handleClearDesign:()=>{var e;t.meshes=[],t.offsetGeometries=[],t.graphicsLayerTemp.removeAll(),t.graphicsLayerMesh.removeAll(),t.mergedMesh=null,t.totalVolumeDifference=null,t.excavationVolume=null,t.fillVolume=null,t.intersectingPanden=null,t.intersectingBomen=null,t.intersectingPercelen=null,t.userLinePoints=[],(e=t.designLayer2D).queryObjectIds().then((t=>{if(0===t.length)return void console.log("No features to delete.");const i=t.map((e=>({objectId:e})));e.applyEdits({deleteFeatures:i}).catch((e=>{console.error("Error deleting features:",e)}))}))},handleCreateCrossSection:()=>async()=>{S(!1),await async function(e){e.messages.commands.ui.displayNotification.execute({title:"Cross Section",message:"Klik op de kaart om een dwarsprofiel te tekenen. Deze tool is in ontwikkeling.",type:"success"}),e.startDrawingLine(e.graphicsLayerCrossSection).then((()=>{var t;(t=e.graphicsLayerCrossSection.graphics.items[0].geometry,new Promise(((e,i)=>{try{const i=t.paths[0],r=i.length-1;let a=0,s=0,n=[];for(let e=0;e<r;e++){const[r,o]=i[e],[l,c]=i[e+1],h=new(Hs())({hasZ:!1,hasM:!1,paths:[[[r,o],[l,c]]],spatialReference:t.spatialReference});let u=Math.round(Qs.geodesicLength(h,"meters"));u%2!=0&&(u+=1),a+=u,n=n.concat(sn(s,u,1,e)),s+=u}e(n)}catch(e){i(e)}}))).then((t=>{console.log(t,"Offset locations for cross section");const i=e.graphicsLayerCrossSection.graphics.items[0].geometry.spatialReference,r=t.map((t=>{return r=e.graphicsLayerCrossSection.graphics.items[0].geometry.paths[0],a=t,s=i,new Promise(((e,t)=>{try{const t=r[a.segment][0],i=r[a.segment][1],n=r[a.segment+1][0],o=r[a.segment+1][1],l=new(Hs())({hasZ:!1,hasM:!1,paths:[[[t,i],[n,o]]],spatialReference:s}),c=Qs.planarLength(l,"meters")/Qs.geodesicLength(l,"meters");let h=a.offsetInSegment*c;const u=Math.atan2(o-i,n-t),d=h*Math.cos(u),f=h*Math.sin(u),p=new(Xs())({x:t+d,y:i+f,m:a.offset,spatialReference:s}),g={type:"simple-marker",color:[226,119,40,0],outline:{color:[255,255,255,0],width:1}};e(new(zs())({geometry:p,symbol:g,attributes:{offset:a.offset}}))}catch(e){t(e)}}));var r,a,s}));Promise.all(r).then((async t=>{console.log(t,"Point graphics for cross section");const i=new(Gs())({hasM:!0,points:t.map((e=>{const{x:t,y:i}=e.geometry;return[t,i,void 0,e.attributes?.offset??0]})),spatialReference:e.graphicsLayerCrossSection.graphics.items[0].geometry.spatialReference});console.log(t,"Point graphics for cross section"),console.log(i,"Multipoint for cross section");const r=await e.elevationLayer.queryElevation(i,{returnSampleInfo:!0});if(e.crossSectionChartData=r.geometry.points.map(((e,t)=>({afstand:e[3],hoogte:e[2]}))),e.crossSectionPanelVisible=!0,console.log("Elevation query result:",r),e.meshes.length>0){const t=(await tn.createElevationSampler(e.mergedMesh,{noDataValue:-999})).queryElevation(i);console.log("Mesh elevation result:",t),"points"in t&&Array.isArray(t.points)?(e.meshSeriesData=t.points.filter((e=>-999!==e[2])).map(((e,t)=>({afstand:e[3],hoogte:e[2]}))),console.log("Mesh series data:",e.meshSeriesData)):(e.meshSeriesData=[],console.warn("meshElevationResult does not have a 'points' property or is not an array.",t)),console.log("Mesh elevation result:",t)}e.messages.commands.ui.displayNotification.execute({title:"Cross Section",message:"Dwarsprofiel punten opgehaald en hoogtes berekend, deze worden straks getoond in de grafiek. Deze tool is in ontwikkeling.",type:"success"})}))}))}))}(t)},loading:v})}),(0,r.jsx)(R,{value:_,index:1,children:(0,r.jsx)(md,{model:t})})]}),t.designPanelVisible&&t.chartData&&(0,r.jsx)(ou,{setdesignPanelVisible:S,activeTab:m,setActiveTab:b,mapLeftBorder:d,mapRightBorder:p,chartContainerRef:l,model:t,handleCellChange:(e,i,r)=>{const a=[...t.chartData],s=["afstand","hoogte"].includes(i)?parseFloat(r):r;a[e]={...a[e],[i]:s},t.chartData=a,t.allChartData[t.activeSheet]=a,P.current?.data.setAll(a)}}),t.crossSectionPanelVisible&&(0,r.jsx)(lu,{setcrossSectionPanelVisible:T,mapLeftBorder:d,mapRightBorder:p,crossSectionChartContainerRef:c,model:t})]})};var vd=i(7786),yd=i(65),_d=1200,wd=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ad=function(e){-1!=wd.indexOf(e)&&(xd[0]=e)},Td=function(e){_d=e,Ad(e)};function kd(){Td(1200),Ad(1252)}function Sd(e){for(var t=[],i=0,r=e.length;i<r;++i)t[i]=e.charCodeAt(i);return t}function Pd(e){for(var t=[],i=0;i<e.length>>1;++i)t[i]=String.fromCharCode(e.charCodeAt(2*i)+(e.charCodeAt(2*i+1)<<8));return t.join("")}function Ed(e){for(var t=[],i=0;i<e.length>>1;++i)t[i]=String.fromCharCode(e.charCodeAt(2*i+1)+(e.charCodeAt(2*i)<<8));return t.join("")}var Cd=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1);return 255==t&&254==i?Pd(e.slice(2)):254==t&&255==i?Ed(e.slice(2)):65279==t?e.slice(1):e},Dd=function(e){return String.fromCharCode(e)},Od=function(e){return String.fromCharCode(e)},Rd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Md(e){for(var t="",i=0,r=0,a=0,s=0,n=0,o=0,l=0,c=0;c<e.length;)s=(i=e.charCodeAt(c++))>>2,n=(3&i)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(r)?o=l=64:isNaN(a)&&(l=64),t+=Rd.charAt(s)+Rd.charAt(n)+Rd.charAt(o)+Rd.charAt(l);return t}function Id(e){var t="",i=0,r=0,a=0,s=0,n=0,o=0;"data:"==e.slice(0,5)&&(l=e.slice(0,1024).indexOf(";base64,"))>-1&&(e=e.slice(l+8)),e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=Rd.indexOf(e.charAt(l++))<<2|(s=Rd.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(i),r=(15&s)<<4|(n=Rd.indexOf(e.charAt(l++)))>>2,64!==n&&(t+=String.fromCharCode(r)),a=(3&n)<<6|(o=Rd.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var Ld=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),Fd=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}(),Nd=function(){if("undefined"==typeof Buffer)return!1;var e=Fd([65,0]);return!!e&&1==e.toString("utf16le").length}();function Bd(e){return Ld?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function jd(e){return Ld?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var zd=function(e){return Ld?Fd(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function Ud(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],i=0;i<e.length;++i)t[i]=String.fromCharCode(e[i]);return t.join("")}function Hd(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Hd(new Uint8Array(e));for(var t=new Array(e.length),i=0;i<e.length;++i)t[i]=e[i];return t}var Wd=Ld?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:Fd(e)})))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,i=0;for(t=0;t<e.length;++t)i+=e[t].length;var r=new Uint8Array(i),a=0;for(t=0,i=0;t<e.length;i+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?r.set(e[t],i):"string"==typeof e[t]?r.set(new Uint8Array(zd(e[t])),i):r.set(new Uint8Array(e[t]),i);return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))},Vd=/\u0000/g,$d=/[\u0001-\u0006]/g;function Xd(e){for(var t="",i=e.length-1;i>=0;)t+=e.charAt(i--);return t}function Yd(e,t){var i=""+e;return i.length>=t?i:Jf("0",t-i.length)+i}function Gd(e,t){var i=""+e;return i.length>=t?i:Jf(" ",t-i.length)+i}function Kd(e,t){var i=""+e;return i.length>=t?i:i+Jf(" ",t-i.length)}var qd=Math.pow(2,32);function Zd(e,t){return e>qd||e<-qd?function(e,t){var i=""+Math.round(e);return i.length>=t?i:Jf("0",t-i.length)+i}(e,t):function(e,t){var i=""+e;return i.length>=t?i:Jf("0",t-i.length)+i}(Math.round(e),t)}function Jd(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var Qd=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ef=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],tf={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},rf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},af={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function sf(e,t,i){for(var r=e<0?-1:1,a=e*r,s=0,n=1,o=0,l=1,c=0,h=0,u=Math.floor(a);c<t&&(o=(u=Math.floor(a))*n+s,h=u*c+l,!(a-u<5e-8));)a=1/(a-u),s=n,n=o,l=c,c=h;if(h>t&&(c>t?(h=l,o=s):(h=c,o=n)),!i)return[0,r*o,h];var d=Math.floor(r*o/h);return[d,r*o-d*h,h]}function nf(e,t,i){if(e>2958465||e<0)return null;var r=0|(e=function(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var i=t.slice(0,t.indexOf("e"));return(i=i.indexOf(".")>-1?i.slice(0,"0."==i.slice(0,2)?17:16):i.slice(0,15)+Jf("0",i.length-15))+t.slice(t.indexOf("e"))}var r=t.indexOf(".")>-1?t.slice(0,"0."==t.slice(0,2)?17:16):t.slice(0,15)+Jf("0",t.length-15);return Number(r)}(e)),a=Math.floor(86400*(e-r)),s=0,n=[],o={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++r,++o.D)),60===r)n=i?[1317,10,29]:[1900,2,29],s=3;else if(0===r)n=i?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),n=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),i&&(s=function(e,t){t[0]-=581;var i=e.getDay();return e<60&&(i=(i+6)%7),i}(l,n))}return o.y=n[0],o.m=n[1],o.d=n[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}function of(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function lf(e){var t,i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=i>=-4&&i<=-1?e.toPrecision(10+i):Math.abs(i)<=9?function(e){var t=e<0?12:11,i=of(e.toFixed(12));return i.length<=t||(i=e.toPrecision(10)).length<=t?i:e.toExponential(5)}(e):10===i?e.toFixed(10).substr(0,12):function(e){var t=of(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),of(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function cf(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):lf(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Cf(14,Wf(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function hf(e,t,i,r){var a,s="",n=0,o=0,l=i.y,c=0;switch(e){case 98:l=i.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=i.m,c=t.length;break;case 3:return ef[i.m-1][1];case 5:return ef[i.m-1][0];default:return ef[i.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=i.d,c=t.length;break;case 3:return Qd[i.q][0];default:return Qd[i.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(i.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=i.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=i.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==i.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(n=Math.round(o*(i.S+i.u)))>=60*o&&(n=0),"s"===t?0===n?"0":""+n/o:(s=Yd(n,2+r),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Yd(i.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*i.D+i.H;break;case"[m]":case"[mm]":a=60*(24*i.D+i.H)+i.M;break;case"[s]":case"[ss]":a=60*(60*(24*i.D+i.H)+i.M)+(0==r?Math.round(i.S+i.u):i.S);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?Yd(a,c):""}function uf(e){if(e.length<=3)return e;for(var t=e.length%3,i=e.substr(0,t);t!=e.length;t+=3)i+=(i.length>0?",":"")+e.substr(t,3);return i}var df=/%/g;function ff(e,t){var i,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+ff(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),-1===(i=(t/Math.pow(10,s)).toPrecision(r+1+(a+s)%a)).indexOf("e")){var n=Math.floor(Math.log(t)*Math.LOG10E);for(-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(n-i.length+s):i+="E+"+(n-s);"0."===i.substr(0,2);)i=(i=i.charAt(0)+i.substr(2,a)+"."+i.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,i,r){return t+i+r.substr(0,(a+s)%a)+"."+r.substr(s)+"E"}))}else i=t.toExponential(r);return e.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),e.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}var pf=/# (\?+)( ?)\/( ?)(\d+)/,gf=/^#*0*\.([0#]+)/,mf=/\)[^)]*[0#]/,bf=/\(###\) ###\\?-####/;function vf(e){for(var t,i="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(t)}return i}function yf(e,t){var i=Math.pow(10,t);return""+Math.round(e*i)/i}function _f(e,t){var i=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(i*r)).length?0:Math.round(i*r)}function wf(e,t,i){if(40===e.charCodeAt(0)&&!t.match(mf)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return i>=0?wf("n",r,i):"("+wf("n",r,-i)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,i){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Tf(e,t.substr(0,r),i/Math.pow(10,3*(t.length-r)))}(e,t,i);if(-1!==t.indexOf("%"))return function(e,t,i){var r=t.replace(df,""),a=t.length-r.length;return Tf(e,r,i*Math.pow(10,2*a))+Jf("%",a)}(e,t,i);if(-1!==t.indexOf("E"))return ff(t,i);if(36===t.charCodeAt(0))return"$"+wf(e,t.substr(" "==t.charAt(1)?2:1),i);var a,s,n,o,l=Math.abs(i),c=i<0?"-":"";if(t.match(/^00+$/))return c+Zd(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=Zd(i,0))&&(a=""),a.length>t.length?a:vf(t.substr(0,t.length-a.length))+a;if(s=t.match(pf))return function(e,t,i){var r=parseInt(e[4],10),a=Math.round(t*r),s=Math.floor(a/r),n=a-s*r,o=r;return i+(0===s?"":""+s)+" "+(0===n?Jf(" ",e[1].length+1+e[4].length):Gd(n,e[1].length)+e[2]+"/"+e[3]+Yd(o,e[4].length))}(s,l,c);if(t.match(/^#+0+$/))return c+Zd(l,t.length-t.indexOf("0"));if(s=t.match(gf))return a=yf(i,s[1].length).replace(/^([^\.]+)$/,"$1."+vf(s[1])).replace(/\.$/,"."+vf(s[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Jf("0",vf(s[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+yf(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+uf(Zd(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return i<0?"-"+wf(e,t,-i):uf(""+(Math.floor(i)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(i,s[1].length)))+"."+Yd(_f(i,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return wf(e,t.replace(/^#,#*,/,""),i);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Xd(wf(e,t.replace(/[\\-]/g,""),i)),n=0,Xd(Xd(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return n<a.length?a.charAt(n++):"0"===e?"0":""})));if(t.match(bf))return"("+(a=wf(e,"##########",i)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return n=Math.min(s[4].length,7),o=sf(l,Math.pow(10,n)-1,!1),a=""+c," "==(h=Tf("n",s[1],o[1])).charAt(h.length-1)&&(h=h.substr(0,h.length-1)+"0"),a+=h+s[2]+"/"+s[3],(h=Kd(o[2],n)).length<s[4].length&&(h=vf(s[4].substr(s[4].length-h.length))+h),a+=h;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return n=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=sf(l,Math.pow(10,n)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Gd(o[1],n)+s[2]+"/"+s[3]+Kd(o[2],n):Jf(" ",2*n+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Zd(i,0),t.length<=a.length?a:vf(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+i.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),n=a.indexOf(".");var u=t.indexOf(".")-n,d=t.length-a.length-u;return vf(t.substr(0,u)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return n=_f(i,s[1].length),i<0?"-"+wf(e,t,-i):uf(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(i)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Yd(0,3-e.length):"")+e}))+"."+Yd(n,s[1].length);switch(t){case"###,##0.00":return wf(e,"#,##0.00",i);case"###,###":case"##,###":case"#,###":var f=uf(Zd(l,0));return"0"!==f?c+f:"";case"###,###.00":return wf(e,"###,##0.00",i).replace(/^0\./,".");case"#,###.00":return wf(e,"#,##0.00",i).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function xf(e,t){var i,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+xf(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),!(i=(t/Math.pow(10,s)).toPrecision(r+1+(a+s)%a)).match(/[Ee]/)){var n=Math.floor(Math.log(t)*Math.LOG10E);-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(n-i.length+s):i+="E+"+(n-s),i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,i,r){return t+i+r.substr(0,(a+s)%a)+"."+r.substr(s)+"E"}))}else i=t.toExponential(r);return e.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),e.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}function Af(e,t,i){if(40===e.charCodeAt(0)&&!t.match(mf)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return i>=0?Af("n",r,i):"("+Af("n",r,-i)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,i){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Tf(e,t.substr(0,r),i/Math.pow(10,3*(t.length-r)))}(e,t,i);if(-1!==t.indexOf("%"))return function(e,t,i){var r=t.replace(df,""),a=t.length-r.length;return Tf(e,r,i*Math.pow(10,2*a))+Jf("%",a)}(e,t,i);if(-1!==t.indexOf("E"))return xf(t,i);if(36===t.charCodeAt(0))return"$"+Af(e,t.substr(" "==t.charAt(1)?2:1),i);var a,s,n,o,l=Math.abs(i),c=i<0?"-":"";if(t.match(/^00+$/))return c+Yd(l,t.length);if(t.match(/^[#?]+$/))return a=""+i,0===i&&(a=""),a.length>t.length?a:vf(t.substr(0,t.length-a.length))+a;if(s=t.match(pf))return function(e,t,i){return i+(0===t?"":""+t)+Jf(" ",e[1].length+2+e[4].length)}(s,l,c);if(t.match(/^#+0+$/))return c+Yd(l,t.length-t.indexOf("0"));if(s=t.match(gf))return a=(a=(""+i).replace(/^([^\.]+)$/,"$1."+vf(s[1])).replace(/\.$/,"."+vf(s[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Jf("0",vf(s[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+uf(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return i<0?"-"+Af(e,t,-i):uf(""+i)+"."+Jf("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Af(e,t.replace(/^#,#*,/,""),i);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Xd(Af(e,t.replace(/[\\-]/g,""),i)),n=0,Xd(Xd(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return n<a.length?a.charAt(n++):"0"===e?"0":""})));if(t.match(bf))return"("+(a=Af(e,"##########",i)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return n=Math.min(s[4].length,7),o=sf(l,Math.pow(10,n)-1,!1),a=""+c," "==(h=Tf("n",s[1],o[1])).charAt(h.length-1)&&(h=h.substr(0,h.length-1)+"0"),a+=h+s[2]+"/"+s[3],(h=Kd(o[2],n)).length<s[4].length&&(h=vf(s[4].substr(s[4].length-h.length))+h),a+=h;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return n=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=sf(l,Math.pow(10,n)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Gd(o[1],n)+s[2]+"/"+s[3]+Kd(o[2],n):Jf(" ",2*n+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+i,t.length<=a.length?a:vf(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+i.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),n=a.indexOf(".");var u=t.indexOf(".")-n,d=t.length-a.length-u;return vf(t.substr(0,u)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return i<0?"-"+Af(e,t,-i):uf(""+i).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Yd(0,3-e.length):"")+e}))+"."+Yd(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=uf(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return Af(e,t.slice(0,t.lastIndexOf(".")),i)+vf(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Tf(e,t,i){return(0|i)===i?Af(e,t,i):wf(e,t,i)}var kf=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Sf(e){for(var t=0,i="",r="";t<e.length;)switch(i=e.charAt(t)){case"G":Jd(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=i;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(kf))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(i=e.charAt(++t))>-1||"\\"==i&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===i;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Pf=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ef(e,t){if(null==t)return!1;var i=parseFloat(t[2]);switch(t[1]){case"=":if(e==i)return!0;break;case">":if(e>i)return!0;break;case"<":if(e<i)return!0;break;case"<>":if(e!=i)return!0;break;case">=":if(e>=i)return!0;break;case"<=":if(e<=i)return!0}return!1}function Cf(e,t,i){null==i&&(i={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&i.dateNF?i.dateNF:e;break;case"number":null==(r=14==e&&i.dateNF?i.dateNF:(null!=i.table?i.table:tf)[e])&&(r=i.table&&i.table[rf[e]]||tf[rf[e]]),null==r&&(r=af[e]||"General")}if(Jd(r,0))return cf(t,i);t instanceof Date&&(t=Wf(t,i.date1904));var a=function(e,t){var i=function(e){for(var t=[],i=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:i=!i;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===i)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=i.length,a=i[r-1].indexOf("@");if(r<4&&a>-1&&--r,i.length>4)throw new Error("cannot find right format for |"+i.join("|")+"|");if("number"!=typeof t)return[4,4===i.length||a>-1?i[i.length-1]:"@"];switch(i.length){case 1:i=a>-1?["General","General","General",i[0]]:[i[0],i[0],i[0],"@"];break;case 2:i=a>-1?[i[0],i[0],i[0],i[1]]:[i[0],i[1],i[0],"@"];break;case 3:i=a>-1?[i[0],i[1],i[0],i[2]]:[i[0],i[1],i[2],"@"]}var s=t>0?i[0]:t<0?i[1]:i[2];if(-1===i[0].indexOf("[")&&-1===i[1].indexOf("["))return[r,s];if(null!=i[0].match(/\[[=<>]/)||null!=i[1].match(/\[[=<>]/)){var n=i[0].match(Pf),o=i[1].match(Pf);return Ef(t,n)?[r,i[0]]:Ef(t,o)?[r,i[1]]:[r,i[null!=n&&null!=o?2:1]]}return[r,s]}(r,t);if(Jd(a[1]))return cf(t,i);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,i,r){for(var a,s,n,o=[],l="",c=0,h="",u="t",d="H";c<e.length;)switch(h=e.charAt(c)){case"G":if(!Jd(e,c))throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(n=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(n);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),p="("===f||")"===f?f:"t";o[o.length]={t:p,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=nf(t,i,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},u=h,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=nf(t,i)))return"";for(l=h;++c<e.length&&e.charAt(c).toLowerCase()===h;)l+=h;"m"===h&&"h"===u.toLowerCase()&&(h="M"),"h"===h&&(h=d),o[o.length]={t:h,v:l},u=h;break;case"A":case"a":case"上":var g={t:h,v:h};if(null==a&&(a=nf(t,i)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(g.v=a.H>=12?e.charAt(c+2):h),g.t="T",d="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"PM":"AM"),g.t="T",c+=5,d="h"):"上午/下午"===e.substr(c,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"下午":"上午"),g.t="T",c+=5,d="h"):(g.t="t",++c),null==a&&"T"===g.t)return"";o[o.length]=g,u=h;break;case"[":for(l=h;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(kf)){if(null==a&&null==(a=nf(t,i)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Sf(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=h;++c<e.length&&"0"===(h=e.charAt(c));)l+=h;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=h;++c<e.length&&"0#?.,E+-%".indexOf(h=e.charAt(c))>-1;)l+=h;o[o.length]={t:"n",v:l};break;case"?":for(l=h;e.charAt(++c)===h;)l+=h;o[o.length]={t:h,v:l},u=h;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":h,v:h},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=h;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:h,v:h},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(h))throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"t",v:h},++c}var m,b,v=0,y=0;for(c=o.length-1,u="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=d,u="h",v<1&&(v=1);break;case"s":(m=o[c].v.match(/\.0+$/))&&(y=Math.max(y,m[0].length-1),v=4),v<3&&(v=3);case"d":case"y":case"e":u=o[c].t;break;case"M":u=o[c].t,v<2&&(v=2);break;case"m":"s"===u&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:case 2:case 3:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H),a.H>=24&&(a.H=0,++a.D,(b=nf(a.D)).u=a.u,b.S=a.S,b.M=a.M,b.H=a.H,a=b);break;case 4:switch(y){case 1:a.u=Math.round(10*a.u)/10;break;case 2:a.u=Math.round(100*a.u)/100;break;case 3:a.u=Math.round(1e3*a.u)/1e3}a.u>=1&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H),a.H>=24&&(a.H=0,++a.D,(b=nf(a.D)).u=a.u,b.S=a.S,b.M=a.M,b.H=a.H,a=b)}var _,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=hf(o[c].t.charCodeAt(0),o[c].v,a,y),o[c].t="t";break;case"n":case"?":for(_=c+1;null!=o[_]&&("?"===(h=o[_].t)||"D"===h||(" "===h||"t"===h)&&null!=o[_+1]&&("?"===o[_+1].t||"t"===o[_+1].t&&"/"===o[_+1].v)||"("===o[c].t&&(" "===h||"n"===h||")"===h)||"t"===h&&("/"===o[_].v||" "===o[_].v&&null!=o[_+1]&&"?"==o[_+1].t));)o[c].v+=o[_].v,o[_]={v:"",t:";"},++_;w+=o[c].v,c=_-1;break;case"G":o[c].t="t",o[c].v=cf(t,i)}var x,A,T="";if(w.length>0){40==w.charCodeAt(0)?(x=t<0&&45===w.charCodeAt(0)?-t:t,A=Tf("n",w,x)):(A=Tf("n",w,x=t<0&&r>1?-t:t),x<0&&o[0]&&"t"==o[0].t&&(A=A.substr(1),o[0].v="-"+o[0].v)),_=A.length-1;var k=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){k=c;break}var S=o.length;if(k===o.length&&-1===A.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(_>=o[c].v.length-1?(_-=o[c].v.length,o[c].v=A.substr(_+1,o[c].v.length)):_<0?o[c].v="":(o[c].v=A.substr(0,_+1),_=-1),o[c].t="t",S=c);_>=0&&S<o.length&&(o[S].v=A.substr(0,_+1)+o[S].v)}else if(k!==o.length&&-1===A.indexOf("E")){for(_=A.indexOf(".")-1,c=k;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(s=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")-1:o[c].v.length-1,T=o[c].v.substr(s+1);s>=0;--s)_>=0&&("0"===o[c].v.charAt(s)||"#"===o[c].v.charAt(s))&&(T=A.charAt(_--)+T);o[c].v=T,o[c].t="t",S=c}for(_>=0&&S<o.length&&(o[S].v=A.substr(0,_+1)+o[S].v),_=A.indexOf(".")+1,c=k;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===k)){for(s=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")+1:0,T=o[c].v.substr(0,s);s<o[c].v.length;++s)_<A.length&&(T+=A.charAt(_++));o[c].v=T,o[c].t="t",S=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(x=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=Tf(o[c].t,o[c].v,x),o[c].t="t");var P="";for(c=0;c!==o.length;++c)null!=o[c]&&(P+=o[c].v);return P}(a[1],t,i,a[0])}function Df(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',tf=e}var Of={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Rf=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Mf={"d.m":"d\\.m"};function If(e,t){return function(e,t){if("number"!=typeof t){t=+t||-1;for(var i=0;i<392;++i)if(null!=tf[i]){if(tf[i]==e){t=i;break}}else t<0&&(t=i);t<0&&(t=391)}return tf[t]=e,t}(Mf[e]||e,t)}var Lf,Ff=function(){var e={version:"1.2.0"},t=function(){for(var e=0,t=new Array(256),i=0;256!=i;++i)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=i)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[i]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),i=function(e){var t=0,i=0,r=0,a="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(i=e[r],t=256+r;t<4096;t+=256)i=a[t]=i>>>8^e[255&i];var s=[];for(r=1;16!=r;++r)s[r-1]="undefined"!=typeof Int32Array&&"function"==typeof a.subarray?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return s}(t),r=i[0],a=i[1],s=i[2],n=i[3],o=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],f=i[10],p=i[11],g=i[12],m=i[13],b=i[14];return e.table=t,e.bstr=function(e,i){for(var r=~i,a=0,s=e.length;a<s;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,i){for(var v=~i,y=e.length-15,_=0;_<y;)v=b[e[_++]^255&v]^m[e[_++]^v>>8&255]^g[e[_++]^v>>16&255]^p[e[_++]^v>>>24]^f[e[_++]]^d[e[_++]]^u[e[_++]]^h[e[_++]]^c[e[_++]]^l[e[_++]]^o[e[_++]]^n[e[_++]]^s[e[_++]]^a[e[_++]]^r[e[_++]]^t[e[_++]];for(y+=15;_<y;)v=v>>>8^t[255&(v^e[_++])];return~v},e.str=function(e,i){for(var r=~i,a=0,s=e.length,n=0,o=0;a<s;)(n=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^n)]:n<2048?r=(r=r>>>8^t[255&(r^(192|n>>6&31))])>>>8^t[255&(r^(128|63&n))]:n>=55296&&n<57344?(n=64+(1023&n),o=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|n>>8&7))])>>>8^t[255&(r^(128|n>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&n)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|n>>12&15))])>>>8^t[255&(r^(128|n>>6&63))])>>>8^t[255&(r^(128|63&n))];return~r},e}(),Nf=function(){var e,t={};function i(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:i(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"==typeof t&&(t=new Date(t));var i=t.getHours();i=(i=i<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,i);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function s(e){Bg(e,0);for(var t={},i=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),s=e.l+a,n={};switch(r){case 21589:1&(i=e.read_shift(1))&&(n.mtime=e.read_shift(4)),a>5&&(2&i&&(n.atime=e.read_shift(4)),4&i&&(n.ctime=e.read_shift(4))),n.mtime&&(n.mt=new Date(1e3*n.mtime));break;case 1:var o=e.read_shift(4),l=e.read_shift(4);n.usz=l*Math.pow(2,32)+o,o=e.read_shift(4),l=e.read_shift(4),n.csz=l*Math.pow(2,32)+o}e.l=s,t[r]=n}return t}function n(){return e||(e=Lf)}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=x(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var i=t&&t.root||"",r=(Ld&&Buffer.isBuffer(e)?e.toString("binary"):x(e)).split("\r\n"),a=0,s="";for(a=0;a<r.length;++a)if(s=r[a],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),i||(i=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,i.length)!=i))for(;i.length>0&&(i=(i=i.slice(0,i.length-1)).slice(0,i.lastIndexOf("/")+1),s.slice(0,i.length)!=i););var n=(r[1]||"").match(/boundary="(.*?)"/);if(!n)throw new Error("MAD cannot find boundary");var o="--"+(n[1]||""),l={FileIndex:[],FullPaths:[]};d(l);var c,h=0;for(a=0;a<r.length;++a){var u=r[a];u!==o&&u!==o+"--"||(h++&&ce(l,r.slice(c,a),i),c=a)}return l}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var i,r,a,s,n,o,f=512,p=[],g=e.slice(0,512);Bg(g,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(v,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(i=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+i)}512!==f&&Bg(g=e.slice(0,f),28);var y=e.slice(0,f);!function(e,t){var i;switch(e.l+=2,i=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+i);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+i);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+i)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,i);var _=g.read_shift(4,"i");if(3===i&&0!==_)throw new Error("# Directory Sectors: Expected 0 saw "+_);g.l+=4,s=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),n=g.read_shift(4,"i"),r=g.read_shift(4,"i"),o=g.read_shift(4,"i"),a=g.read_shift(4,"i");for(var w=-1,A=0;A<109&&!((w=g.read_shift(4,"i"))<0);++A)p[A]=w;var T=function(e,t){for(var i=Math.ceil(e.length/t)-1,r=[],a=1;a<i;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[i-1]=e.slice(i*t),r}(e,f);c(o,a,T,f,p);var k=function(e,t,i,r){var a=e.length,s=[],n=[],o=[],l=[],c=r-1,h=0,u=0,d=0,f=0;for(h=0;h<a;++h)if(o=[],(d=h+t)>=a&&(d-=a),!n[d]){l=[];var p=[];for(u=d;u>=0;){p[u]=!0,n[u]=!0,o[o.length]=u,l.push(e[u]);var g=i[Math.floor(4*u/r)];if(r<4+(f=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+r);if(!e[g])break;if(p[u=Dg(e[g],f)])break}s[d]={nodes:o,data:ng([l])}}return s}(T,s,p,f);s<k.length&&(k[s].name="!Directory"),r>0&&n!==b&&(k[n].name="!MiniFAT"),k[p[0]].name="!FAT",k.fat_addrs=p,k.ssz=f;var S=[],P=[],E=[];!function(e,t,i,r,a,s,n,o){for(var c,d=0,f=r.length?2:0,p=t[e].data,g=0,m=0;g<p.length;g+=128){var v=p.slice(g,g+128);Bg(v,64),m=v.read_shift(2),c=lg(v,0,m-f),r.push(c);var y={name:c,type:v.read_shift(1),color:v.read_shift(1),L:v.read_shift(4,"i"),R:v.read_shift(4,"i"),C:v.read_shift(4,"i"),clsid:v.read_shift(16),state:v.read_shift(4,"i"),start:0,size:0};0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(y.ct=u(v,v.l-8)),0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(y.mt=u(v,v.l-8)),y.start=v.read_shift(4,"i"),y.size=v.read_shift(4,"i"),y.size<0&&y.start<0&&(y.size=y.type=0,y.start=b,y.name=""),5===y.type?(d=y.start,a>0&&d!==b&&(t[d].name="!StreamData")):y.size>=4096?(y.storage="fat",void 0===t[y.start]&&(t[y.start]=h(i,y.start,t.fat_addrs,t.ssz)),t[y.start].name=y.name,y.content=t[y.start].data.slice(0,y.size)):(y.storage="minifat",y.size<0?y.size=0:d!==b&&y.start!==b&&t[d]&&(y.content=l(y,t[d].data,(t[o]||{}).data))),y.content&&Bg(y.content,0),s[c]=y,n.push(y)}}(s,k,T,S,r,{},P,n),function(e,t,i){for(var r=0,a=0,s=0,n=0,o=0,l=i.length,c=[],h=[];r<l;++r)c[r]=h[r]=r,t[r]=i[r];for(;o<h.length;++o)a=e[r=h[o]].L,s=e[r].R,n=e[r].C,c[r]===r&&(-1!==a&&c[a]!==a&&(c[r]=c[a]),-1!==s&&c[s]!==s&&(c[r]=c[s])),-1!==n&&(c[n]=r),-1!==a&&r!=c[r]&&(c[a]=c[r],h.lastIndexOf(a)<o&&h.push(a)),-1!==s&&r!=c[r]&&(c[s]=c[r],h.lastIndexOf(s)<o&&h.push(s));for(r=1;r<l;++r)c[r]===r&&(-1!==s&&c[s]!==s?c[r]=c[s]:-1!==a&&c[a]!==a&&(c[r]=c[a]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(P,E,S),S.shift();var C={FileIndex:P,FullPaths:E};return t&&t.raw&&(C.raw={header:y,sectors:T}),C}function l(e,t,i){for(var r=e.start,a=e.size,s=[],n=r;i&&a>0&&n>=0;)s.push(t.slice(n*m,n*m+m)),a-=m,n=Dg(i,4*n);return 0===s.length?zg(0):Wd(s).slice(0,e.size)}function c(e,t,i,r,a){var s=b;if(e===b){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var n=i[e],o=(r>>>2)-1;if(!n)return;for(var l=0;l<o&&(s=Dg(n,4*l))!==b;++l)a.push(s);t>=1&&c(Dg(n,r-4),t-1,i,r,a)}}function h(e,t,i,r,a){var s=[],n=[];a||(a=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,s[s.length]=l,n.push(e[l]);var h=i[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[h])break;l=Dg(e[h],c)}return{nodes:s,data:ng([n])}}function u(e,t){return new Date(1e3*(Cg(e,t+4)/1e7*Math.pow(2,32)+Cg(e,t)/1e7-11644473600))}function d(e,t){var i=t||{},r=i.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),i.CLSID&&(e.FileIndex[0].clsid=i.CLSID),function(e){var t="Sh33tJ5";if(!Nf.find(e,"/"+t)){var i=zg(4);i[0]=55,i[1]=i[3]=50,i[2]=54,e.FileIndex.push({name:t,type:2,content:i,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}}(e)}function f(e,t){d(e);for(var a=!1,s=!1,n=e.FullPaths.length-1;n>=0;--n){var o=e.FileIndex[n];switch(o.type){case 0:s?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,h=Object.create?Object.create(null):{},u=[];for(n=0;n<e.FullPaths.length;++n)h[e.FullPaths[n]]=!0,0!==e.FileIndex[n].type&&u.push([e.FullPaths[n],e.FileIndex[n]]);for(n=0;n<u.length;++n){var f=i(u[n][0]);for(s=h[f];!s;){for(;i(f)&&!h[i(f)];)f=i(f);u.push([f,{name:r(f).replace("/",""),type:1,clsid:_,ct:l,mt:l,content:null}]),h[f]=!0,s=h[f=i(u[n][0])]}}for(u.sort((function(e,t){return function(e,t){for(var i=e.split("/"),r=t.split("/"),a=0,s=0,n=Math.min(i.length,r.length);a<n;++a){if(s=i[a].length-r[a].length)return s;if(i[a]!=r[a])return i[a]<r[a]?-1:1}return i.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],n=0;n<u.length;++n)e.FullPaths[n]=u[n][0],e.FileIndex[n]=u[n][1];for(n=0;n<u.length;++n){var p=e.FileIndex[n],g=e.FullPaths[n];if(p.name=r(g).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||_,0===n)p.C=u.length>1?1:-1,p.size=0,p.type=5;else if("/"==g.slice(-1)){for(c=n+1;c<u.length&&i(e.FullPaths[c])!=g;++c);for(p.C=c>=u.length?-1:c,c=n+1;c<u.length&&i(e.FullPaths[c])!=i(g);++c);p.R=c>=u.length?-1:c,p.type=1}else i(e.FullPaths[n+1]||"")==i(g)&&(p.R=n+1),p.type=2}}}function p(e,t){var i=t||{};if("mad"==i.fileType)return function(e,t){for(var i=t||{},r=i.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],s=e.FullPaths[0],n=s,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(n=e.FullPaths[l].slice(s.length),(o=e.FileIndex[l]).size&&o.content&&"Sh33tJ5"!=n){n=n.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=o.content,h=Ld&&Buffer.isBuffer(c)?c.toString("binary"):x(c),u=0,d=Math.min(1024,h.length),f=0,p=0;p<=d;++p)(f=h.charCodeAt(p))>=32&&f<128&&++u;var g=u>=4*d/5;a.push(r),a.push("Content-Location: "+(i.root||"file:///C:/SheetJS/")+n),a.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),a.push("Content-Type: "+ne(o,n)),a.push(""),a.push(g?le(h):oe(h))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,i);if(f(e),"zip"===i.fileType)return function(e,t){var i,r=t||{},s=[],n=[],o=zg(1),l=r.compression?8:0,c=0,h=0,u=0,d=0,f=e.FullPaths[0],p=f,m=e.FileIndex[0],b=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(f.length),(m=e.FileIndex[c]).size&&m.content&&"Sh33tJ5"!=p){var y=u,_=zg(p.length);for(h=0;h<p.length;++h)_.write_shift(1,127&p.charCodeAt(h));_=_.slice(0,_.l),b[d]="string"==typeof m.content?Ff.bstr(m.content,0):Ff.buf(m.content,0);var w="string"==typeof m.content?zd(m.content):m.content;8==l&&(i=w,w=g?g.deflateRawSync(i):G(i)),(o=zg(30)).write_shift(4,67324752),o.write_shift(2,20),o.write_shift(2,0),o.write_shift(2,l),m.mt?a(o,m.mt):o.write_shift(4,0),o.write_shift(-4,b[d]),o.write_shift(4,w.length),o.write_shift(4,m.content.length),o.write_shift(2,_.length),o.write_shift(2,0),u+=o.length,s.push(o),u+=_.length,s.push(_),u+=w.length,s.push(w),(o=zg(46)).write_shift(4,33639248),o.write_shift(2,0),o.write_shift(2,20),o.write_shift(2,0),o.write_shift(2,l),o.write_shift(4,0),o.write_shift(-4,b[d]),o.write_shift(4,w.length),o.write_shift(4,m.content.length),o.write_shift(2,_.length),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o.write_shift(4,y),v+=o.l,n.push(o),v+=_.length,n.push(_),++d}return(o=zg(22)).write_shift(4,101010256),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,d),o.write_shift(2,d),o.write_shift(4,v),o.write_shift(4,u),o.write_shift(2,0),Wd([Wd(s),Wd(n),o])}(e,i);var r=function(e){for(var t=0,i=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var s=a.content.length;s>0&&(s<4096?t+=s+63>>6:i+=s+511>>9)}}for(var n=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+i+n+o,c=l+127>>7,h=c<=109?0:Math.ceil((c-109)/127);l+c+h+127>>7>c;)h=++c<=109?0:Math.ceil((c-109)/127);var u=[1,h,c,o,n,i,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),s=zg(r[7]<<9),n=0,o=0;for(n=0;n<8;++n)s.write_shift(1,y[n]);for(n=0;n<8;++n)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),n=0;n<3;++n)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,r[2]),s.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:b),s.write_shift(4,r[3]),s.write_shift(-4,r[1]?r[0]-1:b),s.write_shift(4,r[1]),n=0;n<109;++n)s.write_shift(-4,n<r[2]?r[1]+n:-1);if(r[1])for(o=0;o<r[1];++o){for(;n<236+127*o;++n)s.write_shift(-4,n<r[2]?r[1]+n:-1);s.write_shift(-4,o===r[1]-1?b:o+1)}var l=function(e){for(o+=e;n<o-1;++n)s.write_shift(-4,n+1);e&&(++n,s.write_shift(-4,b))};for(o=n=0,o+=r[1];n<o;++n)s.write_shift(-4,w.DIFSECT);for(o+=r[2];n<o;++n)s.write_shift(-4,w.FATSECT);l(r[3]),l(r[4]);for(var c=0,h=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((h=u.content.length)<4096||(u.start=o,l(h+511>>9)));for(l(r[6]+7>>3);511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(o=n=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(h=u.content.length)||h>=4096||(u.start=o,l(h+63>>6)));for(;511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(n=0;n<r[4]<<2;++n){var d=e.FullPaths[n];if(d&&0!==d.length){u=e.FileIndex[n],0===n&&(u.start=u.size?u.start-1:b);var p=0===n&&i.root||u.name;if(p.length>31&&(console.error("Name "+p+" will be truncated to "+p.slice(0,31)),p=p.slice(0,31)),h=2*(p.length+1),s.write_shift(64,p,"utf16le"),s.write_shift(2,h),s.write_shift(1,u.type),s.write_shift(1,u.color),s.write_shift(-4,u.L),s.write_shift(-4,u.R),s.write_shift(-4,u.C),u.clsid)s.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,u.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,u.start),s.write_shift(4,u.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(n=1;n<e.FileIndex.length;++n)if((u=e.FileIndex[n]).size>=4096)if(s.l=u.start+1<<9,Ld&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(n=1;n<e.FileIndex.length;++n)if((u=e.FileIndex[n]).size>0&&u.size<4096)if(Ld&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(Ld)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.2";var g,m=64,b=-2,v="d0cf11e0a1b11ae1",y=[208,207,17,224,161,177,26,225],_="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:b,FREESECT:-1,HEADER_SIGNATURE:v,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:_,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function x(e){for(var t=new Array(e.length),i=0;i<e.length;++i)t[i]=String.fromCharCode(e[i]);return t.join("")}for(var A,T,k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],P=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],E="undefined"!=typeof Uint8Array,C=E?new Uint8Array(256):[],D=0;D<256;++D)C[D]=(void 0,255&((T=139536&((A=D)<<1|A<<11)|558144&(A<<5|A<<15))>>16|T>>8|T));function O(e,t){var i=C[255&e];return t<=8?i>>>8-t:(i=i<<8|C[e>>8&255],t<=16?i>>>16-t:(i=i<<8|C[e>>16&255])>>>24-t)}function R(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=6?0:e[r+1]<<8))>>>i&3}function M(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=5?0:e[r+1]<<8))>>>i&7}function I(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=3?0:e[r+1]<<8))>>>i&31}function L(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=1?0:e[r+1]<<8))>>>i&127}function F(e,t,i){var r=7&t,a=t>>>3,s=(1<<i)-1,n=e[a]>>>r;return i<8-r?n&s:(n|=e[a+1]<<8-r,i<16-r?n&s:(n|=e[a+2]<<16-r,i<24-r?n&s:(n|=e[a+3]<<24-r)&s))}function N(e,t,i){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&i)<<r:(e[a]|=i<<r&255,e[a+1]=(7&i)>>8-r),t+3}function B(e,t,i){return i=(1&i)<<(7&t),e[t>>>3]|=i,t+1}function j(e,t,i){var r=t>>>3;return i<<=7&t,e[r]|=255&i,i>>>=8,e[r+1]=i,t+8}function z(e,t,i){var r=t>>>3;return i<<=7&t,e[r]|=255&i,i>>>=8,e[r+1]=255&i,e[r+2]=i>>>8,t+16}function U(e,t){var i=e.length,r=2*i>t?2*i:t+5,a=0;if(i>=t)return e;if(Ld){var s=jd(r);if(e.copy)e.copy(s);else for(;a<e.length;++a)s[a]=e[a];return s}if(E){var n=new Uint8Array(r);if(n.set)n.set(e);else for(;a<i;++a)n[a]=e[a];return n}return e.length=r,e}function H(e){for(var t=new Array(e),i=0;i<e;++i)t[i]=0;return t}function W(e,t,i){var r=1,a=0,s=0,n=0,o=0,l=e.length,c=E?new Uint16Array(32):H(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<i;++s)e[s]=0;l=e.length;var h=E?new Uint16Array(l):H(l);for(s=0;s<l;++s)c[a=e[s]]++,r<a&&(r=a),h[s]=0;for(c[0]=0,s=1;s<=r;++s)c[s+16]=o=o+c[s-1]<<1;for(s=0;s<l;++s)0!=(o=e[s])&&(h[s]=c[o+16]++);var u=0;for(s=0;s<l;++s)if(0!=(u=e[s]))for(o=O(h[s],r)>>r-u,n=(1<<r+4-u)-1;n>=0;--n)t[o|n<<u]=15&u|s<<4;return r}var V=E?new Uint16Array(512):H(512),$=E?new Uint16Array(32):H(32);if(!E){for(var X=0;X<512;++X)V[X]=0;for(X=0;X<32;++X)$[X]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);W(e,$,32);var i=[];for(t=0;t<=143;t++)i.push(8);for(;t<=255;t++)i.push(9);for(;t<=279;t++)i.push(7);for(;t<=287;t++)i.push(8);W(i,V,288)}();var Y=function(){for(var e=E?new Uint8Array(32768):[],t=0,i=0;t<P.length-1;++t)for(;i<P[t+1];++i)e[i]=t;for(;i<32768;++i)e[i]=29;var r=E?new Uint8Array(259):[];for(t=0,i=0;t<S.length-1;++t)for(;i<S[t+1];++i)r[i]=t;return function(t,i){return t.length<8?function(e,t){for(var i=0;i<e.length;){var r=Math.min(65535,e.length-i),a=i+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[i++]}return t.l}(t,i):function(t,i){for(var a=0,s=0,n=E?new Uint16Array(32768):[];s<t.length;){var o=Math.min(65535,t.length-s);if(o<10){for(7&(a=N(i,a,+!(s+o!=t.length)))&&(a+=8-(7&a)),i.l=a/8|0,i.write_shift(2,o),i.write_shift(2,65535&~o);o-- >0;)i[i.l++]=t[s++];a=8*i.l}else{a=N(i,a,+!(s+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[s],h=-1,u=0;if((h=n[l=32767&(l<<5^c)])&&((h|=-32768&s)>s&&(h-=32768),h<s))for(;t[h+u]==t[s+u]&&u<250;)++u;if(u>2){(c=r[u])<=22?a=j(i,a,C[c+1]>>1)-1:(j(i,a,3),j(i,a+=5,C[c-23]>>5),a+=3);var d=c<8?0:c-4>>2;d>0&&(z(i,a,u-S[c]),a+=d),c=e[s-h],a=j(i,a,C[c]>>3),a-=3;var f=c<4?0:c-2>>1;f>0&&(z(i,a,s-h-P[c]),a+=f);for(var p=0;p<u;++p)n[l]=32767&s,l=32767&(l<<5^t[s]),++s;o-=u-1}else c<=143?c+=48:a=B(i,a,1),a=j(i,a,C[c]),n[l]=32767&s,++s}a=j(i,a,0)-1}}return i.l=(a+7)/8|0,i.l}(t,i)}}();function G(e){var t=zg(50+Math.floor(1.1*e.length)),i=Y(e,t);return t.slice(0,i)}var K=E?new Uint16Array(32768):H(32768),q=E?new Uint16Array(32768):H(32768),Z=E?new Uint16Array(128):H(128),J=1,Q=1;function ee(e,t){var i=I(e,t)+257,r=I(e,t+=5)+1,a=function(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=4?0:e[r+1]<<8))>>>i&15}(e,t+=5)+4;t+=4;for(var s=0,n=E?new Uint8Array(19):H(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=E?new Uint8Array(8):H(8),h=E?new Uint8Array(8):H(8),u=n.length,d=0;d<a;++d)n[k[d]]=s=M(e,t),l<s&&(l=s),c[s]++,t+=3;var f=0;for(c[0]=0,d=1;d<=l;++d)h[d]=f=f+c[d-1]<<1;for(d=0;d<u;++d)0!=(f=n[d])&&(o[d]=h[f]++);var p=0;for(d=0;d<u;++d)if(0!=(p=n[d])){f=C[o[d]]>>8-p;for(var g=(1<<7-p)-1;g>=0;--g)Z[f|g<<p]=7&p|d<<3}var m=[];for(l=1;m.length<i+r;)switch(t+=7&(f=Z[L(e,t)]),f>>>=3){case 16:for(s=3+R(e,t),t+=2,f=m[m.length-1];s-- >0;)m.push(f);break;case 17:for(s=3+M(e,t),t+=3;s-- >0;)m.push(0);break;case 18:for(s=11+L(e,t),t+=7;s-- >0;)m.push(0);break;default:m.push(f),l<f&&(l=f)}var b=m.slice(0,i),v=m.slice(i);for(d=i;d<286;++d)b[d]=0;for(d=r;d<30;++d)v[d]=0;return J=W(b,K,286),Q=W(v,q,30),t}function te(e,t){var i=function(e,t){if(3==e[0]&&!(3&e[1]))return[Bd(t),2];for(var i=0,r=0,a=jd(t||1<<18),s=0,n=a.length>>>0,o=0,l=0;!(1&r);)if(r=M(e,i),i+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(i=ee(e,i),o=J,l=Q);;){!t&&n<s+32767&&(n=(a=U(a,s+32767)).length);var c=F(e,i,o),h=r>>>1==1?V[c]:K[c];if(i+=15&h,(h>>>=4)>>>8&255){if(256==h)break;var u=(h-=257)<8?0:h-4>>2;u>5&&(u=0);var d=s+S[h];u>0&&(d+=F(e,i,u),i+=u),c=F(e,i,l),i+=15&(h=r>>>1==1?$[c]:q[c]);var f=(h>>>=4)<4?0:h-2>>1,p=P[h];for(f>0&&(p+=F(e,i,f),i+=f),!t&&n<d&&(n=(a=U(a,d+100)).length);s<d;)a[s]=a[s-p],++s}else a[s++]=h}else{7&i&&(i+=8-(7&i));var g=e[i>>>3]|e[1+(i>>>3)]<<8;if(i+=32,g>0)for(!t&&n<s+g&&(n=(a=U(a,s+g)).length);g-- >0;)a[s++]=e[i>>>3],i+=8}return t?[a,i+7>>>3]:[a.slice(0,s),i+7>>>3]}(e.slice(e.l||0),t);return e.l+=i[1],i[0]}function ie(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function re(e,t){var i=e;Bg(i,0);var r={FileIndex:[],FullPaths:[]};d(r,{root:t.root});for(var a=i.length-4;(80!=i[a]||75!=i[a+1]||5!=i[a+2]||6!=i[a+3])&&a>=0;)--a;i.l=a+4,i.l+=4;var n=i.read_shift(2);i.l+=6;var o=i.read_shift(4);for(i.l=o,a=0;a<n;++a){i.l+=20;var l=i.read_shift(4),c=i.read_shift(4),h=i.read_shift(2),u=i.read_shift(2),f=i.read_shift(2);i.l+=8;var p=i.read_shift(4),g=s(i.slice(i.l+h,i.l+h+u));i.l+=h+u+f;var m=i.l;i.l=p+4,g&&g[1]&&((g[1]||{}).usz&&(c=g[1].usz),(g[1]||{}).csz&&(l=g[1].csz)),ae(i,l,c,r,g),i.l=m}return r}function ae(e,t,i,r,a){e.l+=2;var n=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),i=65535&e.read_shift(2),r=new Date,a=31&i,s=15&(i>>>=5);i>>>=4,r.setMilliseconds(0),r.setFullYear(i+1980),r.setMonth(s-1),r.setDate(a);var n=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(n<<1),r}(e);if(8257&n)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),h=e.read_shift(4),u=e.read_shift(2),d=e.read_shift(2),f="",p=0;p<u;++p)f+=String.fromCharCode(e[e.l++]);if(d){var m=s(e.slice(e.l,e.l+d));(m[21589]||{}).mt&&(l=m[21589].mt),(m[1]||{}).usz&&(h=m[1].usz),(m[1]||{}).csz&&(c=m[1].csz),a&&((a[21589]||{}).mt&&(l=a[21589].mt),(a[1]||{}).usz&&(h=m[1].usz),(a[1]||{}).csz&&(c=m[1].csz))}e.l+=d;var b=e.slice(e.l,e.l+c);switch(o){case 8:b=function(e,t){if(!g)return te(e,t);var i=new(0,g.InflateRaw),r=i._processChunk(e.slice(e.l),i._finishFlushFlag);return e.l+=i.bytesRead,r}(e,h);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var v=!1;8&n&&(134695760==e.read_shift(4)&&(e.read_shift(4),v=!0),c=e.read_shift(4),h=e.read_shift(4)),c!=t&&ie(v,"Bad compressed size: "+t+" != "+c),h!=i&&ie(v,"Bad uncompressed size: "+i+" != "+h),he(r,f,b,{unsafe:!0,mt:l})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ne(e,t){if(e.ctype)return e.ctype;var i=e.name||"",r=i.match(/\.([^\.]+)$/);return r&&se[r[1]]||t&&(r=(i=t).match(/[\.\\]([^\.\\])+$/))&&se[r[1]]?se[r[1]]:"application/octet-stream"}function oe(e){for(var t=Md(e),i=[],r=0;r<t.length;r+=76)i.push(t.slice(r,r+76));return i.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var i=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var s=r[a];if(0!=s.length)for(var n=0;n<s.length;){var o=76,l=s.slice(n,n+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(n,n+o),(n+=o)<s.length&&(l+="="),i.push(l)}else i.push("")}return i.join("\r\n")}function ce(e,t,i){for(var r,a="",s="",n="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^([^:]*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":n=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++o,s.toLowerCase()){case"base64":r=zd(Id(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],i=0;i<e.length;++i){for(var r=e[i];i<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++i];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return zd(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var h=he(e,a.slice(i.length),r,{unsafe:!0});n&&(h.ctype=n)}function he(e,t,i,a){var s=a&&a.unsafe;s||d(e);var n=!s&&Nf.find(e,t);if(!n){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),n={name:r(t),type:2},e.FileIndex.push(n),e.FullPaths.push(o),s||Nf.utils.cfb_gc(e)}return n.content=i,n.size=i?i.length:0,a&&(a.CLSID&&(n.clsid=a.CLSID),a.mt&&(n.mt=a.mt),a.ct&&(n.ct=a.ct)),n}return t.find=function(e,t){var i=e.FullPaths.map((function(e){return e.toUpperCase()})),r=i.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),a=!1;47===t.charCodeAt(0)?(a=!0,t=i[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var s=t.toUpperCase(),n=!0===a?i.indexOf(s):r.indexOf(s);if(-1!==n)return e.FileIndex[n];var o=!s.match($d);for(s=s.replace(Vd,""),o&&(s=s.replace($d,"!")),n=0;n<i.length;++n){if((o?i[n].replace($d,"!"):i[n]).replace(Vd,"")==s)return e.FileIndex[n];if((o?r[n].replace($d,"!"):r[n]).replace(Vd,"")==s)return e.FileIndex[n]}return null},t.read=function(t,i){var r=i&&i.type;switch(r||Ld&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,i){return n(),o(e.readFileSync(t),i)}(t,i);case"base64":return o(zd(Id(t)),i);case"binary":return o(zd(t),i)}return o(t,i)},t.parse=o,t.write=function(t,i){var r=p(t,i);switch(i&&i.type||"buffer"){case"file":return n(),e.writeFileSync(i.filename,r),r;case"binary":return"string"==typeof r?r:x(r);case"base64":return Md("string"==typeof r?r:x(r));case"buffer":if(Ld)return Buffer.isBuffer(r)?r:Fd(r);case"array":return"string"==typeof r?zd(r):r}return r},t.writeFile=function(t,i,r){n();var a=p(t,r);e.writeFileSync(i,a)},t.utils={cfb_new:function(e){var t={};return d(t,e),t},cfb_add:he,cfb_del:function(e,t){d(e);var i=Nf.find(e,t);if(i)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==i)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,i){d(e);var a=Nf.find(e,t);if(a)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==a)return e.FileIndex[s].name=r(i),e.FullPaths[s]=i,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Rg,CheckField:Ng,prep_blob:Bg,bconcat:Wd,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:G,_inflateRaw:te,consts:w},t}();function Bf(e){for(var t=Object.keys(e),i=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&i.push(t[r]);return i}function jf(e){for(var t=[],i=Bf(e),r=0;r!==i.length;++r)t[e[i[r]]]=i[r];return t}var zf=Date.UTC(1899,11,30,0,0,0),Uf=Date.UTC(1899,11,31,0,0,0),Hf=Date.UTC(1904,0,1,0,0,0);function Wf(e,t){var i=(e.getTime()-zf)/864e5;return t?(i-=1462)<-1402?i-1:i:i<60?i-1:i}function Vf(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime(24*(e>60?e:e+1)*60*60*1e3+zf),t}function $f(e){var t=0,i=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(i=1,s>3&&(r=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":i*=24;case"H":i*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");i*=60}t+=i*parseInt(a[s],10)}return t}var Xf=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,Yf=/^(\d+)-(\d+)-(\d+)$/,Gf=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Kf(e,t){if(e instanceof Date)return e;var i=e.match(Xf);return i?new Date((t?Hf:Uf)+1e3*(60*(60*parseInt(i[1],10)+parseInt(i[2],10))+(i[3]?parseInt(i[3].slice(1),10):0))+(i[4]?parseInt((i[4]+"000").slice(1,4),10):0)):(i=e.match(Yf))?new Date(Date.UTC(+i[1],+i[2]-1,+i[3],0,0,0,0)):(i=e.match(Gf))?new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],i[6]&&parseInt(i[6].slice(1),10)||0,i[7]&&parseInt((i[7]+"0000").slice(1,4),10)||0)):new Date(e)}function qf(e,t){if(Ld&&Buffer.isBuffer(e)){if(t&&Nd){if(255==e[0]&&254==e[1])return Kp(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Kp(Ed(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Kp(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Kp(new TextDecoder("utf-16be").decode(e.slice(2)))}var i={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"",ˆ:"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,(function(e){return i[e]||e}))}catch(e){}var r=[],a=0;try{for(a=0;a<e.length-65536;a+=65536)r.push(String.fromCharCode.apply(0,e.slice(a,a+65536)));r.push(String.fromCharCode.apply(0,e.slice(a)))}catch(t){try{for(;a<e.length-16384;a+=16384)r.push(String.fromCharCode.apply(0,e.slice(a,a+16384)));r.push(String.fromCharCode.apply(0,e.slice(a)))}catch(t){for(;a!=e.length;++a)r.push(String.fromCharCode(e[a]))}}return r.join("")}function Zf(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=Zf(e[i]));return t}function Jf(e,t){for(var i="";i.length<t;)i+=e;return i}function Qf(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var i=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return i*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(]([^()]*)[)]/,(function(e,t){return i=-i,t})),isNaN(t=Number(r))?t:t/i):t/i}var ep=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,tp=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,ip=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,rp=-177984e5==new Date("6/9/69 00:00 UTC").valueOf(),ap=["january","february","march","april","may","june","july","august","september","october","november","december"];function sp(e){if(ip.test(e))return-1==e.indexOf("Z")?lp(new Date(e)):new Date(e);var t=e.toLowerCase(),i=t.replace(/\s+/g," ").trim(),r=i.match(ep);if(r)return function(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,"p"==e[7]?12:0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),0,0,0))}(r);if(r=i.match(tp))return function(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}(r);if(r=i.match(Gf))return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var a=new Date(rp&&-1==e.indexOf("UTC")?e+" UTC":e),s=new Date(NaN),n=a.getYear(),o=(a.getMonth(),a.getDate());if(isNaN(o))return s;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==ap.indexOf(t))return s}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return s;return n<0||n>8099||e.match(/[^-0-9:,\/\\\ ]/)?s:a}var np=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,i,r){if(e||"string"==typeof i)return t.split(i);for(var a=t.split(i),s=[a[0]],n=1;n<a.length;++n)s.push(r),s.push(a[n]);return s}}();function op(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function lp(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function cp(e){var t=e.slice(0,1024).indexOf("<!DOCTYPE");if(-1==t)return e;var i=e.match(/<[\w]/);return i?e.slice(0,t)+e.slice(i.index):e}function hp(e,t,i){for(var r=[],a=e.indexOf(t);a>-1;){var s=e.indexOf(i,a+t.length);if(-1==s)break;r.push(e.slice(a,s+i.length)),a=e.indexOf(t,s+i.length)}return r.length>0?r:null}function up(e,t,i){var r=[],a=0,s=e.indexOf(t);if(-1==s)return e;for(;s>-1;){r.push(e.slice(a,s));var n=e.indexOf(i,s+t.length);if(-1==n)break;-1==(s=e.indexOf(t,a=n+i.length))&&r.push(e.slice(a))}return r.join("")}var dp={" ":1,"\t":1,"\r":1,"\n":1,">":1};function fp(e,t){for(var i=e.indexOf("<"+t),r=t.length+1,a=e.length;i>=0&&i<=a-r&&!dp[e.charAt(i+r)];)i=e.indexOf("<"+t,i+1);if(-1===i)return null;var s=e.indexOf(">",i+t.length);if(-1===s)return null;var n="</"+t+">",o=e.indexOf(n,s);return-1==o?null:[e.slice(i,o+n.length),e.slice(s+1,o)]}var pp=function(){var e={};return function(t,i){var r=e[i];r||(e[i]=r=[new RegExp("<(?:\\w+:)?"+i+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+i+">","g")]),r[0].lastIndex=r[1].lastIndex=0;var a=r[0].exec(t);if(!a)return null;var s=a.index,n=r[0].lastIndex;if(r[1].lastIndex=r[0].lastIndex,!(a=r[1].exec(t)))return null;var o=a.index,l=r[1].lastIndex;return[t.slice(s,l),t.slice(n,o)]}}(),gp=function(){var e={};return function(t,i){var r,a=[],s=e[i];for(s||(e[i]=s=[new RegExp("<(?:\\w+:)?"+i+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+i+">","g")]),s[0].lastIndex=s[1].lastIndex=0;r=s[0].exec(t);){var n=r.index;if(s[1].lastIndex=s[0].lastIndex,!(r=s[1].exec(t)))return null;var o=s[1].lastIndex;a.push(t.slice(n,o)),s[0].lastIndex=s[1].lastIndex}return 0==a.length?null:a}}(),mp=function(){var e={};return function(t,i){var r,a=[],s=e[i];s||(e[i]=s=[new RegExp("<(?:\\w+:)?"+i+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+i+">","g")]),s[0].lastIndex=s[1].lastIndex=0;for(var n=0,o=0;r=s[0].exec(t);){if(n=r.index,a.push(t.slice(o,n)),o=n,s[1].lastIndex=s[0].lastIndex,!(r=s[1].exec(t)))return null;o=s[1].lastIndex,s[0].lastIndex=s[1].lastIndex}return a.push(t.slice(o)),0==a.length?"":a.join("")}}(),bp=function(){var e={};return function(t,i){var r,a=[],s=e[i];for(s||(e[i]=s=[new RegExp("<"+i+"\\b[^<>]*>","ig"),new RegExp("</"+i+">","ig")]),s[0].lastIndex=s[1].lastIndex=0;r=s[0].exec(t);){var n=r.index;if(s[1].lastIndex=s[0].lastIndex,!(r=s[1].exec(t)))return null;var o=s[1].lastIndex;a.push(t.slice(n,o)),s[0].lastIndex=s[1].lastIndex}return 0==a.length?null:a}}();function vp(e){return e?e.content&&e.type?qf(e.content,!0):e.data?Cd(e.data):e.asNodeBuffer&&Ld?Cd(e.asNodeBuffer().toString("binary")):e.asBinary?Cd(e.asBinary()):e._data&&e._data.getContent?Cd(qf(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function yp(e){if(!e)return null;if(e.data)return Sd(e.data);if(e.asNodeBuffer&&Ld)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?Sd(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function _p(e,t){for(var i=e.FullPaths||Bf(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),s=0;s<i.length;++s){var n=i[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==n||a==n)return e.files?e.files[i[s]]:e.FileIndex[s]}return null}function wp(e,t){var i=_p(e,t);if(null==i)throw new Error("Cannot find file "+t+" in zip");return i}function xp(e,t,i){if(!i)return(r=wp(e,t))&&".bin"===r.name.slice(-4)?yp(r):vp(r);var r;if(!t)return null;try{return xp(e,t)}catch(e){return null}}function Ap(e,t,i){if(!i)return vp(wp(e,t));if(!t)return null;try{return Ap(e,t)}catch(e){return null}}function Tp(e,t,i){if(!i)return yp(wp(e,t));if(!t)return null;try{return Tp(e,t)}catch(e){return null}}function kp(e){for(var t=e.FullPaths||Bf(e.files),i=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&i.push(t[r].replace(/^Root Entry[\/]/,""));return i.sort()}function Sp(e,t){switch(t.type){case"base64":return Nf.read(e,{type:"base64"});case"binary":return Nf.read(e,{type:"binary"});case"buffer":case"array":return Nf.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Pp(e,t){if("/"==e.charAt(0))return e.slice(1);var i=t.split("/");"/"!=t.slice(-1)&&i.pop();for(var r=e.split("/");0!==r.length;){var a=r.shift();".."===a?i.pop():"."!==a&&i.push(a)}return i.join("/")}var Ep='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Cp=/\s([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Dp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?<>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'"<>\s=]+))*\s*[\/\?]?>/gm,Op=Ep.match(Dp)?Dp:/<[^<>]*>/g,Rp=/<\w*:/,Mp=/<(\/?)\w+:/;function Ip(e,t,i){for(var r={},a=0,s=0;a!==e.length&&32!==(s=e.charCodeAt(a))&&10!==s&&13!==s;++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var n=e.match(Cp),o=0,l="",c=0,h="",u="",d=1;if(n)for(c=0;c!=n.length;++c){for(u=n[c].slice(1),s=0;s!=u.length&&61!==u.charCodeAt(s);++s);for(h=u.slice(0,s).trim();32==u.charCodeAt(s+1);)++s;for(d=34==(a=u.charCodeAt(s+1))||39==a?1:0,l=u.slice(s+1+d,u.length-d),o=0;o!=h.length&&58!==h.charCodeAt(o);++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),r[h]=l,i||(r[h.toLowerCase()]=l);else{var f=(5===o&&"xmlns"===h.slice(0,5)?"xmlns":"")+h.slice(o+1);if(r[f]&&"ext"==h.slice(o-3,o))continue;r[f]=l,i||(r[f.toLowerCase()]=l)}}return r}function Lp(e){return e.replace(Mp,"<$1")}var Fp={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Np=jf(Fp),Bp=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;function i(r){var a=r+"",s=a.indexOf("<![CDATA[");if(-1==s)return a.replace(e,(function(e,t){return Fp[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var n=a.indexOf("]]>");return i(a.slice(0,s))+a.slice(s+9,n)+i(a.slice(n+3))}return function(e,t){var r=i(e);return t?r.replace(/\r\n/g,"\n"):r}}(),jp=/[&<>'"]/g,zp=/[\u0000-\u001f]/g;function Up(e){return(e+"").replace(jp,(function(e){return Np[e]})).replace(/\n/g,"<br/>").replace(zp,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var Hp=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(i){return i.replace(e,t)}}();function Wp(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Vp(e){for(var t="",i=0,r=0,a=0,s=0,n=0,o=0;i<e.length;)(r=e.charCodeAt(i++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(i++),r>191&&r<224?(n=(31&r)<<6,n|=63&a,t+=String.fromCharCode(n)):(s=e.charCodeAt(i++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&s):(o=((7&r)<<18|(63&a)<<12|(63&s)<<6|63&(n=e.charCodeAt(i++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function $p(e){var t,i,r,a=Bd(2*e.length),s=1,n=0,o=0;for(i=0;i<e.length;i+=s)s=1,(r=e.charCodeAt(i))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(i+1)),s=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(i+1))+(63&e.charCodeAt(i+2)),s=3):(s=4,t=262144*(7&r)+4096*(63&e.charCodeAt(i+1))+64*(63&e.charCodeAt(i+2))+(63&e.charCodeAt(i+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[n++]=255&o,a[n++]=o>>>8,o=0),a[n++]=t%256,a[n++]=t>>>8;return a.slice(0,n).toString("ucs2")}function Xp(e){return Fd(e,"binary").toString("utf8")}var Yp="foo bar bazâð£",Gp=Ld&&(Xp(Yp)==Vp(Yp)&&Xp||$p(Yp)==Vp(Yp)&&$p)||Vp,Kp=Ld?function(e){return Fd(e,"utf8").toString("binary")}:function(e){for(var t=[],i=0,r=0,a=0;i<e.length;)switch(r=e.charCodeAt(i++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(i++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},qp=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^<>]*>/g,""),r=0;r<e.length;++r)i=i.replace(e[r][0],e[r][1]);return i}}(),Zp=/<\/?(?:vt:)?variant>/g,Jp=/<(?:vt:)([^<"'>]*)>([\s\S]*)</;function Qp(e,t){var i=Ip(e),r=gp(e,i.baseType)||[],a=[];if(r.length!=i.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+i.size);return a}return r.forEach((function(e){var t=e.replace(Zp,"").match(Jp);t&&a.push({v:Gp(t[2]),t:t[1]})})),a}var eg=/(^\s|\s$|\n)/;function tg(e,t,i){return"<"+e+(null!=i?function(e){return Bf(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}(i):"")+(null!=t?(t.match(eg)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ig(e){if(Ld&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return Gp(Ud(Hd(e)));throw new Error("Bad input format: expected Buffer or string")}var rg=/<([\/]?)([^\s?><!\/:"]*:|)([^\s?<>:\/"]+)(?:\s+[^<>=?"'\s]+="[^"]*?")*\s*[\/]?>/gm,ag=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],sg=function(e){for(var t=[],i=0;i<e[0].length;++i)if(e[0][i])for(var r=0,a=e[0][i].length;r<a;r+=10240)t.push.apply(t,e[0][i].slice(r,r+10240));return t},ng=Ld?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:Fd(e)}))):sg(e)}:sg,og=function(e,t,i){for(var r=[],a=t;a<i;a+=2)r.push(String.fromCharCode(Pg(e,a)));return r.join("").replace(Vd,"")},lg=Ld?function(e,t,i){return Buffer.isBuffer(e)&&Nd?e.toString("utf16le",t,i).replace(Vd,""):og(e,t,i)}:og,cg=function(e,t,i){for(var r=[],a=t;a<t+i;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},hg=Ld?function(e,t,i){return Buffer.isBuffer(e)?e.toString("hex",t,t+i):cg(e,t,i)}:cg,ug=function(e,t,i){for(var r=[],a=t;a<i;a++)r.push(String.fromCharCode(Sg(e,a)));return r.join("")},dg=Ld?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):ug(e,t,i)}:ug,fg=function(e,t){var i=Cg(e,t);return i>0?dg(e,t+4,t+4+i-1):""},pg=fg,gg=function(e,t){var i=Cg(e,t);return i>0?dg(e,t+4,t+4+i-1):""},mg=gg,bg=function(e,t){var i=2*Cg(e,t);return i>0?dg(e,t+4,t+4+i-1):""},vg=bg,yg=function(e,t){var i=Cg(e,t);return i>0?lg(e,t+4,t+4+i):""},_g=yg,wg=function(e,t){var i=Cg(e,t);return i>0?dg(e,t+4,t+4+i):""},xg=wg,Ag=function(e,t){return function(e,t){for(var i=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],s=5;s>=0;--s)a=256*a+e[t+s];return 2047==r?0==a?i*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),i*Math.pow(2,r-52)*a)}(e,t)},Tg=Ag,kg=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};Ld&&(pg=function(e,t){if(!Buffer.isBuffer(e))return fg(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},mg=function(e,t){if(!Buffer.isBuffer(e))return gg(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},vg=function(e,t){if(!Buffer.isBuffer(e)||!Nd)return bg(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},_g=function(e,t){if(!Buffer.isBuffer(e)||!Nd)return yg(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},xg=function(e,t){if(!Buffer.isBuffer(e))return wg(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},Tg=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Ag(e,t)},kg=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array});var Sg=function(e,t){return e[t]},Pg=function(e,t){return 256*e[t+1]+e[t]},Eg=function(e,t){var i=256*e[t+1]+e[t];return i<32768?i:-1*(65535-i+1)},Cg=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Dg=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Og=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Rg(e,t){var i,r,a,s,n,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,Ld&&Buffer.isBuffer(this)&&Nd)l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(n=0;n<e;++n)l+=String.fromCharCode(Pg(this,o)),o+=2;e*=2;break;case"utf8":l=dg(this,this.l,this.l+e);break;case"utf16le":e*=2,l=lg(this,this.l,this.l+e);break;case"wstr":return Rg.call(this,e,"dbcs");case"lpstr-ansi":l=pg(this,this.l),e=4+Cg(this,this.l);break;case"lpstr-cp":l=mg(this,this.l),e=4+Cg(this,this.l);break;case"lpwstr":l=vg(this,this.l),e=4+2*Cg(this,this.l);break;case"lpp4":e=4+Cg(this,this.l),l=_g(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Cg(this,this.l),l=xg(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=Sg(this,this.l+e++));)c.push(Dd(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=Pg(this,this.l+e));)c.push(Dd(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,n=0;n<e;++n){if(this.lens&&-1!==this.lens.indexOf(o))return a=Sg(this,o),this.l=o+1,s=Rg.call(this,e-n,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(Dd(Pg(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":0;case"sbcs-cont":for(l="",o=this.l,n=0;n!=e;++n){if(this.lens&&-1!==this.lens.indexOf(o))return a=Sg(this,o),this.l=o+1,s=Rg.call(this,e-n,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(Dd(Sg(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return i=Sg(this,this.l),this.l++,i;case 2:return i=("i"===t?Eg:Pg)(this,this.l),this.l+=2,i;case 4:case-4:return"i"!==t&&128&this[this.l+3]?(r=Cg(this,this.l),this.l+=4,r):(i=(e>0?Dg:Og)(this,this.l),this.l+=4,i);case 8:case-8:if("f"===t)return r=8==e?Tg(this,this.l):Tg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=hg(this,this.l,e)}}return this.l+=e,l}var Mg=function(e,t,i){e[i]=255&t,e[i+1]=t>>>8&255,e[i+2]=t>>>16&255,e[i+3]=t>>>24&255},Ig=function(e,t,i){e[i]=255&t,e[i+1]=t>>8&255,e[i+2]=t>>16&255,e[i+3]=t>>24&255},Lg=function(e,t,i){e[i]=255&t,e[i+1]=t>>>8&255};function Fg(e,t,i){var r=0,a=0;if("dbcs"===i){for(a=0;a!=t.length;++a)Lg(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===i||"cpstr"==i){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===i){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===i){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var n=t.charCodeAt(a);this[this.l++]=255&n,this[this.l++]=n>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,Mg(this,t,this.l);break;case 8:if(r=8,"f"===i){!function(e,t,i){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,n=r?-t:t;isFinite(n)?0==n?a=s=0:(a=Math.floor(Math.log(n)/Math.LN2),s=n*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[i+o]=255&s;e[i+6]=(15&a)<<4|15&s,e[i+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,Ig(this,t,this.l)}}return this.l+=r,this}function Ng(e,t){var i=hg(this,this.l,e.length>>1);if(i!==e)throw new Error(t+"Expected "+e+" saw "+i);this.l+=e.length>>1}function Bg(e,t){e.l=t,e.read_shift=Rg,e.chk=Ng,e.write_shift=Fg}function jg(e,t){e.l+=t}function zg(e){var t=Bd(e);return Bg(t,0),t}function Ug(e,t,i){if(e){var r,a,s;Bg(e,e.l||0);for(var n=e.length,o=0,l=0;e.l<n;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=f_[o]||f_[65535];for(s=127&(r=e.read_shift(1)),a=1;a<4&&128&r;++a)s+=(127&(r=e.read_shift(1)))<<7*a;l=e.l+s;var h=c.f&&c.f(e,s,i);if(e.l=l,t(h,c,o))return}}}function Hg(){var e=[],t=Ld?256:2048,i=function(e){var t=zg(e);return Bg(t,0),t},r=i(t),a=function(){r&&(r.l&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r)),r=null)},s=function(e){return r&&e<r.length-r.l?r:(a(),r=i(Math.max(e+1,t)))};return{next:s,push:function(e){a(),null==(r=e).l&&(r.l=r.length),s(t)},end:function(){return a(),Wd(e)},_bufs:e}}function Wg(e,t,i){var r=Zf(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!i||i.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Vg(e,t,i){var r=Zf(e);return r.s=Wg(r.s,t.s,i),r.e=Wg(r.e,t.s,i),r}function $g(e,t){if(e.cRel&&e.c<0)for(e=Zf(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Zf(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var i=Jg(e);return e.cRel||null==e.cRel||(i=i.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(i=i.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")),i}function Xg(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?$g(e.s,t.biff)+":"+$g(e.e,t.biff):(e.s.rRel?"":"$")+Gg(e.s.r)+":"+(e.e.rRel?"":"$")+Gg(e.e.r):(e.s.cRel?"":"$")+qg(e.s.c)+":"+(e.e.cRel?"":"$")+qg(e.e.c)}function Yg(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Gg(e){return""+(e+1)}function Kg(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),i=0,r=0;r!==t.length;++r)i=26*i+t.charCodeAt(r)-64;return i-1}function qg(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Zg(e){for(var t=0,i=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(i=26*i+(a-64))}return{c:i-1,r:t-1}}function Jg(e){for(var t=e.c+1,i="";t;t=(t-1)/26|0)i=String.fromCharCode((t-1)%26+65)+i;return i+(e.r+1)}function Qg(e){var t=e.indexOf(":");return-1==t?{s:Zg(e),e:Zg(e)}:{s:Zg(e.slice(0,t)),e:Zg(e.slice(t+1))}}function em(e,t){return void 0===t||"number"==typeof t?em(e.s,e.e):("string"!=typeof e&&(e=Jg(e)),"string"!=typeof t&&(t=Jg(t)),e==t?e:e+":"+t)}function tm(e){var t={s:{c:0,r:0},e:{c:0,r:0}},i=0,r=0,a=0,s=e.length;for(i=0;r<s&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)i=26*i+a;for(t.s.c=--i,i=0;r<s&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)i=10*i+a;if(t.s.r=--i,r===s||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,i=0;r!=s&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)i=26*i+a;for(t.e.c=--i,i=0;r!=s&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)i=10*i+a;return t.e.r=--i,t}function im(e,t,i){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&i&&i.dateNF&&(e.z=i.dateNF),"e"==e.t?Cm[e.v]||e.v:function(e,t){var i="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Cf(e.z,i?Wf(t):t)}catch(e){}try{return e.w=Cf((e.XF||{}).numFmtId||(i?14:0),i?Wf(t):t)}catch(e){return""+t}}(e,null==t?e.v:t))}function rm(e,t){var i=t&&t.sheet?t.sheet:"Sheet1",r={};return r[i]=e,{SheetNames:[i],Sheets:r}}function am(e,t,i){var r=i||{},a=e?null!=e["!data"]:r.dense,s=e||{};a&&!s["!data"]&&(s["!data"]=[]);var n=0,o=0;if(s&&null!=r.origin)if("number"==typeof r.origin)n=r.origin;else{var l="string"==typeof r.origin?Zg(r.origin):r.origin;n=l.r,o=l.c}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=tm(s["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),-1==n&&(c.e.r=n=s["!ref"]?h.e.r+1:0)}else c.s.c=c.e.c=c.s.r=c.e.r=0;for(var u=[],d=!1,f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");var p=n+f,g=""+(p+1);a&&(s["!data"][p]||(s["!data"][p]=[]),u=s["!data"][p]);for(var m=0;m!=t[f].length;++m)if(void 0!==t[f][m]){var b={v:t[f][m]},v=o+m;if(c.s.r>p&&(c.s.r=p),c.s.c>v&&(c.s.c=v),c.e.r<p&&(c.e.r=p),c.e.c<v&&(c.e.c=v),d=!0,!t[f][m]||"object"!=typeof t[f][m]||Array.isArray(t[f][m])||t[f][m]instanceof Date)if(Array.isArray(b.v)&&(b.f=t[f][m][1],b.v=b.v[0]),null===b.v)if(b.f)b.t="n";else if(r.nullError)b.t="e",b.v=0;else{if(!r.sheetStubs)continue;b.t="z"}else"number"==typeof b.v?b.t="n":"boolean"==typeof b.v?b.t="b":b.v instanceof Date?(b.z=r.dateNF||tf[14],r.UTC||(b.v=lp(b.v)),r.cellDates?(b.t="d",b.w=Cf(b.z,Wf(b.v,r.date1904))):(b.t="n",b.v=Wf(b.v,r.date1904),b.w=Cf(b.z,b.v))):b.t="s";else b=t[f][m];if(a)u[v]&&u[v].z&&(b.z=u[v].z),u[v]=b;else{var y=qg(v)+g;s[y]&&s[y].z&&(b.z=s[y].z),s[y]=b}}}return d&&c.s.c<104e5&&(s["!ref"]=em(c)),s}function sm(e,t){return am(null,e,t)}function nm(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function om(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function lm(e,t){var i=e.l,r=e.read_shift(1),a=nm(e),s=[],n={t:a,h:a};if(1&r){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(om(e));n.r=s}else n.r=[{ich:0,ifnt:0}];return e.l=i+t,n}var cm=lm;function hm(e){var t=e.read_shift(4),i=e.read_shift(2);return i+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:i}}function um(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var dm=nm;function fm(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var pm=nm,gm=fm;function mm(e){var t=e.slice(e.l,e.l+4),i=1&t[0],r=2&t[0];e.l+=4;var a=0===r?Tg([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Dg(t,0)>>2;return i?a/100:a}function bm(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var vm=bm;function ym(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _m(e,t){var i=e.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var wm=80,xm=[wm,81],Am={1:{n:"CodePage",t:2},2:{n:"Category",t:wm},3:{n:"PresentationFormat",t:wm},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:wm},15:{n:"Company",t:wm},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:wm},27:{n:"ContentStatus",t:wm},28:{n:"Language",t:wm},29:{n:"Version",t:wm},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Tm={1:{n:"CodePage",t:2},2:{n:"Title",t:wm},3:{n:"Subject",t:wm},4:{n:"Author",t:wm},5:{n:"Keywords",t:wm},6:{n:"Comments",t:wm},7:{n:"Template",t:wm},8:{n:"LastAuthor",t:wm},9:{n:"RevNumber",t:wm},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:wm},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},km={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Sm=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Pm(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var Em=Zf(Pm([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Cm={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Dm={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Om=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],Rm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Mm={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Im(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Lm(e,t){var i={"!id":{}};if(!e)return i;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(Op)||[]).forEach((function(e){var a=Ip(e);if("<Relationship"===a[0]){var s={};s.Type=a.Type,s.Target=Bp(a.Target),s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var n="External"===a.TargetMode?a.Target:Pp(a.Target,t);i[n]=s,r[a.Id]=s}})),i["!id"]=r,i}var Fm=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Nm(e){var t={};e=Gp(e);for(var i=0;i<Fm.length;++i){var r=Fm[i],a=fp(e,r[0]);null!=a&&a.length>0&&(t[r[1]]=Bp(a[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=Kf(t[r[1]]))}return t}var Bm=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function jm(e,t,i,r){var a=[];if("string"==typeof e)a=Qp(e,r);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map((function(e){return{v:e}})));var n="string"==typeof t?Qp(t,r).map((function(e){return e.v})):t,o=0,l=0;if(n.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":i.Worksheets=l,i.SheetNames=n.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":i.NamedRanges=l,i.DefinedNames=n.slice(o,o+l);break;case"Charts":case"Diagramme":i.Chartsheets=l,i.ChartNames=n.slice(o,o+l)}o+=l}}var zm,Um=/<[^<>]+>[^<]*/g,Hm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Wm(e,t,i){zm||(zm=jf(Hm)),e[t=zm[t]||t]=i}function Vm(e){var t=e.read_shift(4),i=e.read_shift(4);return new Date(1e3*(i/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function $m(e,t,i){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(i)for(;e.l-r&3;)++e.l;return a}function Xm(e,t,i){var r=e.read_shift(0,"lpwstr");return i&&(e.l+=4-(r.length+1&3)&3),r}function Ym(e,t,i){return 31===t?Xm(e):$m(e,0,i)}function Gm(e,t,i){return Ym(e,t,!1===i?0:4)}function Km(e){var t=e.l,i=Jm(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[i,Jm(e,3)]}function qm(e,t){for(var i=e.read_shift(4),r={},a=0;a!=i;++a){var s=e.read_shift(4),n=e.read_shift(4);r[s]=e.read_shift(n,1200===t?"utf16le":"utf8").replace(Vd,"").replace($d,"!"),1200===t&&n%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function Zm(e){var t=e.read_shift(4),i=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),i}function Jm(e,t,i){var r,a=e.read_shift(2),s=i||{};if(e.l+=2,12!==t&&a!==t&&-1===xm.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return r=e.read_shift(2,"i"),s.raw||(e.l+=2),r;case 3:return e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return e.read_shift(4);case 30:return $m(e,0,4).replace(Vd,"");case 31:return Xm(e);case 64:return Vm(e);case 65:return Zm(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Gm(e,a,!s.raw).replace(Vd,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ym(e,t,0)}(e,a).replace(Vd,"");case 4108:return function(e){for(var t=e.read_shift(4),i=[],r=0;r<t/2;++r)i.push(Km(e));return i}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),i=[],r=0;r!=t;++r){var a=e.l;i[r]=e.read_shift(0,"lpwstr").replace(Vd,""),e.l-a&2&&(e.l+=2)}return i}(e):function(e){for(var t=e.read_shift(4),i=[],r=0;r!=t;++r)i[r]=e.read_shift(0,"lpstr-cp").replace(Vd,"");return i}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Qm(e,t){var i=e.l,r=e.read_shift(4),a=e.read_shift(4),s=[],n=0,o=0,l=-1,c={};for(n=0;n!=a;++n){var h=e.read_shift(4),u=e.read_shift(4);s[n]=[h,u+i]}s.sort((function(e,t){return e[1]-t[1]}));var d={};for(n=0;n!=a;++n){if(e.l!==s[n][1]){var f=!0;if(n>0&&t)switch(t[s[n-1][0]].t){case 2:e.l+2===s[n][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=s[n][1]&&(e.l=s[n][1],f=!1)}if((!t||0==n)&&e.l<=s[n][1]&&(f=!1,e.l=s[n][1]),f)throw new Error("Read Error: Expected address "+s[n][1]+" at "+e.l+" :"+n)}if(t){if(0==s[n][0]&&s.length>n+1&&s[n][1]==s[n+1][1])continue;var p=t[s[n][0]];if(d[p.n]=Jm(e,p.t,{raw:!0}),"version"===p.p&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(65535&d[p.n])).slice(-4)),"CodePage"==p.n)switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Td(o=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(1===s[n][0]){if(o=d.CodePage=Jm(e,2),Td(o),-1!==l){var g=e.l;e.l=s[l][1],c=qm(e,o),e.l=g}}else if(0===s[n][0]){if(0===o){l=n,e.l=s[n+1][1];continue}c=qm(e,o)}else{var m,b=c[s[n][0]];switch(e[e.l]){case 65:e.l+=4,m=Zm(e);break;case 30:case 31:e.l+=4,m=Gm(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=ib(e,4);break;case 64:e.l+=4,m=Kf(Vm(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[b]=m}}return e.l=i+r,d}function eb(e,t,i){var r=e.content;if(!r)return{};Bg(r,0);var a,s,n,o,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var c=r.read_shift(4),h=r.read_shift(16);if(h!==Nf.utils.consts.HEADER_CLSID&&h!==i)throw new Error("Bad PropertySet CLSID "+h);if(1!==(a=r.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(s=r.read_shift(16),o=r.read_shift(4),1===a&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);2===a&&(n=r.read_shift(16),l=r.read_shift(4));var u,d=Qm(r,t),f={SystemIdentifier:c};for(var p in d)f[p]=d[p];if(f.FMTID=s,1===a)return f;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{u=Qm(r,null)}catch(e){}for(p in u)f[p]=u[p];return f.FMTID=[s,n],f}function tb(e,t){return e.read_shift(t),null}function ib(e,t){return 1===e.read_shift(t)}function rb(e){return e.read_shift(2,"u")}function ab(e,t){return function(e,t,i){for(var r=[],a=e.l+t;e.l<a;)r.push(i(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}(e,t,rb)}function sb(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}function nb(e,t,i){var r=e.read_shift(i&&i.biff>=12?2:1),a="sbcs-cont",s=_d;i&&i.biff>=8&&(_d=1200),i&&8!=i.biff?12==i.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont"),i.biff>=2&&i.biff<=5&&(a="cpstr");var n=r?e.read_shift(r,a):"";return _d=s,n}function ob(e){var t=_d;_d=1200;var i,r=e.read_shift(2),a=e.read_shift(1),s=4&a,n=8&a,o=1+(1&a),l=0,c={};n&&(l=e.read_shift(2)),s&&(i=e.read_shift(4));var h=2==o?"dbcs-cont":"sbcs-cont",u=0===r?"":e.read_shift(r,h);return n&&(e.l+=4*l),s&&(e.l+=i),c.t=u,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),_d=t,c}function lb(e,t,i){if(i){if(i.biff>=2&&i.biff<=5)return e.read_shift(t,"cpstr");if(i.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function cb(e,t,i){var r=e.read_shift(i&&2==i.biff?1:2);return 0===r?(e.l++,""):lb(e,r,i)}function hb(e,t,i){if(i.biff>5)return cb(e,0,i);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,i.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ub(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(Vd,""):""}function db(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function fb(e,t){var i=db(e);return i[3]=0,i}function pb(e,t,i){var r={r:e.read_shift(2),c:e.read_shift(2),ixfe:0};if(i&&2==i.biff||7==t){var a=e.read_shift(1);r.ixfe=63&a,e.l+=2}else r.ixfe=e.read_shift(2);return r}function gb(e,t,i){var r=i.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function mb(e){return[e.read_shift(2),mm(e)]}function bb(e){var t=e.read_shift(2),i=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:i}}}function vb(e){var t=e.read_shift(2),i=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:i}}}var yb=vb;function _b(e){e.l+=4;var t=e.read_shift(2),i=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[i,t,r]}function wb(e){e.l+=2,e.l+=e.read_shift(2)}var xb={0:wb,4:wb,5:wb,6:wb,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:wb,9:wb,10:wb,11:wb,12:wb,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:wb,15:wb,16:wb,17:wb,18:wb,19:wb,20:wb,21:_b};function Ab(e,t){var i={BIFFVer:0,dt:0};switch(i.BIFFVer=e.read_shift(2),(t-=2)>=2&&(i.dt=e.read_shift(2),e.l-=2),i.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+i.BIFFVer)}return e.read_shift(t),i}function Tb(e,t,i){var r=0;i&&2==i.biff||(r=e.read_shift(2));var a=e.read_shift(2);return i&&2==i.biff&&(r=1-(a>>15),a&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},a]}var kb=hb;function Sb(e,t,i){var r=e.l+t,a=8!=i.biff&&i.biff?2:4,s=e.read_shift(a),n=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=r,{s:{r:s,c:o},e:{r:n,c:l}}}var Pb=function(e,t,i){return 0===t?"":hb(e,0,i)};function Eb(e,t,i){var r,a=e.read_shift(2),s={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===i.sbcch&&(r=function(e,t,i){e.l+=4,t-=4;var r=e.l+t,a=nb(e,0,i),s=e.read_shift(2);if(s!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return e.l+=s,a}(e,t-2,i)),s.body=r||e.read_shift(t-2),"string"==typeof r&&(s.Name=r),s}function Cb(e,t,i){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1),o=e.read_shift(i&&2==i.biff?1:2),l=0;(!i||i.biff>=5)&&(5!=i.biff&&(e.l+=2),l=e.read_shift(2),5==i.biff&&(e.l+=2),e.l+=4);var c=lb(e,n,i);32&a&&(c=Om[c.charCodeAt(0)]);var h=r-e.l;i&&2==i.biff&&--h;var u=r!=e.l&&0!==o&&h>0?function(e,t,i,r){var a,s=e.l+t,n=ry(e,r,i);return s!==e.l&&(a=iy(e,s-e.l,n,i)),[n,a]}(e,h,i,o):[];return{chKey:s,Name:c,itab:l,rgce:u}}function Db(e,t,i){if(i.biff<8)return Ob(e,0,i);if(!(i.biff>8)&&t==e[e.l]+(3==e[e.l+1]?1:0)+1)return Ob(e,0,i);for(var r=[],a=e.l+t,s=e.read_shift(i.biff>8?4:2);0!=s--;)r.push(gb(e,i.biff,i));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function Ob(e,t,i){3==e[e.l+1]&&e[e.l]++;var r=nb(e,0,i);return 3==r.charCodeAt(0)?r.slice(1):r}function Rb(e,t,i){var r=yb(e,6);switch(i.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,cy(e,t,i)]}var Mb={8:function(e,t){var i=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=i,{fmt:r}}};function Ib(e,t,i){if(!i.cellStyles)return jg(e,t);var r=i&&i.biff>=12?4:2,a=e.read_shift(r),s=e.read_shift(r),n=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:a,e:s,w:n,ixfe:o,flags:l};return(i.biff>=5||!i.biff)&&(c.level=l>>8&7),c}var Lb=pb,Fb=ab,Nb=cb,Bb=[2,3,48,49,131,139,140,245],jb=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=jf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function i(t,i){var r=i||{};r.dateNF||(r.dateNF="yyyymmdd");var a=sm(function(t,i){var r=[],a=Bd(1);switch(i.type){case"base64":a=zd(Id(t));break;case"binary":a=zd(t);break;case"buffer":case"array":a=t}Bg(a,0);var s=a.read_shift(1),n=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,n=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,h=521;2==s&&(c=a.read_shift(2)),a.l+=3,2!=s&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(h=a.read_shift(2));var u=a.read_shift(2);i.codepage;2!=s&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&e[a[a.l]],a.l+=1,a.l+=2),l&&(a.l+=36);for(var d=[],f={},p=Math.min(a.length,2==s?521:h-10-(o?264:0)),g=l?32:11;a.l<p&&13!=a[a.l];)switch((f={}).name=Ud(a.slice(a.l,a.l+g)).replace(/[\u0000\r\n][\S\s]*$/g,""),a.l+=g,f.type=String.fromCharCode(a.read_shift(1)),2==s||l||(f.offset=a.read_shift(4)),f.len=a.read_shift(1),2==s&&(f.offset=a.read_shift(2)),f.dec=a.read_shift(1),f.name.length&&d.push(f),2!=s&&(a.l+=l?13:14),f.type){case"B":o&&8==f.len||!i.WTF||console.log("Skipping "+f.name+":"+f.type);break;case"G":case"P":i.WTF&&console.log("Skipping "+f.name+":"+f.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+f.type)}if(13!==a[a.l]&&(a.l=h-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=h;var m=0,b=0;for(r[0]=[],b=0;b!=d.length;++b)r[0][b]=d[b].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,r[++m]=[],b=0,b=0;b!=d.length;++b){var v=a.slice(a.l,a.l+d[b].len);a.l+=d[b].len,Bg(v,0);var y=Ud(v);switch(d[b].type){case"C":y.trim().length&&(r[m][b]=y.replace(/([^\s])\s+$/,"$1"));break;case"D":8===y.length?(r[m][b]=new Date(Date.UTC(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8),0,0,0,0)),i&&i.UTC||(r[m][b]=op(r[m][b]))):r[m][b]=y;break;case"F":r[m][b]=parseFloat(y.trim());break;case"+":case"I":r[m][b]=l?2147483648^v.read_shift(-4,"i"):v.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":r[m][b]=!0;break;case"N":case"F":r[m][b]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!n)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));r[m][b]="##MEMO##"+(l?parseInt(y.trim(),10):v.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(r[m][b]=+y||0);break;case"@":r[m][b]=new Date(v.read_shift(-8,"f")-621356832e5);break;case"T":var _=v.read_shift(4),w=v.read_shift(4);if(0==_&&0==w)break;r[m][b]=new Date(864e5*(_-2440588)+w),i&&i.UTC||(r[m][b]=op(r[m][b]));break;case"Y":r[m][b]=v.read_shift(4,"i")/1e4+v.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[m][b]=-v.read_shift(-8,"f");break;case"B":if(o&&8==d[b].len){r[m][b]=v.read_shift(8,"f");break}case"G":case"P":v.l+=d[b].len;break;case"0":if("_NullFlags"===d[b].name)break;default:throw new Error("DBF Unsupported data type "+d[b].type)}}else a.l+=u;if(2!=s&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return i&&i.sheetRows&&(r=r.slice(0,i.sheetRows)),i.DBF=d,r}(t,r),r);return a["!cols"]=r.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{var r=rm(i(e,t),t);return r.bookType="dbf",r}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:i,from_sheet:function(i,a){if(!i["!ref"])throw new Error("Cannot export empty sheet to DBF");var s=a||{},n=_d;if(+s.codepage>=0&&Td(+s.codepage),"string"==s.type)throw new Error("Cannot write DBF to JS string");var o=Hg(),l=J_(i,{header:1,raw:!0,cellDates:!0}),c=l[0],h=l.slice(1),u=i["!cols"]||[],d=0,f=0,p=0,g=1;for(d=0;d<c.length;++d)if(((u[d]||{}).DBF||{}).name)c[d]=u[d].DBF.name,++p;else if(null!=c[d]){if(++p,"number"==typeof c[d]&&(c[d]=c[d].toString(10)),"string"!=typeof c[d])throw new Error("DBF Invalid column name "+c[d]+" |"+typeof c[d]+"|");if(c.indexOf(c[d])!==d)for(f=0;f<1024;++f)if(-1==c.indexOf(c[d]+"_"+f)){c[d]+="_"+f;break}}var m=tm(i["!ref"]),b=[],v=[],y=[];for(d=0;d<=m.e.c-m.s.c;++d){var _="",w="",x=0,A=[];for(f=0;f<h.length;++f)null!=h[f][d]&&A.push(h[f][d]);if(0!=A.length&&null!=c[d]){for(f=0;f<A.length;++f){switch(typeof A[f]){case"number":w="B";break;case"string":default:w="C";break;case"boolean":w="L";break;case"object":w=A[f]instanceof Date?"D":"C"}x=Math.max(x,String(A[f]).length),_=_&&_!=w?"C":w}x>250&&(x=250),"C"==(w=((u[d]||{}).DBF||{}).type)&&u[d].DBF.len>x&&(x=u[d].DBF.len),"B"==_&&"N"==w&&(_="N",y[d]=u[d].DBF.dec,x=u[d].DBF.len),v[d]="C"==_||"N"==w?x:r[_]||0,g+=v[d],b[d]=_}else b[d]="?"}var T=o.next(32);for(T.write_shift(4,318902576),T.write_shift(4,h.length),T.write_shift(2,296+32*p),T.write_shift(2,g),d=0;d<4;++d)T.write_shift(4,0);var k=+t[_d]||3;for(T.write_shift(4,k<<8),e[k]!=+s.codepage&&(s.codepage&&console.error("DBF Unsupported codepage "+_d+", using 1252"),_d=1252),d=0,f=0;d<c.length;++d)if(null!=c[d]){var S=o.next(32),P=(c[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,P,"sbcs"),S.write_shift(1,"?"==b[d]?"C":b[d],"sbcs"),S.write_shift(4,f),S.write_shift(1,v[d]||r[b[d]]||0),S.write_shift(1,y[d]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),f+=v[d]||r[b[d]]||0}var E=o.next(264);for(E.write_shift(4,13),d=0;d<65;++d)E.write_shift(4,0);for(d=0;d<h.length;++d){var C=o.next(g);for(C.write_shift(1,0),f=0;f<c.length;++f)if(null!=c[f])switch(b[f]){case"L":C.write_shift(1,null==h[d][f]?63:h[d][f]?84:70);break;case"B":C.write_shift(8,h[d][f]||0,"f");break;case"N":var D="0";for("number"==typeof h[d][f]&&(D=h[d][f].toFixed(y[f]||0)),D.length>v[f]&&(D=D.slice(0,v[f])),p=0;p<v[f]-D.length;++p)C.write_shift(1,32);C.write_shift(1,D,"sbcs");break;case"D":h[d][f]?(C.write_shift(4,("0000"+h[d][f].getFullYear()).slice(-4),"sbcs"),C.write_shift(2,("00"+(h[d][f].getMonth()+1)).slice(-2),"sbcs"),C.write_shift(2,("00"+h[d][f].getDate()).slice(-2),"sbcs")):C.write_shift(8,"00000000","sbcs");break;case"C":var O=C.l,R=String(null!=h[d][f]?h[d][f]:"").slice(0,v[f]);for(C.write_shift(1,R,"cpstr"),O+=v[f]-C.l,p=0;p<O;++p)C.write_shift(1,32)}}return _d=n,o.next(1).write_shift(1,26),o.end()}}}(),zb=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+Bf(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("N("+Bf(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch(e){}var i=function(t,i){var r=e[i];return"number"==typeof r?Od(r):r},r=function(e,t,i){var r=t.charCodeAt(0)-32<<4|i.charCodeAt(0)-48;return 59==r?e:Od(r)};function a(e,a){var s,n=e.split(/[\n\r]+/),o=-1,l=-1,c=0,h=0,u=[],d=[],f=null,p={},g=[],m=[],b=[],v=0,y={Workbook:{WBProps:{},Names:[]}};for(+a.codepage>=0&&Td(+a.codepage);c!==n.length;++c){v=0;var _,w=n[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,i),x=w.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),A=x[0];if(w.length>0)switch(A){case"ID":case"E":case"B":case"W":break;case"O":for(h=1;h<x.length;++h)if("V"===x[h].charAt(0)){var T=parseInt(x[h].slice(1),10);T>=1&&T<=4&&(y.Workbook.WBProps.date1904=!0)}break;case"P":"P"===x[1].charAt(0)&&d.push(w.slice(3).replace(/;;/g,";"));break;case"NN":var k={Sheet:0};for(h=1;h<x.length;++h)switch(x[h].charAt(0)){case"N":k.Name=x[h].slice(1);break;case"E":k.Ref=(a&&a.sheet||"Sheet1")+"!"+Ov(x[h].slice(1))}y.Workbook.Names.push(k);break;case"C":var S=!1,P=!1,E=!1,C=!1,D=-1,O=-1,R="",M="z",I="";for(h=1;h<x.length;++h)switch(x[h].charAt(0)){case"A":I=x[h].slice(1);break;case"X":l=parseInt(x[h].slice(1),10)-1,P=!0;break;case"Y":for(o=parseInt(x[h].slice(1),10)-1,P||(l=0),s=u.length;s<=o;++s)u[s]=[];break;case"K":'"'===(_=x[h].slice(1)).charAt(0)?(_=_.slice(1,_.length-1),M="s"):"TRUE"===_||"FALSE"===_?(_="TRUE"===_,M="b"):"#"==_.charAt(0)&&null!=Dm[_]?(M="e",_=Dm[_]):isNaN(Qf(_))||(_=Qf(_),M="n",null!==f&&Sf(f)&&a.cellDates&&(M="number"==typeof(_=Vf(y.Workbook.WBProps.date1904?_+1462:_))?"n":"d")),S=!0;break;case"E":C=!0,R=Ov(x[h].slice(1),{r:o,c:l});break;case"S":E=!0;break;case"G":break;case"R":D=parseInt(x[h].slice(1),10)-1;break;case"C":O=parseInt(x[h].slice(1),10)-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}if(S&&(u[o][l]?(u[o][l].t=M,u[o][l].v=_):u[o][l]={t:M,v:_},f&&(u[o][l].z=f),!1!==a.cellText&&f&&(u[o][l].w=Cf(u[o][l].z,u[o][l].v,{date1904:y.Workbook.WBProps.date1904})),f=null),E){if(C)throw new Error("SYLK shared formula cannot have own formula");var L=D>-1&&u[D][O];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");R=Iv(L[1],{r:o-D,c:l-O})}R&&(u[o][l]?u[o][l].f=R:u[o][l]={t:"n",f:R}),I&&(u[o][l]||(u[o][l]={t:"z"}),u[o][l].c=[{a:"SheetJSYLK",t:I}]);break;case"F":var F=0;for(h=1;h<x.length;++h)switch(x[h].charAt(0)){case"X":l=parseInt(x[h].slice(1),10)-1,++F;break;case"Y":for(o=parseInt(x[h].slice(1),10)-1,s=u.length;s<=o;++s)u[s]=[];break;case"M":v=parseInt(x[h].slice(1),10)/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=d[parseInt(x[h].slice(1),10)];break;case"W":for(b=x[h].slice(1).split(" "),s=parseInt(b[0],10);s<=parseInt(b[1],10);++s)v=parseInt(b[2],10),m[s-1]=0===v?{hidden:!0}:{wch:v};break;case"C":m[l=parseInt(x[h].slice(1),10)-1]||(m[l]={});break;case"R":g[o=parseInt(x[h].slice(1),10)-1]||(g[o]={}),v>0?(g[o].hpt=v,g[o].hpx=yv(v)):0===v&&(g[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}F<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}}return g.length>0&&(p["!rows"]=g),m.length>0&&(p["!cols"]=m),m.forEach((function(e){mv(e)})),a&&a.sheetRows&&(u=u.slice(0,a.sheetRows)),[u,p,y]}function s(e,t,i,r,a,s){var n="C;Y"+(i+1)+";X"+(r+1)+";K";switch(e.t){case"n":n+=e.v||0,e.f&&!e.F&&(n+=";E"+Mv(e.f,{r:i,c:r}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||Cm[e.v]||e.v;break;case"d":n+=Wf(Kf(e.v,s),s);break;case"s":n+='"'+(null==e.v?"":String(e.v)).replace(/"/g,"").replace(/;/g,";;")+'"'}return n}function n(e,t,i){return"C;Y"+(t+1)+";X"+(i+1)+";A"+e.map((function(e){return e.t})).join("").replace(/\n/g," :").replace(/\r/g," =")}return e["|"]=254,{to_workbook:function(e,t){var i=function(e,t){switch(t.type){case"base64":return a(Id(e),t);case"binary":return a(e,t);case"buffer":return a(Ld&&Buffer.isBuffer(e)?e.toString("binary"):Ud(e),t);case"array":return a(qf(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=i[0],s=i[1],n=i[2],o=Zf(t);o.date1904=(((n||{}).Workbook||{}).WBProps||{}).date1904;var l=sm(r,o);Bf(s).forEach((function(e){l[e]=s[e]}));var c=rm(l,t);return Bf(n).forEach((function(e){c[e]=n[e]})),c.bookType="sylk",c},from_sheet:function(e,t,i){t||(t={}),t._formats=["General"];var r,a=["ID;PSheetJS;N;E"],o=[],l=tm(e["!ref"]||"A1"),c=null!=e["!data"],h="\r\n",u=(((i||{}).Workbook||{}).WBProps||{}).date1904;a.push("P;PGeneral");var d=l.s.r,f=l.s.c,p=[];if(e["!ref"])for(d=l.s.r;d<=l.e.r;++d)if(!c||e["!data"][d]){for(p=[],f=l.s.c;f<=l.e.c;++f)(r=c?e["!data"][d][f]:e[qg(f)+Gg(d)])&&r.c&&p.push(n(r.c,d,f));p.length&&o.push(p.join(h))}if(e["!ref"])for(d=l.s.r;d<=l.e.r;++d)if(!c||e["!data"][d]){for(p=[],f=l.s.c;f<=l.e.c;++f)if((r=c?e["!data"][d][f]:e[qg(f)+Gg(d)])&&(null!=r.v||r.f&&!r.F)){if("General"!=(r.z||("d"==r.t?tf[14]:"General"))){var g=t._formats.indexOf(r.z);-1==g&&(t._formats.push(r.z),g=t._formats.length-1,a.push("P;P"+r.z.replace(/;/g,";;"))),p.push("F;P"+g+";Y"+(d+1)+";X"+(f+1))}p.push(s(r,0,d,f,0,u))}o.push(p.join(h))}return a.push("F;P0;DG0G8;M255"),e["!cols"]&&function(e,t){t.forEach((function(t,i){var r="F;W"+(i+1)+" "+(i+1)+" ";t.hidden?r+="0":("number"!=typeof t.width||t.wpx||(t.wpx=uv(t.width)),"number"!=typeof t.wpx||t.wch||(t.wch=dv(t.wpx)),"number"==typeof t.wch&&(r+=Math.round(t.wch)))," "!=r.charAt(r.length-1)&&e.push(r)}))}(a,e["!cols"]),e["!rows"]&&function(e,t){t.forEach((function(t,i){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*vv(t.hpx)+";"),r.length>2&&e.push(r+"R"+(i+1))}))}(a,e["!rows"]),e["!ref"]&&a.push("B;Y"+(l.e.r-l.s.r+1)+";X"+(l.e.c-l.s.c+1)+";D"+[l.s.c,l.s.r,l.e.c,l.e.r].join(" ")),a.push("O;L;D;B"+(u?";V4":"")+";K47;G100 0.001"),delete t._formats,a.join(h)+h+o.join(h)+h+"E"+h}}}(),Ub=function(){function e(e,t){for(var i=e.split("\n"),r=-1,a=-1,s=0,n=[];s!==i.length;++s)if("BOT"!==i[s].trim()){if(!(r<0)){for(var o=i[s].trim().split(","),l=o[0],c=o[1],h=i[++s]||"";1&(h.match(/["]/g)||[]).length&&s<i.length-1;)h+="\n"+i[++s];switch(h=h.trim(),+l){case-1:if("BOT"===h){n[++r]=[],a=0;continue}if("EOD"!==h)throw new Error("Unrecognized DIF special command "+h);break;case 0:"TRUE"===h?n[r][a]=!0:"FALSE"===h?n[r][a]=!1:isNaN(Qf(c))?isNaN(sp(c).getDate())?n[r][a]=c:(n[r][a]=Kf(c),t&&t.UTC||(n[r][a]=op(n[r][a]))):n[r][a]=Qf(c),++a;break;case 1:(h=(h=h.slice(1,h.length-1)).replace(/""/g,'"'))&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),n[r][a++]=""!==h?h:null}if("EOD"===h)break}}else n[++r]=[],a=0;return t&&t.sheetRows&&(n=n.slice(0,t.sheetRows)),n}function t(t,i){return sm(function(t,i){switch(i.type){case"base64":return e(Id(t),i);case"binary":return e(t,i);case"buffer":return e(Ld&&Buffer.isBuffer(t)?t.toString("binary"):Ud(t),i);case"array":return e(qf(t),i)}throw new Error("Unrecognized type "+i.type)}(t,i),i)}function i(e,t){return"0,"+String(e)+"\r\n"+t}function r(e){return'1,0\r\n"'+e.replace(/"/g,'""')+'"'}return{to_workbook:function(e,i){var r=rm(t(e,i),i);return r.bookType="dif",r},to_sheet:t,from_sheet:function(e){if(!e["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var t=tm(e["!ref"]),a=null!=e["!data"],s=['TABLE\r\n0,1\r\n"sheetjs"\r\n',"VECTORS\r\n0,"+(t.e.r-t.s.r+1)+'\r\n""\r\n',"TUPLES\r\n0,"+(t.e.c-t.s.c+1)+'\r\n""\r\n','DATA\r\n0,0\r\n""\r\n'],n=t.s.r;n<=t.e.r;++n){for(var o=a?e["!data"][n]:[],l="-1,0\r\nBOT\r\n",c=t.s.c;c<=t.e.c;++c){var h=a?o&&o[c]:e[Jg({r:n,c})];if(null!=h){switch(h.t){case"n":null!=h.w?l+="0,"+h.w+"\r\nV":null!=h.v?l+=i(h.v,"V"):null==h.f||h.F?l+='1,0\r\n""':l+=r("="+h.f);break;case"b":l+=h.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":l+=r(isNaN(+h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Cf(h.z||tf[14],Wf(Kf(h.v)))),l+=i(h.w,"V");break;default:l+='1,0\r\n""'}l+="\r\n"}else l+='1,0\r\n""\r\n'}s.push(l)}return s.join("")+"-1,0\r\nEOD"}}}(),Hb=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return sm(function(e,t){for(var i=e.split("\n"),r=-1,a=-1,s=0,n=[];s!==i.length;++s){var o=i[s].trim().split(":");if("cell"===o[0]){var l=Zg(o[1]);if(n.length<=l.r)for(r=n.length;r<=l.r;++r)n[r]||(n[r]=[]);switch(r=l.r,a=l.c,o[2]){case"t":n[r][a]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":n[r][a]=+o[3];break;case"vtf":var c=o[o.length-1];case"vtc":"nl"===o[3]?n[r][a]=!!+o[4]:n[r][a]=+o[4],"vtf"==o[2]&&(n[r][a]=[n[r][a],c])}}}return t&&t.sheetRows&&(n=n.slice(0,t.sheetRows)),n}(e,t),t)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function n(t){if(!t||!t["!ref"])return"";for(var i,r=[],a=[],s="",n=Qg(t["!ref"]),o=null!=t["!data"],l=n.s.r;l<=n.e.r;++l)for(var c=n.s.c;c<=n.e.c;++c)if(s=Jg({r:l,c}),(i=o?(t["!data"][l]||[])[c]:t[s])&&null!=i.v&&"z"!==i.t){switch(a=["cell",s,"t"],i.t){case"s":case"str":a.push(e(i.v));break;case"n":i.f?(a[2]="vtf",a[3]="n",a[4]=i.v,a[5]=e(i.f)):(a[2]="v",a[3]=i.v);break;case"b":a[2]="vt"+(i.f?"f":"c"),a[3]="nl",a[4]=i.v?"1":"0",a[5]=e(i.f||(i.v?"TRUE":"FALSE"));break;case"d":var h=Wf(Kf(i.v));a[2]="vtc",a[3]="nd",a[4]=""+h,a[5]=i.w||Cf(i.z||tf[14],h);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(n.e.c-n.s.c+1)+":r:"+(n.e.r-n.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,i){return rm(t(e,i),i)},to_sheet:t,from_sheet:function(e){return[i,r,a,r,n(e),s].join("\n")}}}(),Wb=function(){function e(e,t,i,r,a){a.raw?t[i][r]=e:""===e||("TRUE"===e?t[i][r]=!0:"FALSE"===e?t[i][r]=!1:isNaN(Qf(e))?isNaN(sp(e).getDate())?t[i][r]=e:t[i][r]=Kf(e):t[i][r]=Qf(e))}var t={44:",",9:"\t",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,s=0,n=0;s<e.length;++s)34==(n=e.charCodeAt(s))?a=!a:!a&&n in t&&(r[n]=(r[n]||0)+1);for(s in n=[],r)Object.prototype.hasOwnProperty.call(r,s)&&n.push([r[s],s]);if(!n.length)for(s in r=i)Object.prototype.hasOwnProperty.call(r,s)&&n.push([r[s],s]);return n.sort((function(e,t){return e[0]-t[0]||i[e[1]]-i[t[1]]})),t[n.pop()[1]]||44}function a(e,t){var i=t||{},a="",s={};i.dense&&(s["!data"]=[]);var n={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=i&&i.FS?i.FS:r(e.slice(0,1024));var o,l,c=0,h=0,u=0,d=0,f=0,p=a.charCodeAt(0),g=!1,m=0,b=e.charCodeAt(0),v=null!=i.dateNF?(l=(l="number"==typeof(o=i.dateNF)?tf[o]:o).replace(Rf,"(\\d+)"),Rf.lastIndex=0,new RegExp("^"+l+"$")):null;function y(){var t=e.slice(d,f);"\r"==t.slice(-1)&&(t=t.slice(0,-1));var r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),!1!==i.cellText&&(r.w=t),0===t.length)r.t="z";else if(i.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="s",r.f=t.slice(1),r.v=t):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(u=Qf(t)))if(!isNaN((u=sp(t)).getDate())||v&&t.match(v)){if(r.z=i.dateNF||tf[14],v&&t.match(v)){var a=function(e,t,i){var r=-1,a=-1,s=-1,n=-1,o=-1,l=-1;(t.match(Rf)||[]).forEach((function(e,t){var c=parseInt(i[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":s=c;break;case"h":n=c;break;case"s":l=c;break;case"m":n>=0?o=c:a=c}})),Rf.lastIndex=0,l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var h=("00"+(n>=0?n:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==n&&-1==o&&-1==l?c:-1==r&&-1==a&&-1==s?h:c+"T"+h}(0,i.dateNF,t.match(v)||[]);u=Kf(a),i&&!1===i.UTC&&(u=op(u))}else i&&!1===i.UTC?u=op(u):!1!==i.cellText&&i.dateNF&&(r.w=Cf(r.z,u));i.cellDates?(r.t="d",r.v=u):(r.t="n",r.v=Wf(u)),i.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",r.v=u;if("z"==r.t||(i.dense?(s["!data"][c]||(s["!data"][c]=[]),s["!data"][c][h]=r):s[Jg({c:h,r:c})]=r),d=f+1,b=e.charCodeAt(d),n.e.c<h&&(n.e.c=h),n.e.r<c&&(n.e.r=c),m==p)++h;else if(h=0,++c,i.sheetRows&&i.sheetRows<=c)return!0}e:for(;f<e.length;++f)switch(m=e.charCodeAt(f)){case 34:34===b&&(g=!g);break;case 13:if(g)break;10==e.charCodeAt(f+1)&&++f;case p:case 10:if(!g&&y())break e}return f-d>0&&y(),s["!ref"]=em(n),s}function s(t,i){var r="",s="string"==i.type?[0,0,0,0]:Y_(t,i);switch(i.type){case"base64":r=Id(t);break;case"binary":case"string":r=t;break;case"buffer":r=65001==i.codepage?t.toString("utf8"):(i.codepage,Ld&&Buffer.isBuffer(t)?t.toString("binary"):Ud(t));break;case"array":r=qf(t);break;default:throw new Error("Unrecognized type "+i.type)}return 239==s[0]&&187==s[1]&&191==s[2]?r=Gp(r.slice(3)):"string"!=i.type&&"buffer"!=i.type&&65001==i.codepage?r=Gp(r):i.type,"socialcalc:version:"==r.slice(0,19)?Hb.to_sheet("string"==i.type?r:Gp(r),i):function(t,i){return i&&i.PRN?i.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,i):sm(function(t,i){var r=i||{},a=[];if(!t||0===t.length)return a;for(var s=t.split(/[\r\n]/),n=s.length-1;n>=0&&0===s[n].length;)--n;for(var o=10,l=0,c=0;c<=n;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,o=Math.max(o,l);for(c=0;c<=n;++c){a[c]=[];var h=0;for(e(s[c].slice(0,o).trim(),a,c,h,r),h=1;h<=(s[c].length-o)/10+1;++h)e(s[c].slice(o+10*(h-1),o+10*h).trim(),a,c,h,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,i),i):a(t,i)}(r,i)}return{to_workbook:function(e,t){return rm(s(e,t),t)},to_sheet:s,from_sheet:function(e){var t=[];if(!e["!ref"])return"";for(var i,r=tm(e["!ref"]),a=null!=e["!data"],s=r.s.r;s<=r.e.r;++s){for(var n=[],o=r.s.c;o<=r.e.c;++o){var l=Jg({r:s,c:o});if((i=a?(e["!data"][s]||[])[o]:e[l])&&null!=i.v){for(var c=(i.w||(im(i),i.w)||"").slice(0,10);c.length<10;)c+=" ";n.push(c+(0===o?" ":""))}else n.push("          ")}t.push(n.join(""))}return t.join("\n")}}}(),Vb=function(){function e(e,t,i){if(e){Bg(e,e.l||0);for(var r=i.Enum||v;e.l<e.length;){var a=e.read_shift(2),s=r[a]||r[65535],n=e.read_shift(2),o=e.l+n,l=s.f&&s.f(e,n,i);if(e.l=o,t(l,s,a))return}}}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function i(i,r){if(!i)return i;var a=r||{},s={},n="Sheet1",o="",l=0,c={},h=[],u=[],d=[];a.dense&&(d=s["!data"]=[]);var f={s:{r:0,c:0},e:{r:0,c:0}},p=a.sheetRows||0,g={};if(81==i[4]&&80==i[5]&&87==i[6])return function(e,t){Bg(e,0);var i=t||{},r={};i.dense&&(r["!data"]=[]);var a=[],s="",n={s:{r:-1,c:-1},e:{r:-1,c:-1}},o=0,l=0,c=0,h=0,u={SheetNames:[],Sheets:{}},d=[];e:for(;e.l<e.length;){var f=e.read_shift(2),p=e.read_shift(2),g=e.slice(e.l,e.l+p);switch(Bg(g,0),f){case 1:if(962023505!=g.read_shift(4))throw"Bad QPW9 BOF!";break;case 2:break e;case 8:case 1025:case 1026:case 1032:default:break;case 10:for(var m=g.read_shift(4),b=(g.length-g.l)/m|0,v=0;v<m;++v){var y=g.l+b,x={};g.l+=2,x.numFmtId=g.read_shift(2),_[x.numFmtId]&&(x.z=_[x.numFmtId]),g.l=y,d.push(x)}break;case 1031:for(g.l+=12;g.l<g.length;)o=g.read_shift(2),l=g.read_shift(1),a.push(g.read_shift(o,"cstr"));break;case 1537:var A=g.read_shift(2);r={},i.dense&&(r["!data"]=[]),n.s.c=g.read_shift(2),n.e.c=g.read_shift(2),n.s.r=g.read_shift(4),n.e.r=g.read_shift(4),g.l+=4,g.l+2<g.length&&(o=g.read_shift(2),l=g.read_shift(1),s=0==o?"":g.read_shift(o,"cstr")),s||(s=qg(A));break;case 1538:if(n.s.c>255||n.s.r>999999)break;n.e.c<n.s.c&&(n.e.c=n.s.c),n.e.r<n.s.r&&(n.e.r=n.s.r),r["!ref"]=em(n),sw(u,r,s);break;case 2561:c=g.read_shift(2),n.e.c<c&&(n.e.c=c),n.s.c>c&&(n.s.c=c),h=g.read_shift(4),n.s.r>h&&(n.s.r=h),h=g.read_shift(4),n.e.r<h&&(n.e.r=h);break;case 3073:h=g.read_shift(4),o=g.read_shift(4),n.s.r>h&&(n.s.r=h),n.e.r<h+o-1&&(n.e.r=h+o-1);for(var T=qg(c);g.l<g.length;){var k={t:"z"},S=g.read_shift(1),P=-1;128&S&&(P=g.read_shift(2));var E=64&S?g.read_shift(2)-1:0;switch(31&S){case 0:case 1:break;case 2:k={t:"n",v:g.read_shift(2)};break;case 3:k={t:"n",v:g.read_shift(2,"i")};break;case 4:k={t:"n",v:mm(g)};break;case 5:k={t:"n",v:g.read_shift(8,"f")};break;case 7:k={t:"s",v:a[l=g.read_shift(4)-1]};break;case 8:k={t:"n",v:g.read_shift(8,"f")},g.l+=2,g.l+=4,isNaN(k.v)&&(k={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(31&S)}-1!=P&&(d[P-1]||{}).z&&(k.z=d[P-1].z);var C=0;if(32&S)switch(31&S){case 2:case 7:C=g.read_shift(2);break;case 3:C=g.read_shift(2,"i");break;default:throw"Unsupported delta for QPW cell type "+(31&S)}if(i.sheetStubs||"z"!=k.t){var D=Zf(k);"n"==k.t&&k.z&&Sf(k.z)&&i.cellDates&&(D.v=Vf(k.v),D.t="number"==typeof D.v?"n":"d"),null!=r["!data"]?(r["!data"][h]||(r["!data"][h]=[]),r["!data"][h][c]=D):r[T+Gg(h)]=D}for(++h,--o;E-- >0&&o>=0;){if(32&S)switch(31&S){case 2:k={t:"n",v:k.v+C&65535};break;case 3:(k={t:"n",v:k.v+C&65535}).v>32767&&(k.v-=65536);break;case 7:k={t:"s",v:a[l=l+C>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(31&S)}else switch(31&S){case 1:k={t:"z"};break;case 2:k={t:"n",v:g.read_shift(2)};break;case 7:k={t:"s",v:a[l=g.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(31&S)}(i.sheetStubs||"z"!=k.t)&&(null!=r["!data"]?(r["!data"][h]||(r["!data"][h]=[]),r["!data"][h][c]=k):r[T+Gg(h)]=k),++h,--o}}break;case 3074:c=g.read_shift(2),h=g.read_shift(4);var O=w(g);null!=r["!data"]?(r["!data"][h]||(r["!data"][h]=[]),r["!data"][h][c]={t:"s",v:O}):r[qg(c)+Gg(h)]={t:"s",v:O}}e.l+=p}return u}(i,r);if(0==i[2]&&(8==i[3]||9==i[3])&&i.length>=16&&5==i[14]&&108===i[15])throw new Error("Unsupported Works 3 for Mac file");if(2==i[2])a.Enum=v,e(i,(function(e,i,r){switch(r){case 0:a.vers=e,e>=4096&&(a.qpro=!0);break;case 255:a.vers=e,a.works=!0;break;case 6:f=e;break;case 204:e&&(o=e);break;case 222:o=e;break;case 15:case 51:(!a.qpro&&!a.works||51==r)&&e[1].v.charCodeAt(0)<48&&(e[1].v=e[1].v.slice(1)),(a.works||a.works2)&&(e[1].v=e[1].v.replace(/\r\n/g,"\n"));case 13:case 14:case 16:!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=a.dateNF||t[(15&e[2])-1]||tf[14],a.cellDates&&(e[1].v=Vf(e[1].v),e[1].t="number"==typeof e[1].v?"n":"d")),a.qpro&&e[3]>l&&(s["!ref"]=em(f),c[n]=s,h.push(n),s={},a.dense&&(d=s["!data"]=[]),f={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],n=o||"Sheet"+(l+1),o="");var u=a.dense?(d[e[0].r]||[])[e[0].c]:s[Jg(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f),g=u;break}a.dense?(d[e[0].r]||(d[e[0].r]=[]),d[e[0].r][e[0].c]=e[1]):s[Jg(e[0])]=e[1],g=e[1];break;case 21509:a.works2=!0;break;case 21506:5281==e&&(g.z="hh:mm:ss",a.cellDates&&"n"==g.t&&(g.v=Vf(g.v),g.t="number"==typeof g.v?"n":"d"))}}),a);else{if(26!=i[2]&&14!=i[2])throw new Error("Unrecognized LOTUS BOF "+i[2]);a.Enum=y,14==i[2]&&(a.qpro=!0,i.l=0),e(i,(function(e,t,i){switch(i){case 204:n=e;break;case 22:e[1].v.charCodeAt(0)<48&&(e[1].v=e[1].v.slice(1)),e[1].v=e[1].v.replace(/\x0F./g,(function(e){return String.fromCharCode(e.charCodeAt(1)-32)})).replace(/\r\n/g,"\n");case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>l&&(s["!ref"]=em(f),c[n]=s,h.push(n),s={},a.dense&&(d=s["!data"]=[]),f={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],n="Sheet"+(l+1)),p>0&&e[0].r>=p)break;a.dense?(d[e[0].r]||(d[e[0].r]=[]),d[e[0].r][e[0].c]=e[1]):s[Jg(e[0])]=e[1],f.e.c<e[0].c&&(f.e.c=e[0].c),f.e.r<e[0].r&&(f.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==l&&(n=e[1])}}),a)}if(s["!ref"]=em(f),c[o||n]=s,h.push(o||n),!u.length)return{SheetNames:h,Sheets:c};for(var m={},b=[],x=0;x<u.length;++x)c[h[x]]?(b.push(u[x]||h[x]),m[u[x]]=c[u[x]]||c[h[x]]):(b.push(u[x]),m[u[x]]={"!ref":"A1"});return{SheetNames:b,Sheets:m}}function r(e,t,i){var r=[{c:0,r:0},{t:"n",v:0},0,0];return i.qpro&&20768!=i.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):i.works?(r[0].c=e.read_shift(2),r[0].r=e.read_shift(2),r[2]=e.read_shift(2)):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function a(e){return e.z&&Sf(e.z)?240|(t.indexOf(e.z)+1||2):255}function s(e,t,i){var r=zg(7+i.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var s=i.charCodeAt(a);r.write_shift(1,s>=128?95:s)}return r.write_shift(1,0),r}function n(e,t,i){var r=zg(7);return r.write_shift(1,a(i)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,i.v,"i"),r}function o(e,t,i){var r=zg(13);return r.write_shift(1,a(i)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,i.v,"f"),r}function l(e,t,i){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(i?qg(t):Gg(t))}var c={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},h=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,i,r){var a=zg(6+r.length);a.write_shift(2,e),a.write_shift(1,i),a.write_shift(1,t),a.write_shift(1,39);for(var s=0;s<r.length;++s){var n=r.charCodeAt(s);a.write_shift(1,n>=128?95:n)}return a.write_shift(1,0),a}function f(e,t){var i=u(e),r=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===r&&3221225472===a?(i[1].t="e",i[1].v=15):0===r&&3489660928===a?(i[1].t="e",i[1].v=42):i[1].v=0,i;var n=32768&s;return s=(32767&s)-16446,i[1].v=(1-2*n)*(a*Math.pow(2,s+32)+r*Math.pow(2,s)),i}function p(e,t,i,r){var a=zg(14);if(a.write_shift(2,e),a.write_shift(1,i),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var s,n=0,o=0,l=0;return r<0&&(n=1,r=-r),o=0|Math.log2(r),2147483648&(l=(r/=Math.pow(2,o-31))>>>0)||(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,s=(r*=Math.pow(2,32))>>>0,a.write_shift(4,s),a.write_shift(4,l),o+=16383+(n?32768:0),a.write_shift(2,o),a}function g(e,t){var i=u(e),r=e.read_shift(8,"f");return i[1].v=r,i}function m(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function b(e,t){var i=zg(5+e.length);i.write_shift(2,14e3),i.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);i[i.l++]=a>127?95:a}return i[i.l++]=0,i}var v={0:{n:"BOF",f:rb},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,i){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&i.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&i.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&i.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,i){var a=r(e,0,i);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,i){var a=r(e,0,i);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:function(e,t,i){var a=e.l+t,s=r(e,0,i);if(s[1].t="s",20768==(65534&i.vers)){e.l++;var n=e.read_shift(1);return s[1].v=e.read_shift(n,"utf8"),s}return i.qpro&&e.l++,s[1].v=e.read_shift(a-e.l,"cstr"),s}},16:{n:"FORMULA",f:function(e,t,i){var a=e.l+t,s=r(e,0,i);if(s[1].v=e.read_shift(8,"f"),i.qpro)e.l=a;else{var n=e.read_shift(2);!function(e,t){Bg(e,0);for(var i=[],r=0,a="",s="",n="",o="";e.l<e.length;){var u=e[e.l++];switch(u){case 0:i.push(e.read_shift(8,"f"));break;case 1:s=l(t[0].c,e.read_shift(2),!0),a=l(t[0].r,e.read_shift(2),!1),i.push(s+a);break;case 2:var d=l(t[0].c,e.read_shift(2),!0),f=l(t[0].r,e.read_shift(2),!1);s=l(t[0].c,e.read_shift(2),!0),a=l(t[0].r,e.read_shift(2),!1),i.push(d+f+":"+s+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:i.push("("+i.pop()+")");break;case 5:i.push(e.read_shift(2));break;case 6:for(var p="";u=e[e.l++];)p+=String.fromCharCode(u);i.push('"'+p.replace(/"/g,'""')+'"');break;case 8:i.push("-"+i.pop());break;case 23:i.push("+"+i.pop());break;case 22:i.push("NOT("+i.pop()+")");break;case 20:case 21:o=i.pop(),n=i.pop(),i.push(["AND","OR"][u-20]+"("+n+","+o+")");break;default:if(u<32&&h[u])o=i.pop(),n=i.pop(),i.push(n+h[u]+o);else{if(!c[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(r=c[u][1])&&(r=e[e.l++]),r>i.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+i.join("|")+"|");var g=i.slice(-r);i.length-=r,i.push(c[u][0]+"("+g.join(",")+")")}}}1==i.length?t[1].f=""+i[0]:console.error("WK1 bad formula parse |"+i.join("|")+"|")}(e.slice(e.l,e.l+n),s),e.l+=n}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:function(e,t,i){var a=e.l+t,s=r(e,0,i);if(s[1].t="s",20768==i.vers){var n=e.read_shift(1);return s[1].v=e.read_shift(n,"utf8"),s}return s[1].v=e.read_shift(a-e.l,"cstr"),s}},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:m},222:{n:"SHEETNAMELP",f:function(e,t){var i=e[e.l++];i>t-1&&(i=t-1);for(var r="";r.length<i;)r+=String.fromCharCode(e[e.l++]);return r}},255:{n:"BOF",f:rb},21506:{n:"WKSNF",f:rb},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var i=u(e);return i[1].t="s",i[1].v=e.read_shift(t-4,"cstr"),i}},23:{n:"NUMBER17",f},24:{n:"NUMBER18",f:function(e,t){var i=u(e);i[1].v=e.read_shift(2);var r=i[1].v>>1;if(1&i[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return i[1].v=r,i}},25:{n:"FORMULA19",f:function(e,t){var i=f(e);return e.l+=t-14,i}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var i={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(i[a]=[0,""],i[a][0]=e.read_shift(2);e[e.l];)i[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return i}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var i=u(e),r=e.read_shift(4);return i[1].v=r>>6,i}},38:{n:"??"},39:{n:"NUMBER27",f:g},40:{n:"FORMULA28",f:function(e,t){var i=g(e);return e.l+=t-12,i}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:m},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,i){if(i.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},_={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function w(e){var t=e.read_shift(2),i=e.read_shift(1);if(0!=i)throw"unsupported QPW string type "+i.toString(16);return e.read_shift(t,"sbcs-cont")}return{sheet_to_wk1:function(e,t){var i=t||{};if(+i.codepage>=0&&Td(+i.codepage),"string"==i.type)throw new Error("Cannot write WK1 to JS string");var r=Hg();if(!e["!ref"])throw new Error("Cannot export empty sheet to WK1");var a=tm(e["!ref"]),l=null!=e["!data"],c=[];g_(r,0,function(){var e=zg(2);return e.write_shift(2,1030),e}()),g_(r,6,function(e){var t=zg(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(a));for(var h=Math.min(a.e.r,8191),u=a.s.c;u<=a.e.c;++u)c[u]=qg(u);for(var d=a.s.r;d<=h;++d){var f=Gg(d);for(u=a.s.c;u<=a.e.c;++u){var p=l?(e["!data"][d]||[])[u]:e[c[u]+f];if(p&&"z"!=p.t)switch(p.t){case"n":(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?g_(r,13,n(d,u,p)):g_(r,14,o(d,u,p));break;case"d":var g=Wf(p.v);(0|g)==g&&g>=-32768&&g<=32767?g_(r,13,n(d,u,{t:"n",v:g,z:p.z||tf[14]})):g_(r,14,o(d,u,{t:"n",v:g,z:p.z||tf[14]}));break;default:g_(r,15,s(d,u,im(p).slice(0,239)))}}}return g_(r,1),r.end()},book_to_wk3:function(e,t){var i=t||{};if(+i.codepage>=0&&Td(+i.codepage),"string"==i.type)throw new Error("Cannot write WK3 to JS string");var r=Hg();g_(r,0,function(e){var t=zg(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var i=0,r=0,a=0,s=0;s<e.SheetNames.length;++s){var n=e.SheetNames[s],o=e.Sheets[n];if(o&&o["!ref"]){++a;var l=Qg(o["!ref"]);i<l.e.r&&(i=l.e.r),r<l.e.c&&(r=l.e.c)}}return i>8191&&(i=8191),t.write_shift(2,i),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,s=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&g_(r,27,b(e.SheetNames[a],s++));var n=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=tm(o["!ref"]),c=null!=o["!data"],h=[],u=Math.min(l.e.r,8191),f=l.s.r;f<=u;++f)for(var g=Gg(f),m=l.s.c;m<=l.e.c;++m){f===l.s.r&&(h[m]=qg(m));var v=h[m]+g,y=c?(o["!data"][f]||[])[m]:o[v];y&&"z"!=y.t&&("n"==y.t?g_(r,23,p(f,m,n,y.v)):g_(r,22,d(f,m,n,im(y).slice(0,239))))}++n}}return g_(r,1),r.end()},to_workbook:function(e,t){switch(t.type){case"base64":return i(zd(Id(e)),t);case"binary":return i(zd(e),t);case"buffer":case"array":return i(e,t)}throw"Unsupported type "+t.type}}}(),$b=function(){function e(e){var t=pp(e,"t");if(!t)return{t:"s",v:""};var i={t:"s",v:Bp(t[1])},r=pp(e,"rPr");return r&&(i.s=function(e){var t={},i=e.match(Op),r=0,a=!1;if(i)for(;r!=i.length;++r){var s=Ip(i[r]);switch(s[0].replace(/<\w*:/g,"<")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=xd[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==s[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}(r[1])),i}var t=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(r){return r.replace(t,"").split(i).map(e).filter((function(e){return e.v}))}}(),Xb=function(){var e=/(\r\n|\n)/g;function t(t){var i=[[],t.v,[]];return t.v?(t.s&&function(e,t,i){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),i.push("</b>")),e.i&&(t.push("<i>"),i.push("</i>")),e.strike&&(t.push("<s>"),i.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),i.push("</"+a+">")),i.push("</span>")}(t.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(e){return e.map(t).join("")}}(),Yb=/<(?:\w+:)?t\b[^<>]*>([^<]*)<\/(?:\w+:)?t>/g,Gb=/<(?:\w+:)?r\b[^<>]*>/;function Kb(e,t){var i=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Bp(Gp(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),r.r=Gp(e),i&&(r.h=Up(r.t))):e.match(Gb)&&(r.r=Gp(e),r.t=Bp(Gp((mp(e,"rPh").match(Yb)||[]).join("").replace(Op,"")),!0),i&&(r.h=Xb($b(r.r)))),r):{t:""}}var qb=/<(?:\w+:)?(?:si|sstItem)>/g,Zb=/<\/(?:\w+:)?(?:si|sstItem)>/;function Jb(e){for(var t=[],i=e.split(""),r=0;r<i.length;++r)t[r]=i[r].charCodeAt(0);return t}function Qb(e,t){var i={};return i.Major=e.read_shift(2),i.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),i}function ev(e){for(var t=e.read_shift(4),i=e.l+t-4,r={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=s,e.l!=i)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+i);return r}function tv(e,t){var i=e.l+t,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=36==r.Flags;break;case 26625:a=4==r.Flags;break;case 0:a=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(i-e.l>>1,"utf16le"),e.l=i,r}function iv(e,t){var i={},r=e.l+t;return e.l+=4,i.Salt=e.slice(e.l,e.l+16),e.l+=16,i.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),i.VerifierHash=e.slice(e.l,r),e.l=r,i}function rv(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:tv(e,t),v:iv(e,e.length-e.l)}}function av(){throw new Error("File is password-protected: ECMA-376 Extensible")}function sv(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var i=e.read_shift(e.length-e.l,"utf8"),r={};return i.replace(Op,(function(e){var i=Ip(e);switch(Lp(i[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){r[e]=i[e]}));break;case"<dataIntegrity":r.encryptedHmacKey=i.encryptedHmacKey,r.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=i.uri;break;case"<encryptedKey":r.encs.push(i);break;default:throw i[0]}})),r}var nv=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],i=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return 255&((i=e^t)/2|128*i);var i};return function(a){for(var s,n,o,l=Jb(a),c=function(e){for(var r=t[e.length-1],a=104,s=e.length-1;s>=0;--s)for(var n=e[s],o=0;7!=o;++o)64&n&&(r^=i[a]),n*=2,--a;return r}(l),h=l.length,u=Bd(16),d=0;16!=d;++d)u[d]=0;for(1&~h||(s=c>>8,u[h]=r(e[0],s),--h,s=255&c,n=l[l.length-1],u[h]=r(n,s));h>0;)s=c>>8,u[--h]=r(l[h],s),s=255&c,u[--h]=r(l[h],s);for(h=15,o=15-l.length;o>0;)s=c>>8,u[h]=r(e[o],s),--o,s=255&c,u[--h]=r(l[h],s),--h,--o;return u}}();function ov(e,t){var i=t||{},r={},a=i.dense;a&&(r["!data"]=[]);var s=hp(e,"\\trowd","\\row");if(!s)throw new Error("RTF missing table");var n={s:{c:0,r:0},e:{c:0,r:s.length-1}},o=[];return s.forEach((function(e,t){a&&(o=r["!data"][t]=[]);for(var s,l=/\\[\w\-]+\b/g,c=0,h=-1,u=[];null!=(s=l.exec(e));){var d=e.slice(c,l.lastIndex-s[0].length);switch(32==d.charCodeAt(0)&&(d=d.slice(1)),d.length&&u.push(d),s[0]){case"\\cell":if(++h,u.length){var f={v:u.join(""),t:"s"};"TRUE"==f.v||"FALSE"==f.v?(f.v="TRUE"==f.v,f.t="b"):isNaN(Qf(f.v))||(f.t="n",!1!==i.cellText&&(f.w=f.v),f.v=Qf(f.v)),a?o[h]=f:r[Jg({r:t,c:h})]=f}u=[];break;case"\\par":u.push("\n")}c=l.lastIndex}h>n.e.c&&(n.e.c=h)})),r["!ref"]=em(n),r}function lv(e){for(var t=0,i=1;3!=t;++t)i=256*i+(e[t]>255?255:e[t]<0?0:e[t]);return i.toString(16).toUpperCase().slice(1)}function cv(e,t){if(0===t)return e;var i,r,a=function(e){var t=e[0]/255,i=e[1]/255,r=e[2]/255,a=Math.max(t,i,r),s=Math.min(t,i,r),n=a-s;if(0===n)return[0,0,t];var o,l=0,c=a+s;switch(o=n/(c>1?2-c:c),a){case t:l=((i-r)/n+6)%6;break;case i:l=(r-t)/n+2;break;case r:l=(t-i)/n+4}return[l/6,o,c/2]}((r=(i=e).slice("#"===i[0]?1:0).slice(0,6),[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]));return a[2]=t<0?a[2]*(1+t):1-(1-a[2])*(1-t),lv(function(e){var t,i=e[0],r=e[1],a=e[2],s=2*r*(a<.5?a:1-a),n=a-s/2,o=[n,n,n],l=6*i;if(0!==r)switch(0|l){case 0:case 6:t=s*l,o[0]+=s,o[1]+=t;break;case 1:t=s*(2-l),o[0]+=t,o[1]+=s;break;case 2:t=s*(l-2),o[1]+=s,o[2]+=t;break;case 3:t=s*(4-l),o[1]+=t,o[2]+=s;break;case 4:t=s*(l-4),o[2]+=s,o[0]+=t;break;case 5:t=s*(6-l),o[2]+=t,o[0]+=s}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(a))}var hv=6;function uv(e){return Math.floor((e+Math.round(128/hv)/256)*hv)}function dv(e){return Math.floor((e-5)/hv*100+.5)/100}function fv(e){return Math.round((e*hv+5)/hv*256)/256}function pv(e){return fv(dv(uv(e)))}function gv(e){var t=Math.abs(e-pv(e)),i=hv;if(t>.005)for(hv=1;hv<15;++hv)Math.abs(e-pv(e))<=t&&(t=Math.abs(e-pv(e)),i=hv);hv=i}function mv(e){e.width?(e.wpx=uv(e.width),e.wch=dv(e.wpx),e.MDW=hv):e.wpx?(e.wch=dv(e.wpx),e.width=fv(e.wch),e.MDW=hv):"number"==typeof e.wch&&(e.width=fv(e.wch),e.wpx=uv(e.width),e.MDW=hv),e.customWidth&&delete e.customWidth}var bv=96;function vv(e){return 96*e/bv}function yv(e){return e*bv/96}var _v={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},wv=["numFmtId","fillId","fontId","borderId","xfId"],xv=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Av=function(){return function(e,t,i){var r,a={};return e?(e=cp(up(e,"\x3c!--","--\x3e")),(r=pp(e,"numFmts"))&&function(e,t,i){t.NumberFmt=[];for(var r=Bf(tf),a=0;a<r.length;++a)t.NumberFmt[r[a]]=tf[r[a]];var s=e.match(Op);if(s)for(a=0;a<s.length;++a){var n=Ip(s[a]);switch(Lp(n[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=Bp(Gp(n.formatCode)),l=parseInt(n.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}If(o,l)}break;default:if(i.WTF)throw new Error("unrecognized "+n[0]+" in numFmts")}}}(r[0],a,i),(r=pp(e,"fonts"))&&function(e,t,i,r){t.Fonts=[];var a={},s=!1;(e.match(Op)||[]).forEach((function(e){var n=Ip(e);switch(Lp(n[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":n.val&&(a.name=Gp(n.val));break;case"<b":a.bold=n.val?Wp(n.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=n.val?Wp(n.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(n.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=n.val?Wp(n.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=n.val?Wp(n.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=n.val?Wp(n.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=n.val?Wp(n.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=n.val?Wp(n.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":n.val&&(a.sz=+n.val);break;case"<vertAlign":n.val&&(a.vertAlign=n.val);break;case"<family":n.val&&(a.family=parseInt(n.val,10));break;case"<scheme":n.val&&(a.scheme=n.val);break;case"<charset":if("1"==n.val)break;n.codepage=xd[parseInt(n.val,10)];break;case"<color":if(a.color||(a.color={}),n.auto&&(a.color.auto=Wp(n.auto)),n.rgb)a.color.rgb=n.rgb.slice(-6);else if(n.indexed){a.color.index=parseInt(n.indexed,10);var o=Em[a.color.index];81==a.color.index&&(o=Em[1]),o||(o=Em[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else n.theme&&(a.color.theme=parseInt(n.theme,10),n.tint&&(a.color.tint=parseFloat(n.tint)),n.theme&&i.themeElements&&i.themeElements.clrScheme&&(a.color.rgb=cv(i.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+n[0]+" in fonts")}}))}(r[0],a,t,i),(r=pp(e,"fills"))&&function(e,t,i,r){t.Fills=[];var a={},s=!1;(e.match(Op)||[]).forEach((function(e){var i=Ip(e);switch(Lp(i[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":i.patternType&&(a.patternType=i.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),i.indexed&&(a.bgColor.indexed=parseInt(i.indexed,10)),i.theme&&(a.bgColor.theme=parseInt(i.theme,10)),i.tint&&(a.bgColor.tint=parseFloat(i.tint)),i.rgb&&(a.bgColor.rgb=i.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),i.theme&&(a.fgColor.theme=parseInt(i.theme,10)),i.tint&&(a.fgColor.tint=parseFloat(i.tint)),null!=i.rgb&&(a.fgColor.rgb=i.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fills")}}))}(r[0],a,0,i),(r=pp(e,"borders"))&&function(e,t,i,r){t.Borders=[];var a={},s=!1;(e.match(Op)||[]).forEach((function(e){var i=Ip(e);switch(Lp(i[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},i.diagonalUp&&(a.diagonalUp=Wp(i.diagonalUp)),i.diagonalDown&&(a.diagonalDown=Wp(i.diagonalDown)),t.Borders.push(a);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in borders")}}))}(r[0],a,0,i),(r=pp(e,"cellXfs"))&&function(e,t,i){var r;t.CellXf=[];var a=!1;(e.match(Op)||[]).forEach((function(e){var s=Ip(e),n=0;switch(Lp(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"<protection>":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":case"<xf>":for(delete(r=s)[0],n=0;n<wv.length;++n)r[wv[n]]&&(r[wv[n]]=parseInt(r[wv[n]],10));for(n=0;n<xv.length;++n)r[xv[n]]&&(r[xv[n]]=Wp(r[xv[n]]));if(t.NumberFmt&&r.numFmtId>392)for(n=392;n>60;--n)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[n]){r.numFmtId=n;break}t.CellXf.push(r);break;case"<alignment":case"<alignment/>":case"<alignment>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),null!=s.textRotation&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=Wp(s.wrapText)),r.alignment=o;break;case"<AlternateContent":case"<AlternateContent>":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}}))}(r[0],a,i),a):a}}(),Tv=jg,kv=jg,Sv=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Pv(e,t){var i;e&&0!==e.length||(e=function(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var i=[Ep];return i[i.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',i[i.length]="<a:themeElements>",i[i.length]='<a:clrScheme name="Office">',i[i.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',i[i.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',i[i.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',i[i.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',i[i.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',i[i.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',i[i.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',i[i.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',i[i.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',i[i.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',i[i.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',i[i.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',i[i.length]="</a:clrScheme>",i[i.length]='<a:fontScheme name="Office">',i[i.length]="<a:majorFont>",i[i.length]='<a:latin typeface="Cambria"/>',i[i.length]='<a:ea typeface=""/>',i[i.length]='<a:cs typeface=""/>',i[i.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',i[i.length]='<a:font script="Hang" typeface="맑은 고딕"/>',i[i.length]='<a:font script="Hans" typeface="宋体"/>',i[i.length]='<a:font script="Hant" typeface="新細明體"/>',i[i.length]='<a:font script="Arab" typeface="Times New Roman"/>',i[i.length]='<a:font script="Hebr" typeface="Times New Roman"/>',i[i.length]='<a:font script="Thai" typeface="Tahoma"/>',i[i.length]='<a:font script="Ethi" typeface="Nyala"/>',i[i.length]='<a:font script="Beng" typeface="Vrinda"/>',i[i.length]='<a:font script="Gujr" typeface="Shruti"/>',i[i.length]='<a:font script="Khmr" typeface="MoolBoran"/>',i[i.length]='<a:font script="Knda" typeface="Tunga"/>',i[i.length]='<a:font script="Guru" typeface="Raavi"/>',i[i.length]='<a:font script="Cans" typeface="Euphemia"/>',i[i.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',i[i.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',i[i.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',i[i.length]='<a:font script="Thaa" typeface="MV Boli"/>',i[i.length]='<a:font script="Deva" typeface="Mangal"/>',i[i.length]='<a:font script="Telu" typeface="Gautami"/>',i[i.length]='<a:font script="Taml" typeface="Latha"/>',i[i.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',i[i.length]='<a:font script="Orya" typeface="Kalinga"/>',i[i.length]='<a:font script="Mlym" typeface="Kartika"/>',i[i.length]='<a:font script="Laoo" typeface="DokChampa"/>',i[i.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',i[i.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',i[i.length]='<a:font script="Viet" typeface="Times New Roman"/>',i[i.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',i[i.length]='<a:font script="Geor" typeface="Sylfaen"/>',i[i.length]="</a:majorFont>",i[i.length]="<a:minorFont>",i[i.length]='<a:latin typeface="Calibri"/>',i[i.length]='<a:ea typeface=""/>',i[i.length]='<a:cs typeface=""/>',i[i.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',i[i.length]='<a:font script="Hang" typeface="맑은 고딕"/>',i[i.length]='<a:font script="Hans" typeface="宋体"/>',i[i.length]='<a:font script="Hant" typeface="新細明體"/>',i[i.length]='<a:font script="Arab" typeface="Arial"/>',i[i.length]='<a:font script="Hebr" typeface="Arial"/>',i[i.length]='<a:font script="Thai" typeface="Tahoma"/>',i[i.length]='<a:font script="Ethi" typeface="Nyala"/>',i[i.length]='<a:font script="Beng" typeface="Vrinda"/>',i[i.length]='<a:font script="Gujr" typeface="Shruti"/>',i[i.length]='<a:font script="Khmr" typeface="DaunPenh"/>',i[i.length]='<a:font script="Knda" typeface="Tunga"/>',i[i.length]='<a:font script="Guru" typeface="Raavi"/>',i[i.length]='<a:font script="Cans" typeface="Euphemia"/>',i[i.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',i[i.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',i[i.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',i[i.length]='<a:font script="Thaa" typeface="MV Boli"/>',i[i.length]='<a:font script="Deva" typeface="Mangal"/>',i[i.length]='<a:font script="Telu" typeface="Gautami"/>',i[i.length]='<a:font script="Taml" typeface="Latha"/>',i[i.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',i[i.length]='<a:font script="Orya" typeface="Kalinga"/>',i[i.length]='<a:font script="Mlym" typeface="Kartika"/>',i[i.length]='<a:font script="Laoo" typeface="DokChampa"/>',i[i.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',i[i.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',i[i.length]='<a:font script="Viet" typeface="Arial"/>',i[i.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',i[i.length]='<a:font script="Geor" typeface="Sylfaen"/>',i[i.length]="</a:minorFont>",i[i.length]="</a:fontScheme>",i[i.length]='<a:fmtScheme name="Office">',i[i.length]="<a:fillStyleLst>",i[i.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:lin ang="16200000" scaled="1"/>',i[i.length]="</a:gradFill>",i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:lin ang="16200000" scaled="0"/>',i[i.length]="</a:gradFill>",i[i.length]="</a:fillStyleLst>",i[i.length]="<a:lnStyleLst>",i[i.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]="</a:lnStyleLst>",i[i.length]="<a:effectStyleLst>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]="</a:effectStyle>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]="</a:effectStyle>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',i[i.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',i[i.length]="</a:effectStyle>",i[i.length]="</a:effectStyleLst>",i[i.length]="<a:bgFillStyleLst>",i[i.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',i[i.length]="</a:gradFill>",i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',i[i.length]="</a:gradFill>",i[i.length]="</a:bgFillStyleLst>",i[i.length]="</a:fmtScheme>",i[i.length]="</a:themeElements>",i[i.length]="<a:objectDefaults>",i[i.length]="<a:spDef>",i[i.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',i[i.length]="</a:spDef>",i[i.length]="<a:lnDef>",i[i.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',i[i.length]="</a:lnDef>",i[i.length]="</a:objectDefaults>",i[i.length]="<a:extraClrSchemeLst/>",i[i.length]="</a:theme>",i.join("")}());var r={};if(!(i=fp(e,"a:themeElements")))throw new Error("themeElements not found in theme");return function(e,t,i){var r;if(t.themeElements={},!(r=fp(e,"a:clrScheme")))throw new Error("clrScheme not found in themeElements");if(function(e,t,i){t.themeElements.clrScheme=[];var r={};(e[0].match(Op)||[]).forEach((function(e){var a=Ip(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":case"</a:srgbClr>":case"</a:sysClr>":break;case"<a:srgbClr":r.rgb=a.val;break;case"<a:sysClr":r.rgb=a.lastClr;break;case"</a:dk1>":case"</a:lt1>":case"<a:dk1>":case"<a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[Sv.indexOf(a[0])]=r,r={}):r.name=a[0].slice(3,a[0].length-1);break;default:if(i&&i.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}}))}(r,t,i),!(r=fp(e,"a:fontScheme")))throw new Error("fontScheme not found in themeElements");if(!(r=fp(e,"a:fmtScheme")))throw new Error("fmtScheme not found in themeElements")}(i[0],r,t),r.raw=e,r}function Ev(e){var t=e.read_shift(2),i=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=function(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e){return jg(e,4)}(e);break;case 2:t.xclrValue=db(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}(e);break;case 6:r[1]=function(e,t){return jg(e,t)}(e,i);break;case 14:case 15:r[1]=e.read_shift(1===i?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+i)}return r}function Cv(e,t,i,r){var a,s=null!=e["!data"];t.forEach((function(t){var n=Zg(t.ref);if(!(n.r<0||n.c<0)){if(s?(e["!data"][n.r]||(e["!data"][n.r]=[]),a=e["!data"][n.r][n.c]):a=e[t.ref],!a){a={t:"z"},s?e["!data"][n.r][n.c]=a:e[t.ref]=a;var o=tm(e["!ref"]||"BDWGO1000001:A1");o.s.r>n.r&&(o.s.r=n.r),o.e.r<n.r&&(o.e.r=n.r),o.s.c>n.c&&(o.s.c=n.c),o.e.c<n.c&&(o.e.c=n.c);var l=em(o);e["!ref"]=l}a.c||(a.c=[]);var c={a:t.author,t:t.t,r:t.r,T:i};t.h&&(c.h=t.h);for(var h=a.c.length-1;h>=0;--h){if(!i&&a.c[h].T)return;i&&!a.c[h].T&&a.c.splice(h,1)}if(i&&r)for(h=0;h<r.length;++h)if(c.a==r[h].id){c.a=r[h].name||c.a;break}a.c.push(c)}}))}var Dv=nm,Ov=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function i(e,i,r,a){var s=!1,n=!1;0==r.length?n=!0:"["==r.charAt(0)&&(n=!0,r=r.slice(1,-1)),0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=a.length>0?0|parseInt(a,10):0;return s?l+=t.c:--l,n?o+=t.r:--o,i+(s?"":"$")+qg(l)+(n?"":"$")+Gg(o)}return function(r,a){return t=a,r.replace(e,i)}}(),Rv=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{Rv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch(e){}var Mv=function(){return function(e,t){return e.replace(Rv,(function(e,i,r,a,s,n){var o=Kg(a)-(r?0:t.c),l=Yg(n)-(s?0:t.r);return i+"R"+("$"==s?l+1:0==l?"":"["+l+"]")+"C"+("$"==r?o+1:0==o?"":"["+o+"]")}))}}();function Iv(e,t){return e.replace(Rv,(function(e,i,r,a,s,n){return i+("$"==r?r+a:qg(Kg(a)+t.c))+("$"==s?s+n:Gg(Yg(n)+t.r))}))}function Lv(e,t,i){var r=Qg(t).s,a=Zg(i);return Iv(e,{r:a.r-r.r,c:a.c-r.c})}function Fv(e){return e.replace(/_xlfn\./g,"")}function Nv(e){e.l+=1}function Bv(e,t){var i=e.read_shift(1==t?1:2);return[16383&i,i>>14&1,i>>15&1]}function jv(e,t,i){var r=2;if(i){if(i.biff>=2&&i.biff<=5)return zv(e);12==i.biff&&(r=4)}var a=e.read_shift(r),s=e.read_shift(r),n=Bv(e,2),o=Bv(e,2);return{s:{r:a,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function zv(e){var t=Bv(e,2),i=Bv(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:i[0],c:a,cRel:i[1],rRel:i[2]}}}function Uv(e,t,i){if(i&&i.biff>=2&&i.biff<=5)return function(e){var t=Bv(e,2),i=e.read_shift(1);return{r:t[0],c:i,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(i&&12==i.biff?4:2),a=Bv(e,2);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function Hv(e){var t=e.read_shift(2),i=e.read_shift(2);return{r:t,c:255&i,fQuoted:!!(16384&i),cRel:i>>15,rRel:i>>15}}function Wv(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Vv(e){return[e.read_shift(1),e.read_shift(1)]}function $v(e,t){var i=[e.read_shift(1)];if(12==t)switch(i[0]){case 2:i[0]=4;break;case 4:i[0]=16;break;case 0:i[0]=1;break;case 1:i[0]=2}switch(i[0]){case 4:i[1]=ib(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:i[1]=Cm[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:i[1]=ym(e);break;case 2:i[1]=hb(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+i[0])}return i}function Xv(e,t,i){for(var r=e.read_shift(12==i.biff?4:2),a=[],s=0;s!=r;++s)a.push((12==i.biff?vm:bb)(e,8));return a}function Yv(e,t,i){var r=0,a=0;12==i.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),i.biff>=2&&i.biff<8&&(--r,0==--a&&(a=256));for(var s=0,n=[];s!=r&&(n[s]=[]);++s)for(var o=0;o!=a;++o)n[s][o]=$v(e,i.biff);return n}function Gv(e,t,i){return e.l+=2,[Hv(e)]}function Kv(e){return e.l+=6,[]}function qv(e){return e.l+=2,[rb(e),1&e.read_shift(2)]}var Zv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],Jv={1:{n:"PtgExp",f:function(e,t,i){return e.l++,i&&12==i.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(i&&2==i.biff?1:2)]}},2:{n:"PtgTbl",f:jg},3:{n:"PtgAdd",f:Nv},4:{n:"PtgSub",f:Nv},5:{n:"PtgMul",f:Nv},6:{n:"PtgDiv",f:Nv},7:{n:"PtgPower",f:Nv},8:{n:"PtgConcat",f:Nv},9:{n:"PtgLt",f:Nv},10:{n:"PtgLe",f:Nv},11:{n:"PtgEq",f:Nv},12:{n:"PtgGe",f:Nv},13:{n:"PtgGt",f:Nv},14:{n:"PtgNe",f:Nv},15:{n:"PtgIsect",f:Nv},16:{n:"PtgUnion",f:Nv},17:{n:"PtgRange",f:Nv},18:{n:"PtgUplus",f:Nv},19:{n:"PtgUminus",f:Nv},20:{n:"PtgPercent",f:Nv},21:{n:"PtgParen",f:Nv},22:{n:"PtgMissArg",f:Nv},23:{n:"PtgStr",f:function(e,t,i){return e.l++,nb(e,0,i)}},26:{n:"PtgSheet",f:function(e,t,i){return e.l+=5,e.l+=2,e.l+=2==i.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,i){return e.l+=2==i.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Cm[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,ym(e)}},32:{n:"PtgArray",f:function(e,t,i){var r=(96&e[e.l++])>>5;return e.l+=2==i.biff?6:12==i.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,i){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(i&&i.biff<=3?1:2);return[yy[a],vy[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,i){var r=e[e.l++],a=e.read_shift(1),s=i&&i.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===s[0]?vy:by)[s[1]]]}},35:{n:"PtgName",f:function(e,t,i){var r=e.read_shift(1)>>>5&3,a=!i||i.biff>=8?4:2,s=e.read_shift(a);switch(i.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,s]}},36:{n:"PtgRef",f:function(e,t,i){var r=(96&e[e.l])>>5;return e.l+=1,[r,Uv(e,0,i)]}},37:{n:"PtgArea",f:function(e,t,i){return[(96&e[e.l++])>>5,jv(e,i.biff>=2&&i.biff,i)]}},38:{n:"PtgMemArea",f:function(e,t,i){var r=e.read_shift(1)>>>5&3;return e.l+=i&&2==i.biff?3:4,[r,e.read_shift(i&&2==i.biff?1:2)]}},39:{n:"PtgMemErr",f:jg},40:{n:"PtgMemNoMem",f:jg},41:{n:"PtgMemFunc",f:function(e,t,i){return[e.read_shift(1)>>>5&3,e.read_shift(i&&2==i.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,i){var r=e.read_shift(1)>>>5&3;return e.l+=4,i.biff<8&&e.l--,12==i.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,i){var r=(96&e[e.l++])>>5;return e.l+=i&&i.biff>8?12:i.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,i){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,i){var r=i&&i.biff?i.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),i=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&i>=128&&(i-=256),{r:t,c:i,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),s=e.read_shift(2),n=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)for(;a>524287;)a-=1048576;if(1==n)for(;s>8191;)s-=16384;return{r:a,c:s,cRel:n,rRel:o}}(e,0,i);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,i){var r=(96&e[e.l++])>>5,a=function(e,t,i){if(i.biff<8)return zv(e);var r=e.read_shift(12==i.biff?4:2),a=e.read_shift(12==i.biff?4:2),s=Bv(e,2),n=Bv(e,2);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:n[0],cRel:n[1],rRel:n[2]}}}(e,0,i);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,i){return 5==i.biff?function(e){var t=e.read_shift(1)>>>5&3,i=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,i,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,i){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return i&&5==i.biff&&(e.l+=12),[r,a,Uv(e,0,i)]}},59:{n:"PtgArea3d",f:function(e,t,i){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(i&&5===i.biff)e.l+=12;return[r,a,jv(e,0,i)]}},60:{n:"PtgRefErr3d",f:function(e,t,i){var r=(96&e[e.l++])>>5,a=e.read_shift(2),s=4;if(i)switch(i.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,i){var r=(96&e[e.l++])>>5,a=e.read_shift(2),s=8;if(i)switch(i.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[r,a]}},255:{}},Qv={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ey={1:{n:"PtgElfLel",f:qv},2:{n:"PtgElfRw",f:Gv},3:{n:"PtgElfCol",f:Gv},6:{n:"PtgElfRwV",f:Gv},7:{n:"PtgElfColV",f:Gv},10:{n:"PtgElfRadical",f:Gv},11:{n:"PtgElfRadicalS",f:Kv},13:{n:"PtgElfColS",f:Kv},15:{n:"PtgElfColSV",f:Kv},16:{n:"PtgElfRadicalLel",f:qv},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),i=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&i,rt:Zv[i>>2&31],idx:r,c:a,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},ty={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,i){var r=255&e[e.l+1]?1:0;return e.l+=i&&2==i.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,i){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(i&&2==i.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,i){e.l+=2;for(var r=e.read_shift(i&&2==i.biff?1:2),a=[],s=0;s<=r;++s)a.push(e.read_shift(i&&2==i.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,i){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(i&&2==i.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,i){e.l+=i&&2==i.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Wv},33:{n:"PtgAttrBaxcel",f:Wv},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Vv(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Vv(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function iy(e,t,i,r){if(r.biff<8)return jg(e,t);for(var a=e.l+t,s=[],n=0;n!==i.length;++n)switch(i[n][0]){case"PtgArray":i[n][1]=Yv(e,0,r),s.push(i[n][1]);break;case"PtgMemArea":i[n][2]=Xv(e,i[n][1],r),s.push(i[n][2]);break;case"PtgExp":r&&12==r.biff&&(i[n][1][1]=e.read_shift(4),s.push(i[n][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+i[n][0]}return 0!=(t=a-e.l)&&s.push(jg(e,t)),s}function ry(e,t,i){for(var r,a,s=e.l+t,n=[];s!=e.l;)t=s-e.l,a=e[e.l],r=Jv[a]||Jv[Qv[a]],24!==a&&25!==a||(r=(24===a?ey:ty)[e[e.l+1]]),r&&r.f?n.push([r.n,r.f(e,t,i)]):jg(e,t);return n}function ay(e){for(var t=[],i=0;i<e.length;++i){for(var r=e[i],a=[],s=0;s<r.length;++s){var n=r[s];n?2===n[0]?a.push('"'+n[1].replace(/"/g,'""')+'"'):a.push(n[1]):a.push("")}t.push(a.join(","))}return t.join(";")}var sy={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ny(e,t,i){if(!e)return"SH33TJSERR0";if(i.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(i.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(i.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=i.SID?e.SheetNames[i.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function oy(e,t,i){var r=ny(e,t,i);return"#REF"==r?r:function(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}(r,i)}function ly(e,t,i,r,a){var s,n,o,l,c,h,u,d,f=a&&a.biff||8,p={s:{c:0,r:0},e:{c:0,r:0}},g=[],m=0,b=0,v="";if(!e[0]||!e[0][0])return"";for(var y=-1,_="",w=0,x=e[0].length;w<x;++w){var A=e[0][w];switch(A[0]){case"PtgUminus":g.push("-"+g.pop());break;case"PtgUplus":g.push("+"+g.pop());break;case"PtgPercent":g.push(g.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=g.pop(),n=g.pop(),y>=0){switch(e[0][y][1][0]){case 0:_=Jf(" ",e[0][y][1][1]);break;case 1:_=Jf("\r",e[0][y][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}n+=_,y=-1}g.push(n+sy[A[0]]+s);break;case"PtgIsect":s=g.pop(),n=g.pop(),g.push(n+" "+s);break;case"PtgUnion":s=g.pop(),n=g.pop(),g.push(n+","+s);break;case"PtgRange":s=g.pop(),n=g.pop(),g.push((h=s,u=void 0,d=void 0,u=(c=n).lastIndexOf("!"),d=h.lastIndexOf("!"),-1==u&&-1==d?c+":"+h:u>0&&d>0&&c.slice(0,u).toLowerCase()==h.slice(0,d).toLowerCase()?c+":"+h.slice(d+1):(console.error("Cannot hydrate range",c,h),c+":"+h)));break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Wg(A[1][1],p,a),g.push($g(o,f));break;case"PtgRefN":o=i?Wg(A[1][1],i,a):A[1][1],g.push($g(o,f));break;case"PtgRef3d":m=A[1][1],o=Wg(A[1][2],p,a),v=oy(r,m,a),g.push(v+"!"+$g(o,f));break;case"PtgFunc":case"PtgFuncVar":var T=A[1][0],k=A[1][1];T||(T=0);var S=0==(T&=127)?[]:g.slice(-T);g.length-=T,"User"===k&&(k=S.shift()),g.push(k+"("+S.join(",")+")");break;case"PtgBool":g.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":g.push(A[1]);break;case"PtgNum":g.push(String(A[1]));break;case"PtgStr":g.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Vg(A[1][1],i?{s:i}:p,a),g.push(Xg(l,a));break;case"PtgArea":l=Vg(A[1][1],p,a),g.push(Xg(l,a));break;case"PtgArea3d":m=A[1][1],l=A[1][2],v=oy(r,m,a),g.push(v+"!"+Xg(l,a));break;case"PtgAttrSum":g.push("SUM("+g.pop()+")");break;case"PtgName":b=A[1][2];var P=(r.names||[])[b-1]||(r[0]||[])[b],E=P?P.Name:"SH33TJSNAME"+String(b);E&&"_xlfn."==E.slice(0,6)&&!a.xlfn&&(E=E.slice(6)),g.push(E);break;case"PtgNameX":var C,D=A[1][1];if(b=A[1][2],!(a.biff<=5)){var O="";if(14849==((r[D]||[])[0]||[])[0]||(1025==((r[D]||[])[0]||[])[0]?r[D][b]&&r[D][b].itab>0&&(O=r.SheetNames[r[D][b].itab-1]+"!"):O=r.SheetNames[b-1]+"!"),r[D]&&r[D][b])O+=r[D][b].Name;else if(r[0]&&r[0][b])O+=r[0][b].Name;else{var R=(ny(r,D,a)||"").split(";;");R[b-1]?O=R[b-1]:O+="SH33TJSERRX"}g.push(O);break}D<0&&(D=-D),r[D]&&(C=r[D][b]),C||(C={Name:"SH33TJSERRY"}),g.push(C.Name);break;case"PtgParen":var M="(",I=")";if(y>=0){switch(_="",e[0][y][1][0]){case 2:M=Jf(" ",e[0][y][1][1])+M;break;case 3:M=Jf("\r",e[0][y][1][1])+M;break;case 4:I=Jf(" ",e[0][y][1][1])+I;break;case 5:I=Jf("\r",e[0][y][1][1])+I;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}g.push(M+g.pop()+I);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":g.push("#REF!");break;case"PtgExp":o={c:A[1][1],r:A[1][0]};var L={c:i.c,r:i.r};if(r.sharedf[Jg(o)]){var F=r.sharedf[Jg(o)];g.push(ly(F,0,L,r,a))}else{var N=!1;for(s=0;s!=r.arrayf.length;++s)if(n=r.arrayf[s],!(o.c<n[0].s.c||o.c>n[0].e.c||o.r<n[0].s.r||o.r>n[0].e.r)){g.push(ly(n[1],0,L,r,a)),N=!0;break}N||g.push(A[1])}break;case"PtgArray":g.push("{"+ay(A[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=w;break;case"PtgMissArg":g.push("");break;case"PtgList":g.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(A))}if(3!=a.biff&&y>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][w][0])){var B=!0;switch((A=e[0][y])[1][0]){case 4:B=!1;case 0:_=Jf(" ",A[1][1]);break;case 5:B=!1;case 1:_=Jf("\r",A[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}g.push((B?_:"")+g.pop()+(B?"":_)),y=-1}}if(g.length>1&&a.WTF)throw new Error("bad formula stack");return"TRUE"==g[0]||"FALSE"!=g[0]&&g[0]}function cy(e,t,i){var r,a=e.l+t,s=2==i.biff?1:2,n=e.read_shift(s);if(65535==n)return[[],jg(e,t-2)];var o=ry(e,n,i);return t!==n+s&&(r=iy(e,t-n-s,o,i)),e.l=a,[o,r]}function hy(e,t,i){var r,a=e.l+t,s=e.read_shift(2),n=ry(e,s,i);return 65535==s?[[],jg(e,t-2)]:(t!==s+2&&(r=iy(e,a-s-2,n,i)),[n,r])}function uy(e,t,i){var r=e.l+t,a=pb(e,6,i),s=function(e){var t;if(65535!==Pg(e,e.l+6))return[ym(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),n=e.read_shift(1);2!=i.biff&&(e.read_shift(1),i.biff>=5&&e.read_shift(4));var o=function(e,t,i){var r,a=e.l+t,s=2==i.biff?1:2,n=e.read_shift(s);if(65535==n)return[[],jg(e,t-2)];var o=ry(e,n,i);return t!==n+s&&(r=iy(e,t-n-s,o,i)),e.l=a,[o,r]}(e,r-e.l,i);return{cell:a,val:s[0],formula:o,shared:n>>3&1,tt:s[1]}}function dy(e,t,i){var r=e.read_shift(4),a=ry(e,r,i),s=e.read_shift(4);return[a,s>0?iy(e,s,a,i):null]}var fy=dy,py=dy,gy=dy,my=dy,by={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},yy={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _y(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\$'([^']|'')+'/g,(function(e){return e.slice(1)}))).replace(/\$([^\]\. #$]+)/g,(function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function wy(e){var t=(e=(e=e.replace(/\$'([^']|'')+'/g,(function(e){return e.slice(1)}))).replace(/\$([^\]\. #$]+)/g,(function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t}))).split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var xy={},Ay={};function Ty(e,t){if(e){var i=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(i=[1,1,1,1,.5,.5]),null==e.left&&(e.left=i[0]),null==e.right&&(e.right=i[1]),null==e.top&&(e.top=i[2]),null==e.bottom&&(e.bottom=i[3]),null==e.header&&(e.header=i[4]),null==e.footer&&(e.footer=i[5])}}function ky(e,t,i,r,a,s,n){try{r.cellNF&&(e.z=tf[t])}catch(e){if(r.WTF)throw e}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=Kf(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==tf[t]&&If(Of[t]||"General",t),"e"===e.t)e.w=e.w||Cm[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=lf(e.v);else if("d"===e.t){var o=Wf(e.v,!!n);e.w=(0|o)===o?o.toString(10):lf(o)}else{if(void 0===e.v)return"";e.w=cf(e.v,Ay)}else"d"===e.t?e.w=Cf(t,Wf(e.v,!!n),Ay):e.w=Cf(t,e.v,Ay)}catch(e){if(r.WTF)throw e}if(r.cellStyles&&null!=i)try{e.s=s.Fills[i],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=cv(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=cv(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(e){if(r.WTF&&s.Fills)throw e}}}var Sy=/<(?:\w+:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,Py=/<(?:\w+:)?hyperlink [^<>]*>/gm,Ey=/"(\w*:\w*)"/,Cy=/<(?:\w+:)?col\b[^<>]*[\/]?>/g,Dy=/<(?:\w+:)?autoFilter[^>]*/g,Oy=/<(?:\w+:)?pageMargins[^<>]*\/>/g,Ry=/<(?:\w+:)?sheetPr\b[^<>]*?\/>/;function My(e,t,i,r){var a=Ip(e);i.Sheets[r]||(i.Sheets[r]={}),a.codeName&&(i.Sheets[r].CodeName=Bp(Gp(a.codeName)))}var Iy=/<(?:\w:)?sheetView(?:[^<>a-z][^<>]*)?\/?>/g,Ly=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,i=/r=["']([^"']*)["']/,r=/ref=["']([^"']*)["']/;return function(a,s,n,o,l,c,h){for(var u,d,f,p,g,m=0,b="",v=[],y=[],_=0,w=0,x=0,A="",T=0,k=0,S=0,P=0,E=Array.isArray(c.CellXf),C=[],D=[],O=null!=s["!data"],R=[],M={},I=!1,L=!!n.sheetStubs,F=!!((h||{}).WBProps||{}).date1904,N=a.split(t),B=0,j=N.length;B!=j;++B){var z=(b=N[B].trim()).length;if(0!==z){var U=0;e:for(m=0;m<z;++m)switch(b[m]){case">":if("/"!=b[m-1]){++m;break e}if(n&&n.cellStyles){if(T=null!=(d=Ip(b.slice(U,m),!0)).r?parseInt(d.r,10):T+1,k=-1,n.sheetRows&&n.sheetRows<T)continue;M={},I=!1,d.ht&&(I=!0,M.hpt=parseFloat(d.ht),M.hpx=yv(M.hpt)),d.hidden&&Wp(d.hidden)&&(I=!0,M.hidden=!0),null!=d.outlineLevel&&(I=!0,M.level=+d.outlineLevel),I&&(R[T-1]=M)}break;case"<":U=m}if(U>=m)break;if(T=null!=(d=Ip(b.slice(U,m),!0)).r?parseInt(d.r,10):T+1,k=-1,!(n.sheetRows&&n.sheetRows<T)){n.nodim||(o.s.r>T-1&&(o.s.r=T-1),o.e.r<T-1&&(o.e.r=T-1)),n&&n.cellStyles&&(M={},I=!1,d.ht&&(I=!0,M.hpt=parseFloat(d.ht),M.hpx=yv(M.hpt)),d.hidden&&Wp(d.hidden)&&(I=!0,M.hidden=!0),null!=d.outlineLevel&&(I=!0,M.level=+d.outlineLevel),I&&(R[T-1]=M)),v=b.slice(m).split(e);for(var H=0;H!=v.length&&"<"==v[H].trim().charAt(0);++H);for(v=v.slice(H),m=0;m!=v.length;++m)if(0!==(b=v[m].trim()).length){if(y=b.match(i),_=m,w=0,x=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=y&&2===y.length){for(_=0,A=y[1],w=0;w!=A.length&&!((x=A.charCodeAt(w)-64)<1||x>26);++w)_=26*_+x;k=--_}else++k;for(w=0;w!=b.length&&62!==b.charCodeAt(w);++w);if(++w,(d=Ip(b.slice(0,w),!0)).r||(d.r=Jg({r:T-1,c:k})),A=b.slice(w),u={t:""},null!=(y=pp(A,"v"))&&""!==y[1]&&(u.v=Bp(y[1])),n.cellFormula){if(null!=(y=pp(A,"f"))){if(""==y[1])y[0].indexOf('t="shared"')>-1&&D[(p=Ip(y[0])).si]&&(u.f=Lv(D[p.si][1],D[p.si][2],d.r));else if(u.f=Bp(Gp(y[1]),!0),n.xlfn||(u.f=Fv(u.f)),y[0].indexOf('t="array"')>-1)u.F=(A.match(r)||[])[1],u.F.indexOf(":")>-1&&C.push([tm(u.F),u.F]);else if(y[0].indexOf('t="shared"')>-1){p=Ip(y[0]);var W=Bp(Gp(y[1]));n.xlfn||(W=Fv(W)),D[parseInt(p.si,10)]=[p,W,d.r]}}else(y=A.match(/<f[^<>]*\/>/))&&D[(p=Ip(y[0])).si]&&(u.f=Lv(D[p.si][1],D[p.si][2],d.r));var V=Zg(d.r);for(w=0;w<C.length;++w)V.r>=C[w][0].s.r&&V.r<=C[w][0].e.r&&V.c>=C[w][0].s.c&&V.c<=C[w][0].e.c&&(u.F=C[w][1])}if(null==d.t&&void 0===u.v)if(u.f||u.F)u.v=0,u.t="n";else{if(!L)continue;u.t="z"}else u.t=d.t||"n";switch(o.s.c>k&&(o.s.c=k),o.e.c<k&&(o.e.c=k),u.t){case"n":if(""==u.v||null==u.v){if(!L)continue;u.t="z"}else u.v=parseFloat(u.v);break;case"s":if(void 0===u.v){if(!L)continue;u.t="z"}else f=xy[parseInt(u.v,10)],u.v=f.t,u.r=f.r,n.cellHTML&&(u.h=f.h);break;case"str":u.t="s",u.v=null!=u.v?Bp(Gp(u.v),!0):"",n.cellHTML&&(u.h=Up(u.v));break;case"inlineStr":y=pp(A,"is"),u.t="s",null!=y&&(f=Kb(y[1]))?(u.v=f.t,n.cellHTML&&(u.h=f.h)):u.v="";break;case"b":u.v=Wp(u.v);break;case"d":n.cellDates?u.v=Kf(u.v,F):(u.v=Wf(Kf(u.v,F),F),u.t="n");break;case"e":n&&!1===n.cellText||(u.w=u.v),u.v=Dm[u.v]}if(S=P=0,g=null,E&&void 0!==d.s&&null!=(g=c.CellXf[d.s])&&(null!=g.numFmtId&&(S=g.numFmtId),n.cellStyles&&null!=g.fillId&&(P=g.fillId)),ky(u,S,P,n,l,c,F),n.cellDates&&E&&"n"==u.t&&Sf(tf[S])&&(u.v=Vf(u.v+(F?1462:0)),u.t="number"==typeof u.v?"n":"d"),d.cm&&n.xlmeta){var $=(n.xlmeta.Cell||[])[+d.cm-1];$&&"XLDAPR"==$.type&&(u.D=!0)}var X;n.nodim&&(X=Zg(d.r),o.s.r>X.r&&(o.s.r=X.r),o.e.r<X.r&&(o.e.r=X.r)),O?(X=Zg(d.r),s["!data"][X.r]||(s["!data"][X.r]=[]),s["!data"][X.r][X.c]=u):s[d.r]=u}}}}R.length>0&&(s["!rows"]=R)}}(),Fy=vm;function Ny(e){return[um(e),ym(e),"n"]}var By=vm,jy=["left","right","top","bottom","header","footer"];var zy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Uy=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Hy=[],Wy=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Vy(e,t){for(var i=0;i!=e.length;++i)for(var r=e[i],a=0;a!=t.length;++a){var s=t[a];if(null==r[s[0]])r[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof r[s[0]]&&(r[s[0]]=Wp(r[s[0]]));break;case"int":"string"==typeof r[s[0]]&&(r[s[0]]=parseInt(r[s[0]],10))}}}function $y(e,t){for(var i=0;i!=t.length;++i){var r=t[i];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=Wp(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function Xy(e){$y(e.WBProps,zy),$y(e.CalcPr,Wy),Vy(e.WBView,Uy),Vy(e.Sheets,Hy),Ay.date1904=Wp(e.WBProps.date1904)}var Yy=":][*?/\\".split("");var Gy=/<\w+:workbook/;function Ky(e,t){var i={};return e.read_shift(4),i.ArchID=e.read_shift(4),e.l+=t-8,i}function qy(e,t,i,r,a,s,n,o){return".bin"===t.slice(-4)?function(e,t,i,r,a,s,n){if(!e)return e;var o=t||{};r||(r={"!id":{}});var l,c={};o.dense&&(c["!data"]=[]);var h,u,d,f,p,g,m,b,v,y={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=[],w=!1,x=!1,A=[];o.biff=12,o["!row"]=0;var T=0,k=!1,S=[],P={},E=o.supbooks||a.supbooks||[[]];if(E.sharedf=P,E.arrayf=S,E.SheetNames=a.SheetNames||a.Sheets.map((function(e){return e.name})),!o.supbooks&&(o.supbooks=E,a.Names))for(var C=0;C<a.Names.length;++C)E[0][C+1]=a.Names[C];var D,O,R=[],M=[],I=!1;f_[16]={n:"BrtShortReal",f:Ny};var L=1462*+!!((a||{}).WBProps||{}).date1904;if(Ug(e,(function(e,t,C){if(!x)switch(C){case 148:l=e;break;case 0:h=e,o.sheetRows&&o.sheetRows<=h.r&&(x=!0),b=Gg(f=h.r),o["!row"]=h.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=yv(e.hpt)),M[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":m=xy[e[1]],u.v=m.t,u.r=m.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=Cm[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((d=n.CellXf[e[0].iStyleRef])&&ky(u,d.numFmtId,null,o,s,n,L>0),p=-1==e[0].c?p+1:e[0].c,o.dense?(c["!data"][f]||(c["!data"][f]=[]),c["!data"][f][p]=u):c[qg(p)+b]=u,o.cellFormula){for(k=!1,T=0;T<S.length;++T){var F=S[T];h.r>=F[0].s.r&&h.r<=F[0].e.r&&p>=F[0].s.c&&p<=F[0].e.c&&(u.F=em(F[0]),k=!0)}!k&&e.length>3&&(u.f=e[3])}if(y.s.r>h.r&&(y.s.r=h.r),y.s.c>p&&(y.s.c=p),y.e.r<h.r&&(y.e.r=h.r),y.e.c<p&&(y.e.c=p),o.cellDates&&d&&"n"==u.t&&Sf(tf[d.numFmtId])){var N=nf(u.v+L);N&&(u.t="d",u.v=new Date(Date.UTC(N.y,N.m-1,N.d,N.H,N.M,N.S,N.u)))}D&&("XLDAPR"==D.type&&(u.D=!0),D=void 0),O&&(O=void 0);break;case 1:case 12:if(!o.sheetStubs||w)break;u={t:"z",v:void 0},p=-1==e[0].c?p+1:e[0].c,o.dense?(c["!data"][f]||(c["!data"][f]=[]),c["!data"][f][p]=u):c[qg(p)+b]=u,y.s.r>h.r&&(y.s.r=h.r),y.s.c>p&&(y.s.c=p),y.e.r<h.r&&(y.e.r=h.r),y.e.c<p&&(y.e.c=p),D&&("XLDAPR"==D.type&&(u.D=!0),D=void 0),O&&(O=void 0);break;case 176:A.push(e);break;case 49:D=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var B=r["!id"][e.relId];for(B?(e.Target=B.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=B):""==e.relId&&(e.Target="#"+e.loc),f=e.rfx.s.r;f<=e.rfx.e.r;++f)for(p=e.rfx.s.c;p<=e.rfx.e.c;++p)o.dense?(c["!data"][f]||(c["!data"][f]=[]),c["!data"][f][p]||(c["!data"][f][p]={t:"z",v:void 0}),c["!data"][f][p].l=e):(g=qg(p)+Gg(f),c[g]||(c[g]={t:"z",v:void 0}),c[g].l=e);break;case 426:if(!o.cellFormula)break;S.push(e),(v=o.dense?c["!data"][f][p]:c[qg(p)+b]).f=ly(e[1],0,{r:h.r,c:p},E,o),v.F=em(e[0]);break;case 427:if(!o.cellFormula)break;P[Jg(e[0].s)]=e[1],(v=o.dense?c["!data"][f][p]:c[qg(p)+b]).f=ly(e[1],0,{r:h.r,c:p},E,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)R[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},I||(I=!0,gv(e.w/256)),mv(R[e.e+1]);break;case 551:e&&(c["!legrel"]=e);break;case 161:c["!autofilter"]={ref:em(e)};break;case 476:c["!margins"]=e;break;case 147:a.Sheets[i]||(a.Sheets[i]={}),e.name&&(a.Sheets[i].CodeName=e.name),(e.above||e.left)&&(c["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:_.push(C),w=!0;break;case 38:_.pop(),w=!1;break;default:if(t.T);else if(!w||o.WTF)throw new Error("Unexpected record 0x"+C.toString(16))}}),o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(y.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=em(l||y)),o.sheetRows&&c["!ref"]){var F=tm(c["!ref"]);o.sheetRows<=+F.e.r&&(F.e.r=o.sheetRows-1,F.e.r>y.e.r&&(F.e.r=y.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>y.e.c&&(F.e.c=y.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),c["!fullref"]=c["!ref"],c["!ref"]=em(F))}return A.length>0&&(c["!merges"]=A),R.length>0&&(c["!cols"]=R),M.length>0&&(c["!rows"]=M),r["!id"][c["!legrel"]]&&(c["!legdrawel"]=r["!id"][c["!legrel"]]),c}(e,r,i,a,s,n,o):function(e,t,i,r,a,s,n){if(!e)return e;r||(r={"!id":{}});var o={};t.dense&&(o["!data"]=[]);var l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",h="",u=pp(e,"sheetData");u?(c=e.slice(0,u.index),h=e.slice(u.index+u[0].length)):c=h=e;var d=c.match(Ry);d?My(d[0],0,a,i):(d=pp(c,"sheetPr"))&&function(e,t,i,r,a){My(e.slice(0,e.indexOf(">")),0,r,a)}(d[0],d[1],0,a,i);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=c.slice(f,f+50).match(Ey);!p||t&&t.nodim||function(e,t){var i=tm(t);i.s.r<=i.e.r&&i.s.c<=i.e.c&&i.s.r>=0&&i.s.c>=0&&(e["!ref"]=em(i))}(o,p[1])}var g=pp(c,"sheetViews");g&&g[1]&&function(e,t){t.Views||(t.Views=[{}]),(e.match(Iy)||[]).forEach((function(e,i){var r=Ip(e);t.Views[i]||(t.Views[i]={}),+r.zoomScale&&(t.Views[i].zoom=+r.zoomScale),r.rightToLeft&&Wp(r.rightToLeft)&&(t.Views[i].RTL=!0)}))}(g[1],a);var m=[];if(t.cellStyles){var b=c.match(Cy);b&&function(e,t){for(var i=!1,r=0;r!=t.length;++r){var a=Ip(t[r],!0);a.hidden&&(a.hidden=Wp(a.hidden));var s=parseInt(a.min,10)-1,n=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!i&&a.width&&(i=!0,gv(a.width)),mv(a);s<=n;)e[s++]=Zf(a)}}(m,b)}u&&Ly(u[1],o,t,l,s,n,a);var v=h.match(Dy);v&&(o["!autofilter"]=function(e){return{ref:(e.match(/ref="([^"]*)"/)||[])[1]}}(v[0]));var y=[],_=h.match(Sy);if(_)for(f=0;f!=_.length;++f)y[f]=tm(_[f].slice(_[f].indexOf('"')+1));var w=h.match(Py);w&&function(e,t,i){for(var r=null!=e["!data"],a=0;a!=t.length;++a){var s=Ip(Gp(t[a]),!0);if(!s.ref)return;var n=((i||{})["!id"]||[])[s.id];n?(s.Target=n.Target,s.location&&(s.Target+="#"+Bp(s.location))):(s.Target="#"+Bp(s.location),n={Target:s.Target,TargetMode:"Internal"}),s.Rel=n,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=tm(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var h=qg(c)+Gg(l);r?(e["!data"][l]||(e["!data"][l]=[]),e["!data"][l][c]||(e["!data"][l][c]={t:"z",v:void 0}),e["!data"][l][c].l=s):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=s)}}}(o,w,r);var x,A,T,k=h.match(Oy);if(k&&(o["!margins"]=(x=Ip(k[0]),A={},["left","right","top","bottom","header","footer"].forEach((function(e){x[e]&&(A[e]=parseFloat(x[e]))})),A)),(T=h.match(/legacyDrawing r:id="(.*?)"/))&&(o["!legrel"]=T[1]),t&&t.nodim&&(l.s.c=l.s.r=0),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=em(l)),t.sheetRows>0&&o["!ref"]){var S=tm(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=em(S))}return m.length>0&&(o["!cols"]=m),y.length>0&&(o["!merges"]=y),r["!id"][o["!legrel"]]&&(o["!legdrawel"]=r["!id"][o["!legrel"]]),o}(e,r,i,a,s,n,o)}var Zy,Jy=/\b((?:\w+:)?[\w]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Qy=/\b((?:\w+:)?[\w]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function e_(e,t){var i=e.split(/\s+/),r=[];if(t||(r[0]=i[0]),1===i.length)return r;var a,s,n,o=e.match(Jy);if(o)for(n=0;n!=o.length;++n)-1===(s=(a=o[n].match(Qy))[1].indexOf(":"))?r[a[1]]=a[2].slice(1,a[2].length-1):r["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(s+1)]=a[2].slice(1,a[2].length-1);return r}function t_(e){var t={};if(1===e.split(/\s+/).length)return t;var i,r,a,s=e.match(Jy);if(s)for(a=0;a!=s.length;++a)-1===(r=(i=s[a].match(Qy))[1].indexOf(":"))?t[i[1]]=i[2].slice(1,i[2].length-1):t["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(r+1)]=i[2].slice(1,i[2].length-1);return t}function i_(e,t,i,r){var a=r;switch((i[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Wp(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Kf(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+i[0])}e[Bp(t)]=a}function r_(e,t,i){if(i.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=_v[r.Pattern]||r.Pattern)}e[t.ID]=t}function a_(e,t,i,r,a,s,n,o,l,c,h){var u="General",d=r.StyleID,f={};c=c||{};var p=[],g=0;for(void 0===d&&o&&(d=o.StyleID),void 0===d&&n&&(d=n.StyleID);void 0!==s[d];){var m=s[d];if(m.nf&&(u=m.nf),m.Interior&&p.push(m.Interior),!m.Parent)break;d=m.Parent}switch(i.Type){case"Boolean":r.t="b",r.v=Wp(e);break;case"String":r.t="s",r.r=Hp(Bp(e)),r.v=e.indexOf("<")>-1?Bp(t||e).replace(/<[^<>]*>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=Wf(Kf(e,h),h),r.v!=r.v&&(r.v=Bp(e)),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=Dm[e],!1!==c.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=Hp(t||e))}if(function(e,t,i,r){if("z"!==e.t){if(!i||!1!==i.cellText)try{"e"===e.t?e.w=e.w||Cm[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=lf(e.v):e.w=cf(e.v):e.w=function(e,t,i){var r=Zy[e]||Bp(e);return"General"===r?cf(t):Cf(r,t,{date1904:!!i})}(t||"General",e.v,r)}catch(e){if(i.WTF)throw e}try{var a=Zy[t]||t||"General";if(i.cellNF&&(e.z=a),i.cellDates&&"n"==e.t&&Sf(a)){var s=nf(e.v+(r?1462:0));s&&(e.t="d",e.v=new Date(Date.UTC(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u)))}}catch(e){if(i.WTF)throw e}}}(r,u,c,h),!1!==c.cellFormula)if(r.Formula){var b=Bp(r.Formula);61==b.charCodeAt(0)&&(b=b.slice(1)),r.f=Ov(b,a),delete r.Formula,"RC"==r.ArrayRange?r.F=Ov("RC:RC",a):r.ArrayRange&&(r.F=Ov(r.ArrayRange,a),l.push([tm(r.F),r.F]))}else for(g=0;g<l.length;++g)a.r>=l[g][0].s.r&&a.r<=l[g][0].e.r&&a.c>=l[g][0].s.c&&a.c<=l[g][0].e.c&&(r.F=l[g][1]);c.cellStyles&&(p.forEach((function(e){!f.patternType&&e.patternType&&(f.patternType=e.patternType)})),r.s=f),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function s_(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function n_(e,t){var i=t||{};Df();var r=Cd(ig(e));"binary"!=i.type&&"array"!=i.type&&"base64"!=i.type||(r=Gp(r));var a,s=r.slice(0,1024).toLowerCase(),n=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var o=Zf(i);return o.type="string",Wb.to_workbook(r,o)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){s.indexOf("<"+e)>=0&&(n=!0)})),n)return function(e,t){var i=bp(e,"table");if(!i||0==i.length)throw new Error("Invalid HTML: could not find <table>");if(1==i.length){var r=rm(m_(i[0],t),t);return r.bookType="html",r}var a=aw();return i.forEach((function(e,i){sw(a,m_(e,t),"Sheet"+(i+1))})),a.bookType="html",a}(r,i);Zy={"General Number":"General","General Date":tf[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":tf[15],"Short Date":tf[14],"Long Time":tf[19],"Medium Time":tf[18],"Short Time":tf[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:tf[2],Standard:tf[4],Percent:tf[10],Scientific:tf[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],h={},u=[],d={},f="";i.dense&&(d["!data"]=[]);var p,g={},m={},b=e_('<Data ss:Type="String">'),v=0,y=0,_=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},x={},A={},T="",k=0,S=[],P={},E={},C=0,D=[],O=[],R={},M=[],I=!1,L=[],F=[],N={},B=0,j=0,z={Sheets:[],WBProps:{date1904:!1}},U={};rg.lastIndex=0,r=up(r,"\x3c!--","--\x3e");for(var H,W="";a=rg.exec(r);)switch(a[3]=(W=a[3]).toLowerCase()){case"data":if("data"==W){if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break}if(c[c.length-1][1])break;"/"===a[1]?a_(r.slice(v,a.index),T,b,"comment"==c[c.length-1][0]?R:g,{c:y,r:_},x,M[y],m,L,i,z.WBProps.date1904):(T="",b=e_(a[0]),v=a.index+a[0].length);break;case"cell":if("/"===a[1])if(O.length>0&&(g.c=O),(!i.sheetRows||i.sheetRows>_)&&void 0!==g.v&&(i.dense?(d["!data"][_]||(d["!data"][_]=[]),d["!data"][_][y]=g):d[qg(y)+Gg(_)]=g),g.HRef&&(g.l={Target:Bp(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(B=y+(0|parseInt(g.MergeAcross,10)),j=_+(0|parseInt(g.MergeDown,10)),(B>y||j>_)&&S.push({s:{c:y,r:_},e:{c:B,r:j}})),i.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var V=y;V<=B;++V)for(var $=_;$<=j;++$)(V>y||$>_)&&(i.dense?(d["!data"][$]||(d["!data"][$]=[]),d["!data"][$][V]={t:"z"}):d[qg(V)+Gg($)]={t:"z"});y=B+1}else++y;else g.MergeAcross?y=B+1:++y;else(g=t_(a[0])).Index&&(y=+g.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),"/>"===a[0].slice(-2)&&++y,O=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(_<w.s.r&&(w.s.r=_),_>w.e.r&&(w.e.r=_),"/>"===a[0].slice(-2)&&(m=e_(a[0])).Index&&(_=+m.Index-1),y=0,++_):((m=e_(a[0])).Index&&(_=+m.Index-1),N={},("0"==m.AutoFitHeight||m.Height)&&(N.hpx=parseInt(m.Height,10),N.hpt=vv(N.hpx),F[_]=N),"1"==m.Hidden&&(N.hidden=!0,F[_]=N));break;case"worksheet":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));u.push(f),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(d["!ref"]=em(w),i.sheetRows&&i.sheetRows<=w.e.r&&(d["!fullref"]=d["!ref"],w.e.r=i.sheetRows-1,d["!ref"]=em(w))),S.length&&(d["!merges"]=S),M.length>0&&(d["!cols"]=M),F.length>0&&(d["!rows"]=F),h[f]=d}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=y=0,c.push([a[3],!1]),l=e_(a[0]),f=Bp(l.Name),d={},i.dense&&(d["!data"]=[]),S=[],L=[],F=[],U={name:f,Hidden:0},z.Sheets.push(U);break;case"table":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==a[0].slice(-2))break;c.push([a[3],!1]),M=[],I=!1}break;case"style":"/"===a[1]?r_(x,A,i):A=e_(a[0]);break;case"numberformat":A.nf=Bp(e_(a[0]).Format||"General"),Zy[A.nf]&&(A.nf=Zy[A.nf]);for(var X=0;392!=X&&tf[X]!=A.nf;++X);if(392==X)for(X=57;392!=X;++X)if(null==tf[X]){If(A.nf,X);break}break;case"column":if("table"!==c[c.length-1][0])break;if("/"===a[1])break;if((p=e_(a[0])).Hidden&&(p.hidden=!0,delete p.Hidden),p.Width&&(p.wpx=parseInt(p.Width,10)),!I&&p.wpx>10){I=!0,hv=6;for(var Y=0;Y<M.length;++Y)M[Y]&&mv(M[Y])}I&&mv(p),M[p.Index-1||M.length]=p;for(var G=0;G<+p.Span;++G)M[M.length]=Zf(p);break;case"namedrange":if("/"===a[1])break;z.Names||(z.Names=[]);var K=Ip(a[0]),q={Name:(H=K.Name,Om.indexOf("_xlnm."+H)>-1?"_xlnm."+H:H),Ref:Ov(K.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(q.Sheet=z.Sheets.length-1),z.Names.push(q);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?T+=r.slice(k,a.index):k=a.index+a[0].length;break;case"interior":if(!i.cellStyles)break;A.Interior=e_(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?Wm(P,W,r.slice(C,a.index)):C=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else c.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));s_(R),O.push(R)}else c.push([a[3],!1]),Wp((l=e_(a[0])).ShowAlways||"0")||(O.hidden=!0),R={a:l.Author};break;case"autofilter":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var Z=e_(a[0]);d["!autofilter"]={ref:Ov(Z.Range).replace(/\$/g,"")},c.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;default:if(0==c.length&&"document"==a[3])return T_(r,i);if(0==c.length&&"uof"==a[3])return T_(r,i);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(a[3]){case"date1904":z.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":case"hideverticalscrollbar":case"hideworkbooktabs":case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(r.slice(C,a.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2}else C=a.index+a[0].length;break;case"header":d["!margins"]||Ty(d["!margins"]={},"xlml"),isNaN(+Ip(a[0]).Margin)||(d["!margins"].header=+Ip(a[0]).Margin);break;case"footer":d["!margins"]||Ty(d["!margins"]={},"xlml"),isNaN(+Ip(a[0]).Margin)||(d["!margins"].footer=+Ip(a[0]).Margin);break;case"pagemargins":var Q=Ip(a[0]);d["!margins"]||Ty(d["!margins"]={},"xlml"),isNaN(+Q.Top)||(d["!margins"].top=+Q.Top),isNaN(+Q.Left)||(d["!margins"].left=+Q.Left),isNaN(+Q.Right)||(d["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(d["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(a[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?i_(E,W,D,r.slice(C,a.index)):(D=a,C=a.index+a[0].length);break}if(i.WTF)throw"Unrecognized tag: "+a[3]+"|"+c.join("|")}var ee={};return i.bookSheets||i.bookProps||(ee.Sheets=h),ee.SheetNames=u,ee.Workbook=z,ee.SSF=Zf(tf),ee.Props=P,ee.Custprops=E,ee.bookType="xlml",ee}function o_(e,t){switch(H_(t=t||{}),t.type||"base64"){case"base64":return n_(Id(e),t);case"binary":case"buffer":case"file":return n_(e,t);case"array":return n_(Ud(e),t)}}var l_=[60,1084,2066,2165,2175];function c_(e,t,i,r,a){var s=r,n=[],o=i.slice(i.l,i.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}n.push(o),i.l+=s;for(var l=Pg(i,i.l),c=p_[l],h=0;null!=c&&l_.indexOf(l)>-1;)s=Pg(i,i.l+2),h=i.l+4,2066==l?h+=4:2165!=l&&2175!=l||(h+=12),o=i.slice(h,i.l+4+s),n.push(o),i.l+=4+s,c=p_[l=Pg(i,i.l)];var u=Wd(n);Bg(u,0);var d=0;u.lens=[];for(var f=0;f<n.length;++f)u.lens.push(d),d+=n[f].length;if(u.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+r;return t.f(u,u.length,a)}function h_(e,t,i){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&null==e.z&&(e.z=tf[r])}catch(e){if(t.WTF)throw e}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Cm[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=lf(e.v):e.w=cf(e.v):e.w=Cf(r,e.v,{date1904:!!i,dateNF:t&&t.dateNF})}catch(e){if(t.WTF)throw e}if(t.cellDates&&r&&"n"==e.t&&Sf(tf[r]||String(r))){var a=nf(e.v+(i?1462:0));a&&(e.t="d",e.v=new Date(Date.UTC(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u)))}}}function u_(e,t,i){return{v:e,ixfe:t,t:i}}function d_(e,t){var i,r,a,s;if(t||(t={}),H_(t),kd(),t.codepage&&Ad(t.codepage),e.FullPaths){if(Nf.find(e,"/encryption"))throw new Error("File is password-protected");i=Nf.find(e,"!CompObj"),r=Nf.find(e,"/Workbook")||Nf.find(e,"/Book")}else{switch(t.type){case"base64":e=zd(Id(e));break;case"binary":e=zd(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Bg(e,0),r={content:e}}if(i&&function(e){var t={},i=e.content;if(i.l=28,t.AnsiUserType=i.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return _m(e,1)}(i),i.length-i.l<=4)return t;var r=i.read_shift(4);0==r||r>40||(i.l-=4,t.Reserved1=i.read_shift(0,"lpstr-ansi"),i.length-i.l<=4||1907505652!==(r=i.read_shift(4))||(t.UnicodeClipboardFormat=function(e){return _m(e,2)}(i),0==(r=i.read_shift(4))||r>40||(i.l-=4,t.Reserved2=i.read_shift(0,"lpwstr"))))}(i),t.bookProps&&!t.bookSheets)a={};else{var n=Ld?"buffer":"array";if(r&&r.content)a=function(e,t){var i={opts:{}},r={},a={};t.dense&&(a["!data"]=[]);var s,n,o,l,c,h,u,d,f={},p={},g=null,m=[],b="",v={},y="",_={},w=[],x=[],A=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=!1,P=function(e){return e<8?Em[e]:e<64&&A[e-8]||Em[e]},E=function(e,t,i){if((S||!(B>1))&&!(i.sheetRows&&e.r>=i.sheetRows)){if(i.cellStyles&&t.XF&&t.XF.data&&function(e,t){var i,r=e.XF.data;r&&r.patternType&&t&&t.cellStyles&&(e.s={},e.s.patternType=r.patternType,(i=lv(P(r.icvFore)))&&(e.s.fgColor={rgb:i}),(i=lv(P(r.icvBack)))&&(e.s.bgColor={rgb:i}))}(t,i),delete t.ixfe,delete t.XF,s=e,y=Jg(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),i.cellFormula&&t.f)for(var r=0;r<w.length;++r)if(!(w[r][0].s.c>e.c||w[r][0].s.r>e.r||w[r][0].e.c<e.c||w[r][0].e.r<e.r)){t.F=em(w[r][0]),w[r][0].s.c==e.c&&w[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+ly(w[r][1],0,e,L,C));break}i.dense?(a["!data"][e.r]||(a["!data"][e.r]=[]),a["!data"][e.r][e.c]=t):a[y]=t}},C={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var D=[],O=[],R=[],M=[],I=!1,L=[];L.SheetNames=C.snames,L.sharedf=C.sharedf,L.arrayf=C.arrayf,L.names=[],L.XTI=[];var F,N=0,B=0,j=0,z=[],U=[];C.codepage=1200,Td(1200);for(var H=!1;e.l<e.length-1;){var W=e.l,V=e.read_shift(2);if(0===V&&10===N)break;var $=e.l===e.length?0:e.read_shift(2),X=p_[V];if(0==B&&-1==[9,521,1033,2057].indexOf(V))break;if(X&&X.f){if(t.bookSheets&&133===N&&133!==V)break;if(N=V,2===X.r||12==X.r){var Y=e.read_shift(2);if($-=2,!C.enc&&Y!==V&&((255&Y)<<8|Y>>8)!==V)throw new Error("rt mismatch: "+Y+"!="+V);12==X.r&&(e.l+=10,$-=10)}var G={};if(G=10===V?X.f(e,$,C):c_(V,X,e,$,C),0==B&&-1===[9,521,1033,2057].indexOf(N))continue;switch(V){case 34:i.opts.Date1904=T.WBProps.date1904=G;break;case 134:i.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=G,!t.password)throw new Error("File is password-protected");if(null==G.valid)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=G;break;case 66:var K=Number(G);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252}Td(C.codepage=K),H=!0;break;case 317:C.rrtabid=G;break;case 25:C.winlocked=G;break;case 439:i.opts.RefreshAll=G;break;case 12:i.opts.CalcCount=G;break;case 16:i.opts.CalcDelta=G;break;case 17:i.opts.CalcIter=G;break;case 13:i.opts.CalcMode=G;break;case 14:i.opts.CalcPrecision=G;break;case 95:i.opts.CalcSaveRecalc=G;break;case 15:C.CalcRefMode=G;break;case 2211:i.opts.FullCalc=G;break;case 129:G.fDialog&&(a["!type"]="dialog"),G.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),G.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:x.push(G);break;case 430:L.push([G]),L[L.length-1].XTI=[];break;case 35:case 547:L[L.length-1].push(G);break;case 24:case 536:F={Name:G.Name,Ref:ly(G.rgce,0,null,L,C)},G.itab>0&&(F.Sheet=G.itab-1),L.names.push(F),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push(G),"_xlnm._FilterDatabase"==G.Name&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&"PtgArea3d"==G.rgce[0][0][0]&&(U[G.itab-1]={ref:em(G.rgce[0][0][1][2])});break;case 22:C.ExternCount=G;break;case 23:0==L.length&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat(G),L.XTI=L.XTI.concat(G);break;case 2196:if(C.biff<8)break;null!=F&&(F.Comment=G[1]);break;case 18:a["!protect"]=G;break;case 19:0!==G&&C.WTF&&console.error("Password verifier: "+G);break;case 133:f[4==C.biff?C.snames.length:G.pos]=G,C.snames.push(G.name);break;case 10:if(--B?!S:S)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,a["!ref"]=em(p),t.sheetRows&&t.sheetRows<=p.e.r){var q=p.e.r;p.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=em(p),p.e.r=q}p.e.r++,p.e.c++}D.length>0&&(a["!merges"]=D),O.length>0&&(a["!objects"]=O),R.length>0&&(a["!cols"]=R),M.length>0&&(a["!rows"]=M),T.Sheets.push(k)}""===b?v=a:r[b]=a,a={},t.dense&&(a["!data"]=[]);break;case 9:case 521:case 1033:case 2057:if(8===C.biff&&(C.biff={9:2,521:3,1033:4}[V]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),C.biffguess=0==G.BIFFVer,0==G.BIFFVer&&4096==G.dt&&(C.biff=5,H=!0,Td(C.codepage=28591)),4==C.biff&&256&G.dt&&(S=!0),8==C.biff&&0==G.BIFFVer&&16==G.dt&&(C.biff=2),B++&&!S)break;if(a={},t.dense&&(a["!data"]=[]),C.biff<8&&!H&&(H=!0,Td(C.codepage=t.codepage||1252)),4==C.biff&&S)b=(f[C.snames.indexOf(b)+1]||{name:""}).name;else if(C.biff<5||0==G.BIFFVer&&4096==G.dt){""===b&&(b="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var Z={pos:e.l-$,name:b};f[Z.pos]=Z,C.snames.push(b)}else b=(f[W]||{name:""}).name;32==G.dt&&(a["!type"]="chart"),64==G.dt&&(a["!type"]="macro"),D=[],O=[],C.arrayf=w=[],R=[],M=[],I=!1,k={Hidden:(f[W]||{hs:0}).hs,name:b};break;case 515:case 3:case 2:"chart"==a["!type"]&&(t.dense?(a["!data"][G.r]||[])[G.c]:a[qg(G.c)+Gg(G.r)])&&++G.c,h={ixfe:G.ixfe,XF:x[G.ixfe]||{},v:G.val,t:"n"},j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E({c:G.c,r:G.r},h,t);break;case 5:case 517:h={ixfe:G.ixfe,XF:x[G.ixfe],v:G.val,t:G.t},j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E({c:G.c,r:G.r},h,t);break;case 638:h={ixfe:G.ixfe,XF:x[G.ixfe],v:G.rknum,t:"n"},j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E({c:G.c,r:G.r},h,t);break;case 189:for(var J=G.c;J<=G.C;++J){var Q=G.rkrec[J-G.c][0];h={ixfe:Q,XF:x[Q],v:G.rkrec[J-G.c][1],t:"n"},j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E({c:J,r:G.r},h,t)}break;case 6:case 518:case 1030:if("String"==G.val){g=G;break}if((h=u_(G.val,G.cell.ixfe,G.tt)).XF=x[h.ixfe],t.cellFormula){var ee=G.formula;if(ee&&ee[0]&&ee[0][0]&&"PtgExp"==ee[0][0][0]){var te=ee[0][0][1][0],ie=ee[0][0][1][1],re=Jg({r:te,c:ie});_[re]?h.f=""+ly(G.formula,0,G.cell,L,C):h.F=((t.dense?(a["!data"][te]||[])[ie]:a[re])||{}).F}else h.f=""+ly(G.formula,0,G.cell,L,C)}j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E(G.cell,h,t),g=G;break;case 7:case 519:if(!g)throw new Error("String record expects Formula");g.val=G,(h=u_(G,g.cell.ixfe,"s")).XF=x[h.ixfe],t.cellFormula&&(h.f=""+ly(g.formula,0,g.cell,L,C)),j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E(g.cell,h,t),g=null;break;case 33:case 545:w.push(G);var ae=Jg(G[0].s);if(n=t.dense?(a["!data"][G[0].s.r]||[])[G[0].s.c]:a[ae],t.cellFormula&&n){if(!g)break;if(!ae||!n)break;n.f=""+ly(G[1],0,G[0],L,C),n.F=em(G[0])}break;case 1212:if(!t.cellFormula)break;if(y){if(!g)break;_[Jg(g.cell)]=G[0],((n=t.dense?(a["!data"][g.cell.r]||[])[g.cell.c]:a[Jg(g.cell)])||{}).f=""+ly(G[0],0,s,L,C)}break;case 253:h=u_(m[G.isst].t,G.ixfe,"s"),m[G.isst].h&&(h.h=m[G.isst].h),h.XF=x[h.ixfe],j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E({c:G.c,r:G.r},h,t);break;case 513:t.sheetStubs&&(h={ixfe:G.ixfe,XF:x[G.ixfe],t:"z"},j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E({c:G.c,r:G.r},h,t));break;case 190:if(t.sheetStubs)for(var se=G.c;se<=G.C;++se){var ne=G.ixfe[se-G.c];h={ixfe:ne,XF:x[ne],t:"z"},j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E({c:se,r:G.r},h,t)}break;case 214:case 516:case 4:(h=u_(G.val,G.ixfe,"s")).XF=x[h.ixfe],j>0&&(h.z=h.XF&&h.XF.numFmtId&&z[h.XF.numFmtId]||z[h.ixfe>>8&63]),h_(h,t,i.opts.Date1904),E({c:G.c,r:G.r},h,t);break;case 0:case 512:1===B&&(p=G);break;case 252:m=G;break;case 1054:if(C.biff>=3&&C.biff<=4){z[j++]=G[1];for(var oe=0;oe<j+163&&tf[oe]!=G[1];++oe);oe>=163&&If(G[1],j+163)}else If(G[1],G[0]);break;case 30:z[j++]=G;for(var le=0;le<j+163&&tf[le]!=G;++le);le>=163&&If(G,j+163);break;case 229:D=D.concat(G);break;case 93:O[G.cmo[0]]=C.lastobj=G;break;case 438:C.lastobj.TxO=G;break;case 127:C.lastobj.ImData=G;break;case 440:for(c=G[0].s.r;c<=G[0].e.r;++c)for(l=G[0].s.c;l<=G[0].e.c;++l)(n=t.dense?(a["!data"][c]||[])[l]:a[Jg({c:l,r:c})])&&(n.l=G[1]);break;case 2048:for(c=G[0].s.r;c<=G[0].e.r;++c)for(l=G[0].s.c;l<=G[0].e.c;++l)(n=t.dense?(a["!data"][c]||[])[l]:a[Jg({c:l,r:c})])&&n.l&&(n.l.Tooltip=G[1]);break;case 28:if((n=t.dense?(a["!data"][G[0].r]||[])[G[0].c]:a[Jg(G[0])])||(t.dense?(a["!data"][G[0].r]||(a["!data"][G[0].r]=[]),n=a["!data"][G[0].r][G[0].c]={t:"z"}):n=a[Jg(G[0])]={t:"z"},p.e.r=Math.max(p.e.r,G[0].r),p.s.r=Math.min(p.s.r,G[0].r),p.e.c=Math.max(p.e.c,G[0].c),p.s.c=Math.min(p.s.c,G[0].c)),n.c||(n.c=[]),C.biff<=5&&C.biff>=2)o={a:"SheetJ5",t:G[1]};else{var ce=O[G[2]];o={a:G[1],t:ce.TxO.t},null==G[3]||2&G[3]||(n.c.hidden=!0)}n.c.push(o);break;case 2173:x[G.ixfe],G.ext.forEach((function(e){e[0]}));break;case 125:if(!C.cellStyles)break;for(;G.e>=G.s;)R[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(1&G.flags)},I||(I=!0,gv(G.w/256)),mv(R[G.e+1]);break;case 520:var he={};null!=G.level&&(M[G.r]=he,he.level=G.level),G.hidden&&(M[G.r]=he,he.hidden=!0),G.hpt&&(M[G.r]=he,he.hpt=G.hpt,he.hpx=yv(G.hpt));break;case 38:case 39:case 40:case 41:a["!margins"]||Ty(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[V]]=G;break;case 161:a["!margins"]||Ty(a["!margins"]={}),a["!margins"].header=G.header,a["!margins"].footer=G.footer;break;case 574:G.RTL&&(T.Views[0].RTL=!0);break;case 146:A=G;break;case 2198:d=G;break;case 140:u=G;break;case 442:b?k.CodeName=G||k.name:T.WBProps.CodeName=G||"ThisWorkbook"}}else X||console.error("Missing Info for XLS Record 0x"+V.toString(16)),e.l+=$}return i.SheetNames=Bf(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(i.Sheets=r),!i.SheetNames.length&&v["!ref"]?(i.SheetNames.push("Sheet1"),i.Sheets&&(i.Sheets.Sheet1=v)):i.Preamble=v,i.Sheets&&U.forEach((function(e,t){i.Sheets[i.SheetNames[t]]["!autofilter"]=e})),i.Strings=m,i.SSF=Zf(tf),C.enc&&(i.Encryption=C.enc),d&&(i.Themes=d),i.Metadata={},void 0!==u&&(i.Metadata.Country=u),L.names.length>0&&(T.Names=L.names),i.Workbook=T,i}(r.content,t);else if((s=Nf.find(e,"PerfectOffice_MAIN"))&&s.content)a=Vb.to_workbook(s.content,(t.type=n,t));else{if(!(s=Nf.find(e,"NativeContent_MAIN"))||!s.content)throw(s=Nf.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=Vb.to_workbook(s.content,(t.type=n,t))}t.bookVBA&&e.FullPaths&&Nf.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=Nf.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(i,r){if("/"!==i.slice(-1)&&i.match(/_VBA_PROJECT_CUR/)){var a=i.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Nf.utils.cfb_add(t,a,e.FileIndex[r].content)}})),Nf.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,i){var r=Nf.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=eb(r,Am,"02d5cdd59c2e1b10939708002b2cf9ae");for(var s in a)t[s]=a[s]}catch(e){if(i.WTF)throw e}var n=Nf.find(e,"/!SummaryInformation");if(n&&n.size>0)try{var o=eb(n,Tm,"e0859ff2f94f6810ab9108002b27b3d9");for(var l in o)null==t[l]&&(t[l]=o[l])}catch(e){if(i.WTF)throw e}t.HeadingPairs&&t.TitlesOfParts&&(jm(t.HeadingPairs,t.TitlesOfParts,t,i),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var f_={0:{f:function(e,t){var i={},r=e.l+t;i.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,7&s&&(i.level=7&s),16&s&&(i.hidden=!0),32&s&&(i.hpt=a/20),i}},1:{f:function(e){return[hm(e)]}},2:{f:function(e){return[hm(e),mm(e),"n"]}},3:{f:function(e){return[hm(e),e.read_shift(1),"e"]}},4:{f:function(e){return[hm(e),e.read_shift(1),"b"]}},5:{f:function(e){return[hm(e),ym(e),"n"]}},6:{f:function(e){return[hm(e),nm(e),"str"]}},7:{f:function(e){return[hm(e),e.read_shift(4),"s"]}},8:{f:function(e,t,i){var r=e.l+t,a=hm(e);a.r=i["!row"];var s=[a,nm(e),"str"];if(i.cellFormula){e.l+=2;var n=py(e,r-e.l,i);s[3]=ly(n,0,a,i.supbooks,i)}else e.l=r;return s}},9:{f:function(e,t,i){var r=e.l+t,a=hm(e);a.r=i["!row"];var s=[a,ym(e),"n"];if(i.cellFormula){e.l+=2;var n=py(e,r-e.l,i);s[3]=ly(n,0,a,i.supbooks,i)}else e.l=r;return s}},10:{f:function(e,t,i){var r=e.l+t,a=hm(e);a.r=i["!row"];var s=[a,e.read_shift(1),"b"];if(i.cellFormula){e.l+=2;var n=py(e,r-e.l,i);s[3]=ly(n,0,a,i.supbooks,i)}else e.l=r;return s}},11:{f:function(e,t,i){var r=e.l+t,a=hm(e);a.r=i["!row"];var s=[a,e.read_shift(1),"e"];if(i.cellFormula){e.l+=2;var n=py(e,r-e.l,i);s[3]=ly(n,0,a,i.supbooks,i)}else e.l=r;return s}},12:{f:function(e){return[um(e)]}},13:{f:function(e){return[um(e),mm(e),"n"]}},14:{f:function(e){return[um(e),e.read_shift(1),"e"]}},15:{f:function(e){return[um(e),e.read_shift(1),"b"]}},16:{f:Ny},17:{f:function(e){return[um(e),nm(e),"str"]}},18:{f:function(e){return[um(e),e.read_shift(4),"s"]}},19:{f:lm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,i){var r=e.l+t,a=e.read_shift(4);e.l+=1;var s,n=e.read_shift(4),o=pm(e),l="";try{s=gy(e,0,i);try{l=fm(e)}catch(e){}}catch(e){console.error("Could not parse defined name "+o)}32&a&&(o="_xlnm."+o),e.l=r;var c={Name:o,Ptg:s,Flags:a};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}},40:{},42:{},43:{f:function(e,t,i){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(r.underline=s);var n=e.read_shift(1);n>0&&(r.family=n);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},i=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),n=e.read_shift(1),o=e.read_shift(1);switch(e.l++,i){case 0:t.auto=1;break;case 1:t.index=r;var l=Em[r];l&&(t.rgb=lv(l));break;case 2:t.rgb=lv([s,n,o]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=nm(e),r}},44:{f:function(e,t){return[e.read_shift(2),nm(e)]}},45:{f:Tv},46:{f:kv},47:{f:function(e,t){var i=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=i,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],i=e.read_shift(4);i-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ib},62:{f:function(e){return[hm(e),lm(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var i={};i.r=e.read_shift(4),i.c=e.read_shift(4),t.r=Jg(i);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jg,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var i={},r=e[e.l];return++e.l,i.above=!(64&r),i.left=!(128&r),e.l+=18,i.name=dm(e,t-19),i}},148:{f:Fy,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var i={},r=e.read_shift(4);i.defaultThemeVersion=e.read_shift(4);var a=t>8?nm(e):"";return a.length>0&&(i.CodeName=a),i.autoCompressPictures=!!(65536&r),i.backupFile=!!(64&r),i.checkCompatibility=!!(4096&r),i.date1904=!!(1&r),i.filterPrivacy=!!(8&r),i.hidePivotFieldList=!!(1024&r),i.promptedSolutions=!!(16&r),i.publishItems=!!(2048&r),i.refreshAllConnections=!!(262144&r),i.saveExternalLinkValues=!!(128&r),i.showBorderUnselectedTables=!!(4&r),i.showInkAnnotation=!!(32&r),i.showObjects=["all","placeholders","none"][r>>13&3],i.showPivotChartFilter=!!(32768&r),i.updateLinks=["userSet","never","always"][r>>8&3],i}},154:{},155:{},156:{f:function(e,t){var i={};return i.Hidden=e.read_shift(4),i.iTabID=e.read_shift(4),i.strRelID=gm(e,t-8),i.name=nm(e),i}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:vm},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:By},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:nm(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:gm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Db},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,i){var r=e.l+t,a=bm(e),s=e.read_shift(1),n=[a];if(n[2]=s,i.cellFormula){var o=fy(e,r-e.l,i);n[1]=o}else e.l=r;return n}},427:{f:function(e,t,i){var r=e.l+t,a=[vm(e,16)];if(i.cellFormula){var s=my(e,r-e.l,i);a[1]=s,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return jy.forEach((function(i){t[i]=ym(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var i=e.l+t,r=vm(e,16),a=fm(e),s=nm(e),n=nm(e),o=nm(e);e.l=i;var l={rfx:r,relId:a,loc:s,display:o};return n&&(l.Tooltip=n),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:gm},551:{f:fm},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Dv},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var i=vm(e,16);return t.rfx=i.s,t.ref=Jg(i.s),e.l+=16,t}},636:{T:-1},637:{f:cm},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:nm(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},p_={6:{f:uy},10:{f:tb},12:{f:rb},13:{f:rb},14:{f:ib},15:{f:ib},16:{f:ym},17:{f:ib},18:{f:ib},19:{f:rb},20:{f:Pb},21:{f:Pb},23:{f:Db},24:{f:Cb},25:{f:ib},26:{},27:{},28:{f:function(e,t,i){if(i&&i.biff<8){var r=e.read_shift(2),a=e.read_shift(2);if(65535==r||-1==r)return;var s=e.read_shift(2);return[{r,c:a},e.read_shift(Math.min(s,2048),"cpstr")]}return function(e,t,i){var r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return[{r,c:a},hb(e,0,i),n,s]}(e,0,i)}},29:{},34:{f:ib},35:{f:Eb},38:{f:ym},39:{f:ym},40:{f:ym},41:{f:ym},42:{f:ib},43:{f:ib},47:{f:function(e,t,i){var r={Type:i.biff>=8?e.read_shift(2):0};return r.Type?function(e,t,i){var r=i||{};r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},i=t.EncryptionVersionInfo=Qb(e,4);if(1!=i.Major||1!=i.Minor)throw"unrecognized version code "+i.Major+" : "+i.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):r.Data=function(e,t){var i={},r=i.EncryptionVersionInfo=Qb(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);i.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,i.EncryptionHeader=tv(e,a),t-=a,i.EncryptionVerifier=iv(e,t),i}(e,t)}(e,t-2,r):function(e,t,i,r){var a,s,n,o={key:rb(e),verificationBytes:rb(e)};i.password&&(o.verifier=function(e){var t,i,r=0,a=Jb(e),s=a.length+1;for((t=Bd(s))[0]=a.length,i=1;i!=s;++i)t[i]=a[i-1];for(i=s-1;i>=0;--i)r=((16384&r?1:0)|r<<1&32767)^t[i];return 52811^r}(i.password)),r.valid=o.verificationBytes===o.verifier,r.valid&&(r.insitu=(a=i.password,s=0,n=nv(a),function(e){var t=function(e,t,i,r,a){var s,n;for(a||(a=t),r||(r=nv("")),s=0;s!=t.length;++s)n=t[s],n=255&((n^=r[i])>>5|n<<3),a[s]=n,++i;return[a,i,r]}(0,e,s,n);return s=t[1],t[0]}))}(e,i.biff,i,r),r}},49:{f:function(e,t,i){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(i&&i.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=nb(e,0,i),r}},51:{f:rb},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:ib},65:{f:function(){}},66:{f:rb},77:{},80:{},81:{},82:{},85:{f:rb},89:{},90:{},91:{},92:{f:function(e,t,i){if(i.enc)return e.l+=t,"";var r=e.l,a=hb(e,0,i);return e.read_shift(t+r-e.l),a}},93:{f:function(e,t,i){if(i&&i.biff<8)return function(e,t,i){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var n=[];return n.push((Mb[r]||jg)(e,t,i)),{cmo:[a,r,s],ft:n}}(e,t,i);var r=_b(e),a=function(e,t){for(var i=e.l+t,r=[];e.l<i;){var a=e.read_shift(2);e.l-=2;try{r[a]=xb[a](e,i-e.l)}catch(t){return e.l=i,r}}return e.l!=i&&(e.l=i),r}(e,t-22,r[1]);return{cmo:r,ft:a}}},94:{},95:{f:ib},96:{},97:{},99:{f:ib},125:{f:Ib},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,i){var r=i&&8==i.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:rb},131:{f:ib},132:{f:ib},133:{f:function(e,t,i){var r="";if(4==i.biff)return 0===(r=nb(e,0,i)).length&&(r="Sheet1"),{name:r};var a=e.read_shift(4),s=3&e.read_shift(1),n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule"}return 0===(r=nb(e,0,i)).length&&(r="Sheet1"),{pos:a,hs:s,dt:n,name:r}}},134:{},140:{f:function(e){var t,i=[0,0];return t=e.read_shift(2),i[0]=km[t]||t,t=e.read_shift(2),i[1]=km[t]||t,i}},141:{f:rb},144:{},146:{f:function(e){for(var t=e.read_shift(2),i=[];t-- >0;)i.push(fb(e));return i}},151:{},152:{},153:{},154:{},155:{},156:{f:rb},157:{},158:{},160:{f:Fb},161:{f:function(e,t){var i={};return t<32||(e.l+=16,i.header=ym(e),i.footer=ym(e),e.l+=2),i}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var i=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),s=[];e.l<i;)s.push(mb(e));if(e.l!==i)throw new Error("MulRK read error");var n=e.read_shift(2);if(s.length!=n-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:n,rkrec:s}}},190:{f:function(e,t){for(var i=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),s=[];e.l<i;)s.push(e.read_shift(2));if(e.l!==i)throw new Error("MulBlank read error");var n=e.read_shift(2);if(s.length!=n-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:n,ixfe:s}}},193:{f:tb},197:{},198:{},199:{},200:{},201:{},202:{f:ib},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rb},220:{},221:{f:ib},222:{},224:{f:function(e,t,i){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function(e,t,i,r){var a={},s=e.read_shift(4),n=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=Sm[o>>26],r.cellStyles?(a.alc=7&s,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=15&n,a.dgRight=n>>4&15,a.dgTop=n>>8&15,a.dgBottom=n>>12&15,a.icvLeft=n>>16&127,a.icvRight=n>>23&127,a.grbitDiag=n>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&l,a.icvBack=l>>7&127,a.fsxButton=l>>14&1,a):a}(e,0,r.fStyle,i),r}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:tb},227:{},229:{f:function(e,t){for(var i=[],r=e.read_shift(2);r--;)i.push(bb(e));return i}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var i=e.l+t,r=e.read_shift(4),a=e.read_shift(4),s=[],n=0;n!=a&&e.l<i;++n)s.push(ob(e));return s.Count=r,s.Unique=a,s}},253:{f:function(e,t,i){var r=pb(e,t,i);return r.isst=e.read_shift(4),r}},255:{f:function(e,t){var i={};return i.dsst=e.read_shift(2),e.l+=t-2,i}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ab},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ib},353:{f:tb},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,i){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(i.sbcch=s,1025==s||14849==s)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var n=lb(e,s),o=[];r>e.l;)o.push(cb(e));return[s,a,n,o]}},431:{f:ib},432:{},433:{},434:{},437:{},438:{f:function(e,t,i){var r=e.l,a="";try{e.l+=4;var s=(i.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var i=e.read_shift(2);e.l+=2}(e);var n=e.read_shift(2);e.read_shift(2),rb(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((a+=lb(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?n:2*n))break}if(a.length!==n&&a.length!==2*n)throw new Error("cchText: "+n+" != "+a.length);return e.l=r+t,{t:a}}catch(i){return e.l=r+t,{t:a}}}},439:{f:ib},440:{f:function(e,t){var i=bb(e);e.l+=16;var r=function(e,t){var i=e.l+t,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var s,n,o,l,c,h,u="";16&a&&(s=ub(e,e.l)),128&a&&(n=ub(e,e.l)),257&~a||(o=ub(e,e.l)),1==(257&a)&&(l=function(e){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),i=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=i);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(Vd,"");return r&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),i="";t-- >0;)i+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return i+r.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return i+e.read_shift(a>>1,"utf16le").replace(Vd,"")}(e);default:throw new Error("Unsupported Moniker "+t)}}(e,e.l)),8&a&&(u=ub(e,e.l)),32&a&&(c=e.read_shift(16)),64&a&&(h=Vm(e)),e.l=i;var d=n||o||l||"";d&&u&&(d+="#"+u),d||(d="#"+u),2&a&&"/"==d.charAt(0)&&"/"!=d.charAt(1)&&(d="file://"+d);var f={Target:d};return c&&(f.guid=c),h&&(f.time=h),s&&(f.Tooltip=s),f}(e,t-24);return[i,r]}},441:{},442:{f:cb},443:{},444:{f:rb},445:{},446:{},448:{f:tb},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:tb},512:{f:Sb},513:{f:Lb},515:{f:function(e,t,i){i.biffguess&&2==i.biff&&(i.biff=5);var r=pb(e,6,i),a=ym(e);return r.val=a,r}},516:{f:function(e,t,i){i.biffguess&&2==i.biff&&(i.biff=5),e.l;var r=pb(e,t,i),a=cb(e,e.l,i);return r.val=a,r}},517:{f:function(e,t,i){var r=pb(e,6,i),a=sb(e);return r.val=a,r.t=!0===a||!1===a?"b":"e",r}},519:{f:Nb},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var i=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=i/20),t}},523:{},545:{f:Rb},549:{f:Tb},566:{},574:{f:function(e,t,i){return i&&i.biff>=2&&i.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),i=e.read_shift(2),r=mb(e);return{r:t,c:i,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,t,i){return[e.read_shift(2),hb(e,0,i)]}},1084:{},1212:{f:function(e,t,i){var r=vb(e);e.l++;var a=e.read_shift(1);return[hy(e,t-=8,i),a,r]}},2048:{f:function(e,t){e.read_shift(2);var i=bb(e),r=e.read_shift((t-10)/2,"dbcs-cont");return[i,r=r.replace(Vd,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ab},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:tb},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var i=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),a=[];r-- >0;)a.push(Ev(e,e.l));return{ixfe:i,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ib,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,i){if(!(i.biff<8)){var r=e.read_shift(2),a=e.read_shift(2);return[lb(e,r,i),lb(e,a,i)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,i){var r=e.l+t;if(124226!==e.read_shift(4))if(i.cellStyles){var a,s=e.slice(e.l);e.l=r;try{a=Sp(s,{type:"array"})}catch(e){return}var n=Ap(a,"theme/theme/theme1.xml",!0);if(n)return Pv(n,i)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:tb},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),i=e.read_shift(2);return e.l+=8,{type:t,flags:i}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rb},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,i){var r={area:!1};if(5!=i.biff)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,16&a&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),i=[];t-- >0;)i.push(fb(e));return i}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Sb},1:{},2:{f:function(e,t,i){var r=pb(e,7,i),a=e.read_shift(2);return r.t="n",r.val=a,r}},3:{f:function(e,t,i){var r=pb(e,7,i),a=ym(e);return r.t="n",r.val=a,r}},4:{f:function(e,t,i){i.biffguess&&5==i.biff&&(i.biff=2);var r=pb(e,7,i),a=hb(e,0,i);return r.t="str",r.val=a,r}},5:{f:function(e,t,i){var r=e.l+7,a=pb(e,6,i);e.l=r;var s=sb(e);return a.val=s,a.t=!0===s||!1===s?"b":"e",a}},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:Ab},11:{},22:{f:rb},30:{f:kb},31:{},32:{},33:{f:Rb},36:{},37:{f:Tb},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{f:function(e){var t={};return t.ifnt=e.read_shift(1),e.l++,t.flags=e.read_shift(1),t.numFmtId=63&t.flags,t.flags>>=6,t.fStyle=0,t.data={},t}},68:{f:rb},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),i=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:i,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}},135:{},136:{},137:{},143:{f:function(e){var t=e.read_shift(4),i=e.read_shift(1),r=e.read_shift(i,"sbcs");return 0===r.length&&(r="Sheet1"),{flags:t,name:r}}},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,i){var r=e.l+t,a=pb(e,6,i),s=e.read_shift(2),n=lb(e,s,i);return e.l=r,a.t="str",a.val=n,a}},223:{},234:{},354:{},421:{},518:{f:uy},521:{f:Ab},536:{f:Cb},547:{f:Eb},561:{},579:{f:function(e){var t={};return t.ifnt=e.read_shift(1),t.numFmtId=e.read_shift(1),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,t.data={},t}},1030:{f:uy},1033:{f:Ab},1091:{f:function(e){var t={};return t.ifnt=e.read_shift(1),t.numFmtId=e.read_shift(1),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,t.data={},t}},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function g_(e,t,i,r){var a=t;if(!isNaN(a)){var s=r||(i||[]).length||0,n=e.next(4);n.write_shift(2,a),n.write_shift(2,s),s>0&&kg(i)&&e.push(i)}}function m_(e,t){var i=t||{},r=null!=i.dense?i.dense:null,a={};r&&(a["!data"]=[]);var s=(e=up(e,"\x3c!--","--\x3e")).match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),o=s.index,l=n&&n.index||e.length,c=np(e.slice(o,l),/(:?<tr[^<>]*>)/i,"<tr>"),h=-1,u=0,d=0,f=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<c.length;++o){var m=c[o].trim(),b=m.slice(0,3).toLowerCase();if("<tr"!=b){if("<td"==b||"<th"==b){var v=m.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var y=v[l].trim();if(y.match(/<t[dh]/i)){for(var _=y,w=0;"<"==_.charAt(0)&&(w=_.indexOf(">"))>-1;)_=_.slice(w+1);for(var x=0;x<g.length;++x){var A=g[x];A.s.c==u&&A.s.r<h&&h<=A.e.r&&(u=A.e.c+1,x=-1)}var T=Ip(y.slice(0,y.indexOf(">")));f=T.colspan?+T.colspan:1,((d=+T.rowspan)>1||f>1)&&g.push({s:{r:h,c:u},e:{r:h+(d||1)-1,c:u+f-1}});var k=T.t||T["data-t"]||"";if(_.length)if(_=qp(_),p.s.r>h&&(p.s.r=h),p.e.r<h&&(p.e.r=h),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),_.length){var S={t:"s",v:_};i.raw||!_.trim().length||"s"==k||("TRUE"===_?S={t:"b",v:!0}:"FALSE"===_?S={t:"b",v:!1}:isNaN(Qf(_))?isNaN(sp(_).getDate())||(S={t:"d",v:Kf(_)},!1===i.UTC&&(S.v=op(S.v)),i.cellDates||(S={t:"n",v:Wf(S.v)}),S.z=i.dateNF||tf[14]):S={t:"n",v:Qf(_)}),!1!==S.cellText&&(S.w=_),r?(a["!data"][h]||(a["!data"][h]=[]),a["!data"][h][u]=S):a[Jg({r:h,c:u})]=S,u+=f}else u+=f;else u+=f}}}}else{if(++h,i.sheetRows&&i.sheetRows<=h){--h;break}u=0}}return a["!ref"]=em(p),g.length&&(a["!merges"]=g),a}function b_(e,t,i,r){for(var a=e["!merges"]||[],s=[],n={},o=null!=e["!data"],l=t.s.c;l<=t.e.c;++l){for(var c=0,h=0,u=0;u<a.length;++u)if(!(a[u].s.r>i||a[u].s.c>l||a[u].e.r<i||a[u].e.c<l)){if(a[u].s.r<i||a[u].s.c<l){c=-1;break}c=a[u].e.r-a[u].s.r+1,h=a[u].e.c-a[u].s.c+1;break}if(!(c<0)){var d=qg(l)+Gg(i),f=o?(e["!data"][i]||[])[l]:e[d],p=f&&null!=f.v&&(f.h||Up(f.w||(im(f),f.w)||""))||"";n={},c>1&&(n.rowspan=c),h>1&&(n.colspan=h),r.editable?p='<span contenteditable="true">'+p+"</span>":f&&(n["data-t"]=f&&f.t||"z",null!=f.v&&(n["data-v"]=Up(f.v instanceof Date?f.v.toISOString():f.v)),null!=f.z&&(n["data-z"]=f.z),f.l&&"#"!=(f.l.Target||"#").charAt(0)&&(p='<a href="'+Up(f.l.Target)+'">'+p+"</a>")),n.id=(r.id||"sjs")+"-"+d,s.push(tg("td",p,n))}}return"<tr>"+s.join("")+"</tr>"}function v_(e,t,i){var r=t.rows;if(!r)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var a=i||{},s=null!=e["!data"],n=0,o=0;if(null!=a.origin)if("number"==typeof a.origin)n=a.origin;else{var l="string"==typeof a.origin?Zg(a.origin):a.origin;n=l.r,o=l.c}var c=Math.min(a.sheetRows||1e7,r.length),h={s:{r:0,c:0},e:{r:n,c:o}};if(e["!ref"]){var u=Qg(e["!ref"]);h.s.r=Math.min(h.s.r,u.s.r),h.s.c=Math.min(h.s.c,u.s.c),h.e.r=Math.max(h.e.r,u.e.r),h.e.c=Math.max(h.e.c,u.e.c),-1==n&&(h.e.r=n=u.e.r+1)}var d=[],f=0,p=e["!rows"]||(e["!rows"]=[]),g=0,m=0,b=0,v=0,y=0,_=0;for(e["!cols"]||(e["!cols"]=[]);g<r.length&&m<c;++g){var w=r[g];if(__(w)){if(a.display)continue;p[m]={hidden:!0}}var x=w.cells;for(b=v=0;b<x.length;++b){var A=x[b];if(!a.display||!__(A)){var T=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):qp(A.innerHTML),k=A.getAttribute("data-z")||A.getAttribute("z");for(f=0;f<d.length;++f){var S=d[f];S.s.c==v+o&&S.s.r<m+n&&m+n<=S.e.r&&(v=S.e.c+1-o,f=-1)}_=+A.getAttribute("colspan")||1,((y=+A.getAttribute("rowspan")||1)>1||_>1)&&d.push({s:{r:m+n,c:v+o},e:{r:m+n+(y||1)-1,c:v+o+(_||1)-1}});var P={t:"s",v:T},E=A.getAttribute("data-t")||A.getAttribute("t")||"";null!=T&&(0==T.length?P.t=E||"z":a.raw||0==T.trim().length||"s"==E||("TRUE"===T?P={t:"b",v:!0}:"FALSE"===T?P={t:"b",v:!1}:isNaN(Qf(T))?isNaN(sp(T).getDate())||(P={t:"d",v:Kf(T)},a.UTC&&(P.v=lp(P.v)),a.cellDates||(P={t:"n",v:Wf(P.v)}),P.z=a.dateNF||tf[14]):P={t:"n",v:Qf(T)})),void 0===P.z&&null!=k&&(P.z=k);var C="",D=A.getElementsByTagName("A");if(D&&D.length)for(var O=0;O<D.length&&(!D[O].hasAttribute("href")||"#"==(C=D[O].getAttribute("href")).charAt(0));++O);C&&"#"!=C.charAt(0)&&"javascript:"!=C.slice(0,11).toLowerCase()&&(P.l={Target:C}),s?(e["!data"][m+n]||(e["!data"][m+n]=[]),e["!data"][m+n][v+o]=P):e[Jg({c:v+o,r:m+n})]=P,h.e.c<v+o&&(h.e.c=v+o),v+=_}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),h.e.r=Math.max(h.e.r,m-1+n),e["!ref"]=em(h),m>=c&&(e["!fullref"]=em((h.e.r=r.length-g+m-1+n,h))),e}function y_(e,t){var i={};return(t||{}).dense&&(i["!data"]=[]),v_(i,e,t)}function __(e){var t="",i=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return i&&(t=i(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function w_(e,t,i){var r=i||{},a=ig(e);rg.lastIndex=0,a=cp(up(a,"\x3c!--","--\x3e"));for(var s,n,o,l="",c="",h=0,u=-1,d="";s=rg.exec(a);)switch(s[3]=s[3].replace(/_[\s\S]*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":"/"===s[1]?("false"==n["truncate-on-overflow"]&&(l.match(/h/)?l=l.replace(/h+/,"[$&]"):l.match(/m/)?l=l.replace(/m+/,"[$&]"):l.match(/s/)&&(l=l.replace(/s+/,"[$&]"))),r[n.name]=l,l=""):"/"!==s[0].charAt(s[0].length-2)&&(l="",n=Ip(s[0],!1));break;case"boolean-style":"/"===s[1]?(r[n.name]="General",l=""):"/"!==s[0].charAt(s[0].length-2)&&(l="",n=Ip(s[0],!1));break;case"boolean":l+="General";break;case"text":"/"===s[1]?"%"==(d=a.slice(u,rg.lastIndex-s[0].length))&&"<number:percentage-style"==n[0]?l+="%":l+='"'+d.replace(/"/g,'""')+'"':"/"!==s[0].charAt(s[0].length-2)&&(u=rg.lastIndex);break;case"day":"short"===(o=Ip(s[0],!1)).style?l+="d":l+="dd";break;case"day-of-week":switch((o=Ip(s[0],!1)).style){case"short":default:l+="ddd";break;case"long":l+="dddd"}break;case"era":"short"===(o=Ip(s[0],!1)).style?l+="ee":l+="eeee";break;case"hours":"short"===(o=Ip(s[0],!1)).style?l+="h":l+="hh";break;case"minutes":"short"===(o=Ip(s[0],!1)).style?l+="m":l+="mm";break;case"month":switch((o=Ip(s[0],!1)).textual&&(l+="mm"),o.style){case"short":default:l+="m";break;case"long":l+="mm"}break;case"seconds":"short"===(o=Ip(s[0],!1)).style?l+="s":l+="ss",o["decimal-places"]&&(l+="."+Jf("0",+o["decimal-places"]));break;case"year":switch((o=Ip(s[0],!1)).style){case"short":default:l+="yy";break;case"long":l+="yyyy"}break;case"am-pm":l+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+s[3]);break;case"fill-character":"/"===s[1]?l+='"'+(d=a.slice(u,rg.lastIndex-s[0].length)).replace(/"/g,'""')+'"*':"/"!==s[0].charAt(s[0].length-2)&&(u=rg.lastIndex);break;case"scientific-number":l+="0."+Jf("0",+(o=Ip(s[0],!1))["min-decimal-places"]||+o["decimal-places"]||2)+Jf("?",+o["decimal-places"]-+o["min-decimal-places"]||0)+"E"+(Wp(o["forced-exponent-sign"])?"+":"")+Jf("0",+o["min-exponent-digits"]||2);break;case"fraction":+(o=Ip(s[0],!1))["min-integer-digits"]?l+=Jf("0",+o["min-integer-digits"]):l+="#",l+=" ",l+=Jf("?",+o["min-numerator-digits"]||1),l+="/",+o["denominator-value"]?l+=o["denominator-value"]:l+=Jf("?",+o["min-denominator-digits"]||1);break;case"currency-symbol":"/"===s[1]?l+='"'+a.slice(u,rg.lastIndex-s[0].length).replace(/"/g,'""')+'"':"/"!==s[0].charAt(s[0].length-2)?u=rg.lastIndex:l+="$";break;case"text-properties":switch(((o=Ip(s[0],!1)).color||"").toLowerCase().replace("#","")){case"ff0000":case"red":l="[Red]"+l}break;case"text-content":l+="@";break;case"map":o=Ip(s[0],!1),"value()>=0"==Bp(o.condition)?l=r[o["apply-style-name"]]+";"+l:console.error("ODS number format may be incorrect: "+o.condition);break;case"number":if("/"===s[1])break;c="",c+=Jf("0",+(o=Ip(s[0],!1))["min-integer-digits"]||1),Wp(o.grouping)&&(c=uf(Jf("#",Math.max(0,4-c.length))+c)),(+o["min-decimal-places"]||+o["decimal-places"])&&(c+="."),+o["min-decimal-places"]&&(c+=Jf("0",+o["min-decimal-places"]||1)),+o["decimal-places"]-(+o["min-decimal-places"]||0)&&(c+=Jf("0",+o["decimal-places"]-(+o["min-decimal-places"]||0))),l+=c;break;case"embedded-text":"/"===s[1]?0==h?l+='"'+a.slice(u,rg.lastIndex-s[0].length).replace(/"/g,'""')+'"':l=l.slice(0,h)+'"'+a.slice(u,rg.lastIndex-s[0].length).replace(/"/g,'""')+'"'+l.slice(h):"/"!==s[0].charAt(s[0].length-2)&&(u=rg.lastIndex,h=-+Ip(s[0],!1).position||0)}return r}function x_(e,t,i){var r,a,s,n,o,l,c,h=t||{},u=ig(e),d=[],f=0,p={},g=[],m={};h.dense&&(m["!data"]=[]);var b,v={value:""},y="",_=0,w="",x=0,A=[],T=[],k=-1,S=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,C=i||{},D={},O=[],R={},M=[],I=1,L=1,F=[],N={Names:[],WBProps:{}},B={},j=["",""],z=[],U={},H="",W=0,V=!1,$=!1,X=0;for(rg.lastIndex=0,u=cp(up(u,"\x3c!--","--\x3e"));l=rg.exec(u);)switch(l[3]=l[3].replace(/_[\s\S]*$/,"")){case"table":case"工作表":"/"===l[1]?(P.e.c>=P.s.c&&P.e.r>=P.s.r?m["!ref"]=em(P):m["!ref"]="A1:A1",h.sheetRows>0&&h.sheetRows<=P.e.r&&(m["!fullref"]=m["!ref"],P.e.r=h.sheetRows-1,m["!ref"]=em(P)),O.length&&(m["!merges"]=O),M.length&&(m["!rows"]=M),n.name=n["名称"]||n.name,"undefined"!=typeof JSON&&JSON.stringify(n),g.push(n.name),p[n.name]=m,$=!1):"/"!==l[0].charAt(l[0].length-2)&&(n=Ip(l[0],!1),k=S=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,m={},h.dense&&(m["!data"]=[]),O=[],M=[],$=!0);break;case"table-row-group":"/"===l[1]?--E:++E;break;case"table-row":case"行":if("/"===l[1]){k+=I,I=1;break}if((o=Ip(l[0],!1))["行号"]?k=o["行号"]-1:-1==k&&(k=0),(I=+o["number-rows-repeated"]||1)<10)for(X=0;X<I;++X)E>0&&(M[k+X]={level:E});S=-1;break;case"covered-table-cell":"/"!==l[1]&&++S,h.sheetStubs&&(h.dense?(m["!data"][k]||(m["!data"][k]=[]),m["!data"][k][S]={t:"z"}):m[Jg({r:k,c:S})]={t:"z"}),y="",A=[];break;case"table-cell":case"数据":if("/"===l[0].charAt(l[0].length-2))++S,v=Ip(l[0],!1),L=parseInt(v["number-columns-repeated"]||"1",10),c={t:"z",v:null},v.formula&&0!=h.cellFormula&&(c.f=_y(Bp(v.formula))),v["style-name"]&&D[v["style-name"]]&&(c.z=D[v["style-name"]]),"string"==(v["数据类型"]||v["value-type"])&&(c.t="s",c.v=Bp(v["string-value"]||""),h.dense?(m["!data"][k]||(m["!data"][k]=[]),m["!data"][k][S]=c):m[qg(S)+Gg(k)]=c),S+=L-1;else if("/"!==l[1]){y=w="",_=x=0,A=[],T=[],L=1;var Y=I?k+I-1:k;if(++S>P.e.c&&(P.e.c=S),S<P.s.c&&(P.s.c=S),k<P.s.r&&(P.s.r=k),Y>P.e.r&&(P.e.r=Y),z=[],U={},c={t:(v=Ip(l[0],!1))["数据类型"]||v["value-type"],v:null},v["style-name"]&&D[v["style-name"]]&&(c.z=D[v["style-name"]]),h.cellFormula)if(v.formula&&(v.formula=Bp(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(R={s:{r:k,c:S},e:{r:k+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:S+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},c.F=em(R),F.push([R,c.F])),v.formula)c.f=_y(v.formula);else for(X=0;X<F.length;++X)k>=F[X][0].s.r&&k<=F[X][0].e.r&&S>=F[X][0].s.c&&S<=F[X][0].e.c&&(c.F=F[X][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(R={s:{r:k,c:S},e:{r:k+(parseInt(v["number-rows-spanned"],10)||0)-1,c:S+(parseInt(v["number-columns-spanned"],10)||0)-1}},O.push(R)),v["number-columns-repeated"]&&(L=parseInt(v["number-columns-repeated"],10)),c.t){case"boolean":c.t="b",c.v=Wp(v["boolean-value"])||+v["boolean-value"]>=1;break;case"float":c.t="n",c.v=parseFloat(v.value),h.cellDates&&c.z&&Sf(c.z)&&(c.v=Vf(c.v+(N.WBProps.date1904?1462:0)),c.t="number"==typeof c.v?"n":"d");break;case"percentage":case"currency":c.t="n",c.v=parseFloat(v.value);break;case"date":c.t="d",c.v=Kf(v["date-value"],N.WBProps.date1904),h.cellDates||(c.t="n",c.v=Wf(c.v,N.WBProps.date1904)),c.z||(c.z="m/d/yy");break;case"time":c.t="n",c.v=$f(v["time-value"])/86400,h.cellDates&&(c.v=Vf(c.v),c.t="number"==typeof c.v?"n":"d"),c.z||(c.z="HH:MM:SS");break;case"number":c.t="n",c.v=parseFloat(v["数据数值"]);break;default:if("string"!==c.t&&"text"!==c.t&&c.t)throw new Error("Unsupported value type "+c.t);c.t="s",null!=v["string-value"]&&(y=Bp(v["string-value"]),A=[])}}else{if(V=!1,"s"===c.t&&(c.v=y||"",A.length&&(c.R=A),V=0==_),B.Target&&(c.l=B),z.length>0&&(c.c=z,z=[]),y&&!1!==h.cellText&&(c.w=y),V&&(c.t="z",delete c.v),(!V||h.sheetStubs)&&!(h.sheetRows&&h.sheetRows<=k))for(var G=0;G<I;++G){if(L=parseInt(v["number-columns-repeated"]||"1",10),h.dense)for(m["!data"][k+G]||(m["!data"][k+G]=[]),m["!data"][k+G][S]=0==G?c:Zf(c);--L>0;)m["!data"][k+G][S+L]=Zf(c);else for(m[Jg({r:k+G,c:S})]=c;--L>0;)m[Jg({r:k+G,c:S+L})]=Zf(c);P.e.c<=S&&(P.e.c=S)}S+=(L=parseInt(v["number-columns-repeated"]||"1",10))-1,L=0,c={},y="",A=[]}B={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===l[1]){if((r=d.pop())[0]!==l[3])throw"Bad state: "+r}else"/"!==l[0].charAt(l[0].length-2)&&d.push([l[3],!0]);break;case"annotation":if("/"===l[1]){if((r=d.pop())[0]!==l[3])throw"Bad state: "+r;U.t=y,A.length&&(U.R=A),U.a=H,z.push(U),y=w,_=x,A=T}else if("/"!==l[0].charAt(l[0].length-2)){d.push([l[3],!1]);var K=Ip(l[0],!0);K.display&&Wp(K.display)||(z.hidden=!0),w=y,x=_,T=A,y="",_=0,A=[]}H="",W=0;break;case"creator":"/"===l[1]?H=u.slice(W,l.index):W=l.index+l[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===l[1]){if((r=d.pop())[0]!==l[3])throw"Bad state: "+r}else"/"!==l[0].charAt(l[0].length-2)&&d.push([l[3],!1]);y="",_=0,A=[];break;case"scientific-number":case"currency-symbol":case"fill-character":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"number":case"fraction":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":case"boolean":case"text-content":case"text-properties":case"embedded-text":case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"filter-set-item":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if("/"===l[1]){var q=rg.lastIndex;w_(u.slice(s,rg.lastIndex),0,C),rg.lastIndex=q}else"/"!==l[0].charAt(l[0].length-2)&&(s=rg.lastIndex-l[0].length);break;case"style":var Z=Ip(l[0],!1);"table-cell"==Z.family&&C[Z["data-style-name"]]&&(D[Z.name]=C[Z["data-style-name"]]);break;case"text":if("/>"===l[0].slice(-2))break;if("/"===l[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":u.slice(f,l.index)}else f=l.index+l[0].length;break;case"named-range":j=wy((a=Ip(l[0],!1))["cell-range-address"]);var J={Name:a.name,Ref:j[0]+"!"+j[1]};$&&(J.Sheet=g.length),N.Names.push(J);break;case"null-date":"1904-01-01"===(a=Ip(l[0],!1))["date-value"]&&(N.WBProps.date1904=!0);break;case"p":case"文本串":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==l[1]||v&&v["string-value"])"/>"==l[0].slice(-2)?y+="\n":(Ip(l[0],!1),_=l.index+l[0].length);else{var Q=(b=void 0,b=u.slice(_,l.index).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^<>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),[Bp(b.replace(/<[^<>]*>/g,""))]);y=(y.length>0?y+"\n":"")+Q[0]}break;case"database-range":if("/"===l[1])break;try{p[(j=wy(Ip(l[0])["target-range-address"]))[0]]["!autofilter"]={ref:j[1]}}catch(e){}break;case"a":if("/"!==l[1]){if(!(B=Ip(l[0],!1)).href)break;B.Target=Bp(B.href),delete B.href,"#"==B.Target.charAt(0)&&B.Target.indexOf(".")>-1?(j=wy(B.Target.slice(1)),B.Target="#"+j[0]+"!"+j[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;default:switch(l[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(h.WTF)throw new Error(l)}}var ee={Sheets:p,SheetNames:g,Workbook:N};return h.bookSheets&&delete ee.Sheets,ee}function A_(e,t){t=t||{},_p(e,"META-INF/manifest.xml")&&function(e,t){for(var i,r,a=ig(e);i=rg.exec(a);)switch(i[3]){case"manifest":break;case"file-entry":if("/"==(r=Ip(i[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==r.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw i}}(xp(e,"META-INF/manifest.xml"),t);var i=Ap(e,"styles.xml"),r=i&&w_(Gp(i)),a=Ap(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var s=x_(Gp(a),t,r);return _p(e,"meta.xml")&&(s.Props=Nm(xp(e,"meta.xml"))),s.bookType="ods",s}function T_(e,t){var i=x_(e,t);return i.bookType="fods",i}var k_=function(){try{return"undefined"==typeof Uint8Array||void 0===Uint8Array.prototype.subarray?"slice":"undefined"!=typeof Buffer?void 0===Buffer.prototype.subarray?"slice":("function"==typeof Buffer.from?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch(e){return"slice"}}();function S_(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function P_(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Gp(Ud(e))}function E_(e){for(var t=0,i=0;i<e.length;++i)t+=e[i].length;var r=new Uint8Array(t),a=0;for(i=0;i<e.length;++i){var s=e[i],n=s.length;if(n<250)for(var o=0;o<n;++o)r[a++]=s[o];else r.set(s,a),a+=n}return r}function C_(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function D_(e,t){var i=t.l,r=127&e[i];e:if(e[i++]>=128){if(r|=(127&e[i])<<7,e[i++]<128)break e;if(r|=(127&e[i])<<14,e[i++]<128)break e;if(r|=(127&e[i])<<21,e[i++]<128)break e;if(r+=(127&e[i])*Math.pow(2,28),++i,e[i++]<128)break e;if(r+=(127&e[i])*Math.pow(2,35),++i,e[i++]<128)break e;if(r+=(127&e[i])*Math.pow(2,42),++i,e[i++]<128)break e}return t.l=i,r}function O_(e){var t=0,i=127&e[t];return e[t++]<128?i:(i|=(127&e[t])<<7,e[t++]<128?i:(i|=(127&e[t])<<14,e[t++]<128?i:(i|=(127&e[t])<<21,e[t++]<128?i:i|=(15&e[t])<<28)))}function R_(e){for(var t=[],i={l:0};i.l<e.length;){var r,a=i.l,s=D_(e,i),n=7&s;s=s/8|0;var o=i.l;switch(n){case 0:for(;e[o++]>=128;);r=e[k_](i.l,o),i.l=o;break;case 1:r=e[k_](o,o+8),i.l=o+8;break;case 2:var l=D_(e,i);r=e[k_](i.l,i.l+l),i.l+=l;break;case 5:r=e[k_](o,o+4),i.l=o+4;break;default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(a))}var c={data:r,type:n};null==t[s]&&(t[s]=[]),t[s].push(c)}return t}function M_(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function I_(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var i={l:0},r=D_(t,i),a=[],s=i.l;s<t.length;){var n=3&t[s];if(0!=n){var o=0,l=0;if(1==n?(l=4+(t[s]>>2&7),o=(224&t[s++])<<3,o|=t[s++]):(l=1+(t[s++]>>2),2==n?(o=t[s]|t[s+1]<<8,s+=2):(o=(t[s]|t[s+1]<<8|t[s+2]<<16|t[s+3]<<24)>>>0,s+=4)),0==o)throw new Error("Invalid offset 0");for(var c=a.length-1,h=o;c>=0&&h>=a[c].length;)h-=a[c].length,--c;if(c<0){if(0!=h)throw new Error("Invalid offset beyond length");h=a[c=0].length}if(l<h)a.push(a[c][k_](a[c].length-h,a[c].length-h+l));else{for(h>0&&(a.push(a[c][k_](a[c].length-h)),l-=h),++c;l>=a[c].length;)a.push(a[c]),l-=a[c].length,++c;l&&a.push(a[c][k_](0,l))}a.length>25&&(a=[E_(a)])}else{var u=t[s++]>>2;if(u<60)++u;else{var d=u-59;u=t[s],d>1&&(u|=t[s+1]<<8),d>2&&(u|=t[s+2]<<16),d>3&&(u|=t[s+3]<<24),u>>>=0,u++,s+=d}a.push(t[k_](s,s+u)),s+=u}}for(var f=0,p=0;p<a.length;++p)f+=a[p].length;if(f!=r)throw new Error("Unexpected length: ".concat(f," != ").concat(r));return a}function L_(e,t,i,r,a){var s,n,o,l,c=255&t,h=t>>8,u=h>=5?a:r;e:if(i&(h>4?8:4)&&"n"==e.t&&7==c){var d=(null==(s=u[7])?void 0:s[0])?O_(u[7][0].data):-1;if(-1==d)break e;var f=(null==(n=u[15])?void 0:n[0])?O_(u[15][0].data):-1,p=(null==(o=u[16])?void 0:o[0])?O_(u[16][0].data):-1,g=(null==(l=u[40])?void 0:l[0])?O_(u[40][0].data):-1,m=e.v,b=m;t:if(g){if(0==m){f=p=2;break t}f=m>=604800?1:m>=86400?2:m>=3600?4:m>=60?8:m>=1?16:32,Math.floor(m)!=m?p=32:m%60?p=16:m%3600?p=8:m%86400?p=4:m%604800&&(p=2),p<f&&(p=f)}if(-1==f||-1==p)break e;var v=[],y=[];1==f&&(b=m/604800,1==p?y.push('d"d"'):m-=604800*(b|=0),v.push(b+(2==d?" week"+(1==b?"":"s"):1==d?"w":""))),f<=2&&p>=2&&(b=m/86400,p>2&&(m-=86400*(b|=0)),y.push('d"d"'),v.push(b+(2==d?" day"+(1==b?"":"s"):1==d?"d":""))),f<=4&&p>=4&&(b=m/3600,p>4&&(m-=3600*(b|=0)),y.push((f>=4?"[h]":"h")+'"h"'),v.push(b+(2==d?" hour"+(1==b?"":"s"):1==d?"h":""))),f<=8&&p>=8&&(b=m/60,p>8&&(m-=60*(b|=0)),y.push((f>=8?"[m]":"m")+'"m"'),0==d?v.push((8==f&&8==p||b>=10?"":"0")+b):v.push(b+(2==d?" minute"+(1==b?"":"s"):1==d?"m":""))),f<=16&&p>=16&&(b=m,p>16&&(m-=b|=0),y.push((f>=16?"[s]":"s")+'"s"'),0==d?v.push((16==p&&16==f||b>=10?"":"0")+b):v.push(b+(2==d?" second"+(1==b?"":"s"):1==d?"s":""))),p>=32&&(b=Math.round(1e3*m),f<32&&y.push('.000"ms"'),0==d?v.push((b>=100?"":b>=10?"0":"00")+b):v.push(b+(2==d?" millisecond"+(1==b?"":"s"):1==d?"ms":""))),e.w=v.join(0==d?":":" "),e.z=y.join(0==d?'":"':" "),0==d&&(e.w=e.w.replace(/:(\d\d\d)$/,".$1"))}}function F_(e,t,i){switch(e[0]){case 0:case 1:case 2:case 3:case 4:return function(e,t,i,r){var a,s=S_(e),n=s.getUint32(4,!0),o=-1,l=-1,c=-1,h=NaN,u=0,d=new Date(Date.UTC(2001,0,1)),f=i>1?12:8;2&n&&(c=s.getUint32(f,!0),f+=4),f+=4*C_(n&(i>1?3468:396)),512&n&&(o=s.getUint32(f,!0),f+=4),f+=4*C_(n&(i>1?12288:4096)),16&n&&(l=s.getUint32(f,!0),f+=4),32&n&&(h=s.getFloat64(f,!0),f+=8),64&n&&(d.setTime(d.getTime()+1e3*(u=s.getFloat64(f,!0))),f+=8),i>1&&255&(n=s.getUint32(8,!0)>>>16)&&(-1==c&&(c=s.getUint32(f,!0)),f+=4);var p=e[i>=4?1:2];switch(p){case 0:return;case 2:case 7:a={t:"n",v:h};break;case 3:a={t:"s",v:t.sst[l]};break;case 5:a=(null==r?void 0:r.cellDates)?{t:"d",v:d}:{t:"n",v:u/86400+35430,z:tf[14]};break;case 6:a={t:"b",v:h>0};break;case 8:a={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[k_](0,4)));var g=t.rsst[o];a={t:"s",v:g.v},g.l&&(a.l={Target:g.l});break;default:throw new Error("Unsupported cell type ".concat(e[k_](0,4)))}return c>-1&&L_(a,p|i<<8,n,t.ofmt[c],t.nfmt[c]),7==p&&(a.v/=86400),a}(e,t,e[0],i);case 5:return function(e,t,i){var r,a=S_(e),s=(a.getUint32(4,!0),a.getUint32(8,!0)),n=12,o=-1,l=-1,c=-1,h=NaN,u=NaN,d=0,f=new Date(Date.UTC(2001,0,1));1&s&&(h=function(e,t){for(var i=(127&e[t+15])<<7|e[t+14]>>1,r=1&e[t+14],a=t+13;a>=t;--a)r=256*r+e[a];return(128&e[t+15]?-r:r)*Math.pow(10,i-6176)}(e,n),n+=16),2&s&&(u=a.getFloat64(n,!0),n+=8),4&s&&(f.setTime(f.getTime()+1e3*(d=a.getFloat64(n,!0))),n+=8),8&s&&(l=a.getUint32(n,!0),n+=4),16&s&&(o=a.getUint32(n,!0),n+=4),n+=4*C_(480&s),512&s&&(a.getUint32(n,!0),n+=4),n+=4*C_(1024&s),2048&s&&(a.getUint32(n,!0),n+=4);var p=e[1];switch(p){case 0:r={t:"z"};break;case 2:case 10:r={t:"n",v:h};break;case 3:r={t:"s",v:t.sst[l]};break;case 5:r=(null==i?void 0:i.cellDates)?{t:"d",v:f}:{t:"n",v:d/86400+35430,z:tf[14]};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u};break;case 8:r={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e[k_](0,4)));var g=t.rsst[o];r={t:"s",v:g.v},g.l&&(r.l={Target:g.l});break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e[k_](0,4)))}if(n+=4*C_(4096&s),516096&s&&(-1==c&&(c=a.getUint32(n,!0)),n+=4),524288&s){var m=a.getUint32(n,!0);n+=4,t.cmnt[m]&&(r.c=function(e){var t=[];return t.push({t:e.t||"",a:e.a,T:e.replies&&e.replies.length>0}),e.replies&&e.replies.forEach((function(e){t.push({t:e.t||"",a:e.a,T:!0})})),t}(t.cmnt[m]))}return c>-1&&L_(r,1280|p,s>>13,t.ofmt[c],t.nfmt[c]),7==p&&(r.v/=86400),r}(e,t,i);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function N_(e){return O_(R_(e)[1][0].data)}function B_(e,t){var i=R_(t.data),r=O_(i[1][0].data),a=i[3],s=[];return(a||[]).forEach((function(t){var i,a,n=R_(t.data);if(n[1]){var o=O_(n[1][0].data)>>>0;switch(r){case 1:s[o]=P_(n[3][0].data);break;case 8:var l=R_(e[N_(n[9][0].data)][0].data),c=e[N_(l[1][0].data)][0],h=O_(c.meta[1][0].data);if(2001!=h)throw new Error("2000 unexpected reference to ".concat(h));var u=R_(c.data),d={v:u[3].map((function(e){return P_(e.data)})).join("")};s[o]=d;e:if(null==(i=null==u?void 0:u[11])?void 0:i[0]){var f=null==(a=R_(u[11][0].data))?void 0:a[1];if(!f)break e;f.forEach((function(t){var i,r,a,s=R_(t.data);if(null==(i=s[2])?void 0:i[0]){var n=e[N_(null==(r=s[2])?void 0:r[0].data)][0],o=O_(n.meta[1][0].data);switch(o){case 2032:var l=R_(n.data);(null==(a=null==l?void 0:l[2])?void 0:a[0])&&!d.l&&(d.l=P_(l[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(o))}}}))}break;case 2:s[o]=R_(n[6][0].data);break;case 3:s[o]=R_(n[5][0].data);break;case 10:var p=e[N_(n[10][0].data)][0];s[o]=j_(e,p.data);break;default:throw r}}})),s}function j_(e,t){var i,r,a,s,n,o,l,c,h,u,d={t:"",a:""},f=R_(t);if((null==(r=null==(i=null==f?void 0:f[1])?void 0:i[0])?void 0:r.data)&&(d.t=P_(null==(s=null==(a=null==f?void 0:f[1])?void 0:a[0])?void 0:s.data)||""),null==(o=null==(n=null==f?void 0:f[3])?void 0:n[0])?void 0:o.data){var p=R_(e[N_(null==(c=null==(l=null==f?void 0:f[3])?void 0:l[0])?void 0:c.data)][0].data);(null==(u=null==(h=p[1])?void 0:h[0])?void 0:u.data)&&(d.a=P_(p[1][0].data))}return(null==f?void 0:f[4])&&(d.replies=[],f[4].forEach((function(t){var i=e[N_(t.data)][0];d.replies.push(j_(e,i.data))}))),d}function z_(e,t,i){var r=R_(t.data),a={"!ref":"A1"};(null==i?void 0:i.dense)&&(a["!data"]=[]);var s=e[N_(r[2][0].data)],n=O_(s[0].meta[1][0].data);if(6001!=n)throw new Error("6000 unexpected reference to ".concat(n));return function(e,t,i,r){var a,s,n,o,l,c,h,u,d,f,p=R_(t.data),g={s:{r:0,c:0},e:{r:0,c:0}};if(g.e.r=(O_(p[6][0].data)>>>0)-1,g.e.r<0)throw new Error("Invalid row varint ".concat(p[6][0].data));if(g.e.c=(O_(p[7][0].data)>>>0)-1,g.e.c<0)throw new Error("Invalid col varint ".concat(p[7][0].data));i["!ref"]=em(g);var m=null!=i["!data"],b=i,v=R_(p[4][0].data),y={sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]};(null==(a=v[4])?void 0:a[0])&&(y.sst=B_(e,e[N_(v[4][0].data)][0])),(null==(s=v[6])?void 0:s[0])&&(y.fmla=B_(e,e[N_(v[6][0].data)][0])),(null==(n=v[11])?void 0:n[0])&&(y.ofmt=B_(e,e[N_(v[11][0].data)][0])),(null==(o=v[12])?void 0:o[0])&&(y.ferr=B_(e,e[N_(v[12][0].data)][0])),(null==(l=v[17])?void 0:l[0])&&(y.rsst=B_(e,e[N_(v[17][0].data)][0])),(null==(c=v[19])?void 0:c[0])&&(y.cmnt=B_(e,e[N_(v[19][0].data)][0])),(null==(h=v[22])?void 0:h[0])&&(y.nfmt=B_(e,e[N_(v[22][0].data)][0]));var _=R_(v[3][0].data),w=0;if(!(null==(u=v[9])?void 0:u[0]))throw"NUMBERS file missing row tree";if(R_(v[9][0].data)[1].map((function(e){return R_(e.data)})).forEach((function(t){w=O_(t[1][0].data);var a=O_(t[2][0].data),s=_[1][a];if(!s)throw"NUMBERS missing tile "+a;var n=R_(s.data),o=e[N_(n[2][0].data)][0],l=O_(o.meta[1][0].data);if(6002!=l)throw new Error("6001 unexpected reference to ".concat(l));var c=function(e,t){var i,r=R_(t.data),a=-1;(null==(i=null==r?void 0:r[7])?void 0:i[0])&&(a=O_(r[7][0].data)>>>0?1:0);var s=M_(r[5],(function(e){return function(e,t){var i,r,a,s,n,o,l,c,h,u,d,f,p,g,m,b,v=R_(e),y=O_(v[1][0].data)>>>0,_=O_(v[2][0].data)>>>0,w=(null==(r=null==(i=v[8])?void 0:i[0])?void 0:r.data)&&O_(v[8][0].data)>0||!1;if((null==(s=null==(a=v[7])?void 0:a[0])?void 0:s.data)&&0!=t)m=null==(o=null==(n=v[7])?void 0:n[0])?void 0:o.data,b=null==(c=null==(l=v[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(u=null==(h=v[4])?void 0:h[0])?void 0:u.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");m=null==(f=null==(d=v[4])?void 0:d[0])?void 0:f.data,b=null==(g=null==(p=v[3])?void 0:p[0])?void 0:g.data}for(var x=w?4:1,A=S_(m),T=[],k=0;k<m.length/2;++k){var S=A.getUint16(2*k,!0);S<65535&&T.push([k,S])}if(T.length!=_)throw"Expected ".concat(_," cells, found ").concat(T.length);var P=[];for(k=0;k<T.length-1;++k)P[T[k][0]]=b[k_](T[k][1]*x,T[k+1][1]*x);return T.length>=1&&(P[T[T.length-1][0]]=b[k_](T[T.length-1][1]*x)),{R:y,cells:P}}(e,a)}));return{nrows:O_(r[4][0].data)>>>0,data:s.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(i,r){if(e[t.R][r])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(r));e[t.R][r]=i})),e}),[])}}(0,o);c.data.forEach((function(e,t){e.forEach((function(e,a){var s=F_(e,y,r);s&&(m?(b["!data"][w+t]||(b["!data"][w+t]=[]),b["!data"][w+t][a]=s):i[qg(a)+Gg(w+t)]=s)}))})),w+=c.nrows})),null==(d=v[13])?void 0:d[0]){var x=e[N_(v[13][0].data)][0],A=O_(x.meta[1][0].data);if(6144!=A)throw new Error("Expected merge type 6144, found ".concat(A));i["!merges"]=null==(f=R_(x.data))?void 0:f[1].map((function(e){var t=R_(e.data),i=S_(R_(t[1][0].data)[1][0].data),r=S_(R_(t[2][0].data)[1][0].data);return{s:{r:i.getUint16(0,!0),c:i.getUint16(2,!0)},e:{r:i.getUint16(0,!0)+r.getUint16(0,!0)-1,c:i.getUint16(2,!0)+r.getUint16(2,!0)-1}}}))}}(e,s[0],a,i),a}function U_(e,t){var i,r,a,s,n,o,l,c={},h=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)&&0==e.content[0]){var t,i;try{t=function(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],i=0;i<e.length;){var r=e[i++],a=e[i]|e[i+1]<<8|e[i+2]<<16;i+=3,t.push.apply(t,I_(r,e[k_](i,i+a))),i+=a}if(i!==e.length)throw new Error("data is not a valid framed stream!");return 1==t.length?t[0]:E_(t)}(e.content)}catch(t){return console.log("?? "+e.content.length+" "+(t.message||t))}try{i=function(e){for(var t,i=[],r={l:0};r.l<e.length;){var a=D_(e,r),s=R_(e[k_](r.l,r.l+a));r.l+=a;var n={id:O_(s[1][0].data),messages:[]};s[2].forEach((function(t){var i=R_(t.data),a=O_(i[3][0].data);n.messages.push({meta:i,data:e[k_](r.l,r.l+a)}),r.l+=a})),(null==(t=s[3])?void 0:t[0])&&(n.merge=O_(s[3][0].data)>>>0>0),i.push(n)}return i}(t)}catch(e){return console.log("## "+(e.message||e))}i.forEach((function(e){c[e.id]=e.messages,h.push(e.id)}))}})),!h.length)throw new Error("File has no messages");if((null==(a=null==(r=null==(i=null==c?void 0:c[1])?void 0:i[0].meta)?void 0:r[1])?void 0:a[0].data)&&1e4==O_(c[1][0].meta[1][0].data))throw new Error("Pages documents are not supported");var u=(null==(l=null==(o=null==(n=null==(s=null==c?void 0:c[1])?void 0:s[0])?void 0:n.meta)?void 0:o[1])?void 0:l[0].data)&&1==O_(c[1][0].meta[1][0].data)&&c[1][0];if(u||h.forEach((function(e){c[e].forEach((function(e){if(1==O_(e.meta[1][0].data)>>>0){if(u)throw new Error("Document has multiple roots");u=e}}))})),!u)throw new Error("Cannot find Document root");return function(e,t,i){var r,a=aw();a.Workbook={WBProps:{date1904:!0}};var s=R_(t.data);if(null==(r=s[2])?void 0:r[0])throw new Error("Keynote presentations are not supported");if(M_(s[1],N_).forEach((function(t){e[t].forEach((function(t){if(2==O_(t.meta[1][0].data)){var r=function(e,t,i){var r,a=R_(t.data),s={name:(null==(r=a[1])?void 0:r[0])?P_(a[1][0].data):"",sheets:[]};return M_(a[2],N_).forEach((function(t){e[t].forEach((function(t){6e3==O_(t.meta[1][0].data)&&s.sheets.push(z_(e,t,i))}))})),s}(e,t,i);r.sheets.forEach((function(e,t){sw(a,e,0==t?r.name:r.name+"_"+t,!0)}))}}))})),0==a.SheetNames.length)throw new Error("Empty NUMBERS file");return a.bookType="numbers",a}(c,u,t)}function H_(e){var t;(t=[["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]],function(e){for(var i=0;i!=t.length;++i){var r=t[i];void 0===e[r[0]]&&(e[r[0]]=r[1]),"n"===r[2]&&(e[r[0]]=Number(e[r[0]]))}})(e)}function W_(e,t,i,r,a,s,n,o,l,c,h,u){try{s[r]=Lm(Ap(e,i,!0),t);var d,f=xp(e,t);switch(o){case"sheet":d=qy(f,t,a,l,s[r],c,h,u);break;case"chart":if(!(d=function(e,t,i,r,a,s){return".bin"===t.slice(-4)?function(e,t,i,r,a){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},n=[],o=!1;return Ug(e,(function(e,r,l){switch(l){case 550:s["!rel"]=e;break;case 651:a.Sheets[i]||(a.Sheets[i]={}),e.name&&(a.Sheets[i].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:n.push(l);break;case 38:n.pop();break;default:if(r.T>0)n.push(l);else if(r.T<0)n.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}(e,r,i,a,s):function(e,t,i,r,a){if(!e)return e;r||(r={"!id":{}});var s,n={"!type":"chart","!drawel":null,"!rel":""},o=e.match(Ry);return o&&My(o[0],0,a,i),(s=e.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=s[1]),r["!id"][n["!rel"]]&&(n["!drawel"]=r["!id"][n["!rel"]]),n}(e,0,i,a,s)}(f,t,a,l,s[r],c))||!d["!drawel"])break;var p=Pp(d["!drawel"].Target,t),g=Im(p),m=function(e,t){if(!e)return"??";var i=(e.match(/<c:chart [^<>]*r:id="([^<>"]*)"/)||["",""])[1];return t["!id"][i].Target}(Ap(e,p,!0),Lm(Ap(e,g,!0),p)),b=Pp(m,p),v=Im(b);d=function(e,t,i,r,a,s){var n=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(hp(e,"<c:numCache>","</c:numCache>")||[]).forEach((function(e){var t=function(e){var t,i=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<])<\/c:v><\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<]*)<\/c:v><\/c:pt>/);t&&(i[+t[1]]=r?+t[2]:t[2])}));var a=Bp((fp(e,"c:formatCode")||["","General"])[1]);return(hp(e,"<c:f>","</c:f>")||[]).forEach((function(e){t=e.replace(/<[^<>]*>/g,"")})),[i,a,t]}(e);h.s.r=h.s.c=0,h.e.c=o,c=qg(o),t[0].forEach((function(e,i){n["!data"]?(n["!data"][i]||(n["!data"][i]=[]),n["!data"][i][o]={t:"n",v:e,z:t[1]}):n[c+Gg(i)]={t:"n",v:e,z:t[1]},l=i})),h.e.r<l&&(h.e.r=l),++o})),o>0&&(n["!ref"]=em(h)),n}(Ap(e,b,!0),0,0,Lm(Ap(e,v,!0),b),0,d);break;case"macro":w=t,s[r],w.slice(-4),d={"!type":"macro"};break;case"dialog":d=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,s[r]);break;default:throw new Error("Unrecognized sheet type "+o)}n[r]=d;var y=[],_=[];s&&s[r]&&Bf(s[r]).forEach((function(i){var a="";if(s[r][i].Type==Mm.CMNT){if(a=Pp(s[r][i].Target,t),!(y=function(e,t,i){return".bin"===t.slice(-4)?function(e,t){var i=[],r=[],a={},s=!1;return Ug(e,(function(e,n,o){switch(o){case 632:r.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,i.push(a);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(n.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),i}(e,i):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var i=[],r=[],a=pp(e,"authors");a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^<>]*>(.*)/);t&&i.push(t[1])}}));var s=pp(e,"commentList");return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^<>]*>/);if(a){var s=Ip(a[0]),n={author:s.authorId&&i[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},o=Zg(s.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=pp(e,"text"),c=!!l&&!!l[1]&&Kb(l[1])||{r:"",t:"",h:""};n.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),n.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(n.h=c.h),r.push(n)}}}})),r}(e,i)}(xp(e,a,!0),a,l))||!y.length)return;Cv(d,y,!1)}s[r][i].Type==Mm.TCMNT&&(a=Pp(s[r][i].Target,t),_=_.concat(function(e,t){var i=[],r=!1,a={},s=0;return e.replace(Op,(function(n,o){var l=Ip(n);switch(Lp(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=a.t&&i.push(a);break;case"<text>":case"<text":s=o+n.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return n})),i}(xp(e,a,!0),l)))})),_&&_.length&&Cv(d,_,!0,l.people||[]),function(e,t,i,r,a,s,n,o){if(e&&e["!legdrawel"]){var l=Ap(i,Pp(e["!legdrawel"].Target,r),!0);l&&function(e,t,i){var r=0;(gp(e,"shape")||[]).forEach((function(e){var a="",s=!0,n=-1,o=-1,l=-1;if(e.replace(Op,(function(t,i){var r=Ip(t);switch(Lp(r[0])){case"<ClientData":r.ObjectType&&(a=r.ObjectType);break;case"<Visible":case"<Visible/>":s=!1;break;case"<Row":case"<Row>":case"<Column":case"<Column>":n=i+t.length;break;case"</Row>":o=+e.slice(n,i).trim();break;case"</Column>":l=+e.slice(n,i).trim()}return""})),"Note"===a){var c=rw(t,o>=0&&l>=0?Jg({r:o,c:l}):i[r].ref);c.c&&(c.c.hidden=s),++r}}))}(Gp(l),e,o||[])}}(d,0,e,t,0,0,0,y)}catch(e){if(l.WTF)throw e}var w}function V_(e){return"/"==e.charAt(0)?e.slice(1):e}function $_(e,t){if(Df(),H_(t=t||{}),_p(e,"META-INF/manifest.xml"))return A_(e,t);if(_p(e,"objectdata.xml"))return A_(e,t);if(_p(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==U_){if(e.FileIndex)return U_(e,t);var i=Nf.utils.cfb_new();return kp(e).forEach((function(t){!function(e,t,i){if(e.FullPaths){var r;if("string"==typeof i)return r=Ld?Fd(i):function(e){for(var t=[],i=0,r=e.length+250,a=Bd(e.length+255),s=0;s<e.length;++s){var n=e.charCodeAt(s);if(n<128)a[i++]=n;else if(n<2048)a[i++]=192|n>>6&31,a[i++]=128|63&n;else if(n>=55296&&n<57344){n=64+(1023&n);var o=1023&e.charCodeAt(++s);a[i++]=240|n>>8&7,a[i++]=128|n>>2&63,a[i++]=128|o>>6&15|(3&n)<<4,a[i++]=128|63&o}else a[i++]=224|n>>12&15,a[i++]=128|n>>6&63,a[i++]=128|63&n;i>r&&(t.push(a.slice(0,i)),i=0,a=Bd(65535),r=65530)}return t.push(a.slice(0,i)),Wd(t)}(i),Nf.utils.cfb_add(e,t,r);Nf.utils.cfb_add(e,t,i)}else e.file(t,i)}(i,t,Tp(e,t))})),U_(i,t)}throw new Error("Unsupported NUMBERS file")}if(!_p(e,"[Content_Types].xml")){if(_p(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(_p(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var r=Nf.find(e,"Index.zip");if(r)return delete(t=Zf(t)).type,"string"==typeof r.content&&(t.type="binary"),"undefined"!=typeof Bun&&Buffer.isBuffer(r.content)?q_(new Uint8Array(r.content),t):q_(r.content,t);throw new Error("Unsupported ZIP file")}var a,s,n=kp(e),o=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var i={};if((e.match(Op)||[]).forEach((function(e){var r=Ip(e);switch(r[0].replace(Rp,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":i[r.Extension.toLowerCase()]=r.ContentType;break;case"<Override":void 0!==t[Rm[r.ContentType]]&&t[Rm[r.ContentType]].push(r.PartName)}})),"http://schemas.openxmlformats.org/package/2006/content-types"!==t.xmlns)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=i,delete t.calcchains,t}(Ap(e,"[Content_Types].xml")),l=!1;if(0===o.workbooks.length&&xp(e,s="xl/workbook.xml",!0)&&o.workbooks.push(s),0===o.workbooks.length){if(!xp(e,s="xl/workbook.bin",!0))throw new Error("Could not find workbook");o.workbooks.push(s),l=!0}"bin"==o.workbooks[0].slice(-3)&&(l=!0);var c={},h={};if(!t.bookSheets&&!t.bookProps){if(xy=[],o.sst)try{xy=function(e,t,i){return".bin"===t.slice(-4)?function(e,t){var i=[],r=!1;return Ug(e,(function(e,a,s){switch(s){case 159:i.Count=e[0],i.Unique=e[1];break;case 19:i.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(a.T,!r||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),i}(e,i):function(e,t){var i=[],r="";if(!e)return i;var a=pp(e,"sst");if(a){r=a[1].replace(qb,"").split(Zb);for(var s=0;s!=r.length;++s){var n=Kb(r[s].trim(),t);null!=n&&(i[i.length]=n)}a=Ip(a[0].slice(0,a[0].indexOf(">"))),i.Count=a.count,i.Unique=a.uniqueCount}return i}(e,i)}(xp(e,V_(o.sst)),o.sst,t)}catch(e){if(t.WTF)throw e}t.cellStyles&&o.themes.length&&(c=Pv(Ap(e,o.themes[0].replace(/^\//,""),!0)||"",t)),o.style&&(h=function(e,t,i,r){return".bin"===t.slice(-4)?function(e,t,i){var r={NumberFmt:[]};for(var a in tf)r.NumberFmt[a]=tf[a];r.CellXf=[],r.Fonts=[];var s=[],n=!1;return Ug(e,(function(e,a,o){switch(o){case 44:r.NumberFmt[e[0]]=e[1],If(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=cv(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&r.CellXf.push(e);break;case 35:n=!0;break;case 36:n=!1;break;case 37:s.push(o),n=!0;break;case 38:s.pop(),n=!1;break;default:if(a.T>0)s.push(o);else if(a.T<0)s.pop();else if(!n||i.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}})),r}(e,i,r):Av(e,i,r)}(xp(e,V_(o.style)),o.style,c,t))}o.links.map((function(i){try{return Lm(Ap(e,Im(V_(i))),i),function(e,t,i,r){if(".bin"===i.slice(-4))return function(e,t,i,r){if(!e)return e;var a=r||{},s=!1;Ug(e,(function(e,t,i){switch(i){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||a.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}),a)}(e,0,0,r)}(xp(e,V_(i)),0,i,t)}catch(e){}}));var u=function(e,t,i){return".bin"===t.slice(-4)?function(e,t){var i={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var s=[],n=[[]];return n.SheetNames=[],n.XTI=[],f_[16]={n:"BrtFRTArchID$",f:Ky},Ug(e,(function(e,o,l){switch(l){case 156:n.SheetNames.push(e.name),i.Sheets.push(e);break;case 153:i.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=e.Ptg?ly(e.Ptg,0,null,n,t):"#REF!",delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:n[0].length?n.push([l,e]):n[0]=[l,e],n[n.length-1].XTI=[];break;case 362:0===n.length&&(n[0]=[],n[0].XTI=[]),n[n.length-1].XTI=n[n.length-1].XTI.concat(e),n.XTI=n.XTI.concat(e);break;case 35:case 37:r.push(l),a=!0;break;case 36:case 38:r.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),t),Xy(i),i.Names=s,i.supbooks=n,i}(e,i):function(e,t){if(!e)throw new Error("Could not find file");var i={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",s={},n=0;if(e.replace(Op,(function(o,l){var c=Ip(o);switch(Lp(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(Gy)&&(a="xmlns"+o.match(/<(\w+):/)[1]),i.xmlns=c[a];break;case"<fileVersion":delete c[0],i.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":zy.forEach((function(e){if(null!=c[e[0]])switch(e[2]){case"bool":i.WBProps[e[0]]=Wp(c[e[0]]);break;case"int":i.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:i.WBProps[e[0]]=c[e[0]]}})),c.codeName&&(i.WBProps.CodeName=Gp(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],i.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Bp(Gp(c.name)),delete c[0],i.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(s={}).Name=Gp(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),Wp(c.hidden||"0")&&(s.Hidden=!0),n=l+o.length;break;case"</definedName>":s.Ref=Bp(Gp(e.slice(n,l))),i.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],i.CalcPr=c;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o})),-1===ag.indexOf(i.xmlns))throw new Error("Unknown Namespace: "+i.xmlns);return Xy(i),i}(e,i)}(xp(e,V_(o.workbooks[0])),o.workbooks[0],t),d={},f="";o.coreprops.length&&((f=xp(e,V_(o.coreprops[0]),!0))&&(d=Nm(f)),0!==o.extprops.length&&(f=xp(e,V_(o.extprops[0]),!0))&&function(e,t,i){var r={};t||(t={}),e=Gp(e),Bm.forEach((function(i){var a=(pp(e,i[0])||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=Bp(a));break;case"bool":t[i[1]]="true"===a;break;case"raw":var s=fp(e,i[0]);s&&s.length>0&&(r[i[1]]=s[1])}})),r.HeadingPairs&&r.TitlesOfParts&&jm(r.HeadingPairs,r.TitlesOfParts,t,i)}(f,d,t));var p={};t.bookSheets&&!t.bookProps||0!==o.custprops.length&&(f=Ap(e,V_(o.custprops[0]),!0))&&(p=function(e,t){var i={},r="",a=e.match(Um);if(a)for(var s=0;s!=a.length;++s){var n=a[s],o=Ip(n);switch(Lp(o[0])){case"<?xml":case"<Properties":break;case"<property":r=Bp(o.name);break;case"</property>":r=null;break;default:if(0===n.indexOf("<vt:")){var l=n.split(">"),c=l[0].slice(4),h=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":i[r]=Bp(h);break;case"bool":i[r]=Wp(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":i[r]=parseInt(h,10);break;case"r4":case"r8":case"decimal":i[r]=parseFloat(h);break;case"filetime":case"date":i[r]=Kf(h);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",n,c,l)}}else if("</"===n.slice(0,2));else if(t.WTF)throw new Error(n)}}return i}(f,t));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?a=u.Sheets.map((function(e){return e.name})):d.Worksheets&&d.SheetNames.length>0&&(a=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=p),t.bookSheets&&void 0!==a&&(g.SheetNames=a),t.bookSheets?g.SheetNames:t.bookProps))return g;a={};var m,b={};t.bookDeps&&o.calcchain&&(m=xp(e,V_(o.calcchain)),b=".bin"===o.calcchain.slice(-4)?function(e){var t=[];return Ug(e,(function(e,i,r){if(63===r)t.push(e);else if(!i.T)throw new Error("Unexpected record 0x"+r.toString(16))})),t}(m):function(e){var t=[];if(!e)return t;var i=1;return(e.match(Op)||[]).forEach((function(e){var r=Ip(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?i=r.i:r.i=i,t.push(r)}})),t}(m));var v,y,_=0,w={},x=u.Sheets;d.Worksheets=x.length,d.SheetNames=[];for(var A=0;A!=x.length;++A)d.SheetNames[A]=x[A].name;var T=l?"bin":"xml",k=o.workbooks[0].lastIndexOf("/"),S=(o.workbooks[0].slice(0,k+1)+"_rels/"+o.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");_p(e,S)||(S="xl/_rels/workbook."+T+".rels");var P=Lm(Ap(e,S,!0),S.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(t.xlmeta=function(e,t,i){return".bin"===t.slice(-4)?function(e,t,i){var r={Types:[],Cell:[],Value:[]},a=i||{},s=[],n=!1,o=2;return Ug(e,(function(e,t,i){switch(i){case 335:r.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==o?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==o&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})}));break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:s.push(i),n=!0;break;case 36:s.pop(),n=!1;break;default:if(t.T);else if(!n||a.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+i.toString(16))}})),r}(e,0,i):function(e,t,i){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a,s=!1,n=2;return e.replace(Op,(function(e){var t=Ip(e);switch(Lp(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<r.Types.length;++o)r.Types[o].name==t.name&&(a=r.Types[o]);break;case"<rc":1==n?r.Cell.push({type:r.Types[t.t-1].name,index:+t.v}):0==n&&r.Value.push({type:r.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":n=1;break;case"</cellMetadata>":case"</valueMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!s&&(null==i?void 0:i.WTF))throw new Error("unrecognized "+t[0]+" in metadata")}return e})),r}(e,0,i)}(xp(e,V_(o.metadata[0])),o.metadata[0],t)),(o.people||[]).length>=1&&(t.people=function(e,t){var i=[],r=!1;return e.replace(Op,(function(e){var a=Ip(e);switch(Lp(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":i.push({name:a.displayname,id:a.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e})),i}(xp(e,V_(o.people[0])),t)),P&&(P=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(i=e["!id"][t.id].Type,Mm.WS.indexOf(i)>-1?"sheet":Mm.CS&&i==Mm.CS?"chart":Mm.DS&&i==Mm.DS?"dialog":Mm.MS&&i==Mm.MS?"macro":i&&i.length?i:"sheet")];var i}))}catch(e){return null}return e&&0!==e.length?e:null}(P,u.Sheets));var E=xp(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=d.Worksheets;++_){var C="sheet";if(P&&P[_]?(v="xl/"+P[_][1].replace(/[\/]?xl\//,""),_p(e,v)||(v=P[_][1]),_p(e,v)||(v=S.replace(/_rels\/[\S\s]*$/,"")+P[_][1]),C=P[_][2]):v=(v="xl/worksheets/sheet"+(_+1-E)+"."+T).replace(/sheet0\./,"sheet."),y=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(d.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,O=0;O!=t.sheets.length;++O)"number"==typeof t.sheets[O]&&t.sheets[O]==_&&(D=1),"string"==typeof t.sheets[O]&&t.sheets[O].toLowerCase()==d.SheetNames[_].toLowerCase()&&(D=1);if(!D)continue e}}W_(e,v,y,d.SheetNames[_],_,w,a,C,t,u,c,h)}return g={Directory:o,Workbook:u,Props:d,Custprops:p,Deps:b,Sheets:a,SheetNames:d.SheetNames,Strings:xy,Styles:h,Themes:c,SSF:Zf(tf)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach((function(t,i){t=t.replace(/^Root Entry[\/]/,""),g.keys.push(t),g.files[t]=e.FileIndex[i]})))),t&&t.bookVBA&&(o.vba.length>0?g.vbaraw=xp(e,V_(o.vba[0]),!0):o.defaults&&"application/vnd.ms-office.vbaProject"===o.defaults.bin&&(g.vbaraw=xp(e,"xl/vbaProject.bin",!0))),g.bookType=l?"xlsb":"xlsx",g}function X_(e,t){var i,r,a=t||{},s="Workbook",n=Nf.find(e,s);try{if(s="/!DataSpaces/Version",!(n=Nf.find(e,s))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(i=n.content,(r={}).id=i.read_shift(0,"lpp4"),r.R=Qb(i,4),r.U=Qb(i,4),r.W=Qb(i,4),s="/!DataSpaces/DataSpaceMap",!(n=Nf.find(e,s))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=function(e){var t=[];e.l+=4;for(var i=e.read_shift(4);i-- >0;)t.push(ev(e));return t}(n.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(n=Nf.find(e,s))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=function(e){var t=[];e.l+=4;for(var i=e.read_shift(4);i-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(n.content);if(1!=l.length||"StrongEncryptionTransform"!=l[0])throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(n=Nf.find(e,s))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);!function(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Qb(e,4),t.U=Qb(e,4),t.W=Qb(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record")}(n.content)}catch(e){}if(s="/EncryptionInfo",!(n=Nf.find(e,s))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var c=function(e){var t=Qb(e);switch(t.Minor){case 2:return[t.Minor,rv(e)];case 3:return[t.Minor,av()];case 4:return[t.Minor,sv(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(n.content);if(s="/EncryptedPackage",!(n=Nf.find(e,s))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(4==c[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(c[1],n.content,a.password||"",a);if(2==c[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(c[1],n.content,a.password||"",a);throw new Error("File is password-protected")}function Y_(e,t){var i="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":i=Id(e.slice(0,12));break;case"binary":i=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3),i.charCodeAt(4),i.charCodeAt(5),i.charCodeAt(6),i.charCodeAt(7)]}function G_(e,t){var i=0;e:for(;i<e.length;)switch(e.charCodeAt(i)){case 10:case 13:case 32:++i;break;case 60:return o_(e.slice(i),t);default:break e}return Wb.to_workbook(e,t)}function K_(e,t,i,r){return r?(i.type="string",Wb.to_workbook(e,i)):Wb.to_workbook(t,i)}function q_(e,t){kd();var i=t||{};if(i.codepage&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return q_(new Uint8Array(e),((i=Zf(i)).type="array",i));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!i.type&&(i.type="undefined"!=typeof Deno?"buffer":"array");var r,a=e,s=!1;if(i.cellStyles&&(i.cellNF=!0,i.sheetStubs=!0),Ay={},i.dateNF&&(Ay.dateNF=i.dateNF),i.type||(i.type=Ld&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==i.type&&(i.type=Ld?"buffer":"binary",a=function(e){if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var i=t.read();return t.close(),i}catch(e){if(!e.message||-1==e.message.indexOf("onstruct"))throw e}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||Ld||(i.type="array")),"string"==i.type&&(s=!0,i.type="binary",i.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?Kp(e):e}(e)),"array"==i.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var n=new ArrayBuffer(3),o=new Uint8Array(n);if(o.foo="bar",!o.foo)return(i=Zf(i)).type="array",q_(Hd(a),i)}switch((r=Y_(a,i))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return Nf.find(e,"EncryptedPackage")?X_(e,t):d_(e,t)}(Nf.read(a,i),i);break;case 9:if(r[1]<=8)return d_(a,i);break;case 60:return o_(a,i);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,t){var i=t||{},r=!!i.WTF;i.WTF=!0;try{var a=zb.to_workbook(e,i);return i.WTF=r,a}catch(a){if(i.WTF=r,-1==a.message.indexOf("SYLK bad record ID")&&r)throw a;return Wb.to_workbook(e,t)}}(a,i);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return Ub.to_workbook(a,i);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var i=e,r=t||{};return r.type||(r.type=Ld&&Buffer.isBuffer(e)?"buffer":"base64"),$_(Sp(i,r),r)}(a,i):K_(e,a,i,s);case 239:return 60===r[3]?o_(a,i):K_(e,a,i,s);case 255:if(254===r[1])return function(e,t){var i=e;return"base64"==t.type&&(i=Id(i)),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&(i=new Uint8Array(e)),i=Ld&&Buffer.isBuffer(e)?e.slice(2).toString("utf16le"):"undefined"!=typeof Uint8Array&&i instanceof Uint8Array?"undefined"!=typeof TextDecoder?new TextDecoder("utf-16le").decode(i.slice(2)):function(e){for(var t=[],i=0;i<e.length>>1;++i)t[i]=String.fromCharCode(e[2*i]+(e[2*i+1]<<8));return t.join("")}(i.slice(2)):Pd(i.slice(2)),t.type="binary",G_(i,t)}(a,i);if(0===r[1]&&2===r[2]&&0===r[3])return Vb.to_workbook(a,i);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return Vb.to_workbook(a,i);if(0===r[2]&&(8===r[3]||9===r[3]))return Vb.to_workbook(a,i)}break;case 3:case 131:case 139:case 140:return jb.to_workbook(a,i);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return function(e,t){var i=rm(function(e,t){switch(t.type){case"base64":return ov(Id(e),t);case"binary":return ov(e,t);case"buffer":return ov(Ld&&Buffer.isBuffer(e)?e.toString("binary"):Ud(e),t);case"array":return ov(qf(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),t);return i.bookType="rtf",i}(a,i);break;case 10:case 13:case 32:return function(e,t){var i="",r=Y_(e,t);switch(t.type){case"base64":i=Id(e);break;case"binary":i=e;break;case"buffer":i=e.toString("binary");break;case"array":i=qf(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(i=Gp(i)),t.type="binary",G_(i,t)}(a,i);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(231===r[1])throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(236===r[1])throw new Error("Unsupported Multiplan 2.x file!");if(237===r[1])throw new Error("Unsupported Multiplan 3.x file!")}return Bb.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?jb.to_workbook(a,i):K_(e,a,i,s)}function Z_(e,t,i,r,a,s,n){var o=Gg(i),l=n.defval,c=n.raw||!Object.prototype.hasOwnProperty.call(n,"raw"),h=!0,u=null!=e["!data"],d=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:i,enumerable:!1})}catch(e){d.__rowNum__=i}else d.__rowNum__=i;if(!u||e["!data"][i])for(var f=t.s.c;f<=t.e.c;++f){var p=u?(e["!data"][i]||[])[f]:e[r[f]+o];if(null!=p&&void 0!==p.t){var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"b":case"n":if(!p.z||!Sf(p.z))break;if("number"==typeof(g=Vf(g)))break;case"d":n&&(n.UTC||!1===n.raw)||(g=op(new Date(g)));break;default:throw new Error("unrecognized type "+p.t)}if(null!=s[f]){if(null==g)if("e"==p.t&&null===g)d[s[f]]=null;else if(void 0!==l)d[s[f]]=l;else{if(!c||null!==g)continue;d[s[f]]=null}else d[s[f]]=("n"===p.t&&"boolean"==typeof n.rawNumbers?n.rawNumbers:c)?g:im(p,g,n);null!=g&&(h=!1)}}else{if(void 0===l)continue;null!=s[f]&&(d[s[f]]=l)}}return{row:d,isempty:h}}function J_(e,t){if(null==e||null==e["!ref"])return[];var i={t:"n",v:0},r=0,a=1,s=[],n=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},h=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof h){case"string":l=tm(h);break;case"number":(l=tm(e["!ref"])).s.r=h;break;default:l=h}r>0&&(a=0);var u=Gg(l.s.r),d=[],f=[],p=0,g=0,m=null!=e["!data"],b=l.s.r,v=0,y={};m&&!e["!data"][b]&&(e["!data"][b]=[]);var _=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(v=l.s.c;v<=l.e.c;++v)if(!(_[v]||{}).hidden)switch(d[v]=qg(v),i=m?e["!data"][b][v]:e[d[v]+u],r){case 1:s[v]=v-l.s.c;break;case 2:s[v]=d[v];break;case 3:s[v]=c.header[v-l.s.c];break;default:if(null==i&&(i={w:"__EMPTY",t:"s"}),o=n=im(i,null,c),g=y[n]||0){do{o=n+"_"+g++}while(y[o]);y[n]=g,y[o]=1}else y[n]=1;s[v]=o}for(b=l.s.r+a;b<=l.e.r;++b)if(!(w[b]||{}).hidden){var x=Z_(e,l,b,d,r,s,c);(!1===x.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(f[p++]=x.row)}return f.length=p,f}var Q_=/"/g;function ew(e,t,i,r,a,s,n,o){for(var l=!0,c=[],h="",u=Gg(i),d=null!=e["!data"],f=d&&e["!data"][i]||[],p=t.s.c;p<=t.e.c;++p)if(r[p]){var g=d?f[p]:e[r[p]+u];if(null==g)h="";else if(null!=g.v){l=!1,h=""+(o.rawNumbers&&"n"==g.t?g.v:im(g,null,o));for(var m=0,b=0;m!==h.length;++m)if((b=h.charCodeAt(m))===a||b===s||34===b||o.forceQuotes){h='"'+h.replace(Q_,'""')+'"';break}"ID"==h&&(h='"ID"')}else null==g.f||g.F?h="":(l=!1,(h="="+g.f).indexOf(",")>=0&&(h='"'+h.replace(Q_,'""')+'"'));c.push(h)}if(o.strip)for(;""===c[c.length-1];)--c.length;return!1===o.blankrows&&l?null:c.join(n)}function tw(e,t){var i=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";for(var a=tm(e["!ref"]),s=void 0!==r.FS?r.FS:",",n=s.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c="",h=[],u=r.skipHidden&&e["!cols"]||[],d=r.skipHidden&&e["!rows"]||[],f=a.s.c;f<=a.e.c;++f)(u[f]||{}).hidden||(h[f]=qg(f));for(var p=0,g=a.s.r;g<=a.e.r;++g)(d[g]||{}).hidden||null!=(c=ew(e,a,g,h,n,l,s,r))&&(c||!1!==r.blankrows)&&i.push((p++?o:"")+c);return i.join("")}function iw(e,t,i){var r=i||{},a=e?null!=e["!data"]:r.dense,s=+!r.skipHeader,n=e||{};!e&&a&&(n["!data"]=[]);var o=0,l=0;if(n&&null!=r.origin)if("number"==typeof r.origin)o=r.origin;else{var c="string"==typeof r.origin?Zg(r.origin):r.origin;o=c.r,l=c.c}var h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(n["!ref"]){var u=tm(n["!ref"]);h.e.c=Math.max(h.e.c,u.e.c),h.e.r=Math.max(h.e.r,u.e.r),-1==o&&(o=u.e.r+1,h.e.r=o+t.length-1+s)}else-1==o&&(o=0,h.e.r=t.length-1+s);var d=r.header||[],f=0,p=[];t.forEach((function(e,t){a&&!n["!data"][o+t+s]&&(n["!data"][o+t+s]=[]),a&&(p=n["!data"][o+t+s]),Bf(e).forEach((function(i){-1==(f=d.indexOf(i))&&(d[f=d.length]=i);var c=e[i],h="z",u="",g=a?"":qg(l+f)+Gg(o+t+s),m=a?p[l+f]:n[g];!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?h="n":"boolean"==typeof c?h="b":"string"==typeof c?h="s":c instanceof Date?(h="d",r.UTC||(c=lp(c)),r.cellDates||(h="n",c=Wf(c)),u=null!=m&&m.z&&Sf(m.z)?m.z:r.dateNF||tf[14]):null===c&&r.nullError&&(h="e",c=0),m?(m.t=h,m.v=c,delete m.w,delete m.R,u&&(m.z=u)):a?p[l+f]=m={t:h,v:c}:n[g]=m={t:h,v:c},u&&(m.z=u)):a?p[l+f]=c:n[g]=c}))})),h.e.c=Math.max(h.e.c,l+d.length-1);var g=Gg(o);if(a&&!n["!data"][o]&&(n["!data"][o]=[]),s)for(f=0;f<d.length;++f)a?n["!data"][o][f+l]={t:"s",v:d[f]}:n[qg(f+l)+g]={t:"s",v:d[f]};return n["!ref"]=em(h),n}function rw(e,t,i){if("string"==typeof t){if(null!=e["!data"]){var r=Zg(t);return e["!data"][r.r]||(e["!data"][r.r]=[]),e["!data"][r.r][r.c]||(e["!data"][r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return rw(e,"number"!=typeof t?Jg(t):qg(i||0)+Gg(t))}function aw(e,t){var i={SheetNames:[],Sheets:{}};return e&&sw(i,e,t||"Sheet1"),i}function sw(e,t,i,r){var a=1;if(!i)for(;a<=65535&&-1!=e.SheetNames.indexOf(i="Sheet"+a);++a,i=void 0);if(!i||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(i)>=0&&i.length<32){var s=i.match(/\d+$/);a=s&&+s[0]||0;var n=s&&i.slice(0,s.index)||i;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(i=n+a);++a);}if(function(e,t){try{if(""==e)throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(39==e.charCodeAt(0)||39==e.charCodeAt(e.length-1))throw new Error("Sheet name cannot start or end with apostrophe (')");if("history"==e.toLowerCase())throw new Error("Sheet name cannot be 'History'");Yy.forEach((function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}))}catch(e){if(t)return!1;throw e}}(i),e.SheetNames.indexOf(i)>=0)throw new Error("Worksheet with name |"+i+"| already exists!");return e.SheetNames.push(i),e.Sheets[i]=t,i}function nw(e,t,i){return t?(e.l={Target:t},i&&(e.l.Tooltip=i)):delete e.l,e}var ow={encode_col:qg,encode_row:Gg,encode_cell:Jg,encode_range:em,decode_col:Kg,decode_row:Yg,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Zg,decode_range:Qg,format_cell:im,sheet_new:function(e){var t={};return(e||{}).dense&&(t["!data"]=[]),t},sheet_add_aoa:am,sheet_add_json:iw,sheet_add_dom:v_,aoa_to_sheet:sm,json_to_sheet:function(e,t){return iw(null,e,t)},table_to_sheet:y_,table_to_book:function(e,t){return rm(y_(e,t),t)},sheet_to_csv:tw,sheet_to_txt:function(e,t){t||(t={}),t.FS="\t",t.RS="\n";var i=tw(e,t);return i},sheet_to_json:J_,sheet_to_html:function(e,t){var i=t||{},r=null!=i.header?i.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',a=null!=i.footer?i.footer:"</body></html>",s=[r],n=Qg(e["!ref"]||"A1");if(s.push(function(e,t,i){return[].join("")+"<table"+(i&&i.id?' id="'+i.id+'"':"")+">"}(0,0,i)),e["!ref"])for(var o=n.s.r;o<=n.e.r;++o)s.push(b_(e,n,o,i));return s.push("</table>"+a),s.join("")},sheet_to_formulae:function(e){var t,i="",r="";if(null==e||null==e["!ref"])return[];var a,s=tm(e["!ref"]),n="",o=[],l=[],c=null!=e["!data"];for(a=s.s.c;a<=s.e.c;++a)o[a]=qg(a);for(var h=s.s.r;h<=s.e.r;++h)for(n=Gg(h),a=s.s.c;a<=s.e.c;++a)if(i=o[a]+n,r="",void 0!==(t=c?(e["!data"][h]||[])[a]:e[i])){if(null!=t.F){if(i=t.F,!t.f)continue;r=t.f,-1==i.indexOf(":")&&(i=i+":"+i)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=i+"="+r}return l},sheet_to_row_object_array:J_,sheet_get_cell:rw,book_new:aw,book_append_sheet:sw,book_set_sheet_visibility:function(e,t,i){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var i=e.SheetNames.indexOf(t);if(i>-1)return i;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),i){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+i)}e.Workbook.Sheets[r].Hidden=i},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:nw,cell_set_internal_link:function(e,t,i){return nw(e,"#"+t,i)},cell_add_comment:function(e,t,i){e.c||(e.c=[]),e.c.push({t,a:i||"SheetJS"})},sheet_set_array_formula:function(e,t,i,r){for(var a="string"!=typeof t?t:tm(t),s="string"==typeof t?t:em(t),n=a.s.r;n<=a.e.r;++n)for(var o=a.s.c;o<=a.e.c;++o){var l=rw(e,n,o);l.t="n",l.F=s,delete l.v,n==a.s.r&&o==a.s.c&&(l.f=i,r&&(l.D=!0))}var c=Qg(e["!ref"]);return c.s.r>a.s.r&&(c.s.r=a.s.r),c.s.c>a.s.c&&(c.s.c=a.s.c),c.e.r<a.e.r&&(c.e.r=a.e.r),c.e.c<a.e.c&&(c.e.c=a.e.c),e["!ref"]=em(c),e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},lw=i(5745),cw=i.n(lw),hw=i(6333),uw=i.n(hw),dw=i(9098),fw=i.n(dw),pw=i(1618),gw=i.n(pw),mw=i(9904),bw=i.n(mw);let vw=class extends yd.ComponentModelBase{designPanelVisible=!1;crossSectionPanelVisible=!1;loading=!1;elevationLayerUrl;graphicsLayerLine;graphicsLayerCrossSection;graphicsLayerTemp;graphicsLayerMesh;elevationLayer;designLayer2D=null;uniqueParts=[];map;view;sketchViewModel;drawnLine;offsetGeometries=[];meshes=[];mergedMesh=null;meshGraphic=null;gridSize=1;totalVolumeDifference=0;excavationVolume=0;fillVolume=0;chartData=null;allChartData={};excelSheets={};activeSheet="";chartRoot=null;chart=null;chartSeries=null;crossSectionChartData=null;crossSectionChartRoot=null;crossSectionChart=null;meshSeriesData=null;userLinePoints=[];slopeLabels=[];lineFeatureLayers=[];selectedLineLayerId;selectedLineLayer;selectedDijkvakLayerFields=[];selectedDijkvakField=null;lineLayerSymbol={type:"simple-line",color:[255,0,255],width:4};intersectingPanden=[];intersectingBomen=[];intersectingPercelen=[];dwpLocations=["buitenteen","onderkant_buitenberm","bovenkant_buitenberm","buitenkruin","binnenkruin","bovenkant_binnenberm","onderkant_binnenberm","binnenteen"];overviewVisible=!1;handleGeoJSONUpload(e){const t=new FileReader;t.onload=e=>{try{const t=JSON.parse(e.target?.result);if(console.log("Parsed GeoJSON:",t),!t?.features)return void console.error("Invalid GeoJSON format.");const i=function(e){if(!e)return console.warn("No CRS information found."),null;if("string"==typeof e){const t=e.match(/EPSG[:]*([0-9]+)/);return t?parseInt(t[1]):null}if(e?.properties?.name){const t=e.properties.name,i=t.match(/EPSG[:]*([0-9]+)/);if(i)return parseInt(i[1]);if(t.includes("CRS84"))return console.warn("CRS84 detected, defaulting to EPSG:4326."),4326}return console.warn("Unsupported CRS format:",e),null}(t.crs?.properties?.name||"");console.log("Input EPSG:",i),en.load().then((()=>{t.features.forEach((e=>{const{geometry:t,properties:r}=e;let a;const s=new(Js())({wkid:3857});let n=new(Js())({wkid:i});if(i||(n=new(Js())({wkid:4326})),"LineString"===t.type)a=new(Hs())({paths:[t.coordinates],spatialReference:n});else{if("MultiLineString"!==t.type)return void console.warn("Unsupported geometry type:",t.type);a=new(Hs())({paths:t.coordinates,spatialReference:n})}const o=en.project(a,s),l=new(zs())({geometry:o,attributes:r,symbol:this.lineLayerSymbol});this.graphicsLayerLine.add(l)}))}))}catch(e){console.error("Error parsing GeoJSON:",e)}},t.readAsText(e)}startDrawingLine(e){return e?.graphics?.length>0&&e.removeAll(),this.sketchViewModel.layer=e,this.sketchViewModel.create("polyline"),new Promise(((e,t)=>{const i=this.sketchViewModel.on("create",(t=>{if("complete"===t.state){const r=t.graphic.geometry;this.drawnLine=r,this.sketchViewModel.set("state","update"),this.sketchViewModel.update(t.graphic),i.remove(),e(r)}}))}))}selectLineFromMap(){}handleExcelUpload=e=>{const t=e.target,i=t.files?.[0];if(i){const e=new FileReader;e.onload=e=>{const t=q_(new Uint8Array(e.target?.result),{type:"array"}),i={},r={};t.SheetNames.forEach((e=>{const a=t.Sheets[e],s=ow.sheet_to_json(a,{header:1});i[e]=s,s.length>1&&(r[e]=s.slice(1).map((e=>({locatie:e[0],afstand:e[1],hoogte:e[2]}))).sort(((e,t)=>e.afstand-t.afstand)))})),this.allChartData=r,console.log("All chart data:",this.allChartData);const a=t.SheetNames[0];this.chartData=r[a],this.activeSheet=a},e.readAsArrayBuffer(i)}t.value="",this.overviewVisible=!0};setSheetData(e){const t=this.excelSheets[e];if(t&&t.length>1){const e=t.slice(1).map((e=>({locatie:e[0],afstand:e[1],hoogte:e[2]}))).sort(((e,t)=>e.afstand-t.afstand));this.chartData=e}}_getSerializableProperties(){return{...super._getSerializableProperties(),elevationLayerUrl:{serializeModes:["initial"],default:"https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer"}}}async _onInitialize(){await super._onInitialize(),console.log("DikeDesignerModel initialized"),this.messages.events.map.initialized.subscribe((async e=>{function t(e){return e.includes("berm")?{type:"simple-fill",color:[102,204,102,.9],outline:{color:[0,100,0,1],width:1}}:e.includes("kruin")?{type:"simple-fill",color:[180,180,180,.9],outline:{color:[80,80,80,1],width:1}}:{type:"simple-fill",color:[200,200,255,.9],outline:{color:[100,100,200,1],width:1}}}console.log("Map initialized:",e),this.map=e.maps.map,this.view=e.maps.view,this.designLayer2D=new(fw())({title:"Ontwerpdata - 2D",listMode:"show",geometryType:"polygon",objectIdField:"ObjectID",source:[],fields:[{name:"ObjectID",alias:"ObjectID",type:"oid"},{name:"name",alias:"Name",type:"string"}]});const i=["buitenkruin-binnenkruin","buitenkruin-bovenkant_buitenberm","binnenkruin-bovenkant_binnenberm","bovenkant_buitenberm-onderkant_buitenberm","onderkant_buitenberm-buitenteen","bovenkant_binnenberm-onderkant_binnenberm","onderkant_binnenberm-binnenteen"].map((e=>({value:e,symbol:t(e)})));this.designLayer2D.renderer=new(gw())({field:"name",uniqueValueInfos:i,defaultSymbol:{type:"simple-fill",color:[204,255,204,.7],outline:{color:[0,128,0,1],width:1}}}),this.graphicsLayerLine=new(cw())({title:"Temporary Layer",elevationInfo:{mode:"absolute-height",offset:0},listMode:"hide"}),this.graphicsLayerCrossSection=new(cw())({title:"Dwarsprofiel - tijdelijk",elevationInfo:{mode:"absolute-height",offset:0},listMode:"hide"}),this.graphicsLayerTemp=new(cw())({title:"Ontwerpdata - tijdelijk",elevationInfo:{mode:"absolute-height",offset:0},listMode:"show",visible:!1}),this.graphicsLayerMesh=new(cw())({title:"Mesh layer - tijdelijk",elevationInfo:{mode:"absolute-height",offset:0},listMode:"show"}),this.elevationLayer=new(uw())({url:this.elevationLayerUrl}),this.map.add(this.graphicsLayerLine),this.map.add(this.graphicsLayerCrossSection),this.map.add(this.graphicsLayerTemp),this.map.add(this.graphicsLayerMesh),this.map.add(this.designLayer2D),this.lineFeatureLayers=await async function(e){if(!e)return console.error("Map is not initialized."),[];const t=e.layers.filter((e=>"feature"===e.type)).filter((e=>"polyline"===e.geometryType));return console.log("Line Feature Layers:",t),t}(this.map),console.log("Line feature layers:",this.lineFeatureLayers),await vd.whenOnce((()=>this.view)).then((()=>{console.log("Graphics layer added to the map."),this.sketchViewModel=new(bw())({view:this.view})}))}))}};vw=function(e,t,i,r){var a,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n}([yd.serializable],vw);const yw=vw;var _w=i(3622);const ww=async e=>{const{model:t,settings:i}=e,{elevationLayerUrl:r,...a}=i;await(0,_w.applyComponentModelDesignerSettings)(e);const s=a;void 0!==r&&(s.elevationLayerUrl=r),t.assignProperties(s)},xw=async e=>{const{model:t}=e,{elevationLayerUrl:i}=t;return{...await(0,_w.getComponentModelDesignerSettings)(e),elevationLayerUrl:i}},Aw=async e=>{const t=await(0,_w.getComponentModelDesignerSettingsSchema)(e);return t.settings[0].settings=t.settings[0].settings.concat([{id:"elevationLayerUrl",type:"text",description:"The url for the elevation layer.",displayName:"Elevation Layer URL"}]),{...t,settings:[...t.settings]}}},7786:e=>{"use strict";e.exports=v},5961:e=>{"use strict";e.exports=b},9478:t=>{"use strict";t.exports=e},7320:e=>{"use strict";e.exports=t},1618:e=>{"use strict";e.exports=A},5635:e=>{"use strict";e.exports=a},3622:e=>{"use strict";e.exports=k},65:e=>{"use strict";e.exports=y},6817:e=>{"use strict";e.exports=s},6879:e=>{"use strict";e.exports=S},8309:e=>{"use strict";e.exports=P},3418:e=>{"use strict";e.exports=n},3250:e=>{"use strict";e.exports=u},3346:e=>{"use strict";e.exports=h},4351:e=>{"use strict";e.exports=c},8071:e=>{"use strict";e.exports=l},6795:e=>{"use strict";e.exports=o},1438:e=>{"use strict";e.exports=d},7761:e=>{"use strict";e.exports=f},2542:e=>{"use strict";e.exports=p},1591:e=>{"use strict";e.exports=g},1580:e=>{"use strict";e.exports=E},6333:e=>{"use strict";e.exports=w},9098:e=>{"use strict";e.exports=x},5745:e=>{"use strict";e.exports=_},9904:e=>{"use strict";e.exports=T},5959:e=>{"use strict";e.exports=r},8398:e=>{"use strict";e.exports=m},6308:e=>{"use strict";e.exports=i},4634:e=>{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4994:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},4893:e=>{e.exports=function(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i},e.exports.__esModule=!0,e.exports.default=e.exports},8168:(e,t,i)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},r.apply(null,arguments)}i.d(t,{A:()=>r})},8587:(e,t,i)=>{"use strict";function r(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i}i.d(t,{A:()=>r})},4164:(e,t,i)=>{"use strict";function r(e){var t,i,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(i=r(e[t]))&&(a&&(a+=" "),a+=i)}else for(i in e)e[i]&&(a&&(a+=" "),a+=i);return a}i.d(t,{A:()=>a});const a=function(){for(var e,t,i=0,a="",s=arguments.length;i<s;i++)(e=arguments[i])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}}},D={};function O(e){var t=D[e];if(void 0!==t)return t.exports;var i=D[e]={exports:{}};return C[e](i,i.exports,O),i.exports}O.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return O.d(t,{a:t}),t},O.d=(e,t)=>{for(var i in t)O.o(t,i)&&!O.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},O.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),O.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var R={};return(()=>{"use strict";O.r(R),O.d(R,{default:()=>A});var e=O(9478),t=O.n(e),i=O(7320);const r=new(O.n(i)())({appId:"bF0Vj7tJiGzVrnlq",popup:!0,portalUrl:"https://portal.wsrl.nl/portal",popupCallbackUrl:"http://localhost:3001/oath-callback.html"});var a=O(9740),s=O(6308),n=O(5635),o=O(6817),l=O(6879),c=O.n(l),h=O(8309),u=O.n(h);const d=e=>{const{model:t}=e;return(0,o.useWatchAndRerender)(t,"exaggeration"),(0,s.jsx)(n.LayoutElement,{...e,children:(0,s.jsxs)(c(),{sx:{width:300,height:100,p:"32px",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,s.jsx)(c(),{sx:{alignSelf:"flex-start",mb:1,fontWeight:600},children:"Hoogte factor:"}),(0,s.jsx)(u(),{value:t.exaggeration,onChange:(e,i)=>{t.exaggeration=i,t.processChange()},"aria-label":"Elevation Exaggeration",defaultValue:1,valueLabelDisplay:"auto",step:.2,marks:!0,min:1,max:2})]})})};var f=O(65),p=O(1580),g=O.n(p),m=O(6333),b=O.n(m);let v=class extends f.ComponentModelBase{map;view;elevationLayerUrl;exaggeration=1;processChange(){const e=this.createNewElevation(this.exaggeration);this.map.ground.layers=[new e]}createNewElevation(e){class t extends(g()){_elevation;async load(){this._elevation=new(b())({url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer"}),await this.addResolvingPromise(this._elevation.load())}async fetchTile(t,i,r,a){const s=await this._elevation.fetchTile(t,i,r,a),n=e;for(let e=0;e<s.values.length;e++)s.values[e]!==s.noDataValue&&(s.values[e]*=n);return s}}return t}_getSerializableProperties(){return{...super._getSerializableProperties(),elevationLayerUrl:{serializeModes:["initial"],default:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer"}}}async _onInitialize(){await super._onInitialize(),this.messages.events.map.initialized.subscribe((async e=>{console.log("Map initialized:",e),this.map=e.maps.map,this.view=e.maps.view;const t=this.createNewElevation(this.exaggeration);this.map.ground.layers=[new t]}))}};v=function(e,t,i,r){var a,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n}([f.serializable],v);const y=v,_="vertigis-wsrl",w="localhost"===window.location.hostname,x=()=>Promise.resolve().then(O.bind(O,9740));function A(e){e.registerComponent({category:"map",iconId:"station-locator",name:"dike-designer",namespace:_,getComponentType:()=>a.default,itemType:"dike-designer-model",title:"Dike designer",getDesignerSettings:async e=>(await x()).getSettings(e),applyDesignerSettings:async e=>(await x()).applySettings(e),getDesignerSettingsSchema:async e=>(await x()).getSettingsSchema(e)}),e.registerModel({getModel:e=>new a.DikeDesignerModel(e),itemType:"dike-designer-model"}),function(e){e.registerComponent({category:"map",iconId:"station-locator",name:"elevation-exaggerator",namespace:"vertigis-wsrl",getComponentType:()=>d,itemType:"elevation-exaggerator-model",title:"Elevation Exaggerator"}),e.registerModel({getModel:e=>new y(e),itemType:"elevation-exaggerator-model"})}(e)}w?(console.log("Running in development mode"),async function(){try{t().registerOAuthInfos([r])}catch(e){console.log(e,"error")}}().then((e=>{console.log("User authenticated:",e)})).catch((e=>{console.error("Error during authentication:",e)}))):console.log("Not in development mode")})(),R})()));